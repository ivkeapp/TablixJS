{"version":3,"file":"tablixjs.cjs.js","sources":["../src/core/DataManager.js","../src/core/Renderer.js","../src/core/EventManager.js","../src/core/PaginationManager.js","../src/core/SortingManager.js","../src/core/ColumnManager.js","../src/core/FilterManager.js","../src/core/FilterUI.js","../src/core/SearchManager.js","../src/core/SelectionManager.js","../src/core/VirtualScroll.js","../src/core/Table.js","../src/index.js"],"sourcesContent":["export default class DataManager {\r\n  constructor(table, data = []) {\r\n    this.table = table;\r\n    this.originalData = data;   // full data set\r\n    this.filteredData = [...data];  // filtered data\r\n    this.currentFilters = {};   // current filter criteria\r\n    this.currentSorts = [];     // current sort criteria (deprecated - use SortingManager)\r\n    this.serverTotalRows = null; // for server-side pagination\r\n  }\r\n\r\n  getData() {\r\n    return this.filteredData;\r\n  }\r\n\r\n  setData(data) {\r\n    this.originalData = data;\r\n    this.filteredData = [...data];\r\n    \r\n    // Update pagination info after data change\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.updatePaginationInfo();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set data from server (for server-side operations)\r\n   */\r\n  setServerData(data, totalRows = null) {\r\n    this.originalData = data;\r\n    this.filteredData = [...data];\r\n    this.serverTotalRows = totalRows;\r\n    \r\n    // Update pagination info after data change\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.updatePaginationInfo(totalRows);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get total rows (for server-side pagination)\r\n   */\r\n  getTotalRows() {\r\n    return this.serverTotalRows !== null ? this.serverTotalRows : this.originalData.length;\r\n  }\r\n\r\n  applyFilter(criteria) {\r\n    this.currentFilters = criteria;\r\n    \r\n    if (Object.keys(criteria).length === 0) {\r\n      // No filters, show all data\r\n      this.filteredData = [...this.originalData];\r\n    } else {\r\n      // Simple filtering: supports multiple criteria (legacy format)\r\n      this.filteredData = this.originalData.filter(item => {\r\n        return Object.entries(criteria).every(([key, value]) => {\r\n          const itemValue = (item[key] + '').toLowerCase();\r\n          const searchValue = (value + '').toLowerCase();\r\n          return itemValue.includes(searchValue);\r\n        });\r\n      });\r\n    }\r\n\r\n    // Reset pagination to first page after filtering\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.resetToFirstPage();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Apply filtering from FilterManager (this will be called by FilterManager)\r\n   * @param {Array} filteredData - Pre-filtered data from FilterManager\r\n   */\r\n  setFilteredData(filteredData) {\r\n    this.filteredData = filteredData;\r\n    \r\n    // Reset pagination to first page after filtering\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.resetToFirstPage();\r\n    }\r\n  }\r\n\r\n  applySorting(sorts) {\r\n    this.currentSorts = sorts;\r\n    \r\n    if (!sorts || sorts.length === 0) {\r\n      return;\r\n    }\r\n\r\n    // Use SortingManager if available, otherwise fall back to basic sorting\r\n    if (this.table.sortingManager && this.table.sortingManager.currentSorts.length > 0) {\r\n      this.table.sortingManager._applySorting();\r\n    } else {\r\n      // Legacy sorting implementation\r\n      this.filteredData.sort((a, b) => {\r\n        for (const sort of sorts) {\r\n          const { column, direction } = sort;\r\n          const aVal = a[column];\r\n          const bVal = b[column];\r\n          \r\n          let comparison = 0;\r\n          if (aVal < bVal) comparison = -1;\r\n          else if (aVal > bVal) comparison = 1;\r\n          \r\n          if (comparison !== 0) {\r\n            return direction === 'desc' ? -comparison : comparison;\r\n          }\r\n        }\r\n        return 0;\r\n      });\r\n    }\r\n\r\n    // Reset pagination to first page after sorting\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.resetToFirstPage();\r\n    }\r\n  }\r\n\r\n  clearFilters() {\r\n    this.currentFilters = {};\r\n    this.filteredData = [...this.originalData];\r\n    \r\n    // Reset pagination to first page\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.resetToFirstPage();\r\n    }\r\n  }\r\n\r\n  clearSorting() {\r\n    this.currentSorts = [];\r\n    // Don't change the filtered data order, just clear the sort state\r\n    \r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.resetToFirstPage();\r\n    }\r\n  }\r\n\r\n  // Legacy method for backward compatibility\r\n  getPageData(page = 1) {\r\n    const pageSize = this.table.paginationManager ? \r\n      this.table.paginationManager.pageSize : 10;\r\n    const start = (page - 1) * pageSize;\r\n    return this.filteredData.slice(start, start + pageSize);\r\n  }\r\n}","export default class Renderer {\r\n  constructor(table) {\r\n    this.table = table;\r\n  }\r\n\r\n  renderTable(data, virtualMode = false) {\r\n    const columns = this.table.columnManager ? this.table.columnManager.getColumns() : (this.table.options.columns || []);\r\n    const controlsOptions = this.table.options.controls;\r\n    const isVirtualScrollEnabled = this.table.virtualScrollManager && this.table.virtualScrollManager.isEnabled();\r\n\r\n    // Preserve search input value and focus state before re-rendering\r\n    let preservedSearchValue = '';\r\n    let searchInputHadFocus = false;\r\n    let cursorPosition = 0;\r\n    const existingSearchInput = this.table.container.querySelector('.tablix-search-input');\r\n    if (existingSearchInput) {\r\n      preservedSearchValue = existingSearchInput.value;\r\n      searchInputHadFocus = document.activeElement === existingSearchInput;\r\n      cursorPosition = existingSearchInput.selectionStart || 0;\r\n    }\r\n\r\n    // Determine selection attributes\r\n    const selectionEnabled = this.table.selectionManager && this.table.selectionManager.options.enabled;\r\n    const selectionAttributes = selectionEnabled \r\n      ? `data-selection-enabled data-selection-mode=\"${this.table.selectionManager.options.mode}\"` \r\n      : 'data-selection-disabled';\r\n\r\n    let html = `<div class=\"tablix-wrapper\" ${selectionAttributes}>`;\r\n    \r\n    // Top controls\r\n    if (controlsOptions.enabled && (controlsOptions.position === 'top' || controlsOptions.position === 'both')) {\r\n      html += this.renderControls('top');\r\n    }\r\n    \r\n    // Virtual scroll container (if enabled)\r\n    if (isVirtualScrollEnabled) {\r\n      const containerHeight = this.table.options.virtualScroll.containerHeight || 400;\r\n      html += `<div class=\"tablix-scroll-container\" style=\"height: ${containerHeight}px; overflow: auto; position: relative; border: 1px solid #ddd;\">`;\r\n    }\r\n    \r\n    // Table\r\n    html += '<table class=\"tablix-table\" style=\"width:100%; border-collapse:collapse;\">';\r\n\r\n    // Header\r\n    html += '<thead class=\"tablix-thead\"><tr class=\"tablix-header-row\">';\r\n    columns.forEach(col => {\r\n      const isSortable = this._isColumnSortable(col);\r\n      const sortDirection = this._getSortDirection(col.name);\r\n      const sortClass = isSortable ? ' tablix-sortable' : '';\r\n      const sortDirectionClass = sortDirection ? ` tablix-sorted tablix-sorted-${sortDirection}` : '';\r\n      \r\n      html += `<th class=\"tablix-th${sortClass}${sortDirectionClass}\" data-column=\"${col.name}\">`;\r\n      html += `<div class=\"tablix-th-content\">`;\r\n      html += `<span class=\"tablix-th-text\">${col.title || col.name}</span>`;\r\n      \r\n      if (isSortable) {\r\n        html += `<span class=\"tablix-sort-indicator\">`;\r\n        if (sortDirection === 'asc') {\r\n          html += `<span class=\"tablix-sort-arrow tablix-sort-asc\" aria-label=\"Sorted ascending\">↑</span>`;\r\n        } else if (sortDirection === 'desc') {\r\n          html += `<span class=\"tablix-sort-arrow tablix-sort-desc\" aria-label=\"Sorted descending\">↓</span>`;\r\n        } else {\r\n          html += `<span class=\"tablix-sort-arrow tablix-sort-none\" aria-label=\"Not sorted\">↕</span>`;\r\n        }\r\n        html += `</span>`;\r\n      }\r\n      \r\n      html += `</div>`;\r\n      html += `</th>`;\r\n    });\r\n    html += '</tr></thead>';\r\n\r\n    // Body\r\n    html += '<tbody class=\"tablix-tbody\">';\r\n    \r\n    // For virtual scrolling, only render empty structure or limited rows\r\n    if (isVirtualScrollEnabled && virtualMode) {\r\n      // Empty body for virtual scrolling - rows will be added by VirtualScrollManager\r\n      html += `<tr class=\"tablix-placeholder-row\" style=\"display: none;\"><td colspan=\"${columns.length}\"></td></tr>`;\r\n    } else if (data.length === 0) {\r\n      html += `<tr class=\"tablix-empty-row\"><td colspan=\"${columns.length}\" class=\"tablix-empty-cell\">No data available</td></tr>`;\r\n    } else {\r\n      data.forEach((row, index) => {\r\n        // Calculate global row index for pagination\r\n        let globalIndex = index;\r\n        if (this.table.paginationManager && this.table.paginationManager.options.mode === 'client') {\r\n          const currentPage = this.table.paginationManager.currentPage;\r\n          const pageSize = this.table.paginationManager.pageSize;\r\n          globalIndex = (currentPage - 1) * pageSize + index;\r\n        }\r\n        \r\n        html += `<tr class=\"tablix-row\" data-row-index=\"${globalIndex}\">`;\r\n        columns.forEach(col => {\r\n          const cell = row[col.name];\r\n          let renderedCell;\r\n          \r\n          // Use ColumnManager for formatting if available\r\n          if (this.table.columnManager) {\r\n            const result = this.table.columnManager.formatCellValue(col.name, cell, row);\r\n            if (result.isHtml) {\r\n              // Custom renderer returned HTML - use as is\r\n              renderedCell = result.value;\r\n            } else {\r\n              // Formatted or raw value - escape for safety\r\n              renderedCell = this.escapeHtml(result.value);\r\n            }\r\n          } else {\r\n            // Fallback to original renderer logic\r\n            renderedCell = col.renderer ? col.renderer(cell, row) : this.escapeHtml(cell);\r\n          }\r\n          \r\n          html += `<td class=\"tablix-td\">${renderedCell}</td>`;\r\n        });\r\n        html += '</tr>';\r\n      });\r\n    }\r\n    html += '</tbody>';\r\n    html += '</table>';\r\n    \r\n    // Close virtual scroll container if enabled\r\n    if (isVirtualScrollEnabled) {\r\n      html += '</div>'; // Close tablix-scroll-container\r\n    }\r\n\r\n    // Pagination will be rendered separately\r\n    html += '<div class=\"tablix-pagination-container\"></div>';\r\n    \r\n    // Bottom controls\r\n    if (controlsOptions.enabled && (controlsOptions.position === 'bottom' || controlsOptions.position === 'both')) {\r\n      html += this.renderControls('bottom');\r\n    }\r\n    \r\n    html += '</div>';\r\n\r\n    // Update DOM\r\n    this.table.container.innerHTML = html;\r\n    \r\n    // Restore search input value immediately after DOM update\r\n    if (preservedSearchValue) {\r\n      const newSearchInput = this.table.container.querySelector('.tablix-search-input');\r\n      if (newSearchInput) {\r\n        newSearchInput.value = preservedSearchValue;\r\n      }\r\n    }\r\n    \r\n    // Render pagination controls if pagination is enabled\r\n    this.renderPagination();\r\n    \r\n    // Bind control events\r\n    if (controlsOptions.enabled) {\r\n      this.bindControlEvents();\r\n    }\r\n\r\n    // Bind search events if search is enabled\r\n    if (this.table.searchManager) {\r\n      this.table.searchManager.bindEvents();\r\n    }\r\n\r\n    // Bind sort events if sorting is enabled\r\n    if (this.table.sortingManager) {\r\n      this.bindSortEvents();\r\n    }\r\n\r\n    // Bind row click events if selection is enabled\r\n    if (this.table.selectionManager && this.table.selectionManager.options.enabled) {\r\n      this.bindRowClickEvents();\r\n    }\r\n\r\n    // Render filter icons and bind events if filtering is enabled\r\n    if (this.table.filterUI) {\r\n      this.table.filterUI.renderFilterIcons();\r\n    }\r\n\r\n    // Restore focus AFTER all event binding is complete\r\n    if (searchInputHadFocus) {\r\n      const newSearchInput = this.table.container.querySelector('.tablix-search-input');\r\n      if (newSearchInput) {\r\n        // Use requestAnimationFrame to ensure focus happens after all DOM operations\r\n        requestAnimationFrame(() => {\r\n          newSearchInput.focus();\r\n          // Restore cursor position\r\n          if (cursorPosition > 0) {\r\n            newSearchInput.setSelectionRange(cursorPosition, cursorPosition);\r\n          }\r\n        });\r\n      }\r\n    }\r\n\r\n    // Trigger afterRender event\r\n    this.table.eventManager.trigger('afterRender');\r\n  }\r\n\r\n  renderPagination() {\r\n    const paginationContainer = this.table.container.querySelector('.tablix-pagination-container');\r\n    if (!paginationContainer || !this.table.paginationManager) {\r\n      return;\r\n    }\r\n\r\n    const paginationManager = this.table.paginationManager;\r\n    const info = paginationManager.getInfo();\r\n    \r\n    if (!paginationManager.options.enabled && paginationManager.options.enabled !== undefined) {\r\n      paginationContainer.innerHTML = '';\r\n      return;\r\n    }\r\n\r\n    // Don't show pagination if there's only one page and no custom page sizes\r\n    if (info.totalPages <= 1 && !paginationManager.options.showPageSizes) {\r\n      paginationContainer.innerHTML = '';\r\n      return;\r\n    }\r\n\r\n    let html = '<div class=\"tablix-pagination\">';\r\n    \r\n    // Page info\r\n    html += `<div class=\"tablix-pagination-info\">`;\r\n    if (info.totalRows === 0) {\r\n      html += 'No records found';\r\n    } else {\r\n      html += `Showing ${info.startRow}-${info.endRow} of ${info.totalRows} records`;\r\n    }\r\n    html += '</div>';\r\n\r\n    // Page size selector\r\n    if (paginationManager.options.showPageSizes && paginationManager.options.pageSizeOptions.length > 1) {\r\n      html += '<div class=\"tablix-pagination-page-size\">';\r\n      html += 'Show ';\r\n      html += '<select class=\"tablix-page-size-select\">';\r\n      paginationManager.options.pageSizeOptions.forEach(size => {\r\n        const selected = size === info.pageSize ? ' selected' : '';\r\n        html += `<option value=\"${size}\"${selected}>${size}</option>`;\r\n      });\r\n      html += '</select>';\r\n      html += ' records per page';\r\n      html += '</div>';\r\n    }\r\n\r\n    // Navigation controls\r\n    if (info.totalPages > 1) {\r\n      html += '<div class=\"tablix-pagination-nav\">';\r\n      \r\n      // First page\r\n      if (paginationManager.options.showFirstLast) {\r\n        const disabled = info.currentPage === 1 ? ' disabled' : '';\r\n        html += `<button class=\"tablix-pagination-btn tablix-pagination-first\" data-page=\"1\"${disabled}>First</button>`;\r\n      }\r\n      \r\n      // Previous page\r\n      if (paginationManager.options.showPrevNext) {\r\n        const disabled = !info.hasPrevPage ? ' disabled' : '';\r\n        html += `<button class=\"tablix-pagination-btn tablix-pagination-prev\" data-page=\"${info.currentPage - 1}\"${disabled}>Previous</button>`;\r\n      }\r\n      \r\n      // Page numbers\r\n      if (paginationManager.options.showPageNumbers) {\r\n        const pageNumbers = paginationManager.getPageNumbers();\r\n        pageNumbers.forEach(page => {\r\n          if (page === '...') {\r\n            html += '<span class=\"tablix-pagination-ellipsis\">...</span>';\r\n          } else {\r\n            const active = page === info.currentPage ? ' active' : '';\r\n            html += `<button class=\"tablix-pagination-btn tablix-pagination-page${active}\" data-page=\"${page}\">${page}</button>`;\r\n          }\r\n        });\r\n      }\r\n      \r\n      // Next page\r\n      if (paginationManager.options.showPrevNext) {\r\n        const disabled = !info.hasNextPage ? ' disabled' : '';\r\n        html += `<button class=\"tablix-pagination-btn tablix-pagination-next\" data-page=\"${info.currentPage + 1}\"${disabled}>Next</button>`;\r\n      }\r\n      \r\n      // Last page\r\n      if (paginationManager.options.showFirstLast) {\r\n        const disabled = info.currentPage === info.totalPages ? ' disabled' : '';\r\n        html += `<button class=\"tablix-pagination-btn tablix-pagination-last\" data-page=\"${info.totalPages}\"${disabled}>Last</button>`;\r\n      }\r\n      \r\n      html += '</div>';\r\n    }\r\n\r\n    // Loading indicator\r\n    if (info.isLoading) {\r\n      html += '<div class=\"tablix-pagination-loading\">Loading...</div>';\r\n    }\r\n    \r\n    html += '</div>';\r\n\r\n    paginationContainer.innerHTML = html;\r\n    this.bindPaginationEvents();\r\n  }\r\n\r\n  bindPaginationEvents() {\r\n    const paginationContainer = this.table.container.querySelector('.tablix-pagination');\r\n    if (!paginationContainer) {\r\n      return;\r\n    }\r\n\r\n    // Page navigation buttons\r\n    paginationContainer.addEventListener('click', async (e) => {\r\n      if (e.target.classList.contains('tablix-pagination-btn') && !e.target.disabled) {\r\n        e.preventDefault();\r\n        const page = parseInt(e.target.dataset.page);\r\n        if (!isNaN(page)) {\r\n          try {\r\n            await this.table.paginationManager.goToPage(page);\r\n          } catch (error) {\r\n            console.error('Failed to navigate to page:', error);\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    // Page size selector\r\n    const pageSizeSelect = paginationContainer.querySelector('.tablix-page-size-select');\r\n    if (pageSizeSelect) {\r\n      pageSizeSelect.addEventListener('change', async (e) => {\r\n        try {\r\n          const newPageSize = parseInt(e.target.value);\r\n          await this.table.paginationManager.changePageSize(newPageSize);\r\n        } catch (error) {\r\n          console.error('Failed to change page size:', error);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Escape HTML to prevent XSS attacks\r\n   */\r\n  escapeHtml(text) {\r\n    if (text == null) return '';\r\n    const div = document.createElement('div');\r\n    div.textContent = text.toString();\r\n    return div.innerHTML;\r\n  }\r\n\r\n  /**\r\n   * Render loading state\r\n   */\r\n  renderLoading() {\r\n    this.table.container.innerHTML = '<div class=\"tablix-loading\">Loading...</div>';\r\n  }\r\n\r\n  /**\r\n   * Render error state\r\n   */\r\n  renderError(error) {\r\n    this.table.container.innerHTML = `<div class=\"tablix-error\">Error: ${this.escapeHtml(error.message || error)}</div>`;\r\n  }\r\n\r\n  /**\r\n   * Render control panel\r\n   */\r\n  renderControls(position) {\r\n    const controlsOptions = this.table.options.controls;\r\n    const searchOptions = this.table.options.search || { enabled: false, placeholder: 'Search...' };\r\n    \r\n    let html = `<div class=\"tablix-controls tablix-controls-${position}\">`;\r\n    \r\n    // Left side controls\r\n    html += '<div class=\"tablix-controls-left\">';\r\n    \r\n    // Pagination controls\r\n    if (controlsOptions.pagination && this.table.paginationManager) {\r\n      html += '<div class=\"tablix-control-group tablix-pagination-controls\">';\r\n      html += '<button type=\"button\" class=\"tablix-btn tablix-control-btn\" data-action=\"firstPage\">First</button>';\r\n      html += '<button type=\"button\" class=\"tablix-btn tablix-control-btn\" data-action=\"prevPage\">Previous</button>';\r\n      html += '<button type=\"button\" class=\"tablix-btn tablix-control-btn\" data-action=\"nextPage\">Next</button>';\r\n      html += '<button type=\"button\" class=\"tablix-btn tablix-control-btn\" data-action=\"lastPage\">Last</button>';\r\n      html += '</div>';\r\n    }\r\n    \r\n    // Page size control\r\n    if (controlsOptions.pageSize && this.table.paginationManager) {\r\n      const pageSizeOptions = this.table.paginationManager.options.pageSizeOptions;\r\n      const currentPageSize = this.table.paginationManager.pageSize;\r\n      \r\n      html += '<div class=\"tablix-control-group tablix-page-size-group\">';\r\n      html += '<label for=\"tablix-page-size-select\">Show:</label>';\r\n      html += '<select class=\"tablix-page-size-select\" id=\"tablix-page-size-select\">';\r\n      pageSizeOptions.forEach(size => {\r\n        const selected = size === currentPageSize ? ' selected' : '';\r\n        html += `<option value=\"${size}\"${selected}>${size}</option>`;\r\n      });\r\n      html += '</select>';\r\n      html += '<span>entries</span>';\r\n      html += '</div>';\r\n    }\r\n    \r\n    // Refresh control\r\n    if (controlsOptions.refresh) {\r\n      html += '<div class=\"tablix-control-group tablix-refresh-group\">';\r\n      html += '<button type=\"button\" class=\"tablix-btn tablix-control-btn\" data-action=\"refresh\" title=\"Refresh data\">⟳</button>';\r\n      html += '</div>';\r\n    }\r\n    \r\n    html += '</div>'; // Close left controls\r\n    \r\n    // Right side controls\r\n    html += '<div class=\"tablix-controls-right\">';\r\n    \r\n    // Search control\r\n    if (controlsOptions.search && searchOptions.enabled) {\r\n      // Ensure placeholder always has a default value to prevent \"undefined\" display\r\n      const placeholderText = searchOptions.placeholder || 'Search...';\r\n      \r\n      html += '<div class=\"tablix-control-group tablix-search-group\">';\r\n      html += `<input type=\"text\" \r\n                      class=\"tablix-search-input\" \r\n                      id=\"tablix-search-input\" \r\n                      name=\"table-search\"\r\n                      placeholder=\"${placeholderText}\" />`;\r\n      html += '<button type=\"button\" class=\"tablix-btn tablix-search-clear\" title=\"Clear search\" style=\"display: none;\">✕</button>';\r\n      html += '</div>';\r\n    }\r\n    \r\n    html += '</div>'; // Close right controls\r\n    \r\n    html += '</div>'; // Close main controls container\r\n    \r\n    return html;\r\n  }\r\n\r\n  /**\r\n   * Bind control panel events\r\n   */\r\n  bindControlEvents() {\r\n    const wrapper = this.table.container.querySelector('.tablix-wrapper');\r\n    if (!wrapper) return;\r\n\r\n    // Page size selector\r\n    const pageSizeSelect = wrapper.querySelector('.tablix-page-size-select');\r\n    if (pageSizeSelect) {\r\n      pageSizeSelect.addEventListener('change', async (e) => {\r\n        try {\r\n          const newPageSize = parseInt(e.target.value);\r\n          await this.table.changePageSize(newPageSize);\r\n        } catch (error) {\r\n          console.error('Failed to change page size:', error);\r\n        }\r\n      });\r\n    }\r\n\r\n    // Control buttons\r\n    wrapper.addEventListener('click', async (e) => {\r\n      if (e.target.classList.contains('tablix-control-btn')) {\r\n        e.preventDefault();\r\n        const action = e.target.dataset.action;\r\n        \r\n        try {\r\n          switch (action) {\r\n            case 'firstPage':\r\n              await this.table.firstPage();\r\n              break;\r\n            case 'prevPage':\r\n              await this.table.prevPage();\r\n              break;\r\n            case 'nextPage':\r\n              await this.table.nextPage();\r\n              break;\r\n            case 'lastPage':\r\n              await this.table.lastPage();\r\n              break;\r\n            case 'refresh':\r\n              await this.handleRefresh();\r\n              break;\r\n            case 'export':\r\n              this.handleExport();\r\n              break;\r\n          }\r\n        } catch (error) {\r\n          console.error(`Failed to execute action ${action}:`, error);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Handle refresh functionality\r\n   */\r\n  async handleRefresh() {\r\n    this.table.eventManager.trigger('beforeRefresh');\r\n    \r\n    if (this.table.options.onRefresh && typeof this.table.options.onRefresh === 'function') {\r\n      // Custom refresh handler\r\n      try {\r\n        const newData = await this.table.options.onRefresh();\r\n        if (newData) {\r\n          await this.table.loadData(newData);\r\n        }\r\n      } catch (error) {\r\n        console.error('Custom refresh failed:', error);\r\n      }\r\n    } else if (this.table.paginationManager && this.table.paginationManager.options.mode === 'server') {\r\n      // Server-side refresh\r\n      await this.table.paginationManager.refreshTable();\r\n    } else {\r\n      // Client-side refresh - just re-render current data\r\n      await this.table.refreshTable();\r\n    }\r\n    \r\n    this.table.eventManager.trigger('afterRefresh');\r\n  }\r\n\r\n  /**\r\n   * Handle export functionality\r\n   */\r\n  handleExport() {\r\n    const data = this.table.getData();\r\n    const columns = this.table.options.columns || [];\r\n    \r\n    // Simple CSV export\r\n    let csv = columns.map(col => col.title || col.name).join(',') + '\\n';\r\n    \r\n    data.forEach(row => {\r\n      const values = columns.map(col => {\r\n        const value = row[col.name];\r\n        // Simple CSV escaping\r\n        return typeof value === 'string' && value.includes(',') \r\n          ? `\"${value.replace(/\"/g, '\"\"')}\"` \r\n          : value;\r\n      });\r\n      csv += values.join(',') + '\\n';\r\n    });\r\n    \r\n    // Download CSV\r\n    const blob = new Blob([csv], { type: 'text/csv' });\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = 'table-data.csv';\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    document.body.removeChild(a);\r\n    URL.revokeObjectURL(url);\r\n    \r\n    this.table.eventManager.trigger('afterExport', { data, format: 'csv' });\r\n  }\r\n\r\n  /**\r\n   * Bind sorting events to header columns\r\n   */\r\n  bindSortEvents() {\r\n    const headerRow = this.table.container.querySelector('.tablix-header-row');\r\n    if (!headerRow) return;\r\n\r\n    headerRow.addEventListener('click', async (e) => {\r\n      const th = e.target.closest('.tablix-sortable');\r\n      if (!th) return;\r\n\r\n      e.preventDefault();\r\n      \r\n      const columnName = th.dataset.column;\r\n      \r\n      try {\r\n        await this.table.toggleSort(columnName);\r\n      } catch (error) {\r\n        console.error('Failed to sort column:', error);\r\n      }\r\n    });\r\n\r\n    // Keyboard support for accessibility\r\n    headerRow.addEventListener('keydown', async (e) => {\r\n      const th = e.target.closest('.tablix-sortable');\r\n      if (!th || (e.key !== 'Enter' && e.key !== ' ')) return;\r\n\r\n      e.preventDefault();\r\n      \r\n      const columnName = th.dataset.column;\r\n      \r\n      try {\r\n        await this.table.toggleSort(columnName);\r\n      } catch (error) {\r\n        console.error('Failed to sort column:', error);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Bind row click events for selection\r\n   */\r\n  bindRowClickEvents() {\r\n    const tbody = this.table.container.querySelector('.tablix-tbody');\r\n    if (!tbody) return;\r\n\r\n    tbody.addEventListener('click', (e) => {\r\n      const row = e.target.closest('.tablix-row');\r\n      if (!row || row.classList.contains('tablix-empty-row')) return;\r\n\r\n      const globalRowIndex = parseInt(row.dataset.rowIndex, 10);\r\n      if (isNaN(globalRowIndex)) return;\r\n\r\n      // Convert global index to local index for current page data\r\n      let localRowIndex = globalRowIndex;\r\n      if (this.table.paginationManager && this.table.paginationManager.options.mode === 'client') {\r\n        const currentPage = this.table.paginationManager.currentPage;\r\n        const pageSize = this.table.paginationManager.pageSize;\r\n        localRowIndex = globalRowIndex - (currentPage - 1) * pageSize;\r\n      }\r\n\r\n      // Get current page data to find the clicked row\r\n      const currentData = this.getCurrentPageData();\r\n      if (localRowIndex >= 0 && localRowIndex < currentData.length) {\r\n        const rowData = currentData[localRowIndex];\r\n        \r\n        // Trigger row click event for SelectionManager with global index\r\n        this.table.eventManager.trigger('rowClick', {\r\n          rowData,\r\n          rowIndex: globalRowIndex, // Pass global index\r\n          localRowIndex: localRowIndex, // Also pass local index if needed\r\n          originalEvent: e\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get current page data (same logic as SelectionManager)\r\n   */\r\n  getCurrentPageData() {\r\n    if (this.table.paginationManager) {\r\n      return this.table.paginationManager.getCurrentPageData() || [];\r\n    }\r\n    return this.table.dataManager.getData();\r\n  }\r\n\r\n  /**\r\n   * Update sort indicators in headers\r\n   */\r\n  updateSortIndicators(currentSort) {\r\n    const headers = this.table.container.querySelectorAll('.tablix-th[data-column]');\r\n    \r\n    headers.forEach(th => {\r\n      const columnName = th.dataset.column;\r\n      const isSorted = currentSort && currentSort.column === columnName;\r\n      \r\n      // Remove all sort classes\r\n      th.classList.remove('tablix-sorted', 'tablix-sorted-asc', 'tablix-sorted-desc');\r\n      \r\n      const indicator = th.querySelector('.tablix-sort-indicator');\r\n      if (!indicator) return;\r\n\r\n      const arrow = indicator.querySelector('.tablix-sort-arrow');\r\n      if (!arrow) return;\r\n\r\n      if (isSorted) {\r\n        // Column is sorted\r\n        th.classList.add('tablix-sorted', `tablix-sorted-${currentSort.direction}`);\r\n        arrow.classList.remove('tablix-sort-none', 'tablix-sort-asc', 'tablix-sort-desc');\r\n        arrow.classList.add(`tablix-sort-${currentSort.direction}`);\r\n        arrow.textContent = currentSort.direction === 'asc' ? '↑' : '↓';\r\n        arrow.setAttribute('aria-label', `Sorted ${currentSort.direction === 'asc' ? 'ascending' : 'descending'}`);\r\n        arrow.removeAttribute('data-sort-order');\r\n      } else {\r\n        // Column is not sorted\r\n        arrow.classList.remove('tablix-sort-asc', 'tablix-sort-desc');\r\n        arrow.classList.add('tablix-sort-none');\r\n        arrow.textContent = '↕';\r\n        arrow.setAttribute('aria-label', 'Not sorted');\r\n        arrow.removeAttribute('data-sort-order');\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Check if a column is sortable\r\n   */\r\n  _isColumnSortable(column) {\r\n    if (!this.table.sortingManager) return false;\r\n    return this.table.sortingManager.isColumnSortable(column.name);\r\n  }\r\n\r\n  /**\r\n   * Get sort direction for a column\r\n   */\r\n  _getSortDirection(columnName) {\r\n    if (!this.table.sortingManager) return null;\r\n    return this.table.sortingManager.getSortDirection(columnName);\r\n  }\r\n}","export default class EventManager {\r\n  constructor() {\r\n    this.events = {};\r\n  }\r\n\r\n  on(event, callback) {\r\n    if (!this.events[event]) this.events[event] = [];\r\n    this.events[event].push(callback);\r\n  }\r\n\r\n  off(event, callback) {\r\n    if (this.events[event]) {\r\n      const index = this.events[event].indexOf(callback);\r\n      if (index > -1) {\r\n        this.events[event].splice(index, 1);\r\n      }\r\n    }\r\n  }\r\n\r\n  clear(event) {\r\n    if (event) {\r\n      this.events[event] = [];\r\n    } else {\r\n      this.events = {};\r\n    }\r\n  }\r\n\r\n  trigger(event, payload) {\r\n    (this.events[event] || []).forEach(cb => cb(payload));\r\n  }\r\n}","/**\r\n * PaginationManager handles both client-side and server-side pagination\r\n * \r\n * Features:\r\n * - Client-side: slices filtered data locally\r\n * - Server-side: calls async data loader with pagination params\r\n * - Consistent API regardless of pagination mode\r\n * - Event emission for page changes\r\n * - Customizable pagination controls\r\n */\r\nexport default class PaginationManager {\r\n  constructor(table, options = {}) {\r\n    this.table = table;\r\n    this.options = {\r\n      pageSize: 10,\r\n      mode: 'client', // 'client' or 'server'\r\n      showPageNumbers: true,\r\n      maxPageNumbers: 5,\r\n      showFirstLast: true,\r\n      showPrevNext: true,\r\n      showPageSizes: false,\r\n      pageSizeOptions: [10, 25, 50, 100],\r\n      serverDataLoader: null, // async function for server-side pagination\r\n      ...options\r\n    };\r\n\r\n    // Pagination state\r\n    this.currentPage = 1;\r\n    this.totalPages = 1;\r\n    this.totalRows = 0;\r\n    this.pageSize = this.options.pageSize;\r\n    this.isLoading = false;\r\n\r\n    // Event bindings\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.updatePaginationInfo();\r\n  }\r\n\r\n  /**\r\n   * Update pagination information based on current data\r\n   */\r\n  updatePaginationInfo(totalRows = null) {\r\n    if (this.options.mode === 'client') {\r\n      // For client-side pagination, calculate from filtered data\r\n      this.totalRows = this.table.dataManager.filteredData.length;\r\n    } else {\r\n      // For server-side pagination, total rows should be provided\r\n      this.totalRows = totalRows || this.totalRows;\r\n    }\r\n\r\n    this.totalPages = Math.ceil(this.totalRows / this.pageSize) || 1;\r\n    \r\n    // Ensure current page is within bounds\r\n    if (this.currentPage > this.totalPages) {\r\n      this.currentPage = this.totalPages;\r\n    }\r\n    if (this.currentPage < 1) {\r\n      this.currentPage = 1;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current page data\r\n   * For client-side: slice the filtered data\r\n   * For server-side: return cached data or trigger load\r\n   */\r\n  async getPageData() {\r\n    if (this.options.mode === 'client') {\r\n      return this.getClientPageData();\r\n    } else {\r\n      return await this.getServerPageData();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get page data for client-side pagination\r\n   */\r\n  getClientPageData() {\r\n    const start = (this.currentPage - 1) * this.pageSize;\r\n    const end = start + this.pageSize;\r\n    return this.table.dataManager.filteredData.slice(start, end);\r\n  }\r\n\r\n  /**\r\n   * Get current page data synchronously (for selection and other features)\r\n   * Returns the data that is currently displayed on the page\r\n   */\r\n  getCurrentPageData() {\r\n    if (this.options.mode === 'client') {\r\n      return this.getClientPageData();\r\n    } else {\r\n      // For server-side pagination, return the currently cached data\r\n      // This assumes the data has already been loaded by a previous getPageData call\r\n      return this.table.dataManager.getData();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get page data for server-side pagination\r\n   */\r\n  async getServerPageData() {\r\n    if (!this.options.serverDataLoader) {\r\n      throw new Error('Server data loader not configured for server-side pagination');\r\n    }\r\n\r\n    this.isLoading = true;\r\n    this.table.eventManager.trigger('beforePageLoad', {\r\n      page: this.currentPage,\r\n      pageSize: this.pageSize\r\n    });\r\n\r\n    try {\r\n      const result = await this.options.serverDataLoader({\r\n        page: this.currentPage,\r\n        pageSize: this.pageSize,\r\n        // Include current filter/sort state if available\r\n        filters: this.table.dataManager.currentFilters || {},\r\n        sorts: this.table.dataManager.currentSorts || []\r\n      });\r\n\r\n      // Expect result to have: { data: [], totalRows: number }\r\n      if (result.totalRows !== undefined) {\r\n        this.updatePaginationInfo(result.totalRows);\r\n      }\r\n\r\n      this.isLoading = false;\r\n      this.table.eventManager.trigger('afterPageLoad', {\r\n        page: this.currentPage,\r\n        pageSize: this.pageSize,\r\n        data: result.data,\r\n        totalRows: result.totalRows\r\n      });\r\n\r\n      return result.data;\r\n    } catch (error) {\r\n      this.isLoading = false;\r\n      this.table.eventManager.trigger('pageLoadError', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Navigate to specific page\r\n   */\r\n  async goToPage(pageNumber) {\r\n    const targetPage = Math.max(1, Math.min(pageNumber, this.totalPages));\r\n    \r\n    if (targetPage === this.currentPage) {\r\n      return;\r\n    }\r\n\r\n    const oldPage = this.currentPage;\r\n    this.currentPage = targetPage;\r\n\r\n    this.table.eventManager.trigger('beforePageChange', {\r\n      oldPage,\r\n      newPage: this.currentPage,\r\n      pageSize: this.pageSize\r\n    });\r\n\r\n    try {\r\n      await this.refreshTable();\r\n      \r\n      this.table.eventManager.trigger('afterPageChange', {\r\n        oldPage,\r\n        newPage: this.currentPage,\r\n        pageSize: this.pageSize\r\n      });\r\n    } catch (error) {\r\n      // Revert page change on error\r\n      this.currentPage = oldPage;\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to next page\r\n   */\r\n  async nextPage() {\r\n    if (this.currentPage < this.totalPages) {\r\n      await this.goToPage(this.currentPage + 1);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to previous page\r\n   */\r\n  async prevPage() {\r\n    if (this.currentPage > 1) {\r\n      await this.goToPage(this.currentPage - 1);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to first page\r\n   */\r\n  async firstPage() {\r\n    await this.goToPage(1);\r\n  }\r\n\r\n  /**\r\n   * Go to last page\r\n   */\r\n  async lastPage() {\r\n    await this.goToPage(this.totalPages);\r\n  }\r\n\r\n  /**\r\n   * Change page size\r\n   */\r\n  async changePageSize(newPageSize) {\r\n    if (newPageSize === this.pageSize) {\r\n      return;\r\n    }\r\n\r\n    const oldPageSize = this.pageSize;\r\n    this.pageSize = newPageSize;\r\n\r\n    // Try to maintain current position in the dataset\r\n    const currentRow = (this.currentPage - 1) * oldPageSize;\r\n    const newPage = Math.floor(currentRow / newPageSize) + 1;\r\n\r\n    this.updatePaginationInfo();\r\n    \r\n    this.table.eventManager.trigger('beforePageSizeChange', {\r\n      oldPageSize,\r\n      newPageSize: this.pageSize,\r\n      oldPage: this.currentPage,\r\n      newPage\r\n    });\r\n\r\n    this.currentPage = newPage;\r\n    await this.refreshTable();\r\n\r\n    this.table.eventManager.trigger('afterPageSizeChange', {\r\n      oldPageSize,\r\n      newPageSize: this.pageSize,\r\n      page: this.currentPage\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Refresh the table with current pagination settings\r\n   */\r\n  async refreshTable() {\r\n    const pageData = await this.getPageData();\r\n    this.table.renderer.renderTable(pageData);\r\n    this.table.renderer.renderPagination();\r\n  }\r\n\r\n  /**\r\n   * Reset pagination to first page (useful after filtering/sorting)\r\n   */\r\n  async resetToFirstPage() {\r\n    this.currentPage = 1;\r\n    this.updatePaginationInfo();\r\n    await this.refreshTable();\r\n  }\r\n\r\n  /**\r\n   * Get pagination state info\r\n   */\r\n  getInfo() {\r\n    const start = this.totalRows === 0 ? 0 : (this.currentPage - 1) * this.pageSize + 1;\r\n    const end = Math.min(this.currentPage * this.pageSize, this.totalRows);\r\n\r\n    return {\r\n      currentPage: this.currentPage,\r\n      totalPages: this.totalPages,\r\n      pageSize: this.pageSize,\r\n      totalRows: this.totalRows,\r\n      startRow: start,\r\n      endRow: end,\r\n      hasNextPage: this.currentPage < this.totalPages,\r\n      hasPrevPage: this.currentPage > 1,\r\n      isLoading: this.isLoading\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get page numbers to display in pagination controls\r\n   */\r\n  getPageNumbers() {\r\n    const maxPages = this.options.maxPageNumbers;\r\n    const pages = [];\r\n\r\n    if (this.totalPages <= maxPages) {\r\n      // Show all pages\r\n      for (let i = 1; i <= this.totalPages; i++) {\r\n        pages.push(i);\r\n      }\r\n    } else {\r\n      // Show truncated page numbers\r\n      const half = Math.floor(maxPages / 2);\r\n      let start = Math.max(1, this.currentPage - half);\r\n      let end = Math.min(this.totalPages, start + maxPages - 1);\r\n\r\n      // Adjust if we're near the end\r\n      if (end - start + 1 < maxPages) {\r\n        start = Math.max(1, end - maxPages + 1);\r\n      }\r\n\r\n      for (let i = start; i <= end; i++) {\r\n        pages.push(i);\r\n      }\r\n\r\n      // Add ellipsis indicators\r\n      if (start > 1) {\r\n        if (start > 2) pages.unshift('...');\r\n        pages.unshift(1);\r\n      }\r\n      if (end < this.totalPages) {\r\n        if (end < this.totalPages - 1) pages.push('...');\r\n        pages.push(this.totalPages);\r\n      }\r\n    }\r\n\r\n    return pages;\r\n  }\r\n\r\n  /**\r\n   * Enable/disable pagination\r\n   */\r\n  setEnabled(enabled) {\r\n    this.options.enabled = enabled;\r\n    this.table.renderer.renderPagination();\r\n  }\r\n\r\n  /**\r\n   * Switch between client and server mode\r\n   */\r\n  async setMode(mode, serverDataLoader = null) {\r\n    if (mode === this.options.mode) {\r\n      return;\r\n    }\r\n\r\n    this.options.mode = mode;\r\n    if (mode === 'server' && serverDataLoader) {\r\n      this.options.serverDataLoader = serverDataLoader;\r\n    }\r\n\r\n    // Reset to first page when switching modes\r\n    this.currentPage = 1;\r\n    this.updatePaginationInfo();\r\n    await this.refreshTable();\r\n  }\r\n}\r\n","/**\r\n * SortingManager - Handles all sorting functionality for TablixJS\r\n * Supports client-side and server-side sorting with custom sort functions\r\n */\r\nexport default class SortingManager {\r\n  constructor(table, options = {}) {\r\n    this.table = table;\r\n    this.options = {\r\n      enabled: true,\r\n      mode: 'client', // 'client' or 'server'\r\n      serverSortLoader: null, // Function to load data from server with sorting\r\n      defaultSortType: 'auto', // 'auto', 'string', 'number', 'date'\r\n      caseSensitive: false,\r\n      nullsFirst: false,\r\n      ...options\r\n    };\r\n\r\n    // Current sort state - single column only\r\n    this.currentSort = null; // { column: 'name', direction: 'asc' }\r\n    this.sortOrder = ['asc', 'desc', null]; // Click cycle order\r\n\r\n    // Predefined sort types\r\n    this.sortTypes = {\r\n      auto: this._autoSort.bind(this),\r\n      string: this._stringSort.bind(this),\r\n      number: this._numberSort.bind(this),\r\n      date: this._dateSort.bind(this),\r\n      boolean: this._booleanSort.bind(this)\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Sort by a column\r\n   * @param {string} columnName - Column to sort by\r\n   * @param {string|null} direction - 'asc', 'desc', or null (unsorted)\r\n   */\r\n  async sort(columnName, direction = 'asc') {\r\n    // Trigger beforeSort event\r\n    const beforeSortData = { columnName, direction, currentSort: this.currentSort };\r\n    this.table.eventManager.trigger('beforeSort', beforeSortData);\r\n\r\n    if (this.options.mode === 'server') {\r\n      await this._sortServer(columnName, direction);\r\n    } else {\r\n      this._sortClient(columnName, direction);\r\n    }\r\n\r\n    // Update UI\r\n    this.table.renderer.updateSortIndicators(this.currentSort);\r\n    \r\n    // Refresh table display\r\n    await this.table.refreshTable();\r\n\r\n    // Trigger afterSort event\r\n    this.table.eventManager.trigger('afterSort', {\r\n      columnName,\r\n      direction,\r\n      currentSort: this.currentSort\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Toggle sort for a column (handles click cycling)\r\n   */\r\n  async toggleSort(columnName) {\r\n    const currentDirection = this.currentSort && this.currentSort.column === columnName \r\n      ? this.currentSort.direction \r\n      : null;\r\n    \r\n    // Get next direction in cycle\r\n    const currentIndex = this.sortOrder.indexOf(currentDirection);\r\n    const nextDirection = this.sortOrder[(currentIndex + 1) % this.sortOrder.length];\r\n    \r\n    await this.sort(columnName, nextDirection);\r\n  }\r\n\r\n  /**\r\n   * Client-side sorting\r\n   */\r\n  _sortClient(columnName, direction) {\r\n    // Set current sort\r\n    if (direction !== null) {\r\n      this.currentSort = { column: columnName, direction };\r\n    } else {\r\n      this.currentSort = null;\r\n    }\r\n\r\n    // Apply sorting to data\r\n    this._applySorting();\r\n  }\r\n\r\n  /**\r\n   * Server-side sorting\r\n   */\r\n  async _sortServer(columnName, direction) {\r\n    if (!this.options.serverSortLoader) {\r\n      console.warn('Server-side sorting enabled but no serverSortLoader provided');\r\n      return;\r\n    }\r\n\r\n    // Set current sort\r\n    if (direction !== null) {\r\n      this.currentSort = { column: columnName, direction };\r\n    } else {\r\n      this.currentSort = null;\r\n    }\r\n\r\n    try {\r\n      // Load data from server with current sort state\r\n      const result = await this.options.serverSortLoader({\r\n        sort: this.currentSort,\r\n        filters: this.table.dataManager.currentFilters,\r\n        page: this.table.paginationManager ? this.table.paginationManager.currentPage : 1,\r\n        pageSize: this.table.paginationManager ? this.table.paginationManager.pageSize : 10\r\n      });\r\n\r\n      // Update data manager with new data\r\n      this.table.dataManager.setServerData(result.data, result.totalRows);\r\n      \r\n    } catch (error) {\r\n      console.error('Failed to load sorted data from server:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Apply current sort to filtered data\r\n   */\r\n  _applySorting() {\r\n    if (!this.currentSort) return;\r\n    \r\n    const columns = this.table.options.columns || [];\r\n    \r\n    this.table.dataManager.filteredData.sort((a, b) => {\r\n      // Support both 'name' and 'key' properties for column identification\r\n      const column = columns.find(col => (col.name === this.currentSort.column) || (col.key === this.currentSort.column));\r\n      const comparison = this._compareValues(\r\n        a[this.currentSort.column], \r\n        b[this.currentSort.column], \r\n        column\r\n      );\r\n      \r\n      return this.currentSort.direction === 'desc' ? -comparison : comparison;\r\n    });\r\n\r\n    // Reset pagination to first page after sorting\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.resetToFirstPage();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Compare two values based on column configuration\r\n   */\r\n  _compareValues(a, b, column) {\r\n    // Handle null/undefined values\r\n    if (a == null && b == null) return 0;\r\n    if (a == null) return this.options.nullsFirst ? -1 : 1;\r\n    if (b == null) return this.options.nullsFirst ? 1 : -1;\r\n\r\n    // Use custom sort function if provided\r\n    if (column && column.sortFunction) {\r\n      return column.sortFunction(a, b);\r\n    }\r\n\r\n    // Use specified sort type or auto-detect\r\n    const sortType = (column && column.sortType) || this.options.defaultSortType;\r\n    \r\n    if (this.sortTypes[sortType]) {\r\n      return this.sortTypes[sortType](a, b);\r\n    }\r\n\r\n    // Fallback to auto sort\r\n    return this._autoSort(a, b);\r\n  }\r\n\r\n  /**\r\n   * Auto-detect sort type and compare\r\n   */\r\n  _autoSort(a, b) {\r\n    // Try number comparison first\r\n    const numA = parseFloat(a);\r\n    const numB = parseFloat(b);\r\n    \r\n    if (!isNaN(numA) && !isNaN(numB)) {\r\n      return numA - numB;\r\n    }\r\n\r\n    // Try date comparison - be more strict about what constitutes a date\r\n    const dateA = new Date(a);\r\n    const dateB = new Date(b);\r\n    \r\n    // More strict date validation - check if it looks like a real date format\r\n    const isDateLike = (str) => {\r\n      return /^\\d{4}-\\d{2}-\\d{2}/.test(str) || /^\\d{1,2}\\/\\d{1,2}\\/\\d{4}/.test(str) || /^\\d{1,2}-\\d{1,2}-\\d{4}/.test(str);\r\n    };\r\n    \r\n    if (dateA.toString() !== 'Invalid Date' && dateB.toString() !== 'Invalid Date' && \r\n        isDateLike(String(a)) && isDateLike(String(b))) {\r\n      return dateA - dateB;\r\n    }\r\n\r\n    // Fall back to string comparison\r\n    return this._stringSort(a, b);\r\n  }\r\n\r\n  /**\r\n   * String comparison\r\n   */\r\n  _stringSort(a, b) {\r\n    const strA = String(a).trim();\r\n    const strB = String(b).trim();\r\n    \r\n    if (this.options.caseSensitive) {\r\n      return strA.localeCompare(strB);\r\n    }\r\n    \r\n    return strA.localeCompare(strB, undefined, { sensitivity: 'base' });\r\n  }\r\n\r\n  /**\r\n   * Number comparison\r\n   */\r\n  _numberSort(a, b) {\r\n    const numA = parseFloat(a);\r\n    const numB = parseFloat(b);\r\n    \r\n    if (isNaN(numA) && isNaN(numB)) return 0;\r\n    if (isNaN(numA)) return 1;\r\n    if (isNaN(numB)) return -1;\r\n    \r\n    return numA - numB;\r\n  }\r\n\r\n  /**\r\n   * Date comparison\r\n   */\r\n  _dateSort(a, b) {\r\n    const dateA = new Date(a);\r\n    const dateB = new Date(b);\r\n    \r\n    if (dateA.toString() === 'Invalid Date' && dateB.toString() === 'Invalid Date') return 0;\r\n    if (dateA.toString() === 'Invalid Date') return 1;\r\n    if (dateB.toString() === 'Invalid Date') return -1;\r\n    \r\n    return dateA - dateB;\r\n  }\r\n\r\n  /**\r\n   * Boolean comparison\r\n   */\r\n  _booleanSort(a, b) {\r\n    const boolA = Boolean(a);\r\n    const boolB = Boolean(b);\r\n    \r\n    if (boolA === boolB) return 0;\r\n    return boolA ? 1 : -1;\r\n  }\r\n\r\n  /**\r\n   * Clear all sorting\r\n   */  async clearSorting() {\r\n    this.currentSort = null;\r\n\r\n    if (this.options.mode === 'server') {\r\n      // Reload data without sorting\r\n      if (this.options.serverSortLoader) {\r\n        try {\r\n          const result = await this.options.serverSortLoader({\r\n            sort: null,\r\n            filters: this.table.dataManager.currentFilters,\r\n            page: this.table.paginationManager ? this.table.paginationManager.currentPage : 1,\r\n            pageSize: this.table.paginationManager ? this.table.paginationManager.pageSize : 10\r\n          });\r\n          \r\n          this.table.dataManager.setServerData(result.data, result.totalRows);\r\n        } catch (error) {\r\n          console.error('Failed to clear server sorting:', error);\r\n        }\r\n      }\r\n    }\r\n\r\n    // Update UI and refresh table\r\n    this.table.renderer.updateSortIndicators(null);\r\n    await this.table.refreshTable();\r\n    \r\n    this.table.eventManager.trigger('afterSort', { currentSort: null });\r\n  }\r\n\r\n  /**\r\n   * Get current sort state\r\n   */\r\n  getSortState() {\r\n    return {\r\n      sort: this.currentSort,\r\n      mode: this.options.mode\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Set sorting options\r\n   */\r\n  setOptions(newOptions) {\r\n    this.options = { ...this.options, ...newOptions };\r\n  }\r\n\r\n  /**\r\n   * Check if a column is sortable\r\n   */\r\n  isColumnSortable(columnName) {\r\n    if (!this.options.enabled) return false;\r\n    \r\n    const columns = this.table.options.columns || [];\r\n    const column = columns.find(col => col.name === columnName);\r\n    \r\n    return column && column.sortable !== false;\r\n  }\r\n\r\n  /**\r\n   * Get sort direction for a column\r\n   */\r\n  getSortDirection(columnName) {\r\n    return this.currentSort && this.currentSort.column === columnName \r\n      ? this.currentSort.direction \r\n      : null;\r\n  }\r\n}\r\n","/**\r\n * ColumnManager - Enhanced column formatting system for TablixJS\r\n * \r\n * Features:\r\n * - Flexible formatting with optional locale and formatOptions\r\n * - Supports text, date, currency, number, percent formats\r\n * - Custom renderer priority over formatting\r\n * - Extensible design for future format types\r\n * - Performance-optimized with cached formatters\r\n */\r\nexport default class ColumnManager {\r\n  constructor(table) {\r\n    this.table = table;\r\n    this.columns = [];\r\n    this.formatters = new Map(); // Cache for compiled formatters\r\n    this.supportedFormats = ['text', 'date', 'currency', 'number', 'percent'];\r\n  }\r\n\r\n  /**\r\n   * Initialize columns and prepare formatters\r\n   * @param {Array} columns - Array of column definitions\r\n   */\r\n  initializeColumns(columns = []) {\r\n    this.columns = columns.map(col => this.prepareColumn(col));\r\n    this.compileFormatters();\r\n    return this.columns;\r\n  }\r\n\r\n  /**\r\n   * Prepare and validate a single column definition\r\n   * @param {Object} column - Column definition\r\n   * @returns {Object} Prepared column\r\n   */\r\n  prepareColumn(column) {\r\n    const prepared = { ...column };\r\n\r\n    // Validate format if provided\r\n    if (prepared.format && !this.supportedFormats.includes(prepared.format)) {\r\n      console.warn(`TablixJS: Unsupported format type '${prepared.format}' for column '${prepared.name}'. Falling back to no formatting.`);\r\n      delete prepared.format;\r\n    }\r\n\r\n    // Ensure name property exists\r\n    if (!prepared.name) {\r\n      throw new Error('TablixJS: Column must have a \"name\" property');\r\n    }\r\n\r\n    // Set default title if not provided\r\n    if (!prepared.title) {\r\n      prepared.title = prepared.name;\r\n    }\r\n\r\n    return prepared;\r\n  }\r\n\r\n  /**\r\n   * Compile and cache formatter functions for columns with format specified\r\n   */\r\n  compileFormatters() {\r\n    this.formatters.clear();\r\n\r\n    this.columns.forEach(column => {\r\n      if (column.format) {\r\n        const formatter = this.createFormatter(column);\r\n        if (formatter) {\r\n          this.formatters.set(column.name, formatter);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Create a formatter function for a column\r\n   * @param {Object} column - Column definition\r\n   * @returns {Function|null} Formatter function\r\n   */\r\n  createFormatter(column) {\r\n    const { format, locale, formatOptions = {} } = column;\r\n\r\n    switch (format) {\r\n      case 'text':\r\n        return (value) => this.formatText(value);\r\n\r\n      case 'date':\r\n        return (value) => this.formatDate(value, locale, formatOptions);\r\n\r\n      case 'currency':\r\n        return (value) => this.formatCurrency(value, locale, formatOptions, column.currency);\r\n\r\n      case 'number':\r\n        return (value) => this.formatNumber(value, locale, formatOptions);\r\n\r\n      case 'percent':\r\n        return (value) => this.formatPercent(value, locale, formatOptions);\r\n\r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Format a cell value for a specific column\r\n   * @param {string} columnName - Column name\r\n   * @param {*} value - Cell value\r\n   * @param {Object} row - Full row data (for context)\r\n   * @returns {Object} Object with formatted value and metadata\r\n   */\r\n  formatCellValue(columnName, value, row) {\r\n    const column = this.getColumn(columnName);\r\n    \r\n    // Priority 1: Custom renderer (overrides everything)\r\n    if (column && column.renderer) {\r\n      // If renderer wants formatted value, provide it\r\n      const formatter = this.formatters.get(columnName);\r\n      const formattedValue = formatter ? formatter(value) : value;\r\n      const result = column.renderer(value, row, formattedValue);\r\n      return {\r\n        value: result,\r\n        isHtml: true // Custom renderers can return HTML\r\n      };\r\n    }\r\n\r\n    // Priority 2: Format using cached formatter\r\n    const formatter = this.formatters.get(columnName);\r\n    if (formatter) {\r\n      return {\r\n        value: formatter(value),\r\n        isHtml: false // Formatted values are safe text\r\n      };\r\n    }\r\n\r\n    // Priority 3: Return raw value\r\n    return {\r\n      value: value,\r\n      isHtml: false // Raw values need escaping\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get column definition by name\r\n   * @param {string} columnName - Column name\r\n   * @returns {Object|null} Column definition\r\n   */\r\n  getColumn(columnName) {\r\n    return this.columns.find(col => col.name === columnName) || null;\r\n  }\r\n\r\n  /**\r\n   * Get all columns\r\n   * @returns {Array} Array of column definitions\r\n   */\r\n  getColumns() {\r\n    return this.columns;\r\n  }\r\n\r\n  // =============================================================================\r\n  // FORMAT IMPLEMENTATIONS\r\n  // =============================================================================\r\n\r\n  /**\r\n   * Format text (basic string conversion with null/undefined handling)\r\n   * @param {*} value - Value to format\r\n   * @returns {string} Formatted text\r\n   */\r\n  formatText(value) {\r\n    if (value == null) return '';\r\n    return String(value);\r\n  }\r\n\r\n  /**\r\n   * Format date using Intl.DateTimeFormat\r\n   * @param {*} value - Date value (string, Date, timestamp)\r\n   * @param {string} locale - Locale string (optional)\r\n   * @param {Object} options - Intl.DateTimeFormat options\r\n   * @returns {string} Formatted date\r\n   */\r\n  formatDate(value, locale, options = {}) {\r\n    if (value == null) return '';\r\n\r\n    try {\r\n      const date = value instanceof Date ? value : new Date(value);\r\n      \r\n      if (isNaN(date.getTime())) {\r\n        return String(value); // Return original if invalid date\r\n      }\r\n\r\n      const formatter = new Intl.DateTimeFormat(locale, options);\r\n      return formatter.format(date);\r\n    } catch (error) {\r\n      console.warn('TablixJS: Date formatting error:', error);\r\n      return String(value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Format currency using Intl.NumberFormat\r\n   * @param {*} value - Numeric value\r\n   * @param {string} locale - Locale string (optional)\r\n   * @param {Object} options - Intl.NumberFormat options\r\n   * @param {string} currency - Currency code (e.g., 'USD', 'EUR')\r\n   * @returns {string} Formatted currency\r\n   */\r\n  formatCurrency(value, locale, options = {}, currency = 'USD') {\r\n    if (value == null) return '';\r\n\r\n    const numericValue = Number(value);\r\n    if (isNaN(numericValue)) {\r\n      return String(value);\r\n    }\r\n\r\n    try {\r\n      const formatOptions = {\r\n        style: 'currency',\r\n        currency: currency,\r\n        ...options\r\n      };\r\n\r\n      const formatter = new Intl.NumberFormat(locale, formatOptions);\r\n      return formatter.format(numericValue);\r\n    } catch (error) {\r\n      console.warn('TablixJS: Currency formatting error:', error);\r\n      return String(value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Format number using Intl.NumberFormat\r\n   * @param {*} value - Numeric value\r\n   * @param {string} locale - Locale string (optional)\r\n   * @param {Object} options - Intl.NumberFormat options\r\n   * @returns {string} Formatted number\r\n   */\r\n  formatNumber(value, locale, options = {}) {\r\n    if (value == null) return '';\r\n\r\n    const numericValue = Number(value);\r\n    if (isNaN(numericValue)) {\r\n      return String(value);\r\n    }\r\n\r\n    try {\r\n      const formatter = new Intl.NumberFormat(locale, options);\r\n      return formatter.format(numericValue);\r\n    } catch (error) {\r\n      console.warn('TablixJS: Number formatting error:', error);\r\n      return String(value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Format percentage using Intl.NumberFormat\r\n   * @param {*} value - Numeric value (0.5 = 50%)\r\n   * @param {string} locale - Locale string (optional)\r\n   * @param {Object} options - Intl.NumberFormat options\r\n   * @returns {string} Formatted percentage\r\n   */\r\n  formatPercent(value, locale, options = {}) {\r\n    if (value == null) return '';\r\n\r\n    const numericValue = Number(value);\r\n    if (isNaN(numericValue)) {\r\n      return String(value);\r\n    }\r\n\r\n    try {\r\n      const formatOptions = {\r\n        style: 'percent',\r\n        ...options\r\n      };\r\n\r\n      const formatter = new Intl.NumberFormat(locale, formatOptions);\r\n      return formatter.format(numericValue);\r\n    } catch (error) {\r\n      console.warn('TablixJS: Percent formatting error:', error);\r\n      return String(value);\r\n    }\r\n  }\r\n\r\n  // =============================================================================\r\n  // EXTENSIBILITY METHODS\r\n  // =============================================================================\r\n\r\n  /**\r\n   * Register a custom format type (for future extensibility)\r\n   * @param {string} formatType - Format type name\r\n   * @param {Function} formatterFactory - Function that creates formatter\r\n   */\r\n  registerFormat(formatType, formatterFactory) {\r\n    if (this.supportedFormats.includes(formatType)) {\r\n      console.warn(`TablixJS: Format type '${formatType}' already exists and will be overridden.`);\r\n    }\r\n\r\n    this.supportedFormats.push(formatType);\r\n    \r\n    // You would extend createFormatter method to handle this\r\n    // This is a placeholder for future plugin architecture\r\n    console.log(`TablixJS: Custom format '${formatType}' registered.`);\r\n  }\r\n\r\n  /**\r\n   * Get supported format types\r\n   * @returns {Array} Array of supported format type strings\r\n   */\r\n  getSupportedFormats() {\r\n    return [...this.supportedFormats];\r\n  }\r\n}\r\n","/**\r\n * FilterManager - Advanced column filtering system for TablixJS\r\n * \r\n * Features:\r\n * - Multi-column filtering with independent filter states\r\n * - Two filter types: \"value\" (checkbox selection) and \"condition\" (operators)\r\n * - Supports multiple conditions per column\r\n * - Extensible operator system for custom filters\r\n * - Integration with sorting and pagination\r\n */\r\nexport default class FilterManager {\r\n  constructor(table, options = {}) {\r\n    this.table = table;\r\n    this.options = {\r\n      enabled: true,\r\n      mode: 'client', // 'client' or 'server'\r\n      serverFilterLoader: null, // Function to load filtered data from server\r\n      debounceDelay: 300, // Debounce delay for input filters\r\n      showBadges: true, // Show filter count badges\r\n      showTooltips: true, // Show filter summary tooltips\r\n      ...options\r\n    };\r\n\r\n    // Filter state per column\r\n    this.columnFilters = new Map(); // { columnName: { type, config, isActive } }\r\n    \r\n    // Supported filter operators\r\n    this.operators = {\r\n      'none': { label: 'None', apply: () => true },\r\n      'isEmpty': { label: 'Is empty', apply: (value) => value === null || value === undefined || value === '' },\r\n      'isNotEmpty': { label: 'Is not empty', apply: (value) => value !== null && value !== undefined && value !== '' },\r\n      'equals': { label: 'Is equal to', apply: (value, filterValue) => String(value).toLowerCase() === String(filterValue).toLowerCase() },\r\n      'notEquals': { label: 'Is not equal to', apply: (value, filterValue) => String(value).toLowerCase() !== String(filterValue).toLowerCase() },\r\n      'beginsWith': { label: 'Begins with', apply: (value, filterValue) => String(value).toLowerCase().startsWith(String(filterValue).toLowerCase()) },\r\n      'endsWith': { label: 'Ends with', apply: (value, filterValue) => String(value).toLowerCase().endsWith(String(filterValue).toLowerCase()) },\r\n      'contains': { label: 'Contains', apply: (value, filterValue) => String(value).toLowerCase().includes(String(filterValue).toLowerCase()) },\r\n      'notContains': { label: 'Does not contain', apply: (value, filterValue) => !String(value).toLowerCase().includes(String(filterValue).toLowerCase()) }\r\n    };\r\n\r\n    // Debounce timer for input filtering\r\n    this.debounceTimer = null;\r\n\r\n    // Track open filter dropdowns\r\n    this.openDropdowns = new Set();\r\n  }\r\n\r\n  /**\r\n   * Apply filter to a specific column\r\n   * @param {string} columnName - Column to filter\r\n   * @param {Object} filterConfig - Filter configuration\r\n   */\r\n  async applyFilter(columnName, filterConfig) {\r\n    // Validate filter config\r\n    if (!this.validateFilterConfig(filterConfig)) {\r\n      console.warn(`TablixJS: Invalid filter config for column '${columnName}'`);\r\n      return;\r\n    }\r\n\r\n    // Trigger beforeFilter hook\r\n    const beforeFilterData = { \r\n      columnName, \r\n      filterConfig, \r\n      currentFilters: this.getActiveFilters() \r\n    };\r\n    this.table.eventManager.trigger('beforeFilter', beforeFilterData);\r\n\r\n    // Store filter state\r\n    this.columnFilters.set(columnName, {\r\n      type: filterConfig.type,\r\n      config: filterConfig,\r\n      isActive: this.isFilterActive(filterConfig)\r\n    });\r\n\r\n    if (this.options.mode === 'server') {\r\n      await this._filterServer();\r\n    } else {\r\n      this._filterClient();\r\n    }\r\n\r\n    // Update UI indicators\r\n    this.updateFilterIndicators();\r\n    \r\n    // Refresh table display\r\n    await this.table.refreshTable();\r\n\r\n    // Trigger afterFilter hook\r\n    this.table.eventManager.trigger('afterFilter', {\r\n      columnName,\r\n      filterConfig,\r\n      filteredData: this.table.dataManager.getData(),\r\n      activeFilters: this.getActiveFilters()\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Clear filter for a specific column\r\n   * @param {string} columnName - Column to clear filter for\r\n   */\r\n  async clearFilter(columnName) {\r\n    if (!this.columnFilters.has(columnName)) return;\r\n\r\n    const beforeFilterData = { \r\n      columnName, \r\n      filterConfig: null, \r\n      currentFilters: this.getActiveFilters() \r\n    };\r\n    this.table.eventManager.trigger('beforeFilter', beforeFilterData);\r\n\r\n    this.columnFilters.delete(columnName);\r\n\r\n    if (this.options.mode === 'server') {\r\n      await this._filterServer();\r\n    } else {\r\n      this._filterClient();\r\n    }\r\n\r\n    this.updateFilterIndicators();\r\n    await this.table.refreshTable();\r\n\r\n    this.table.eventManager.trigger('afterFilter', {\r\n      columnName,\r\n      filterConfig: null,\r\n      filteredData: this.table.dataManager.getData(),\r\n      activeFilters: this.getActiveFilters()\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Clear all filters\r\n   */\r\n  async clearAllFilters() {\r\n    if (this.columnFilters.size === 0) return;\r\n\r\n    const beforeFilterData = { \r\n      columnName: null, \r\n      filterConfig: null, \r\n      currentFilters: this.getActiveFilters() \r\n    };\r\n    this.table.eventManager.trigger('beforeFilter', beforeFilterData);\r\n\r\n    this.columnFilters.clear();\r\n\r\n    if (this.options.mode === 'server') {\r\n      await this._filterServer();\r\n    } else {\r\n      this._filterClient();\r\n    }\r\n\r\n    this.updateFilterIndicators();\r\n    await this.table.refreshTable();\r\n\r\n    this.table.eventManager.trigger('afterFilter', {\r\n      columnName: null,\r\n      filterConfig: null,\r\n      filteredData: this.table.dataManager.getData(),\r\n      activeFilters: this.getActiveFilters()\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get active filters\r\n   * @returns {Object} Active filters by column\r\n   */\r\n  getActiveFilters() {\r\n    const activeFilters = {};\r\n    for (const [columnName, filterState] of this.columnFilters) {\r\n      if (filterState.isActive) {\r\n        activeFilters[columnName] = filterState.config;\r\n      }\r\n    }\r\n    return activeFilters;\r\n  }\r\n\r\n  /**\r\n   * Get unique values for a column (for value filtering)\r\n   * @param {string} columnName - Column name\r\n   * @returns {Array} Unique values\r\n   */\r\n  getColumnUniqueValues(columnName) {\r\n    const data = this.table.dataManager.originalData;\r\n    const values = new Set();\r\n    \r\n    data.forEach(row => {\r\n      const value = row[columnName];\r\n      if (value !== null && value !== undefined) {\r\n        values.add(String(value));\r\n      }\r\n    });\r\n    \r\n    return Array.from(values).sort();\r\n  }\r\n\r\n  /**\r\n   * Get filter state for a column\r\n   * @param {string} columnName - Column name\r\n   * @returns {Object|null} Filter state\r\n   */\r\n  getColumnFilter(columnName) {\r\n    return this.columnFilters.get(columnName) || null;\r\n  }\r\n\r\n  /**\r\n   * Check if column has active filter\r\n   * @param {string} columnName - Column name\r\n   * @returns {boolean} Whether column has active filter\r\n   */\r\n  hasColumnFilter(columnName) {\r\n    const filter = this.columnFilters.get(columnName);\r\n    return filter && filter.isActive;\r\n  }\r\n\r\n  /**\r\n   * Validate filter configuration\r\n   * @param {Object} filterConfig - Filter configuration\r\n   * @returns {boolean} Whether config is valid\r\n   */\r\n  validateFilterConfig(filterConfig) {\r\n    if (!filterConfig || !filterConfig.type) return false;\r\n    \r\n    if (filterConfig.type === 'value') {\r\n      return Array.isArray(filterConfig.values);\r\n    }\r\n    \r\n    if (filterConfig.type === 'condition') {\r\n      return Array.isArray(filterConfig.conditions) && \r\n             filterConfig.conditions.every(cond => \r\n               cond.operator && this.operators[cond.operator]\r\n             );\r\n    }\r\n    \r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Check if filter config represents an active filter\r\n   * @param {Object} filterConfig - Filter configuration\r\n   * @returns {boolean} Whether filter is active\r\n   */\r\n  isFilterActive(filterConfig) {\r\n    if (!filterConfig) return false;\r\n    \r\n    if (filterConfig.type === 'value') {\r\n      return filterConfig.values && filterConfig.values.length > 0;\r\n    }\r\n    \r\n    if (filterConfig.type === 'condition') {\r\n      return filterConfig.conditions && \r\n             filterConfig.conditions.some(cond => \r\n               cond.operator && cond.operator !== 'none' && \r\n               (cond.operator === 'isEmpty' || cond.operator === 'isNotEmpty' || cond.value !== undefined)\r\n             );\r\n    }\r\n    \r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Client-side filtering\r\n   * @private\r\n   */\r\n  _filterClient() {\r\n    const originalData = this.table.dataManager.originalData;\r\n    const activeFilters = this.getActiveFilters();\r\n    \r\n    let filteredData;\r\n    if (Object.keys(activeFilters).length === 0) {\r\n      // No filters, show all data\r\n      filteredData = [...originalData];\r\n    } else {\r\n      // Apply all active filters\r\n      filteredData = originalData.filter(row => {\r\n        return Object.entries(activeFilters).every(([columnName, filterConfig]) => {\r\n          return this._testRowAgainstFilter(row, columnName, filterConfig);\r\n        });\r\n      });\r\n    }\r\n\r\n    // Update DataManager with filtered data\r\n    this.table.dataManager.setFilteredData(filteredData);\r\n  }\r\n\r\n  /**\r\n   * Server-side filtering\r\n   * @private\r\n   */\r\n  async _filterServer() {\r\n    if (!this.options.serverFilterLoader) {\r\n      console.warn('TablixJS: Server-side filtering enabled but no serverFilterLoader provided');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const result = await this.options.serverFilterLoader({\r\n        filters: this.getActiveFilters(),\r\n        sort: this.table.sortingManager ? this.table.sortingManager.currentSort : null,\r\n        page: this.table.paginationManager ? this.table.paginationManager.currentPage : 1,\r\n        pageSize: this.table.paginationManager ? this.table.paginationManager.pageSize : 10\r\n      });\r\n\r\n      this.table.dataManager.setServerData(result.data, result.totalRows);\r\n    } catch (error) {\r\n      console.error('Failed to load filtered data from server:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Test a row against a filter\r\n   * @param {Object} row - Data row\r\n   * @param {string} columnName - Column name\r\n   * @param {Object} filterConfig - Filter configuration\r\n   * @returns {boolean} Whether row passes filter\r\n   * @private\r\n   */\r\n  _testRowAgainstFilter(row, columnName, filterConfig) {\r\n    const cellValue = row[columnName];\r\n    \r\n    if (filterConfig.type === 'value') {\r\n      // Value filter: check if cell value is in selected values\r\n      return filterConfig.values.includes(String(cellValue));\r\n    }\r\n    \r\n    if (filterConfig.type === 'condition') {\r\n      // Condition filter: test all conditions (AND logic)\r\n      return filterConfig.conditions.every(condition => {\r\n        const operator = this.operators[condition.operator];\r\n        if (!operator) return true; // Unknown operator, pass\r\n        \r\n        return operator.apply(cellValue, condition.value);\r\n      });\r\n    }\r\n    \r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Update filter indicators in the UI\r\n   */\r\n  updateFilterIndicators() {\r\n    const headers = this.table.container.querySelectorAll('.tablix-th');\r\n    \r\n    headers.forEach(header => {\r\n      const columnName = header.dataset.column;\r\n      const hasFilter = this.hasColumnFilter(columnName);\r\n      const filterIndicator = header.querySelector('.tablix-filter-indicator');\r\n      \r\n      if (hasFilter) {\r\n        header.classList.add('tablix-filtered');\r\n        if (filterIndicator) {\r\n          filterIndicator.classList.add('tablix-filter-active');\r\n          \r\n          // Update badge if enabled\r\n          if (this.options.showBadges) {\r\n            this._updateFilterBadge(header, columnName);\r\n          }\r\n        }\r\n      } else {\r\n        header.classList.remove('tablix-filtered');\r\n        if (filterIndicator) {\r\n          filterIndicator.classList.remove('tablix-filter-active');\r\n          const badge = filterIndicator.querySelector('.tablix-filter-badge');\r\n          if (badge) badge.remove();\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Update filter badge for a column\r\n   * @param {Element} header - Header element\r\n   * @param {string} columnName - Column name\r\n   * @private\r\n   */\r\n  _updateFilterBadge(header, columnName) {\r\n    const filterIndicator = header.querySelector('.tablix-filter-indicator');\r\n    if (!filterIndicator) return;\r\n    \r\n    const filter = this.getColumnFilter(columnName);\r\n    if (!filter || !filter.isActive) return;\r\n    \r\n    let badgeText = '';\r\n    if (filter.type === 'value') {\r\n      badgeText = filter.config.values.length.toString();\r\n    } else if (filter.type === 'condition') {\r\n      const activeConditions = filter.config.conditions.filter(cond => \r\n        cond.operator && cond.operator !== 'none'\r\n      );\r\n      badgeText = activeConditions.length.toString();\r\n    }\r\n    \r\n    let badge = filterIndicator.querySelector('.tablix-filter-badge');\r\n    if (!badge && badgeText) {\r\n      badge = document.createElement('span');\r\n      badge.className = 'tablix-filter-badge';\r\n      filterIndicator.appendChild(badge);\r\n    }\r\n    \r\n    if (badge) {\r\n      badge.textContent = badgeText;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Register a custom filter operator\r\n   * @param {string} name - Operator name\r\n   * @param {Object} operator - Operator definition\r\n   */\r\n  registerOperator(name, operator) {\r\n    if (!operator.label || typeof operator.apply !== 'function') {\r\n      throw new Error('TablixJS: Custom operator must have label and apply function');\r\n    }\r\n    \r\n    this.operators[name] = operator;\r\n  }\r\n\r\n  /**\r\n   * Get available operators\r\n   * @returns {Object} Available operators\r\n   */\r\n  getOperators() {\r\n    return { ...this.operators };\r\n  }\r\n}\r\n","/**\r\n * FilterUI - User interface components for TablixJS filtering\r\n * Handles dropdown creation, event binding, and filter interactions\r\n */\r\nexport default class FilterUI {\r\n  constructor(filterManager) {\r\n    this.filterManager = filterManager;\r\n    this.table = filterManager.table;\r\n    \r\n    // Track open dropdowns\r\n    this.activeDropdown = null;\r\n    \r\n    // Bind methods to preserve context\r\n    this.handleDocumentClick = this.handleDocumentClick.bind(this);\r\n    this.handleFilterIconClick = this.handleFilterIconClick.bind(this);\r\n    \r\n    // Initialize event listeners\r\n    this.init();\r\n  }\r\n\r\n  /**\r\n   * Initialize the FilterUI\r\n   */\r\n  init() {\r\n    // Add document click listener to close dropdowns\r\n    document.addEventListener('click', this.handleDocumentClick);\r\n  }\r\n\r\n  /**\r\n   * Destroy FilterUI and clean up event listeners\r\n   */\r\n  destroy() {\r\n    document.removeEventListener('click', this.handleDocumentClick);\r\n    this.closeAllDropdowns();\r\n  }\r\n\r\n  /**\r\n   * Render filter icons in table headers\r\n   */\r\n  renderFilterIcons() {\r\n    const headers = this.table.container.querySelectorAll('.tablix-th');\r\n    \r\n    headers.forEach(header => {\r\n      const columnName = header.dataset.column;\r\n      if (!columnName) return;\r\n      \r\n      // Skip if filter icon already exists\r\n      if (header.querySelector('.tablix-filter-indicator')) return;\r\n      \r\n      const thContent = header.querySelector('.tablix-th-content');\r\n      if (!thContent) return;\r\n      \r\n      // Create filter indicator\r\n      const filterIndicator = document.createElement('span');\r\n      filterIndicator.className = 'tablix-filter-indicator';\r\n      filterIndicator.innerHTML = `\r\n        <span class=\"tablix-filter-icon\" title=\"Filter column\">⚪</span>\r\n      `;\r\n      \r\n      // Add click handler\r\n      filterIndicator.addEventListener('click', (e) => {\r\n        e.stopPropagation();\r\n        this.handleFilterIconClick(columnName, filterIndicator);\r\n      });\r\n      \r\n      // Insert after sort indicator or at end\r\n      const sortIndicator = thContent.querySelector('.tablix-sort-indicator');\r\n      if (sortIndicator) {\r\n        thContent.insertBefore(filterIndicator, sortIndicator.nextSibling);\r\n      } else {\r\n        thContent.appendChild(filterIndicator);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Handle filter icon click\r\n   * @param {string} columnName - Column name\r\n   * @param {Element} filterIndicator - Filter indicator element\r\n   */\r\n  handleFilterIconClick(columnName, filterIndicator) {\r\n    // Close any existing dropdown\r\n    this.closeAllDropdowns();\r\n    \r\n    // Create and show dropdown\r\n    const dropdown = this.createFilterDropdown(columnName);\r\n    this.showDropdown(dropdown, filterIndicator);\r\n    this.activeDropdown = { dropdown, columnName };\r\n  }\r\n\r\n  /**\r\n   * Handle document clicks to close dropdowns\r\n   * @param {Event} event - Click event\r\n   */\r\n  handleDocumentClick(event) {\r\n    if (this.activeDropdown) {\r\n      const dropdown = this.activeDropdown.dropdown;\r\n      if (!dropdown.contains(event.target)) {\r\n        this.closeAllDropdowns();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create filter dropdown for a column\r\n   * @param {string} columnName - Column name\r\n   * @returns {Element} Dropdown element\r\n   */\r\n  createFilterDropdown(columnName) {\r\n    const dropdown = document.createElement('div');\r\n    dropdown.className = 'tablix-filter-dropdown';\r\n    dropdown.innerHTML = this.renderDropdownContent(columnName);\r\n    \r\n    // Add event listeners\r\n    this.bindDropdownEvents(dropdown, columnName);\r\n    \r\n    return dropdown;\r\n  }\r\n\r\n  /**\r\n   * Render dropdown content\r\n   * @param {string} columnName - Column name\r\n   * @returns {string} HTML content\r\n   */\r\n  renderDropdownContent(columnName) {\r\n    const currentFilter = this.filterManager.getColumnFilter(columnName);\r\n    \r\n    return `\r\n      <div class=\"tablix-filter-dropdown-header\">\r\n        <h4>Filter: ${columnName}</h4>\r\n        <button class=\"tablix-filter-close\" type=\"button\">×</button>\r\n      </div>\r\n      \r\n      <div class=\"tablix-filter-tabs\">\r\n        <button class=\"tablix-filter-tab ${!currentFilter || currentFilter.type === 'value' ? 'active' : ''}\" \r\n                data-tab=\"value\">Filter by Value</button>\r\n        <button class=\"tablix-filter-tab ${currentFilter && currentFilter.type === 'condition' ? 'active' : ''}\" \r\n                data-tab=\"condition\">Filter by Condition</button>\r\n      </div>\r\n      \r\n      <div class=\"tablix-filter-content\">\r\n        <div class=\"tablix-filter-panel tablix-filter-value-panel ${!currentFilter || currentFilter.type === 'value' ? 'active' : ''}\">\r\n          ${this.renderValueFilterPanel(columnName, currentFilter)}\r\n        </div>\r\n        \r\n        <div class=\"tablix-filter-panel tablix-filter-condition-panel ${currentFilter && currentFilter.type === 'condition' ? 'active' : ''}\">\r\n          ${this.renderConditionFilterPanel(columnName, currentFilter)}\r\n        </div>\r\n      </div>\r\n      \r\n      <div class=\"tablix-filter-actions\">\r\n        <button class=\"tablix-filter-apply\" type=\"button\">Apply</button>\r\n        <button class=\"tablix-filter-clear\" type=\"button\">Clear</button>\r\n        <button class=\"tablix-filter-cancel\" type=\"button\">Cancel</button>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  /**\r\n   * Render value filter panel (checkbox list)\r\n   * @param {string} columnName - Column name\r\n   * @param {Object|null} currentFilter - Current filter state\r\n   * @returns {string} HTML content\r\n   */\r\n  renderValueFilterPanel(columnName, currentFilter) {\r\n    const uniqueValues = this.filterManager.getColumnUniqueValues(columnName);\r\n    const selectedValues = currentFilter && currentFilter.type === 'value' ? \r\n      currentFilter.config.values : [];\r\n    \r\n    if (uniqueValues.length === 0) {\r\n      return '<p class=\"tablix-filter-empty\">No values available</p>';\r\n    }\r\n    \r\n    let html = `\r\n      <div class=\"tablix-filter-search\">\r\n        <input type=\"text\" \r\n               id=\"tablix-filter-search-${columnName}\" \r\n               name=\"filter-search-${columnName}\"\r\n               placeholder=\"Search values...\" \r\n               class=\"tablix-filter-search-input\">\r\n      </div>\r\n      <div class=\"tablix-filter-select-all\">\r\n        <label>\r\n          <input type=\"checkbox\" \r\n                 id=\"tablix-filter-select-all-${columnName}\" \r\n                 name=\"filter-select-all-${columnName}\"\r\n                 class=\"tablix-filter-select-all-checkbox\"> Select All\r\n        </label>\r\n      </div>\r\n      <div class=\"tablix-filter-values\">\r\n    `;\r\n    \r\n    uniqueValues.forEach((value, index) => {\r\n      const isChecked = selectedValues.includes(value);\r\n      const valueId = `tablix-filter-value-${columnName}-${index}`;\r\n      html += `\r\n        <label class=\"tablix-filter-value-item\">\r\n          <input type=\"checkbox\" \r\n                 id=\"${valueId}\" \r\n                 name=\"filter-value-${columnName}\" \r\n                 value=\"${this.escapeHtml(value)}\" \r\n                 ${isChecked ? 'checked' : ''}>\r\n          <span class=\"tablix-filter-value-text\">${this.escapeHtml(value)}</span>\r\n        </label>\r\n      `;\r\n    });\r\n    \r\n    html += '</div>';\r\n    return html;\r\n  }\r\n\r\n  /**\r\n   * Render condition filter panel\r\n   * @param {string} columnName - Column name\r\n   * @param {Object|null} currentFilter - Current filter state\r\n   * @returns {string} HTML content\r\n   */\r\n  renderConditionFilterPanel(columnName, currentFilter) {\r\n    const conditions = currentFilter && currentFilter.type === 'condition' ? \r\n      currentFilter.config.conditions : [{ operator: 'none', value: '' }];\r\n    \r\n    let html = '<div class=\"tablix-filter-conditions\">';\r\n    \r\n    conditions.forEach((condition, index) => {\r\n      html += this.renderConditionRow(condition, index);\r\n    });\r\n    \r\n    html += `\r\n      </div>\r\n      <button class=\"tablix-filter-add-condition\" type=\"button\">+ Add Condition</button>\r\n    `;\r\n    \r\n    return html;\r\n  }\r\n\r\n  /**\r\n   * Render a single condition row\r\n   * @param {Object} condition - Condition object\r\n   * @param {number} index - Condition index\r\n   * @returns {string} HTML content\r\n   */\r\n  renderConditionRow(condition, index) {\r\n    const operators = this.filterManager.getOperators();\r\n    const needsValue = condition.operator && \r\n      !['none', 'isEmpty', 'isNotEmpty'].includes(condition.operator);\r\n    \r\n    let html = `\r\n      <div class=\"tablix-filter-condition\" data-index=\"${index}\">\r\n        <select class=\"tablix-filter-operator\" \r\n                id=\"tablix-filter-operator-${index}\" \r\n                name=\"filter-operator-${index}\">\r\n    `;\r\n    \r\n    Object.entries(operators).forEach(([key, op]) => {\r\n      const selected = condition.operator === key ? ' selected' : '';\r\n      html += `<option value=\"${key}\"${selected}>${op.label}</option>`;\r\n    });\r\n    \r\n    html += `\r\n        </select>\r\n        <input type=\"text\" \r\n               id=\"tablix-filter-value-${index}\" \r\n               name=\"filter-value-${index}\"\r\n               class=\"tablix-filter-value\" \r\n               placeholder=\"Value\" \r\n               value=\"${this.escapeHtml(condition.value || '')}\"\r\n               ${needsValue ? '' : 'disabled'}>\r\n        <button class=\"tablix-filter-remove-condition\" \r\n                type=\"button\" \r\n                data-index=\"${index}\"\r\n                title=\"Remove condition\">×</button>\r\n      </div>\r\n    `;\r\n    \r\n    return html;\r\n  }\r\n\r\n  /**\r\n   * Bind dropdown event listeners\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @param {string} columnName - Column name\r\n   */\r\n  bindDropdownEvents(dropdown, columnName) {\r\n    // Tab switching\r\n    dropdown.querySelectorAll('.tablix-filter-tab').forEach(tab => {\r\n      tab.addEventListener('click', (e) => {\r\n        const tabType = e.target.dataset.tab;\r\n        this.switchTab(dropdown, tabType);\r\n      });\r\n    });\r\n\r\n    // Close button\r\n    dropdown.querySelector('.tablix-filter-close').addEventListener('click', () => {\r\n      this.closeAllDropdowns();\r\n    });\r\n\r\n    // Action buttons\r\n    dropdown.querySelector('.tablix-filter-apply').addEventListener('click', () => {\r\n      this.applyFilter(dropdown, columnName);\r\n    });\r\n\r\n    dropdown.querySelector('.tablix-filter-clear').addEventListener('click', () => {\r\n      this.clearFilter(columnName);\r\n    });\r\n\r\n    dropdown.querySelector('.tablix-filter-cancel').addEventListener('click', () => {\r\n      this.closeAllDropdowns();\r\n    });\r\n\r\n    // Value filter events\r\n    this.bindValueFilterEvents(dropdown, columnName);\r\n    \r\n    // Condition filter events\r\n    this.bindConditionFilterEvents(dropdown, columnName);\r\n  }\r\n\r\n  /**\r\n   * Bind value filter events\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @param {string} columnName - Column name\r\n   */\r\n  bindValueFilterEvents(dropdown, columnName) {\r\n    const valuePanel = dropdown.querySelector('.tablix-filter-value-panel');\r\n    if (!valuePanel) return;\r\n\r\n    // Search input with debouncing\r\n    const searchInput = valuePanel.querySelector('.tablix-filter-search-input');\r\n    if (searchInput) {\r\n      let searchTimeout;\r\n      searchInput.addEventListener('input', (e) => {\r\n        clearTimeout(searchTimeout);\r\n        searchTimeout = setTimeout(() => {\r\n          this.filterValueList(valuePanel, e.target.value);\r\n        }, this.filterManager.options.debounceDelay || 150);\r\n      });\r\n    }\r\n\r\n    // Select all checkbox\r\n    const selectAllCheckbox = valuePanel.querySelector('.tablix-filter-select-all-checkbox');\r\n    if (selectAllCheckbox) {\r\n      selectAllCheckbox.addEventListener('change', (e) => {\r\n        this.toggleSelectAll(valuePanel, e.target.checked);\r\n      });\r\n    }\r\n\r\n    // Individual value checkboxes\r\n    valuePanel.querySelectorAll('.tablix-filter-value-item input[type=\"checkbox\"]').forEach(checkbox => {\r\n      checkbox.addEventListener('change', () => {\r\n        this.updateSelectAllState(valuePanel);\r\n      });\r\n    });\r\n\r\n    // Update select all state based on current selections\r\n    this.updateSelectAllState(valuePanel);\r\n  }\r\n\r\n  /**\r\n   * Bind condition filter events\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @param {string} columnName - Column name\r\n   */\r\n  bindConditionFilterEvents(dropdown, columnName) {\r\n    const conditionPanel = dropdown.querySelector('.tablix-filter-condition-panel');\r\n    if (!conditionPanel) return;\r\n\r\n    // Add condition button\r\n    const addButton = conditionPanel.querySelector('.tablix-filter-add-condition');\r\n    if (addButton) {\r\n      addButton.addEventListener('click', () => {\r\n        this.addCondition(conditionPanel);\r\n      });\r\n    }\r\n\r\n    // Operator and value changes\r\n    this.bindConditionRowEvents(conditionPanel);\r\n  }\r\n\r\n  /**\r\n   * Bind events for condition rows\r\n   * @param {Element} conditionPanel - Condition panel element\r\n   */\r\n  bindConditionRowEvents(conditionPanel) {\r\n    // Operator changes\r\n    conditionPanel.querySelectorAll('.tablix-filter-operator').forEach(select => {\r\n      select.addEventListener('change', (e) => {\r\n        const valueInput = e.target.parentElement.querySelector('.tablix-filter-value');\r\n        const needsValue = !['none', 'isEmpty', 'isNotEmpty'].includes(e.target.value);\r\n        valueInput.disabled = !needsValue;\r\n        if (!needsValue) valueInput.value = '';\r\n      });\r\n    });\r\n\r\n    // Remove condition buttons\r\n    conditionPanel.querySelectorAll('.tablix-filter-remove-condition').forEach(button => {\r\n      button.addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        e.stopPropagation(); // Prevent dropdown from closing\r\n        \r\n        const conditionRow = e.target.closest('.tablix-filter-condition');\r\n        const conditionsContainer = conditionPanel.querySelector('.tablix-filter-conditions');\r\n        \r\n        if (conditionsContainer.querySelectorAll('.tablix-filter-condition').length > 1) {\r\n          conditionRow.remove();\r\n        } else {\r\n          // If it's the last condition, reset it to \"none\" instead of removing\r\n          const operatorSelect = conditionRow.querySelector('.tablix-filter-operator');\r\n          const valueInput = conditionRow.querySelector('.tablix-filter-value');\r\n          operatorSelect.value = 'none';\r\n          valueInput.value = '';\r\n          valueInput.disabled = true;\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Switch between filter tabs\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @param {string} tabType - Tab type ('value' or 'condition')\r\n   */\r\n  switchTab(dropdown, tabType) {\r\n    // Update tab buttons\r\n    dropdown.querySelectorAll('.tablix-filter-tab').forEach(tab => {\r\n      tab.classList.toggle('active', tab.dataset.tab === tabType);\r\n    });\r\n\r\n    // Update panels\r\n    dropdown.querySelectorAll('.tablix-filter-panel').forEach(panel => {\r\n      const isActive = panel.classList.contains(`tablix-filter-${tabType}-panel`);\r\n      panel.classList.toggle('active', isActive);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Filter value list based on search\r\n   * @param {Element} valuePanel - Value panel element\r\n   * @param {string} searchTerm - Search term\r\n   */\r\n  filterValueList(valuePanel, searchTerm) {\r\n    const items = valuePanel.querySelectorAll('.tablix-filter-value-item');\r\n    const term = searchTerm.toLowerCase();\r\n    \r\n    items.forEach(item => {\r\n      const text = item.querySelector('.tablix-filter-value-text').textContent.toLowerCase();\r\n      const matches = text.includes(term);\r\n      item.style.display = matches ? '' : 'none';\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Toggle select all checkboxes\r\n   * @param {Element} valuePanel - Value panel element\r\n   * @param {boolean} checked - Whether to check all\r\n   */\r\n  toggleSelectAll(valuePanel, checked) {\r\n    const checkboxes = valuePanel.querySelectorAll('.tablix-filter-value-item input[type=\"checkbox\"]');\r\n    checkboxes.forEach(checkbox => {\r\n      const item = checkbox.closest('.tablix-filter-value-item');\r\n      if (item.style.display !== 'none') {\r\n        checkbox.checked = checked;\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Update select all checkbox state\r\n   * @param {Element} valuePanel - Value panel element\r\n   */\r\n  updateSelectAllState(valuePanel) {\r\n    const selectAllCheckbox = valuePanel.querySelector('.tablix-filter-select-all-checkbox');\r\n    if (!selectAllCheckbox) return;\r\n\r\n    const checkboxes = valuePanel.querySelectorAll('.tablix-filter-value-item input[type=\"checkbox\"]');\r\n    const visibleCheckboxes = Array.from(checkboxes).filter(cb => \r\n      cb.closest('.tablix-filter-value-item').style.display !== 'none'\r\n    );\r\n    \r\n    const checkedCount = visibleCheckboxes.filter(cb => cb.checked).length;\r\n    \r\n    selectAllCheckbox.checked = checkedCount > 0 && checkedCount === visibleCheckboxes.length;\r\n    selectAllCheckbox.indeterminate = checkedCount > 0 && checkedCount < visibleCheckboxes.length;\r\n  }\r\n\r\n  /**\r\n   * Add a new condition row\r\n   * @param {Element} conditionPanel - Condition panel element\r\n   */\r\n  addCondition(conditionPanel) {\r\n    const conditionsContainer = conditionPanel.querySelector('.tablix-filter-conditions');\r\n    const newIndex = conditionsContainer.children.length;\r\n    \r\n    const conditionHtml = this.renderConditionRow({ operator: 'none', value: '' }, newIndex);\r\n    conditionsContainer.insertAdjacentHTML('beforeend', conditionHtml);\r\n    \r\n    // Bind events for the new condition only\r\n    const newCondition = conditionsContainer.lastElementChild;\r\n    \r\n    // Bind operator change event\r\n    const operatorSelect = newCondition.querySelector('.tablix-filter-operator');\r\n    operatorSelect.addEventListener('change', (e) => {\r\n      const valueInput = e.target.parentElement.querySelector('.tablix-filter-value');\r\n      const needsValue = !['none', 'isEmpty', 'isNotEmpty'].includes(e.target.value);\r\n      valueInput.disabled = !needsValue;\r\n      if (!needsValue) valueInput.value = '';\r\n    });\r\n\r\n    // Bind remove button event\r\n    const removeButton = newCondition.querySelector('.tablix-filter-remove-condition');\r\n    removeButton.addEventListener('click', (e) => {\r\n      e.preventDefault();\r\n      e.stopPropagation(); // Prevent dropdown from closing\r\n      \r\n      const conditionRow = e.target.closest('.tablix-filter-condition');\r\n      const conditionsContainer = conditionPanel.querySelector('.tablix-filter-conditions');\r\n      \r\n      if (conditionsContainer.querySelectorAll('.tablix-filter-condition').length > 1) {\r\n        conditionRow.remove();\r\n      } else {\r\n        // If it's the last condition, reset it to \"none\" instead of removing\r\n        const operatorSelect = conditionRow.querySelector('.tablix-filter-operator');\r\n        const valueInput = conditionRow.querySelector('.tablix-filter-value');\r\n        operatorSelect.value = 'none';\r\n        valueInput.value = '';\r\n        valueInput.disabled = true;\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Apply current filter settings\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @param {string} columnName - Column name\r\n   */\r\n  async applyFilter(dropdown, columnName) {\r\n    const activeTab = dropdown.querySelector('.tablix-filter-tab.active').dataset.tab;\r\n    let filterConfig;\r\n\r\n    if (activeTab === 'value') {\r\n      filterConfig = this.collectValueFilter(dropdown);\r\n    } else {\r\n      filterConfig = this.collectConditionFilter(dropdown);\r\n    }\r\n\r\n    await this.filterManager.applyFilter(columnName, filterConfig);\r\n    this.closeAllDropdowns();\r\n  }\r\n\r\n  /**\r\n   * Collect value filter configuration\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @returns {Object} Filter configuration\r\n   */\r\n  collectValueFilter(dropdown) {\r\n    const valuePanel = dropdown.querySelector('.tablix-filter-value-panel');\r\n    const checkboxes = valuePanel.querySelectorAll('.tablix-filter-value-item input[type=\"checkbox\"]:checked');\r\n    const values = Array.from(checkboxes).map(cb => cb.value);\r\n    \r\n    return {\r\n      type: 'value',\r\n      values: values\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Collect condition filter configuration\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @returns {Object} Filter configuration\r\n   */\r\n  collectConditionFilter(dropdown) {\r\n    const conditionPanel = dropdown.querySelector('.tablix-filter-condition-panel');\r\n    const conditionRows = conditionPanel.querySelectorAll('.tablix-filter-condition');\r\n    \r\n    const conditions = Array.from(conditionRows).map(row => {\r\n      const operator = row.querySelector('.tablix-filter-operator').value;\r\n      const value = row.querySelector('.tablix-filter-value').value;\r\n      \r\n      return { operator, value };\r\n    }).filter(cond => cond.operator !== 'none');\r\n    \r\n    return {\r\n      type: 'condition',\r\n      conditions: conditions\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Clear filter for column\r\n   * @param {string} columnName - Column name\r\n   */\r\n  async clearFilter(columnName) {\r\n    await this.filterManager.clearFilter(columnName);\r\n    this.closeAllDropdowns();\r\n  }\r\n\r\n  /**\r\n   * Show dropdown positioned relative to trigger element\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @param {Element} trigger - Trigger element\r\n   */\r\n  showDropdown(dropdown, trigger) {\r\n    document.body.appendChild(dropdown);\r\n    \r\n    // Position dropdown\r\n    const triggerRect = trigger.getBoundingClientRect();\r\n    const dropdownRect = dropdown.getBoundingClientRect();\r\n    \r\n    let left = triggerRect.left;\r\n    let top = triggerRect.bottom + 5;\r\n    \r\n    // Adjust if dropdown goes off screen\r\n    if (left + dropdownRect.width > window.innerWidth) {\r\n      left = window.innerWidth - dropdownRect.width - 10;\r\n    }\r\n    \r\n    if (top + dropdownRect.height > window.innerHeight) {\r\n      top = triggerRect.top - dropdownRect.height - 5;\r\n    }\r\n    \r\n    dropdown.style.left = `${Math.max(10, left)}px`;\r\n    dropdown.style.top = `${Math.max(10, top)}px`;\r\n    dropdown.style.display = 'block';\r\n  }\r\n\r\n  /**\r\n   * Close all open dropdowns\r\n   */\r\n  closeAllDropdowns() {\r\n    if (this.activeDropdown) {\r\n      this.activeDropdown.dropdown.remove();\r\n      this.activeDropdown = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Escape HTML to prevent XSS\r\n   * @param {string} text - Text to escape\r\n   * @returns {string} Escaped text\r\n   */\r\n  escapeHtml(text) {\r\n    const div = document.createElement('div');\r\n    div.textContent = text;\r\n    return div.innerHTML;\r\n  }\r\n}\r\n","/**\r\n * SearchManager - Global search functionality for TablixJS\r\n * Provides real-time search across all table columns\r\n */\r\nexport default class SearchManager {\r\n  constructor(table, options = {}) {\r\n    this.table = table;\r\n    this.options = {\r\n      enabled: true,\r\n      placeholder: 'Search...',\r\n      searchDelay: 300, // Debounce delay in milliseconds\r\n      caseSensitive: false,\r\n      searchColumns: [], // Empty array means search all columns\r\n      minLength: 1, // Minimum characters before search starts (changed from 0 to 1)\r\n      ...options\r\n    };\r\n\r\n    // Ensure placeholder is never undefined to prevent \"undefined\" from showing in UI\r\n    if (!this.options.placeholder) {\r\n      this.options.placeholder = 'Search...';\r\n    }\r\n\r\n    // Current search state\r\n    this.currentSearchTerm = '';\r\n    this.searchTimeout = null;\r\n    this.originalData = null;\r\n\r\n    // Bind methods to preserve context\r\n    this.handleSearchInput = this.handleSearchInput.bind(this);\r\n    this.handleSearchClear = this.handleSearchClear.bind(this);\r\n  }\r\n\r\n  /**\r\n   * Initialize search functionality\r\n   */\r\n  init() {\r\n    // Store reference to original data\r\n    this.originalData = this.table.dataManager.originalData;\r\n    \r\n    // Listen for data changes\r\n    this.table.eventManager.on('afterLoad', (data) => {\r\n      this.originalData = data.data || data.source;\r\n      // Reapply search if there's an active search term\r\n      if (this.currentSearchTerm) {\r\n        this.performSearch(this.currentSearchTerm);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Bind search events to UI elements\r\n   */\r\n  bindEvents() {\r\n    const searchInput = this.table.container.querySelector('.tablix-search-input');\r\n    const searchClear = this.table.container.querySelector('.tablix-search-clear');\r\n\r\n    if (searchInput) {\r\n      // Ensure input value matches current search term\r\n      if (this.currentSearchTerm && searchInput.value !== this.currentSearchTerm) {\r\n        searchInput.value = this.currentSearchTerm;\r\n      }\r\n      \r\n      searchInput.addEventListener('input', this.handleSearchInput);\r\n      searchInput.addEventListener('keydown', (e) => {\r\n        if (e.key === 'Escape') {\r\n          this.clearSearch();\r\n        }\r\n      });\r\n    }\r\n\r\n    if (searchClear) {\r\n      searchClear.addEventListener('click', this.handleSearchClear);\r\n    }\r\n\r\n    // Update clear button visibility\r\n    this.updateClearButtonVisibility();\r\n  }\r\n\r\n  /**\r\n   * Handle search input with debouncing\r\n   * @param {Event} event - Input event\r\n   */\r\n  handleSearchInput(event) {\r\n    const searchTerm = event.target.value;\r\n    \r\n    // Clear existing timeout\r\n    if (this.searchTimeout) {\r\n      clearTimeout(this.searchTimeout);\r\n    }\r\n\r\n    // Debounce search based on configurable delay\r\n    this.searchTimeout = setTimeout(() => {\r\n      this.performSearch(searchTerm);\r\n    }, this.options.searchDelay);\r\n  }\r\n\r\n  /**\r\n   * Handle search clear button\r\n   * @param {Event} event - Click event\r\n   */\r\n  handleSearchClear(event) {\r\n    event.preventDefault();\r\n    this.clearSearch();\r\n  }\r\n\r\n  /**\r\n   * Perform the actual search\r\n   * @param {string} searchTerm - Search term\r\n   */\r\n  async performSearch(searchTerm) {\r\n    const previousTerm = this.currentSearchTerm;\r\n    \r\n    // Capture focus state before performing search\r\n    const searchInput = this.table.container.querySelector('.tablix-search-input');\r\n    const hadFocus = searchInput && document.activeElement === searchInput;\r\n    const cursorPosition = searchInput ? searchInput.selectionStart || 0 : 0;\r\n    \r\n    // Trigger beforeSearch event with more detailed information\r\n    const beforeSearchData = { \r\n      searchTerm, \r\n      previousTerm,\r\n      minLength: this.options.minLength,\r\n      searchDelay: this.options.searchDelay,\r\n      willSearch: searchTerm.length >= this.options.minLength\r\n    };\r\n    \r\n    this.table.eventManager.trigger('beforeSearch', beforeSearchData);\r\n\r\n    this.currentSearchTerm = searchTerm;\r\n\r\n    // If search term is below minimum length, show all data\r\n    if (searchTerm.length < this.options.minLength) {\r\n      this.table.dataManager.filteredData = [...this.originalData];\r\n    } else {\r\n      // Filter data based on search term\r\n      const filteredData = this.filterData(searchTerm);\r\n      this.table.dataManager.filteredData = filteredData;\r\n    }\r\n\r\n    // Reset pagination to first page\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.resetToFirstPage();\r\n    }\r\n\r\n    // Refresh table display\r\n    await this.table.refreshTable();\r\n\r\n    // Restore focus after table refresh if it had focus before\r\n    if (hadFocus) {\r\n      requestAnimationFrame(() => {\r\n        const newSearchInput = this.table.container.querySelector('.tablix-search-input');\r\n        if (newSearchInput) {\r\n          newSearchInput.focus();\r\n          if (cursorPosition > 0 && cursorPosition <= newSearchInput.value.length) {\r\n            newSearchInput.setSelectionRange(cursorPosition, cursorPosition);\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    // Trigger afterSearch event with detailed results\r\n    const afterSearchData = {\r\n      searchTerm,\r\n      previousTerm,\r\n      resultsCount: this.table.dataManager.filteredData.length,\r\n      totalCount: this.originalData.length,\r\n      isActive: this.isSearchActive(),\r\n      searchPerformed: searchTerm.length >= this.options.minLength\r\n    };\r\n    \r\n    this.table.eventManager.trigger('afterSearch', afterSearchData);\r\n\r\n    // Update search clear button visibility\r\n    this.updateClearButtonVisibility();\r\n  }\r\n\r\n  /**\r\n   * Filter data based on search term\r\n   * @param {string} searchTerm - Search term\r\n   * @returns {Array} Filtered data\r\n   */\r\n  filterData(searchTerm) {\r\n    if (!searchTerm || searchTerm.trim() === '') {\r\n      return [...this.originalData];\r\n    }\r\n\r\n    const term = this.options.caseSensitive ? searchTerm : searchTerm.toLowerCase();\r\n    const columns = this.getSearchableColumns();\r\n\r\n    return this.originalData.filter(row => {\r\n      return columns.some(columnName => {\r\n        const cellValue = row[columnName];\r\n        if (cellValue === null || cellValue === undefined) {\r\n          return false;\r\n        }\r\n\r\n        const stringValue = this.options.caseSensitive ? \r\n          String(cellValue) : \r\n          String(cellValue).toLowerCase();\r\n\r\n        return stringValue.includes(term);\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get columns to search in\r\n   * @returns {Array} Array of column names\r\n   */\r\n  getSearchableColumns() {\r\n    // If specific columns are configured, use those\r\n    if (this.options.searchColumns && this.options.searchColumns.length > 0) {\r\n      return this.options.searchColumns;\r\n    }\r\n\r\n    // Otherwise, search all available columns\r\n    const columns = this.table.columnManager ? \r\n      this.table.columnManager.getColumns() : \r\n      (this.table.options.columns || []);\r\n\r\n    return columns.map(col => col.name || col.key).filter(name => name);\r\n  }\r\n\r\n  /**\r\n   * Clear search\r\n   */\r\n  async clearSearch() {\r\n    // Clear search input using the helper method\r\n    this.updateInputValue('');\r\n\r\n    // Clear search timeout\r\n    if (this.searchTimeout) {\r\n      clearTimeout(this.searchTimeout);\r\n      this.searchTimeout = null;\r\n    }\r\n\r\n    // Perform empty search to reset data\r\n    await this.performSearch('');\r\n  }\r\n\r\n  /**\r\n   * Update clear button visibility\r\n   */\r\n  updateClearButtonVisibility() {\r\n    const searchClear = this.table.container.querySelector('.tablix-search-clear');\r\n    if (searchClear) {\r\n      searchClear.style.display = this.currentSearchTerm ? 'block' : 'none';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update input value without triggering search\r\n   * @param {string} value - Value to set\r\n   */\r\n  updateInputValue(value) {\r\n    const searchInput = this.table.container.querySelector('.tablix-search-input');\r\n    if (searchInput && searchInput.value !== value) {\r\n      searchInput.value = value;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set search term programmatically\r\n   * @param {string} searchTerm - Search term\r\n   */\r\n  async setSearchTerm(searchTerm) {\r\n    // Update input value\r\n    this.updateInputValue(searchTerm);\r\n    \r\n    // Clear any pending search timeout\r\n    if (this.searchTimeout) {\r\n      clearTimeout(this.searchTimeout);\r\n      this.searchTimeout = null;\r\n    }\r\n    \r\n    // Perform search immediately\r\n    await this.performSearch(searchTerm);\r\n  }\r\n\r\n  /**\r\n   * Get current search term\r\n   * @returns {string} Current search term\r\n   */\r\n  getSearchTerm() {\r\n    return this.currentSearchTerm;\r\n  }\r\n\r\n  /**\r\n   * Check if search is active\r\n   * @returns {boolean} Whether search is active\r\n   */\r\n  isSearchActive() {\r\n    return this.currentSearchTerm && this.currentSearchTerm.length >= this.options.minLength;\r\n  }\r\n\r\n  /**\r\n   * Get search results count\r\n   * @returns {Object} Search results information\r\n   */\r\n  getSearchInfo() {\r\n    return {\r\n      searchTerm: this.currentSearchTerm,\r\n      resultsCount: this.table.dataManager.filteredData.length,\r\n      totalCount: this.originalData.length,\r\n      isActive: this.isSearchActive()\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Configure search options\r\n   * @param {Object} newOptions - New options to merge\r\n   */\r\n  configure(newOptions) {\r\n    const oldOptions = { ...this.options };\r\n    this.options = { ...this.options, ...newOptions };\r\n    \r\n    // Ensure placeholder is never undefined\r\n    if (!this.options.placeholder) {\r\n      this.options.placeholder = 'Search...';\r\n    }\r\n    \r\n    // Update placeholder if it changed\r\n    if (newOptions.placeholder && newOptions.placeholder !== oldOptions.placeholder) {\r\n      const searchInput = this.table.container.querySelector('.tablix-search-input');\r\n      if (searchInput) {\r\n        searchInput.placeholder = this.options.placeholder;\r\n      }\r\n    }\r\n    \r\n    // If minLength changed and we have an active search, re-evaluate\r\n    if (newOptions.minLength !== undefined && this.currentSearchTerm) {\r\n      this.performSearch(this.currentSearchTerm);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current search configuration\r\n   * @returns {Object} Current search options\r\n   */\r\n  getConfiguration() {\r\n    return { ...this.options };\r\n  }\r\n\r\n  /**\r\n   * Destroy search manager and clean up\r\n   */\r\n  destroy() {\r\n    if (this.searchTimeout) {\r\n      clearTimeout(this.searchTimeout);\r\n    }\r\n\r\n    const searchInput = this.table.container.querySelector('.tablix-search-input');\r\n    const searchClear = this.table.container.querySelector('.tablix-search-clear');\r\n\r\n    if (searchInput) {\r\n      searchInput.removeEventListener('input', this.handleSearchInput);\r\n    }\r\n\r\n    if (searchClear) {\r\n      searchClear.removeEventListener('click', this.handleSearchClear);\r\n    }\r\n  }\r\n}\r\n","export default class SelectionManager {\r\n  constructor(table, options = {}) {\r\n    this.table = table;\r\n    this.options = {\r\n      enabled: false,\r\n      mode: 'single', // 'single' or 'multi'\r\n      ...options\r\n    };\r\n    \r\n    // Selection state - use stable data IDs/keys, not row indexes\r\n    this.selectedRows = new Set(); // Set of row IDs/keys\r\n    this.lastSelectedRow = null; // For range selection with shift+click\r\n    \r\n    // Track row ID mapping for stable selection across pagination/sorting/filtering\r\n    this.rowIdMap = new Map(); // Maps data objects to their stable IDs\r\n    this.dataIdKey = options.dataIdKey || 'id'; // Key to use as stable row ID\r\n    \r\n    // Drag selection state\r\n    this.dragSelection = {\r\n      isActive: false,\r\n      startRowIndex: null,\r\n      currentRowIndex: null,\r\n      startRowId: null,\r\n      originalSelection: null, // Backup of selection before drag started\r\n      isDragging: false,\r\n      dragThreshold: 3 // Minimum pixels to move before considering it a drag\r\n    };\r\n    \r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.eventListenersSetup = false; // Track if event listeners are already set up\r\n    \r\n    if (this.options.enabled) {\r\n      this.setupEventListeners();\r\n    }\r\n  }\r\n\r\n  setupEventListeners() {\r\n    // Prevent setting up listeners multiple times\r\n    if (this.eventListenersSetup) {\r\n      return;\r\n    }\r\n    \r\n    this.eventListenersSetup = true;\r\n    \r\n    // Listen for row clicks\r\n    this.table.eventManager.on('rowClick', (event) => {\r\n      this.handleRowClick(event);\r\n    });\r\n    \r\n    // Listen for drag selection events (only in multi mode and when NOT using virtual scrolling)\r\n    if (this.options.mode === 'multi' && !this.table.virtualScrollManager) {\r\n      this.setupDragSelection();\r\n    }\r\n    \r\n    // Clear selection when data changes\r\n    this.table.eventManager.on('beforeLoad', () => {\r\n      this.clearSelection();\r\n    });\r\n    \r\n    // Update selection state after data operations\r\n    this.table.eventManager.on('afterLoad', () => {\r\n      this.updateSelectionAfterDataChange();\r\n    });\r\n    \r\n    // Update selection UI after rendering\r\n    this.table.eventManager.on('afterRender', () => {\r\n      this.updateUI();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Handle row click events for selection\r\n   * @param {Object} event - Row click event data\r\n   */\r\n  handleRowClick(event) {\r\n    if (!this.options.enabled) {\r\n      return;\r\n    }\r\n\r\n    // If this was a drag operation, don't process as a click\r\n    if (this.dragSelection.isDragging) {\r\n      this.dragSelection.isDragging = false;\r\n      return;\r\n    }\r\n\r\n    const { rowData, rowIndex, originalEvent } = event;\r\n    const rowId = this.getRowId(rowData);\r\n    \r\n    // Debug logging for modifier keys\r\n    console.log('SelectionManager handleRowClick:', {\r\n      rowId,\r\n      hasOriginalEvent: !!originalEvent,\r\n      ctrlKey: originalEvent ? originalEvent.ctrlKey : 'no event',\r\n      shiftKey: originalEvent ? originalEvent.shiftKey : 'no event',\r\n      metaKey: originalEvent ? originalEvent.metaKey : 'no event',\r\n      timestamp: Date.now()\r\n    });\r\n    \r\n    // Prevent default and stop propagation to avoid duplicate events\r\n    if (originalEvent) {\r\n      originalEvent.preventDefault();\r\n      originalEvent.stopPropagation();\r\n    }\r\n\r\n    // Fire beforeSelect event\r\n    const beforeSelectEvent = {\r\n      rowData,\r\n      rowId,\r\n      currentSelection: Array.from(this.selectedRows),\r\n      isCtrlClick: originalEvent && (originalEvent.ctrlKey || originalEvent.metaKey),\r\n      isShiftClick: originalEvent && originalEvent.shiftKey,\r\n      isDragSelection: false\r\n    };\r\n    \r\n    this.table.eventManager.trigger('beforeSelect', beforeSelectEvent);\r\n\r\n    if (this.options.mode === 'single') {\r\n      this.handleSingleSelection(rowId, rowData);\r\n    } else if (this.options.mode === 'multi') {\r\n      this.handleMultiSelection(rowId, rowData, originalEvent);\r\n    }\r\n\r\n    this.updateUI();\r\n    \r\n    // Fire afterSelect event\r\n    const afterSelectEvent = {\r\n      rowData,\r\n      rowId,\r\n      selectedRows: Array.from(this.selectedRows),\r\n      selectedData: this.getSelectedData(),\r\n      isDragSelection: false\r\n    };\r\n    \r\n    this.table.eventManager.trigger('afterSelect', afterSelectEvent);\r\n  }\r\n\r\n  /**\r\n   * Handle single row selection\r\n   * @param {String} rowId - Stable row identifier\r\n   * @param {Object} rowData - Row data object\r\n   */\r\n  handleSingleSelection(rowId, rowData) {\r\n    // In single mode, if the row is already selected, deselect it\r\n    if (this.selectedRows.has(rowId)) {\r\n      this.selectedRows.clear();\r\n      this.lastSelectedRow = null;\r\n    } else {\r\n      // Otherwise, select only the clicked row\r\n      this.selectedRows.clear();\r\n      this.selectedRows.add(rowId);\r\n      this.lastSelectedRow = rowId;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle multi row selection with ctrl+click and shift+click\r\n   * @param {String} rowId - Stable row identifier\r\n   * @param {Object} rowData - Row data object\r\n   * @param {Event} originalEvent - Original mouse event\r\n   */\r\n  handleMultiSelection(rowId, rowData, originalEvent) {\r\n    const isCtrlClick = originalEvent && (originalEvent.ctrlKey || originalEvent.metaKey);\r\n    const isShiftClick = originalEvent && originalEvent.shiftKey;\r\n\r\n    console.log('handleMultiSelection DETAILED:', {\r\n      rowId,\r\n      isCtrlClick,\r\n      isShiftClick,\r\n      'originalEvent.ctrlKey': originalEvent ? originalEvent.ctrlKey : 'no event',\r\n      'originalEvent.metaKey': originalEvent ? originalEvent.metaKey : 'no event',\r\n      'originalEvent.shiftKey': originalEvent ? originalEvent.shiftKey : 'no event',\r\n      lastSelectedRow: this.lastSelectedRow,\r\n      currentSelection: Array.from(this.selectedRows),\r\n      selectionSize: this.selectedRows.size\r\n    });\r\n\r\n    if (isShiftClick && this.lastSelectedRow) {\r\n      // Range selection: select all rows between last selected and current\r\n      console.log('Executing range selection from', this.lastSelectedRow, 'to', rowId);\r\n      this.handleRangeSelection(rowId);\r\n    } else if (isCtrlClick) {\r\n      // Toggle selection of individual row\r\n      console.log('Executing ctrl+click toggle for', rowId);\r\n      if (this.selectedRows.has(rowId)) {\r\n        this.selectedRows.delete(rowId);\r\n        console.log('Ctrl+click: Deselected', rowId);\r\n        // Update lastSelectedRow to another selected row or null\r\n        this.lastSelectedRow = this.selectedRows.size > 0 ? Array.from(this.selectedRows)[0] : null;\r\n      } else {\r\n        this.selectedRows.add(rowId);\r\n        this.lastSelectedRow = rowId;\r\n        console.log('Ctrl+click: Added', rowId, 'to selection. Total selected:', this.selectedRows.size);\r\n      }\r\n    } else {\r\n      // Normal click: select only this row (clear previous selection)\r\n      console.log('Executing normal click for', rowId);\r\n      this.selectedRows.clear();\r\n      this.selectedRows.add(rowId);\r\n      this.lastSelectedRow = rowId;\r\n      console.log('Normal click: Selected only', rowId);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle range selection with shift+click\r\n   * @param {String} endRowId - End row ID for range selection\r\n   */\r\n  handleRangeSelection(endRowId) {\r\n    const fullData = this.getFullData();\r\n    \r\n    // Find indices in the full dataset\r\n    const startIndex = fullData.findIndex(row => this.getRowId(row) === this.lastSelectedRow);\r\n    const endIndex = fullData.findIndex(row => this.getRowId(row) === endRowId);\r\n\r\n    if (startIndex === -1 || endIndex === -1) {\r\n      // Fallback to single selection if we can't find the range\r\n      this.selectedRows.clear();\r\n      this.selectedRows.add(endRowId);\r\n      this.lastSelectedRow = endRowId;\r\n      return;\r\n    }\r\n\r\n    // Select all rows in range\r\n    const minIndex = Math.min(startIndex, endIndex);\r\n    const maxIndex = Math.max(startIndex, endIndex);\r\n    \r\n    for (let i = minIndex; i <= maxIndex; i++) {\r\n      const rowId = this.getRowId(fullData[i]);\r\n      this.selectedRows.add(rowId);\r\n    }\r\n  }\r\n\r\n  // ===== DRAG SELECTION METHODS =====\r\n\r\n  /**\r\n   * Setup drag selection event listeners\r\n   */\r\n  setupDragSelection() {\r\n    const tableElement = this.table.container;\r\n    if (!tableElement) return;\r\n\r\n    let startX, startY;\r\n\r\n    // Mouse down on table body\r\n    tableElement.addEventListener('mousedown', (e) => {\r\n      if (!this.options.enabled || this.options.mode !== 'multi') return;\r\n      \r\n      const row = e.target.closest('.tablix-row');\r\n      if (!row || row.classList.contains('tablix-empty-row')) return;\r\n\r\n      const globalRowIndex = parseInt(row.dataset.rowIndex, 10);\r\n      if (isNaN(globalRowIndex)) return;\r\n\r\n      // Only start drag selection if not using modifier keys\r\n      if (e.ctrlKey || e.metaKey || e.shiftKey) return;\r\n\r\n      startX = e.clientX;\r\n      startY = e.clientY;\r\n\r\n      this.dragSelection.isActive = true;\r\n      this.dragSelection.startRowIndex = globalRowIndex; // Store global index\r\n      this.dragSelection.currentRowIndex = globalRowIndex;\r\n      this.dragSelection.isDragging = false;\r\n      \r\n      // Store original selection for potential restoration\r\n      this.dragSelection.originalSelection = new Set(this.selectedRows);\r\n\r\n      // Get start row data using global index\r\n      const fullData = this.getFullData();\r\n      if (globalRowIndex < fullData.length) {\r\n        this.dragSelection.startRowId = this.getRowId(fullData[globalRowIndex]);\r\n      }\r\n\r\n      e.preventDefault();\r\n    });\r\n\r\n    // Mouse move - handle drag selection\r\n    tableElement.addEventListener('mousemove', (e) => {\r\n      if (!this.dragSelection.isActive) return;\r\n\r\n      const deltaX = Math.abs(e.clientX - startX);\r\n      const deltaY = Math.abs(e.clientY - startY);\r\n\r\n      // Check if we've moved enough to consider it a drag\r\n      if (!this.dragSelection.isDragging && \r\n          (deltaX > this.dragSelection.dragThreshold || deltaY > this.dragSelection.dragThreshold)) {\r\n        this.dragSelection.isDragging = true;\r\n        this.startDragSelection();\r\n      }\r\n\r\n      if (this.dragSelection.isDragging) {\r\n        this.updateDragSelection(e);\r\n      }\r\n    });\r\n\r\n    // Mouse up - complete drag selection\r\n    tableElement.addEventListener('mouseup', (e) => {\r\n      if (this.dragSelection.isActive) {\r\n        this.completeDragSelection();\r\n      }\r\n    });\r\n\r\n    // Mouse leave - cancel drag selection\r\n    tableElement.addEventListener('mouseleave', (e) => {\r\n      if (this.dragSelection.isActive) {\r\n        this.cancelDragSelection();\r\n      }\r\n    });\r\n\r\n    // Prevent text selection during drag\r\n    tableElement.addEventListener('selectstart', (e) => {\r\n      if (this.dragSelection.isDragging) {\r\n        e.preventDefault();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Start drag selection\r\n   */\r\n  startDragSelection() {\r\n    // Add drag selection class to table for styling\r\n    const tableWrapper = this.table.container.querySelector('.tablix-wrapper');\r\n    if (tableWrapper) {\r\n      tableWrapper.classList.add('tablix-drag-selecting');\r\n    }\r\n\r\n    // Fire beforeSelect event for drag start\r\n    const fullData = this.getFullData();\r\n    if (this.dragSelection.startRowIndex < fullData.length) {\r\n      const startRowData = fullData[this.dragSelection.startRowIndex];\r\n      const beforeSelectEvent = {\r\n        rowData: startRowData,\r\n        rowId: this.dragSelection.startRowId,\r\n        currentSelection: Array.from(this.selectedRows),\r\n        isCtrlClick: false,\r\n        isShiftClick: false,\r\n        isDragSelection: true,\r\n        dragStart: true\r\n      };\r\n      \r\n      this.table.eventManager.trigger('beforeSelect', beforeSelectEvent);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update drag selection based on current mouse position\r\n   */\r\n  updateDragSelection(event) {\r\n    const row = event.target.closest('.tablix-row');\r\n    if (!row || row.classList.contains('tablix-empty-row')) return;\r\n\r\n    const globalRowIndex = parseInt(row.dataset.rowIndex, 10);\r\n    if (isNaN(globalRowIndex)) return;\r\n\r\n    if (globalRowIndex !== this.dragSelection.currentRowIndex) {\r\n      this.dragSelection.currentRowIndex = globalRowIndex;\r\n      this.applyDragSelection();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Apply current drag selection range\r\n   */\r\n  applyDragSelection() {\r\n    // Always use full dataset for drag selection (global indices)\r\n    const fullData = this.getFullData();\r\n    \r\n    // Calculate selection range using global indices\r\n    const startIndex = this.dragSelection.startRowIndex;\r\n    const endIndex = this.dragSelection.currentRowIndex;\r\n    const minIndex = Math.min(startIndex, endIndex);\r\n    const maxIndex = Math.max(startIndex, endIndex);\r\n\r\n    // Start with original selection (preserve existing selections)\r\n    this.selectedRows = new Set(this.dragSelection.originalSelection);\r\n\r\n    // Add drag range to selection\r\n    for (let i = minIndex; i <= maxIndex; i++) {\r\n      if (i < fullData.length) {\r\n        const rowId = this.getRowId(fullData[i]);\r\n        this.selectedRows.add(rowId);\r\n      }\r\n    }\r\n\r\n    // Update last selected row\r\n    if (endIndex < fullData.length) {\r\n      this.lastSelectedRow = this.getRowId(fullData[endIndex]);\r\n    }\r\n\r\n    // Update UI immediately for responsive feedback\r\n    this.updateUI();\r\n  }\r\n\r\n  /**\r\n   * Complete drag selection\r\n   */\r\n  completeDragSelection() {\r\n    const tableWrapper = this.table.container.querySelector('.tablix-wrapper');\r\n    if (tableWrapper) {\r\n      tableWrapper.classList.remove('tablix-drag-selecting');\r\n    }\r\n\r\n    if (this.dragSelection.isDragging) {\r\n      // Fire final afterSelect event\r\n      const afterSelectEvent = {\r\n        selectedRows: Array.from(this.selectedRows),\r\n        selectedData: this.getSelectedData(),\r\n        isDragSelection: true,\r\n        dragComplete: true\r\n      };\r\n      \r\n      this.table.eventManager.trigger('afterSelect', afterSelectEvent);\r\n    }\r\n\r\n    this.resetDragSelection();\r\n  }\r\n\r\n  /**\r\n   * Cancel drag selection and restore original state\r\n   */\r\n  cancelDragSelection() {\r\n    const tableWrapper = this.table.container.querySelector('.tablix-wrapper');\r\n    if (tableWrapper) {\r\n      tableWrapper.classList.remove('tablix-drag-selecting');\r\n    }\r\n\r\n    // Restore original selection\r\n    this.selectedRows = new Set(this.dragSelection.originalSelection);\r\n    this.updateUI();\r\n\r\n    this.resetDragSelection();\r\n  }\r\n\r\n  /**\r\n   * Reset drag selection state\r\n   */\r\n  resetDragSelection() {\r\n    this.dragSelection.isActive = false;\r\n    this.dragSelection.startRowIndex = null;\r\n    this.dragSelection.currentRowIndex = null;\r\n    this.dragSelection.startRowId = null;\r\n    this.dragSelection.originalSelection = null;\r\n    this.dragSelection.isDragging = false;\r\n  }\r\n\r\n  /**\r\n   * Get stable row ID from row data\r\n   * @param {Object} rowData - Row data object\r\n   * @returns {String} Stable row identifier\r\n   */\r\n  getRowId(rowData) {\r\n    if (typeof rowData[this.dataIdKey] !== 'undefined') {\r\n      return String(rowData[this.dataIdKey]);\r\n    }\r\n    \r\n    // Fallback: create a hash of the row data for identification\r\n    return this.createRowHash(rowData);\r\n  }\r\n\r\n  /**\r\n   * Create a simple hash from row data for identification\r\n   * @param {Object} rowData - Row data object\r\n   * @returns {String} Hash string\r\n   */\r\n  createRowHash(rowData) {\r\n    const str = JSON.stringify(rowData);\r\n    let hash = 0;\r\n    for (let i = 0; i < str.length; i++) {\r\n      const char = str.charCodeAt(i);\r\n      hash = ((hash << 5) - hash) + char;\r\n      hash = hash & hash; // Convert to 32-bit integer\r\n    }\r\n    return String(hash);\r\n  }\r\n\r\n  /**\r\n   * Get current page data for range selection\r\n   * @returns {Array} Current page data\r\n   */\r\n  getCurrentPageData() {\r\n    // If using virtual scrolling, return full dataset\r\n    if (this.table.virtualScrollManager) {\r\n      return this.table.dataManager.getData();\r\n    }\r\n    // Otherwise use pagination if available\r\n    if (this.table.paginationManager) {\r\n      return this.table.paginationManager.getCurrentPageData() || [];\r\n    }\r\n    return this.table.dataManager.getData();\r\n  }\r\n\r\n  /**\r\n   * Get the full dataset for virtual scrolling operations\r\n   * @returns {Array} Full dataset\r\n   */\r\n  getFullData() {\r\n    return this.table.dataManager.getData();\r\n  }\r\n\r\n  /**\r\n   * Update UI to reflect current selection\r\n   */\r\n  updateUI() {\r\n    if (!this.options.enabled) {\r\n      return;\r\n    }\r\n\r\n    const tableElement = this.table.container.querySelector('.tablix-table');\r\n    if (!tableElement) {\r\n      return;\r\n    }\r\n\r\n    // Remove existing selection classes\r\n    const allRows = tableElement.querySelectorAll('.tablix-row');\r\n    allRows.forEach(row => {\r\n      row.classList.remove('tablix-selected', 'tablix-last-selected');\r\n    });\r\n\r\n    // Check if we're in virtual scroll mode by looking for data-virtual-index attributes\r\n    const hasVirtualIndexes = allRows.length > 0 && allRows[0].hasAttribute('data-virtual-index');\r\n    \r\n    if (hasVirtualIndexes) {\r\n      // Virtual scrolling mode: use data-virtual-index to match against full dataset\r\n      const fullData = this.getFullData();\r\n      allRows.forEach((row) => {\r\n        const virtualIndex = parseInt(row.getAttribute('data-virtual-index'));\r\n        if (!isNaN(virtualIndex) && virtualIndex < fullData.length) {\r\n          const rowData = fullData[virtualIndex];\r\n          const rowId = this.getRowId(rowData);\r\n          \r\n          if (this.selectedRows.has(rowId)) {\r\n            row.classList.add('tablix-selected');\r\n            \r\n            // Mark the last selected row for special styling\r\n            if (rowId === this.lastSelectedRow) {\r\n              row.classList.add('tablix-last-selected');\r\n            }\r\n          }\r\n        }\r\n      });\r\n    } else {\r\n      // Regular mode: match by global row index with full dataset\r\n      const fullData = this.getFullData();\r\n      allRows.forEach((row) => {\r\n        // Get global row index from data attribute\r\n        const globalRowIndex = row.hasAttribute('data-row-index') ? \r\n          parseInt(row.getAttribute('data-row-index')) : -1;\r\n          \r\n        if (globalRowIndex >= 0 && globalRowIndex < fullData.length) {\r\n          const rowData = fullData[globalRowIndex];\r\n          const rowId = this.getRowId(rowData);\r\n          \r\n          if (this.selectedRows.has(rowId)) {\r\n            row.classList.add('tablix-selected');\r\n            \r\n            // Mark the last selected row for special styling\r\n            if (rowId === this.lastSelectedRow) {\r\n              row.classList.add('tablix-last-selected');\r\n            }\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update selection state after data changes (pagination, filtering, sorting)\r\n   */\r\n  updateSelectionAfterDataChange() {\r\n    if (!this.options.enabled) {\r\n      return;\r\n    }\r\n\r\n    if (this.table.virtualScrollManager) {\r\n      // For virtual scrolling: keep all selections as the data is the same, just rendered differently\r\n      // Only need to update UI\r\n      this.updateUI();\r\n    } else {\r\n      // For pagination: keep all selections, but validate they still exist in the full dataset\r\n      const fullData = this.getFullData();\r\n      const allDataRowIds = new Set(fullData.map(row => this.getRowId(row)));\r\n      \r\n      // Remove selections for rows that no longer exist in the dataset at all\r\n      const newSelection = new Set();\r\n      this.selectedRows.forEach(rowId => {\r\n        if (allDataRowIds.has(rowId)) {\r\n          newSelection.add(rowId);\r\n        }\r\n      });\r\n      \r\n      this.selectedRows = newSelection;\r\n      \r\n      // Update last selected row if it no longer exists in the dataset\r\n      if (this.lastSelectedRow && !allDataRowIds.has(this.lastSelectedRow)) {\r\n        this.lastSelectedRow = this.selectedRows.size > 0 ? Array.from(this.selectedRows)[0] : null;\r\n      }\r\n      \r\n      this.updateUI();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get selected row data\r\n   * @returns {Array} Array of selected row data objects\r\n   */\r\n  getSelectedData() {\r\n    if (!this.options.enabled || this.selectedRows.size === 0) {\r\n      return [];\r\n    }\r\n\r\n    // Get all data (including filtered/sorted) to find selected rows\r\n    const allData = this.getFullData();\r\n    return allData.filter(row => this.selectedRows.has(this.getRowId(row)));\r\n  }\r\n\r\n  /**\r\n   * Get selected row IDs\r\n   * @returns {Array} Array of selected row IDs\r\n   */\r\n  getSelectedIds() {\r\n    return Array.from(this.selectedRows);\r\n  }\r\n\r\n  /**\r\n   * Programmatically select rows by ID\r\n   * @param {String|Array} rowIds - Single row ID or array of row IDs\r\n   */\r\n  selectRows(rowIds) {\r\n    if (!this.options.enabled) {\r\n      return;\r\n    }\r\n\r\n    const ids = Array.isArray(rowIds) ? rowIds : [rowIds];\r\n    \r\n    if (this.options.mode === 'single' && ids.length > 1) {\r\n      console.warn('SelectionManager: Cannot select multiple rows in single mode');\r\n      return;\r\n    }\r\n\r\n    if (this.options.mode === 'single') {\r\n      this.selectedRows.clear();\r\n    }\r\n\r\n    ids.forEach(id => {\r\n      this.selectedRows.add(String(id));\r\n    });\r\n\r\n    if (ids.length > 0) {\r\n      this.lastSelectedRow = String(ids[ids.length - 1]);\r\n    }\r\n\r\n    this.updateUI();\r\n    \r\n    // Fire afterSelect event\r\n    this.table.eventManager.trigger('afterSelect', {\r\n      selectedRows: Array.from(this.selectedRows),\r\n      selectedData: this.getSelectedData()\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Programmatically deselect rows by ID\r\n   * @param {String|Array} rowIds - Single row ID or array of row IDs\r\n   */\r\n  deselectRows(rowIds) {\r\n    if (!this.options.enabled) {\r\n      return;\r\n    }\r\n\r\n    const ids = Array.isArray(rowIds) ? rowIds : [rowIds];\r\n    \r\n    ids.forEach(id => {\r\n      this.selectedRows.delete(String(id));\r\n    });\r\n\r\n    // Update last selected row if it was deselected\r\n    if (ids.includes(this.lastSelectedRow)) {\r\n      this.lastSelectedRow = this.selectedRows.size > 0 ? Array.from(this.selectedRows)[0] : null;\r\n    }\r\n\r\n    this.updateUI();\r\n    \r\n    // Fire afterSelect event\r\n    this.table.eventManager.trigger('afterSelect', {\r\n      selectedRows: Array.from(this.selectedRows),\r\n      selectedData: this.getSelectedData()\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Clear all selections\r\n   */\r\n  clearSelection() {\r\n    if (!this.options.enabled) {\r\n      return;\r\n    }\r\n\r\n    const hadSelection = this.selectedRows.size > 0;\r\n    this.selectedRows.clear();\r\n    this.lastSelectedRow = null;\r\n    \r\n    this.updateUI();\r\n\r\n    if (hadSelection) {\r\n      // Fire afterSelect event\r\n      this.table.eventManager.trigger('afterSelect', {\r\n        selectedRows: [],\r\n        selectedData: []\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if a row is selected\r\n   * @param {String} rowId - Row ID to check\r\n   * @returns {Boolean} True if row is selected\r\n   */\r\n  isRowSelected(rowId) {\r\n    return this.selectedRows.has(String(rowId));\r\n  }\r\n\r\n  /**\r\n   * Check if a row is selected by its data object (for virtual scrolling)\r\n   * @param {Object} rowData - Row data object to check\r\n   * @returns {Boolean} True if row is selected\r\n   */\r\n  isRowSelectedByData(rowData) {\r\n    const rowId = this.getRowId(rowData);\r\n    return this.selectedRows.has(String(rowId));\r\n  }\r\n\r\n  /**\r\n   * Get selection count\r\n   * @returns {Number} Number of selected rows\r\n   */\r\n  getSelectionCount() {\r\n    return this.selectedRows.size;\r\n  }\r\n\r\n  /**\r\n   * Enable selection\r\n   */\r\n  enable() {\r\n    this.options.enabled = true;\r\n    if (!this.eventListenersSetup) {\r\n      this.setupEventListeners();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Disable selection\r\n   */\r\n  disable() {\r\n    this.options.enabled = false;\r\n    this.clearSelection();\r\n  }\r\n\r\n  /**\r\n   * Set selection mode\r\n   * @param {String} mode - 'single' or 'multi'\r\n   */\r\n  setMode(mode) {\r\n    if (mode !== 'single' && mode !== 'multi') {\r\n      console.warn('SelectionManager: Invalid mode. Use \"single\" or \"multi\"');\r\n      return;\r\n    }\r\n\r\n    const oldMode = this.options.mode;\r\n    this.options.mode = mode;\r\n    \r\n    // If switching to single mode and multiple rows are selected, keep only the last selected\r\n    if (mode === 'single' && this.selectedRows.size > 1) {\r\n      const lastSelected = this.lastSelectedRow;\r\n      this.selectedRows.clear();\r\n      if (lastSelected) {\r\n        this.selectedRows.add(lastSelected);\r\n      }\r\n      this.updateUI();\r\n    }\r\n\r\n    // Setup or remove drag selection based on mode change\r\n    if (oldMode !== mode && this.options.enabled) {\r\n      if (mode === 'multi') {\r\n        this.setupDragSelection();\r\n      }\r\n      // Note: We don't need to explicitly remove drag listeners as they check mode internally\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Destroy the selection manager\r\n   */\r\n  destroy() {\r\n    this.clearSelection();\r\n    // Remove event listeners would go here if we tracked them\r\n  }\r\n}\r\n","/**\r\n * VirtualScrollManager - High-performance virtual scrolling for large datasets\r\n * \r\n * Features:\r\n * - Dynamic row height detection\r\n * - Configurable buffer zones\r\n * - Smooth scrolling with no visual gaps\r\n * - Selection state preservation\r\n * - Performance optimizations for 100k+ rows\r\n */\r\nexport default class VirtualScrollManager {\r\n  constructor(table, options = {}) {\r\n    this.table = table;\r\n    this.options = {\r\n      enabled: false,\r\n      buffer: 10, // Number of rows to render above/below viewport\r\n      rowHeight: null, // Auto-detected if null\r\n      throttleDelay: 8, // Reduced from 16ms for better responsiveness (~120fps)\r\n      ...options\r\n    };\r\n\r\n    // State tracking\r\n    this.scrollContainer = null;\r\n    this.tableBody = null;\r\n    this.topSpacer = null;\r\n    this.bottomSpacer = null;\r\n    \r\n    // Measurements\r\n    this.rowHeight = this.options.rowHeight || 35; // Default fallback\r\n    this.containerHeight = 0;\r\n    this.totalRows = 0;\r\n    this.visibleStart = 0;\r\n    this.visibleEnd = 0;\r\n    this.renderedStart = 0;\r\n    this.renderedEnd = 0;\r\n    \r\n    // Performance tracking\r\n    this.performanceData = {\r\n      renderTimes: [],\r\n      scrollUpdates: 0,\r\n      lastMeasurement: 0\r\n    };\r\n\r\n    // Throttled scroll handler\r\n    this.throttledScrollHandler = this.throttle(this.handleScroll.bind(this), this.options.throttleDelay);\r\n    this.immediateScrollHandler = this.handleScroll.bind(this);\r\n    \r\n    // RAF-based update handler for smooth rendering\r\n    this.updateScheduled = false;\r\n    this.pendingUpdate = false;\r\n    this.lastScrollTime = 0;\r\n    this.scrollVelocity = 0;\r\n\r\n    // Data reference\r\n    this.data = [];\r\n    this.renderedData = [];\r\n  }\r\n\r\n  /**\r\n   * Initialize virtual scrolling\r\n   */\r\n  init(data = []) {\r\n    if (!this.options.enabled) {\r\n      return;\r\n    }\r\n\r\n    this.data = data;\r\n    this.totalRows = data.length;\r\n    \r\n    this.setupScrollContainer();\r\n    this.detectRowHeight();\r\n    this.calculateViewport();\r\n    this.scheduleUpdate();\r\n    \r\n    // Bind scroll events with both throttled and immediate handling\r\n    this.scrollContainer.addEventListener('scroll', this.handleScrollImmediate.bind(this), { passive: true });\r\n    this.scrollContainer.addEventListener('scroll', this.throttledScrollHandler, { passive: true });\r\n    \r\n    // Handle scrollbar dragging specifically\r\n    this.scrollContainer.addEventListener('mousedown', this.handleScrollStart.bind(this));\r\n    document.addEventListener('mouseup', this.handleScrollEnd.bind(this));\r\n    \r\n    // Handle window resize\r\n    window.addEventListener('resize', this.throttle(this.handleResize.bind(this), 100));\r\n    \r\n    // Set up event delegation for row interactions\r\n    this.setupEventDelegation();\r\n    \r\n    // Listen for selection changes\r\n    this.setupSelectionListeners();\r\n    \r\n    this.log('Virtual scroll initialized', {\r\n      totalRows: this.totalRows,\r\n      rowHeight: this.rowHeight,\r\n      buffer: this.options.buffer\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Set up event delegation for dynamically rendered rows\r\n   */\r\n  setupEventDelegation() {\r\n    if (!this.scrollContainer || !this.table.eventManager) return;\r\n\r\n    // Delegate row click events\r\n    this.rowClickHandler = (event) => {\r\n      const row = event.target.closest('.tablix-row');\r\n      if (!row) return;\r\n\r\n      // Skip click handling if we just finished a drag\r\n      if (this.justFinishedDrag) {\r\n        console.log('Skipping click - just finished drag');\r\n        return;\r\n      }\r\n\r\n      const virtualIndex = parseInt(row.getAttribute('data-virtual-index'));\r\n      const rowData = this.data[virtualIndex];\r\n      \r\n      if (rowData) {\r\n        console.log('VirtualScroll rowClickHandler triggered:', { \r\n          virtualIndex, \r\n          rowId: rowData.id,\r\n          ctrlKey: event.ctrlKey,\r\n          shiftKey: event.shiftKey,\r\n          metaKey: event.metaKey,\r\n          eventType: event.type,\r\n          timestamp: Date.now()\r\n        });\r\n        \r\n        // Trigger row click event for selection manager\r\n        this.table.eventManager.trigger('rowClick', {\r\n          rowData,\r\n          rowIndex: virtualIndex, // Use virtual index as row index\r\n          originalEvent: event,\r\n          element: row\r\n        });\r\n        \r\n        // Immediately update selection states after click\r\n        setTimeout(() => this.updateSelectionStates(), 0);\r\n      }\r\n    };\r\n\r\n    this.scrollContainer.addEventListener('click', this.rowClickHandler);\r\n\r\n    // Set up drag selection for virtual scrolling (if selection is enabled and in multi mode)\r\n    if (this.table.selectionManager && \r\n        this.table.selectionManager.options.enabled && \r\n        this.table.selectionManager.options.mode === 'multi') {\r\n      this.setupVirtualDragSelection();\r\n    }\r\n\r\n    // Delegate row hover events\r\n    this.rowHoverHandler = (event) => {\r\n      const row = event.target.closest('.tablix-row');\r\n      if (!row) return;\r\n\r\n      const virtualIndex = parseInt(row.getAttribute('data-virtual-index'));\r\n      const rowData = this.data[virtualIndex];\r\n      \r\n      if (rowData) {\r\n        this.table.eventManager.trigger('rowHover', {\r\n          rowData,\r\n          rowIndex: virtualIndex,\r\n          originalEvent: event,\r\n          element: row\r\n        });\r\n      }\r\n    };\r\n\r\n    this.scrollContainer.addEventListener('mouseover', this.rowHoverHandler);\r\n  }\r\n\r\n  /**\r\n   * Set up listeners for selection changes\r\n   */\r\n  setupSelectionListeners() {\r\n    if (!this.table.eventManager) return;\r\n\r\n    // Listen for selection changes to update row visual states\r\n    this.table.eventManager.on('afterSelect', () => {\r\n      this.updateSelectionStates();\r\n    });\r\n\r\n    this.table.eventManager.on('selectionCleared', () => {\r\n      this.updateSelectionStates();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Setup the scroll container structure\r\n   */\r\n  setupScrollContainer() {\r\n    const tableWrapper = this.table.container.querySelector('.tablix-wrapper');\r\n    if (!tableWrapper) {\r\n      throw new Error('Table wrapper not found for virtual scrolling');\r\n    }\r\n\r\n    // Find existing scroll container\r\n    let scrollContainer = tableWrapper.querySelector('.tablix-scroll-container');\r\n    if (!scrollContainer) {\r\n      // Create scroll container - it should already exist from renderer\r\n      scrollContainer = tableWrapper.querySelector('.tablix-scroll-container');\r\n      if (!scrollContainer) {\r\n        console.warn('Scroll container not found - virtual scrolling may not work properly');\r\n        return;\r\n      }\r\n    }\r\n\r\n    this.scrollContainer = scrollContainer;\r\n    this.tableBody = scrollContainer.querySelector('.tablix-tbody');\r\n    \r\n    // Create spacer elements for maintaining scroll height\r\n    this.createSpacers();\r\n  }\r\n\r\n  /**\r\n   * Create top and bottom spacer elements\r\n   */\r\n  createSpacers() {\r\n    if (!this.tableBody) return;\r\n\r\n    // Remove existing spacers\r\n    const existingTop = this.tableBody.querySelector('.tablix-top-spacer');\r\n    const existingBottom = this.tableBody.querySelector('.tablix-bottom-spacer');\r\n    if (existingTop) existingTop.remove();\r\n    if (existingBottom) existingBottom.remove();\r\n\r\n    // Create new spacers\r\n    this.topSpacer = document.createElement('tr');\r\n    this.topSpacer.className = 'tablix-top-spacer';\r\n    this.topSpacer.style.cssText = 'height: 0px; border: none;';\r\n    this.topSpacer.innerHTML = `<td colspan=\"100\" style=\"padding: 0; border: none; height: 0;\"></td>`;\r\n\r\n    this.bottomSpacer = document.createElement('tr');\r\n    this.bottomSpacer.className = 'tablix-bottom-spacer';\r\n    this.bottomSpacer.style.cssText = 'height: 0px; border: none;';\r\n    this.bottomSpacer.innerHTML = `<td colspan=\"100\" style=\"padding: 0; border: none; height: 0;\"></td>`;\r\n\r\n    this.tableBody.insertBefore(this.topSpacer, this.tableBody.firstChild);\r\n    this.tableBody.appendChild(this.bottomSpacer);\r\n  }\r\n\r\n  /**\r\n   * Detect row height dynamically by measuring a sample row\r\n   */\r\n  detectRowHeight() {\r\n    if (this.options.rowHeight) {\r\n      this.rowHeight = this.options.rowHeight;\r\n      return;\r\n    }\r\n\r\n    if (!this.tableBody || this.data.length === 0) {\r\n      return;\r\n    }\r\n\r\n    // Render a single sample row to measure height\r\n    const sampleRow = this.renderSingleRow(this.data[0], 0);\r\n    this.tableBody.appendChild(sampleRow);\r\n    \r\n    // Measure the row height\r\n    const rect = sampleRow.getBoundingClientRect();\r\n    this.rowHeight = Math.max(rect.height, 25); // Minimum height of 25px\r\n    \r\n    // Remove sample row\r\n    sampleRow.remove();\r\n    \r\n    this.log('Row height detected', { rowHeight: this.rowHeight });\r\n  }\r\n\r\n  /**\r\n   * Calculate viewport dimensions and visible range\r\n   */\r\n  calculateViewport() {\r\n    if (!this.scrollContainer) return;\r\n\r\n    const rect = this.scrollContainer.getBoundingClientRect();\r\n    this.containerHeight = rect.height;\r\n    \r\n    const scrollTop = this.scrollContainer.scrollTop;\r\n    const visibleRowCount = Math.ceil(this.containerHeight / this.rowHeight);\r\n    \r\n    // Calculate visible range\r\n    this.visibleStart = Math.floor(scrollTop / this.rowHeight);\r\n    this.visibleEnd = Math.min(this.visibleStart + visibleRowCount, this.totalRows);\r\n    \r\n    // Calculate rendered range with buffer\r\n    this.renderedStart = Math.max(0, this.visibleStart - this.options.buffer);\r\n    this.renderedEnd = Math.min(this.totalRows, this.visibleEnd + this.options.buffer);\r\n    \r\n    // Update spacer heights\r\n    this.updateSpacers();\r\n  }\r\n\r\n  /**\r\n   * Update spacer heights to maintain scroll position\r\n   */\r\n  updateSpacers() {\r\n    if (!this.topSpacer || !this.bottomSpacer) return;\r\n\r\n    const topHeight = this.renderedStart * this.rowHeight;\r\n    const bottomHeight = (this.totalRows - this.renderedEnd) * this.rowHeight;\r\n    \r\n    this.topSpacer.style.height = `${topHeight}px`;\r\n    this.bottomSpacer.style.height = `${bottomHeight}px`;\r\n  }\r\n\r\n  /**\r\n   * Handle immediate scroll events (for fast scrolling detection)\r\n   */\r\n  handleScrollImmediate() {\r\n    const now = performance.now();\r\n    const scrollTop = this.scrollContainer.scrollTop;\r\n    \r\n    // Calculate scroll velocity\r\n    if (this.lastScrollTime && this.lastScrollTop !== undefined) {\r\n      const timeDelta = now - this.lastScrollTime;\r\n      const scrollDelta = Math.abs(scrollTop - this.lastScrollTop);\r\n      this.scrollVelocity = timeDelta > 0 ? scrollDelta / timeDelta : 0;\r\n    }\r\n    \r\n    this.lastScrollTime = now;\r\n    this.lastScrollTop = scrollTop;\r\n    \r\n    // For very fast scrolling, schedule immediate update\r\n    if (this.scrollVelocity > 2) { // High velocity threshold\r\n      this.scheduleUpdate();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle scroll start (mousedown on scrollbar)\r\n   */\r\n  handleScrollStart(event) {\r\n    // Only trigger scrollbar dragging for actual scrollbar clicks\r\n    // Check if the click was on the scrollbar area, not on table content\r\n    const target = event.target;\r\n    if (target.closest('.tablix-row') || target.closest('.tablix-table')) {\r\n      // This is a click on table content, not scrollbar - ignore\r\n      return;\r\n    }\r\n    \r\n    this.isScrollbarDragging = true;\r\n    \r\n    // Schedule more frequent updates during scrollbar dragging\r\n    this.scrollDragInterval = setInterval(() => {\r\n      if (this.isScrollbarDragging) {\r\n        this.scheduleUpdate();\r\n      }\r\n    }, 8); // ~120fps during dragging\r\n  }\r\n\r\n  /**\r\n   * Handle scroll end (mouseup)\r\n   */\r\n  handleScrollEnd() {\r\n    this.isScrollbarDragging = false;\r\n    if (this.scrollDragInterval) {\r\n      clearInterval(this.scrollDragInterval);\r\n      this.scrollDragInterval = null;\r\n    }\r\n    // Final update to ensure everything is rendered\r\n    this.scheduleUpdate();\r\n  }\r\n\r\n  /**\r\n   * Setup drag selection for virtual scrolling\r\n   */\r\n  setupVirtualDragSelection() {\r\n    let isDragSelecting = false;\r\n    let dragStartIndex = null;\r\n    let dragStartX = null;\r\n    let dragStartY = null;\r\n    let originalSelection = null;\r\n    const dragThreshold = 3;\r\n\r\n    // Flag to prevent click handling immediately after drag\r\n    this.justFinishedDrag = false;\r\n\r\n    // Mouse down to potentially start drag selection\r\n    this.scrollContainer.addEventListener('mousedown', (event) => {\r\n      // Skip if clicked on scrollbar area or using modifier keys\r\n      if (event.ctrlKey || event.metaKey || event.shiftKey) return;\r\n      \r\n      const row = event.target.closest('.tablix-row');\r\n      if (!row || row.classList.contains('tablix-empty-row')) return;\r\n\r\n      const virtualIndex = parseInt(row.getAttribute('data-virtual-index'));\r\n      if (isNaN(virtualIndex)) return;\r\n\r\n      dragStartIndex = virtualIndex;\r\n      dragStartX = event.clientX;\r\n      dragStartY = event.clientY;\r\n      isDragSelecting = false;\r\n      \r\n      // Store original selection\r\n      originalSelection = new Set(this.table.selectionManager.selectedRows);\r\n\r\n      // Don't prevent default here - let the click event fire normally\r\n      // event.preventDefault();\r\n    });\r\n\r\n    // Mouse move to handle drag selection\r\n    this.scrollContainer.addEventListener('mousemove', (event) => {\r\n      if (dragStartIndex === null) return;\r\n\r\n      const deltaX = Math.abs(event.clientX - dragStartX);\r\n      const deltaY = Math.abs(event.clientY - dragStartY);\r\n\r\n      // Start dragging if moved enough\r\n      if (!isDragSelecting && (deltaX > dragThreshold || deltaY > dragThreshold)) {\r\n        isDragSelecting = true;\r\n        this.scrollContainer.classList.add('tablix-drag-selecting');\r\n      }\r\n\r\n      if (isDragSelecting) {\r\n        const row = event.target.closest('.tablix-row');\r\n        if (row) {\r\n          const currentIndex = parseInt(row.getAttribute('data-virtual-index'));\r\n          if (!isNaN(currentIndex)) {\r\n            this.applyVirtualDragSelection(dragStartIndex, currentIndex, originalSelection);\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    // Mouse up to complete or cancel drag selection\r\n    const handleMouseUp = (event) => {\r\n      if (dragStartIndex !== null) {\r\n        this.scrollContainer.classList.remove('tablix-drag-selecting');\r\n        \r\n        if (!isDragSelecting) {\r\n          // This was just a click, not a drag - don't interfere with click handling\r\n          // Reset drag state and let the normal click handler process this\r\n          dragStartIndex = null;\r\n          isDragSelecting = false;\r\n          originalSelection = null;\r\n          return;\r\n        }\r\n\r\n        // This was actually a drag selection - complete it\r\n        this.table.eventManager.trigger('afterSelect', {\r\n          selectedRows: Array.from(this.table.selectionManager.selectedRows),\r\n          selectedData: this.table.selectionManager.getSelectedData(),\r\n          isDragSelection: true,\r\n          dragComplete: true\r\n        });\r\n\r\n        // Set flag to prevent immediate click handling\r\n        this.justFinishedDrag = true;\r\n        setTimeout(() => {\r\n          this.justFinishedDrag = false;\r\n        }, 50);\r\n\r\n        // Reset drag state\r\n        dragStartIndex = null;\r\n        isDragSelecting = false;\r\n        originalSelection = null;\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mouseup', handleMouseUp);\r\n    this.scrollContainer.addEventListener('mouseleave', handleMouseUp);\r\n\r\n    // Prevent text selection during drag\r\n    this.scrollContainer.addEventListener('selectstart', (event) => {\r\n      if (isDragSelecting) {\r\n        event.preventDefault();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Apply drag selection in virtual scrolling\r\n   */\r\n  applyVirtualDragSelection(startIndex, endIndex, originalSelection) {\r\n    const minIndex = Math.min(startIndex, endIndex);\r\n    const maxIndex = Math.max(startIndex, endIndex);\r\n\r\n    // Start with original selection\r\n    this.table.selectionManager.selectedRows = new Set(originalSelection);\r\n\r\n    // Add drag range to selection\r\n    for (let i = minIndex; i <= maxIndex; i++) {\r\n      if (i < this.data.length) {\r\n        const rowData = this.data[i];\r\n        const rowId = this.table.selectionManager.getRowId(rowData);\r\n        this.table.selectionManager.selectedRows.add(rowId);\r\n      }\r\n    }\r\n\r\n    // Update last selected row\r\n    if (endIndex < this.data.length) {\r\n      const endRowData = this.data[endIndex];\r\n      this.table.selectionManager.lastSelectedRow = this.table.selectionManager.getRowId(endRowData);\r\n    }\r\n\r\n    // Update UI immediately\r\n    this.table.selectionManager.updateUI();\r\n  }\r\n\r\n  /**\r\n   * Handle scroll events\r\n   */\r\n  handleScroll() {\r\n    if (!this.options.enabled || this.updateScheduled) return;\r\n\r\n    this.scheduleUpdate();\r\n  }\r\n\r\n  /**\r\n   * Handle window resize\r\n   */\r\n  handleResize() {\r\n    if (!this.options.enabled) return;\r\n\r\n    this.calculateViewport();\r\n    this.scheduleUpdate();\r\n  }\r\n\r\n  /**\r\n   * Schedule an update using requestAnimationFrame\r\n   */\r\n  scheduleUpdate() {\r\n    if (this.updateScheduled) return;\r\n\r\n    this.updateScheduled = true;\r\n    requestAnimationFrame(() => {\r\n      this.update();\r\n      this.updateScheduled = false;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Main update method - calculates viewport and renders visible rows\r\n   */\r\n  update() {\r\n    const startTime = performance.now();\r\n    \r\n    this.calculateViewport();\r\n    this.renderVisibleRows();\r\n    \r\n    const endTime = performance.now();\r\n    this.trackPerformance(endTime - startTime);\r\n    \r\n    this.performanceData.scrollUpdates++;\r\n  }\r\n\r\n  /**\r\n   * Render only the visible rows plus buffer\r\n   */\r\n  renderVisibleRows() {\r\n    if (!this.tableBody) return;\r\n\r\n    // Clear existing rows (except spacers)\r\n    const existingRows = this.tableBody.querySelectorAll('.tablix-row');\r\n    existingRows.forEach(row => row.remove());\r\n\r\n    // Render new rows\r\n    const fragment = document.createDocumentFragment();\r\n    \r\n    for (let i = this.renderedStart; i < this.renderedEnd; i++) {\r\n      if (i < this.data.length) {\r\n        const row = this.renderSingleRow(this.data[i], i);\r\n        fragment.appendChild(row);\r\n      }\r\n    }\r\n\r\n    // Insert rows between spacers\r\n    this.tableBody.insertBefore(fragment, this.bottomSpacer);\r\n\r\n    // Store currently rendered data slice for other managers\r\n    this.renderedData = this.data.slice(this.renderedStart, this.renderedEnd);\r\n    \r\n    // Handle image loading for the newly rendered rows\r\n    this.handleImageLoading();\r\n    \r\n    // Update selection states for the newly rendered rows\r\n    this.updateSelectionStates();\r\n  }\r\n\r\n  /**\r\n   * Update selection states for currently rendered rows\r\n   */\r\n  updateSelectionStates() {\r\n    if (!this.table.selectionManager || !this.tableBody) return;\r\n\r\n    const rows = this.tableBody.querySelectorAll('.tablix-row');\r\n    rows.forEach(row => {\r\n      const virtualIndex = parseInt(row.getAttribute('data-virtual-index'));\r\n      const rowData = this.data[virtualIndex];\r\n      \r\n      if (rowData && this.table.selectionManager.isRowSelectedByData(rowData)) {\r\n        row.classList.add('tablix-selected');\r\n      } else {\r\n        row.classList.remove('tablix-selected');\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Handle image loading optimization\r\n   */\r\n  handleImageLoading() {\r\n    if (!this.tableBody) return;\r\n\r\n    // Find all images in the rendered rows\r\n    const images = this.tableBody.querySelectorAll('.tablix-row img');\r\n    \r\n    images.forEach((img, index) => {\r\n      // Skip if image is already loaded or loading\r\n      if (img.complete || img.classList.contains('loading')) return;\r\n      \r\n      img.classList.add('loading');\r\n      \r\n      // Create a placeholder while loading\r\n      const placeholder = img.cloneNode();\r\n      placeholder.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSIjZjBmMGYwIi8+CjxwYXRoIGQ9Ik0xNiA4TDIwIDEySDEyTDE2IDhaIiBmaWxsPSIjY2NjY2NjIi8+CjxwYXRoIGQ9Ik04IDIwSDI0VjE2SDhWMjBaIiBmaWxsPSIjY2NjY2NjIi8+Cjwvc3ZnPgo=';\r\n      placeholder.classList.add('image-placeholder');\r\n      \r\n      // Handle successful load\r\n      const handleLoad = () => {\r\n        img.classList.remove('loading');\r\n        img.style.opacity = '1';\r\n        img.removeEventListener('load', handleLoad);\r\n        img.removeEventListener('error', handleError);\r\n      };\r\n      \r\n      // Handle load error\r\n      const handleError = () => {\r\n        img.classList.remove('loading');\r\n        img.src = placeholder.src; // Use placeholder as fallback\r\n        img.removeEventListener('load', handleLoad);\r\n        img.removeEventListener('error', handleError);\r\n      };\r\n      \r\n      img.addEventListener('load', handleLoad);\r\n      img.addEventListener('error', handleError);\r\n      \r\n      // Set initial opacity for fade-in effect\r\n      img.style.opacity = '0.5';\r\n      img.style.transition = 'opacity 0.2s ease';\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Render a single row element\r\n   */\r\n  renderSingleRow(rowData, originalIndex) {\r\n    const columns = this.table.columnManager ? \r\n      this.table.columnManager.getColumns() : \r\n      (this.table.options.columns || []);\r\n\r\n    const tr = document.createElement('tr');\r\n    tr.className = 'tablix-row';\r\n    tr.setAttribute('data-row-index', originalIndex); // Keep for compatibility\r\n    tr.setAttribute('data-virtual-index', originalIndex); // Virtual scroll index\r\n    \r\n    // Add a unique identifier for debugging\r\n    tr.setAttribute('data-row-id', this.table.selectionManager ? \r\n      this.table.selectionManager.getRowId(rowData) : originalIndex);\r\n\r\n    // Apply initial selection state\r\n    const isSelected = this.table.selectionManager && \r\n      this.table.selectionManager.isRowSelectedByData(rowData);\r\n    \r\n    if (isSelected) {\r\n      tr.classList.add('tablix-selected');\r\n      console.log('Row initially selected:', originalIndex, rowData.id);\r\n    }\r\n\r\n    // Render cells\r\n    columns.forEach(col => {\r\n      const td = document.createElement('td');\r\n      td.className = 'tablix-td';\r\n      \r\n      const cellValue = rowData[col.name];\r\n\r\n      // Use ColumnManager for formatting if available\r\n      if (this.table.columnManager) {\r\n        const result = this.table.columnManager.formatCellValue(col.name, cellValue, rowData);\r\n        if (result.isHtml) {\r\n          td.innerHTML = result.value;\r\n        } else {\r\n          td.textContent = result.value;\r\n        }\r\n      } else {\r\n        // Fallback to original renderer logic\r\n        if (col.renderer && typeof col.renderer === 'function') {\r\n          const rendered = col.renderer(cellValue, rowData);\r\n          if (typeof rendered === 'string' && rendered.includes('<')) {\r\n            td.innerHTML = rendered;\r\n          } else {\r\n            td.textContent = rendered;\r\n          }\r\n        } else {\r\n          td.textContent = cellValue != null ? String(cellValue) : '';\r\n        }\r\n      }\r\n\r\n      tr.appendChild(td);\r\n    });\r\n\r\n    return tr;\r\n  }\r\n\r\n  /**\r\n   * Update data and refresh virtual scrolling\r\n   */\r\n  updateData(newData) {\r\n    this.data = newData;\r\n    this.totalRows = newData.length;\r\n    \r\n    if (this.options.enabled) {\r\n      this.calculateViewport();\r\n      this.scheduleUpdate();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Scroll to a specific row index\r\n   */\r\n  scrollToRow(index) {\r\n    if (!this.scrollContainer || !this.options.enabled) return;\r\n\r\n    const targetScrollTop = index * this.rowHeight;\r\n    this.scrollContainer.scrollTop = targetScrollTop;\r\n    \r\n    // Force immediate update\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * Get the currently visible row indices\r\n   */\r\n  getVisibleRange() {\r\n    return {\r\n      start: this.visibleStart,\r\n      end: this.visibleEnd,\r\n      renderedStart: this.renderedStart,\r\n      renderedEnd: this.renderedEnd\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get the currently rendered data slice\r\n   */\r\n  getRenderedData() {\r\n    return this.renderedData;\r\n  }\r\n\r\n  /**\r\n   * Check if virtual scrolling is active\r\n   */\r\n  isEnabled() {\r\n    return this.options.enabled;\r\n  }\r\n\r\n  /**\r\n   * Enable/disable virtual scrolling\r\n   */\r\n  setEnabled(enabled) {\r\n    this.options.enabled = enabled;\r\n    \r\n    if (enabled && this.data.length > 0) {\r\n      this.init(this.data);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Track performance metrics\r\n   */\r\n  trackPerformance(renderTime) {\r\n    this.performanceData.renderTimes.push(renderTime);\r\n    this.performanceData.lastMeasurement = renderTime;\r\n\r\n    // Keep only last 100 measurements\r\n    if (this.performanceData.renderTimes.length > 100) {\r\n      this.performanceData.renderTimes.shift();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get performance statistics\r\n   */\r\n  getPerformanceStats() {\r\n    const times = this.performanceData.renderTimes;\r\n    if (times.length === 0) return null;\r\n\r\n    const avg = times.reduce((a, b) => a + b, 0) / times.length;\r\n    const max = Math.max(...times);\r\n    const min = Math.min(...times);\r\n\r\n    return {\r\n      averageRenderTime: avg.toFixed(2),\r\n      maxRenderTime: max.toFixed(2),\r\n      minRenderTime: min.toFixed(2),\r\n      scrollUpdates: this.performanceData.scrollUpdates,\r\n      totalRows: this.totalRows,\r\n      visibleRows: this.visibleEnd - this.visibleStart,\r\n      renderedRows: this.renderedEnd - this.renderedStart\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Utility: Throttle function\r\n   */\r\n  throttle(func, limit) {\r\n    let inThrottle;\r\n    return function() {\r\n      const args = arguments;\r\n      const context = this;\r\n      if (!inThrottle) {\r\n        func.apply(context, args);\r\n        inThrottle = true;\r\n        setTimeout(() => inThrottle = false, limit);\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Utility: Logging for performance tracking\r\n   */\r\n  log(message, data = {}) {\r\n    if (this.table.options.debug) {\r\n      console.log(`[VirtualScroll] ${message}`, data);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clean up event listeners and resources\r\n   */\r\n  destroy() {\r\n    if (this.scrollContainer) {\r\n      this.scrollContainer.removeEventListener('scroll', this.throttledScrollHandler);\r\n      this.scrollContainer.removeEventListener('scroll', this.handleScrollImmediate);\r\n      this.scrollContainer.removeEventListener('mousedown', this.handleScrollStart);\r\n    }\r\n    document.removeEventListener('mouseup', this.handleScrollEnd);\r\n    window.removeEventListener('resize', this.handleResize);\r\n    \r\n    // Clean up scroll drag interval\r\n    if (this.scrollDragInterval) {\r\n      clearInterval(this.scrollDragInterval);\r\n      this.scrollDragInterval = null;\r\n    }\r\n    \r\n    this.scrollContainer = null;\r\n    this.tableBody = null;\r\n    this.topSpacer = null;\r\n    this.bottomSpacer = null;\r\n  }\r\n}\r\n","import DataManager from './DataManager.js';\r\nimport Renderer from './Renderer.js';\r\nimport EventManager from './EventManager.js';\r\nimport PaginationManager from './PaginationManager.js';\r\nimport SortingManager from './SortingManager.js';\r\nimport ColumnManager from './ColumnManager.js';\r\nimport FilterManager from './FilterManager.js';\r\nimport FilterUI from './FilterUI.js';\r\nimport SearchManager from './SearchManager.js';\r\nimport SelectionManager from './SelectionManager.js';\r\nimport VirtualScrollManager from './VirtualScroll.js';\r\n\r\nexport default class Table {\r\n  constructor(container, options = {}) {\r\n    this.container = typeof container === 'string' ? document.querySelector(container) : container;\r\n    this.options = {\r\n      // Default options\r\n      pagination: {\r\n        enabled: true,\r\n        pageSize: 10,\r\n        mode: 'client', // 'client' or 'server'\r\n        showPageNumbers: true,\r\n        maxPageNumbers: 5,\r\n        showFirstLast: true,\r\n        showPrevNext: true,\r\n        showPageSizes: false,\r\n        pageSizeOptions: [10, 25, 50, 100],\r\n        serverDataLoader: null\r\n      },\r\n      // Sorting options\r\n      sorting: {\r\n        enabled: true,\r\n        mode: 'client', // 'client' or 'server'\r\n        serverSortLoader: null,\r\n        defaultSortType: 'auto',\r\n        caseSensitive: false,\r\n        nullsFirst: false\r\n      },\r\n      // Filtering options\r\n      filtering: {\r\n        enabled: true,\r\n        mode: 'client', // 'client' or 'server'\r\n        serverFilterLoader: null,\r\n        debounceDelay: 300,\r\n        showBadges: true,\r\n        showTooltips: true\r\n      },\r\n      // Control panels\r\n      controls: {\r\n        enabled: true,  // Enable by default to show search\r\n        search: true,\r\n        pagination: true,\r\n        pageSize: true,\r\n        refresh: true,\r\n        export: false,\r\n        position: 'top' // 'top', 'bottom', 'both'\r\n      },\r\n      search: {\r\n        enabled: true,\r\n        placeholder: 'Search...',\r\n        searchDelay: 300, // Debounce delay in milliseconds\r\n        minLength: 1, // Minimum characters before search starts\r\n        caseSensitive: false\r\n      },\r\n      // Selection options\r\n      selection: {\r\n        enabled: false,  // Default: selection is disabled\r\n        mode: 'single',  // 'single' or 'multi'\r\n        dataIdKey: 'id'  // Key to use as stable row identifier\r\n      },\r\n      // Virtual scrolling options\r\n      virtualScroll: {\r\n        enabled: false,\r\n        buffer: 10, // Number of rows to render above/below viewport\r\n        rowHeight: null, // Auto-detected if null\r\n        containerHeight: 400 // Default container height in pixels\r\n      },\r\n      ...options\r\n    };\r\n\r\n    // Initialize managers\r\n    this.eventManager = new EventManager();\r\n    this.columnManager = new ColumnManager(this);\r\n    this.dataManager = new DataManager(this, options.data || []);\r\n    this.renderer = new Renderer(this);\r\n    \r\n    // Initialize columns if provided\r\n    if (options.columns) {\r\n      this.columnManager.initializeColumns(options.columns);\r\n    }\r\n    \r\n    // Initialize pagination if enabled\r\n    if (this.options.pagination && this.options.pagination.enabled !== false) {\r\n      this.paginationManager = new PaginationManager(this, this.options.pagination);\r\n    }\r\n\r\n    // Initialize sorting if enabled\r\n    if (this.options.sorting && this.options.sorting.enabled !== false) {\r\n      this.sortingManager = new SortingManager(this, this.options.sorting);\r\n    }\r\n\r\n    // Initialize filtering if enabled\r\n    if (this.options.filtering && this.options.filtering.enabled !== false) {\r\n      this.filterManager = new FilterManager(this, this.options.filtering);\r\n      this.filterUI = new FilterUI(this.filterManager);\r\n    }\r\n\r\n    // Initialize search if enabled\r\n    if (this.options.search && this.options.search.enabled !== false) {\r\n      this.searchManager = new SearchManager(this, this.options.search);\r\n    }\r\n\r\n    // Initialize selection if enabled\r\n    if (this.options.selection) {\r\n      this.selectionManager = new SelectionManager(this, this.options.selection);\r\n    }\r\n\r\n    // Initialize virtual scrolling\r\n    if (this.options.virtualScroll) {\r\n      this.virtualScrollManager = new VirtualScrollManager(this, this.options.virtualScroll);\r\n    }\r\n\r\n    this.init();\r\n  }\r\n\r\n  async init() {\r\n    try {\r\n      // Initialize search manager\r\n      if (this.searchManager) {\r\n        this.searchManager.init();\r\n      }\r\n\r\n      // Get initial data\r\n      const initialData = this.dataManager.getData();\r\n      \r\n      // Trigger beforeLoad hook for initial data\r\n      this.eventManager.trigger('beforeLoad', { source: initialData });\r\n      \r\n      // Render table with first page of data\r\n      await this.refreshTable();\r\n      \r\n      // Trigger afterLoad hook with consistent payload format\r\n      this.eventManager.trigger('afterLoad', { data: initialData, source: initialData });\r\n    } catch (error) {\r\n      console.error('Failed to initialize table:', error);\r\n      this.eventManager.trigger('loadError', { error, source: 'initialization' });\r\n      if (this.renderer && this.renderer.renderError) {\r\n        this.renderer.renderError(error);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Refresh the table with current data and pagination\r\n   */\r\n  async refreshTable() {\r\n    let dataToRender;\r\n    \r\n    if (this.virtualScrollManager && this.virtualScrollManager.isEnabled()) {\r\n      // Virtual scrolling mode - get all data for virtual scrolling manager\r\n      dataToRender = this.dataManager.getData();\r\n      \r\n      // Initialize or update virtual scrolling with full dataset\r\n      this.virtualScrollManager.updateData(dataToRender);\r\n      \r\n      // Render the table structure first (without data rows)\r\n      this.renderer.renderTable([], true); // Pass empty array and virtualMode flag\r\n      \r\n      // Initialize virtual scrolling after table structure is ready\r\n      this.virtualScrollManager.init(dataToRender);\r\n    } else if (this.paginationManager) {\r\n      // Traditional pagination mode\r\n      dataToRender = await this.paginationManager.getPageData();\r\n      this.renderer.renderTable(dataToRender);\r\n    } else {\r\n      // No pagination, show all data (traditional mode)\r\n      dataToRender = this.dataManager.getData();\r\n      this.renderer.renderTable(dataToRender);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Load new data into the table\r\n   * Supports multiple data sources:\r\n   * - Array: loadData([{id: 1, name: 'John'}])\r\n   * - URL string: loadData('/api/data')\r\n   * - Async function: loadData(() => fetch('/api/data').then(r => r.json()))\r\n   * @param {Array|string|Function} source - Data source\r\n   */\r\n  async loadData(source) {\r\n    try {\r\n      // Trigger beforeLoad hook\r\n      this.eventManager.trigger('beforeLoad', { source });\r\n\r\n      let data;\r\n\r\n      // Handle different data source types\r\n      if (Array.isArray(source)) {\r\n        // Direct array data\r\n        data = source;\r\n      } else if (typeof source === 'string') {\r\n        // URL string - fetch data\r\n        data = await this._fetchFromUrl(source);\r\n      } else if (typeof source === 'function') {\r\n        // Custom async function\r\n        data = await source();\r\n      } else {\r\n        throw new Error('Invalid data source. Expected array, URL string, or function.');\r\n      }\r\n\r\n      // Validate data\r\n      if (!Array.isArray(data)) {\r\n        throw new Error('Data source must resolve to an array.');\r\n      }\r\n\r\n      // Update data and refresh table\r\n      this.dataManager.setData(data);\r\n      await this.refreshTable();\r\n      \r\n      // Trigger afterLoad hook\r\n      this.eventManager.trigger('afterLoad', { data, source });\r\n\r\n    } catch (error) {\r\n      // Handle loading errors\r\n      console.error('Error loading data:', error);\r\n      this.eventManager.trigger('loadError', { error, source });\r\n      \r\n      // Render error state\r\n      if (this.renderer && this.renderer.renderError) {\r\n        this.renderer.renderError(error);\r\n      }\r\n      \r\n      // Re-throw for caller handling\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Internal method to fetch data from URL\r\n   * @private\r\n   */\r\n  async _fetchFromUrl(url) {\r\n    if (typeof fetch === 'undefined') {\r\n      throw new Error('fetch is not available. Please use a modern browser or provide a polyfill.');\r\n    }\r\n\r\n    const response = await fetch(url);\r\n    \r\n    if (!response.ok) {\r\n      throw new Error(`HTTP error! status: ${response.status} - ${response.statusText}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    return data;\r\n  }\r\n\r\n  /**\r\n   * Filter data by criteria\r\n   */\r\n  async filter(criteria) {\r\n    this.dataManager.applyFilter(criteria);\r\n    await this.refreshTable();\r\n    this.eventManager.trigger('afterFilter', criteria);\r\n  }\r\n\r\n  /**\r\n   * Sort data by column\r\n   * @param {string} columnName - Column to sort by\r\n   * @param {string|null} direction - 'asc', 'desc', or null (unsorted)\r\n   */\r\n  async sort(columnName, direction = 'asc') {\r\n    if (this.sortingManager) {\r\n      await this.sortingManager.sort(columnName, direction);\r\n    } else {\r\n      // Fallback to legacy sorting\r\n      this.dataManager.applySorting([{ column: columnName, direction }]);\r\n      await this.refreshTable();\r\n      this.eventManager.trigger('afterSort', [{ column: columnName, direction }]);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Toggle sort for a column (handles click cycling)\r\n   */\r\n  async toggleSort(columnName) {\r\n    if (this.sortingManager) {\r\n      await this.sortingManager.toggleSort(columnName);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear all sorting\r\n   */\r\n  async clearSorting() {\r\n    if (this.sortingManager) {\r\n      await this.sortingManager.clearSorting();\r\n    } else {\r\n      // Fallback to legacy sorting\r\n      this.dataManager.clearSorting();\r\n      await this.refreshTable();\r\n      this.eventManager.trigger('afterSort', []);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current sort state\r\n   */\r\n  getSortState() {\r\n    if (this.sortingManager) {\r\n      return this.sortingManager.getSortState();\r\n    }\r\n    return { sort: null, mode: 'client' };\r\n  }\r\n\r\n  /**\r\n   * Clear all filters\r\n   */\r\n  async clearFilters() {\r\n    this.dataManager.clearFilters();\r\n    await this.refreshTable();\r\n    this.eventManager.trigger('afterFilter', {});\r\n  }\r\n\r\n  /**\r\n   * Clear all sorting\r\n   */\r\n  async clearSorting() {\r\n    if (this.sortingManager) {\r\n      await this.sortingManager.clearSorting();\r\n    } else {\r\n      // Fallback to legacy sorting\r\n      this.dataManager.clearSorting();\r\n      await this.refreshTable();\r\n      this.eventManager.trigger('afterSort', []);\r\n    }\r\n  }\r\n\r\n  // ===== FILTERING API =====\r\n\r\n  /**\r\n   * Apply filter to a specific column\r\n   * @param {string} columnName - Column to filter\r\n   * @param {Object} filterConfig - Filter configuration\r\n   * @example\r\n   * table.applyFilter('status', { type: 'value', values: ['Active', 'Pending'] });\r\n   * table.applyFilter('name', { type: 'condition', conditions: [{ operator: 'beginsWith', value: 'A' }] });\r\n   */\r\n  async applyFilter(columnName, filterConfig) {\r\n    if (this.filterManager) {\r\n      await this.filterManager.applyFilter(columnName, filterConfig);\r\n    } else {\r\n      console.warn('TablixJS: Filtering is not enabled. Set filtering.enabled to true in options.');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear filter for a specific column\r\n   * @param {string} columnName - Column to clear filter for\r\n   */\r\n  async clearFilter(columnName) {\r\n    if (this.filterManager) {\r\n      await this.filterManager.clearFilter(columnName);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear all filters\r\n   */\r\n  async clearAllFilters() {\r\n    if (this.filterManager) {\r\n      await this.filterManager.clearAllFilters();\r\n    } else {\r\n      // Fallback to legacy method\r\n      this.dataManager.clearFilters();\r\n      await this.refreshTable();\r\n      this.eventManager.trigger('afterFilter', {});\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get active filters\r\n   * @returns {Object} Active filters by column\r\n   */\r\n  getActiveFilters() {\r\n    return this.filterManager ? this.filterManager.getActiveFilters() : {};\r\n  }\r\n\r\n  /**\r\n   * Get filter state for a column\r\n   * @param {string} columnName - Column name\r\n   * @returns {Object|null} Filter state\r\n   */\r\n  getColumnFilter(columnName) {\r\n    return this.filterManager ? this.filterManager.getColumnFilter(columnName) : null;\r\n  }\r\n\r\n  // ===== SEARCH API =====\r\n\r\n  /**\r\n   * Set search term programmatically\r\n   * @param {string} searchTerm - Search term\r\n   */\r\n  async setSearchTerm(searchTerm) {\r\n    if (this.searchManager) {\r\n      await this.searchManager.setSearchTerm(searchTerm);\r\n    } else {\r\n      console.warn('TablixJS: Search is not enabled. Set search.enabled to true in options.');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current search term\r\n   * @returns {string} Current search term\r\n   */\r\n  getSearchTerm() {\r\n    return this.searchManager ? this.searchManager.getSearchTerm() : '';\r\n  }\r\n\r\n  /**\r\n   * Clear search\r\n   */\r\n  async clearSearch() {\r\n    if (this.searchManager) {\r\n      await this.searchManager.clearSearch();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get search information\r\n   * @returns {Object} Search results information\r\n   */\r\n  getSearchInfo() {\r\n    return this.searchManager ? this.searchManager.getSearchInfo() : null;\r\n  }\r\n\r\n  // ===== PAGINATION API =====\r\n\r\n  /**\r\n   * Go to next page\r\n   */\r\n  async nextPage() {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.nextPage();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to previous page\r\n   */\r\n  async prevPage() {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.prevPage();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to first page\r\n   */\r\n  async firstPage() {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.firstPage();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to last page\r\n   */\r\n  async lastPage() {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.lastPage();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to specific page\r\n   */\r\n  async goToPage(pageNumber) {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.goToPage(pageNumber);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Change page size\r\n   */\r\n  async changePageSize(pageSize) {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.changePageSize(pageSize);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get pagination information\r\n   */\r\n  getPaginationInfo() {\r\n    return this.paginationManager ? this.paginationManager.getInfo() : null;\r\n  }\r\n\r\n  /**\r\n   * Enable/disable pagination\r\n   */\r\n  async setPaginationEnabled(enabled) {\r\n    if (this.paginationManager) {\r\n      this.paginationManager.setEnabled(enabled);\r\n      await this.refreshTable();\r\n    } else if (enabled) {\r\n      // Create pagination manager if it doesn't exist\r\n      this.paginationManager = new PaginationManager(this, this.options.pagination);\r\n      await this.refreshTable();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Switch between client-side and server-side pagination\r\n   */\r\n  async setPaginationMode(mode, serverDataLoader = null) {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.setMode(mode, serverDataLoader);\r\n    }\r\n  }\r\n\r\n  // ===== EVENT MANAGEMENT =====\r\n\r\n  /**\r\n   * Register event callback\r\n   */\r\n  on(event, callback) {\r\n    this.eventManager.on(event, callback);\r\n  }\r\n\r\n  /**\r\n   * Remove event callback\r\n   */\r\n  off(event, callback) {\r\n    this.eventManager.off(event, callback);\r\n  }\r\n\r\n  /**\r\n   * Clear event listeners\r\n   */\r\n  clearEvents(event) {\r\n    this.eventManager.clear(event);\r\n  }\r\n\r\n  /**\r\n   * Trigger event\r\n   */\r\n  trigger(event, data) {\r\n    this.eventManager.trigger(event, data);\r\n  }\r\n\r\n  // ===== UTILITY METHODS =====\r\n\r\n  /**\r\n   * Get current filtered data\r\n   */\r\n  getData() {\r\n    return this.dataManager.getData();\r\n  }\r\n\r\n  /**\r\n   * Get original unfiltered data\r\n   */\r\n  getOriginalData() {\r\n    return this.dataManager.originalData;\r\n  }\r\n\r\n  /**\r\n   * Get table options\r\n   */\r\n  getOptions() {\r\n    return this.options;\r\n  }\r\n\r\n  /**\r\n   * Update table options\r\n   */\r\n  async setOptions(newOptions) {\r\n    this.options = { ...this.options, ...newOptions };\r\n    \r\n    // Update pagination options if provided\r\n    if (newOptions.pagination && this.paginationManager) {\r\n      this.paginationManager.options = { ...this.paginationManager.options, ...newOptions.pagination };\r\n    }\r\n    \r\n    // Update selection options if provided\r\n    if (newOptions.selection && this.selectionManager) {\r\n      this.selectionManager.options = { ...this.selectionManager.options, ...newOptions.selection };\r\n      \r\n      // Re-initialize if enabled state changed\r\n      if (newOptions.selection.enabled !== undefined) {\r\n        if (newOptions.selection.enabled) {\r\n          this.selectionManager.enable();\r\n        } else {\r\n          this.selectionManager.disable();\r\n        }\r\n      }\r\n      \r\n      // Update mode if provided\r\n      if (newOptions.selection.mode) {\r\n        this.selectionManager.setMode(newOptions.selection.mode);\r\n      }\r\n    }\r\n    \r\n    await this.refreshTable();\r\n  }\r\n\r\n  // ===== SELECTION API =====\r\n\r\n  /**\r\n   * Get selected row data\r\n   * @returns {Array} Array of selected row data objects\r\n   */\r\n  getSelectedData() {\r\n    return this.selectionManager ? this.selectionManager.getSelectedData() : [];\r\n  }\r\n\r\n  /**\r\n   * Get selected row IDs\r\n   * @returns {Array} Array of selected row IDs\r\n   */\r\n  getSelectedIds() {\r\n    return this.selectionManager ? this.selectionManager.getSelectedIds() : [];\r\n  }\r\n\r\n  /**\r\n   * Programmatically select rows by ID\r\n   * @param {String|Array} rowIds - Single row ID or array of row IDs\r\n   */\r\n  selectRows(rowIds) {\r\n    if (this.selectionManager) {\r\n      this.selectionManager.selectRows(rowIds);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Programmatically deselect rows by ID\r\n   * @param {String|Array} rowIds - Single row ID or array of row IDs\r\n   */\r\n  deselectRows(rowIds) {\r\n    if (this.selectionManager) {\r\n      this.selectionManager.deselectRows(rowIds);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear all selections\r\n   */\r\n  clearSelection() {\r\n    if (this.selectionManager) {\r\n      this.selectionManager.clearSelection();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if a row is selected\r\n   * @param {String} rowId - Row ID to check\r\n   * @returns {Boolean} True if row is selected\r\n   */\r\n  isRowSelected(rowId) {\r\n    return this.selectionManager ? this.selectionManager.isRowSelected(rowId) : false;\r\n  }\r\n\r\n  /**\r\n   * Get selection count\r\n   * @returns {Number} Number of selected rows\r\n   */\r\n  getSelectionCount() {\r\n    return this.selectionManager ? this.selectionManager.getSelectionCount() : 0;\r\n  }\r\n\r\n  /**\r\n   * Enable selection\r\n   */\r\n  enableSelection() {\r\n    if (this.selectionManager) {\r\n      this.selectionManager.enable();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Disable selection\r\n   */\r\n  disableSelection() {\r\n    if (this.selectionManager) {\r\n      this.selectionManager.disable();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set selection mode\r\n   * @param {String} mode - 'single' or 'multi'\r\n   */\r\n  setSelectionMode(mode) {\r\n    if (this.selectionManager) {\r\n      this.selectionManager.setMode(mode);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Select all rows (currently visible/filtered rows)\r\n   * This will select all rows that are currently visible based on applied filters and search\r\n   * @returns {Number} Number of rows selected\r\n   */\r\n  selectAllRows() {\r\n    if (!this.selectionManager) {\r\n      console.warn('TablixJS: Selection is not enabled. Set selection.enabled to true in options.');\r\n      return 0;\r\n    }\r\n\r\n    // Get currently visible/filtered data\r\n    const allData = this.getData();\r\n    \r\n    if (allData.length === 0) {\r\n      console.warn('TablixJS: No rows available to select.');\r\n      return 0;\r\n    }\r\n\r\n    // Extract all IDs from current data\r\n    const dataIdKey = this.options.selection.dataIdKey || 'id';\r\n    const allIds = allData.map(row => String(row[dataIdKey]));\r\n\r\n    // Select all rows\r\n    this.selectionManager.selectRows(allIds);\r\n\r\n    // Trigger custom event for select all action\r\n    this.eventManager.trigger('selectAll', { \r\n      selectedIds: allIds, \r\n      selectedData: allData,\r\n      count: allData.length \r\n    });\r\n\r\n    return allData.length;\r\n  }\r\n\r\n  /**\r\n   * Destroy the table and clean up all resources\r\n   */\r\n  destroy() {\r\n    // Clean up virtual scrolling\r\n    if (this.virtualScrollManager) {\r\n      this.virtualScrollManager.destroy();\r\n    }\r\n\r\n    // Clean up other managers\r\n    if (this.selectionManager) {\r\n      this.selectionManager.destroy && this.selectionManager.destroy();\r\n    }\r\n\r\n    if (this.searchManager) {\r\n      this.searchManager.destroy && this.searchManager.destroy();\r\n    }\r\n\r\n    if (this.filterManager) {\r\n      this.filterManager.destroy && this.filterManager.destroy();\r\n    }\r\n\r\n    if (this.sortingManager) {\r\n      this.sortingManager.destroy && this.sortingManager.destroy();\r\n    }\r\n\r\n    if (this.paginationManager) {\r\n      this.paginationManager.destroy && this.paginationManager.destroy();\r\n    }\r\n\r\n    // Clear container\r\n    if (this.container) {\r\n      this.container.innerHTML = '';\r\n    }\r\n\r\n    // Clear references\r\n    this.virtualScrollManager = null;\r\n    this.selectionManager = null;\r\n    this.searchManager = null;\r\n    this.filterManager = null;\r\n    this.sortingManager = null;\r\n    this.paginationManager = null;\r\n    this.dataManager = null;\r\n    this.renderer = null;\r\n    this.eventManager = null;\r\n  }\r\n\r\n  /**\r\n   * Destroy table and clean up event listeners\r\n   */\r\n  destroy() {\r\n    // Clean up any event listeners\r\n    const paginationContainer = this.container.querySelector('.tablix-pagination');\r\n    if (paginationContainer) {\r\n      paginationContainer.removeEventListener('click', this._paginationClickHandler);\r\n    }\r\n\r\n    // Destroy managers\r\n    if (this.selectionManager) {\r\n      this.selectionManager.destroy();\r\n    }\r\n\r\n    // Clear container\r\n    this.container.innerHTML = '';\r\n    \r\n    // Clear references\r\n    this.dataManager = null;\r\n    this.renderer = null;\r\n    this.eventManager = null;\r\n    this.paginationManager = null;\r\n    this.sortingManager = null;\r\n    this.selectionManager = null;\r\n  }\r\n}","import Table from './core/Table.js';\r\n\r\n// Export main Table class as default\r\nexport default Table;\r\n\r\n// Named exports for convenience\r\nexport { Table };\r\n\r\n// Version info\r\nexport const version = '0.1.0';\r\n"],"names":["DataManager","constructor","table","data","originalData","filteredData","currentFilters","currentSorts","serverTotalRows","getData","setData","paginationManager","updatePaginationInfo","setServerData","totalRows","getTotalRows","length","applyFilter","criteria","Object","keys","filter","item","entries","every","key","value","itemValue","toLowerCase","searchValue","includes","resetToFirstPage","setFilteredData","applySorting","sorts","sortingManager","_applySorting","sort","a","b","column","direction","aVal","bVal","comparison","clearFilters","clearSorting","getPageData","page","pageSize","start","slice","Renderer","renderTable","virtualMode","columns","columnManager","getColumns","options","controlsOptions","controls","isVirtualScrollEnabled","virtualScrollManager","isEnabled","preservedSearchValue","searchInputHadFocus","cursorPosition","existingSearchInput","container","querySelector","document","activeElement","selectionStart","selectionEnabled","selectionManager","enabled","selectionAttributes","mode","html","position","renderControls","containerHeight","virtualScroll","forEach","col","isSortable","_isColumnSortable","sortDirection","_getSortDirection","name","sortClass","sortDirectionClass","title","row","index","globalIndex","currentPage","cell","renderedCell","result","formatCellValue","isHtml","escapeHtml","renderer","innerHTML","newSearchInput","renderPagination","bindControlEvents","searchManager","bindEvents","bindSortEvents","bindRowClickEvents","filterUI","renderFilterIcons","requestAnimationFrame","focus","setSelectionRange","eventManager","trigger","paginationContainer","info","getInfo","undefined","totalPages","showPageSizes","startRow","endRow","pageSizeOptions","size","selected","showFirstLast","disabled","showPrevNext","hasPrevPage","showPageNumbers","pageNumbers","getPageNumbers","active","hasNextPage","isLoading","bindPaginationEvents","addEventListener","e","target","classList","contains","preventDefault","parseInt","dataset","isNaN","goToPage","error","console","pageSizeSelect","newPageSize","changePageSize","text","div","createElement","textContent","toString","renderLoading","renderError","message","searchOptions","search","placeholder","pagination","currentPageSize","refresh","placeholderText","wrapper","action","firstPage","prevPage","nextPage","lastPage","handleRefresh","handleExport","onRefresh","newData","loadData","refreshTable","csv","map","join","values","replace","blob","Blob","type","url","URL","createObjectURL","href","download","body","appendChild","click","removeChild","revokeObjectURL","format","headerRow","th","closest","columnName","toggleSort","tbody","globalRowIndex","rowIndex","localRowIndex","currentData","getCurrentPageData","rowData","originalEvent","dataManager","updateSortIndicators","currentSort","headers","querySelectorAll","isSorted","remove","indicator","arrow","add","setAttribute","removeAttribute","isColumnSortable","getSortDirection","EventManager","events","on","event","callback","push","off","indexOf","splice","clear","payload","cb","PaginationManager","maxPageNumbers","serverDataLoader","init","Math","ceil","getClientPageData","getServerPageData","end","Error","filters","pageNumber","targetPage","max","min","oldPage","newPage","oldPageSize","currentRow","floor","pageData","maxPages","pages","i","half","unshift","setEnabled","setMode","SortingManager","serverSortLoader","defaultSortType","caseSensitive","nullsFirst","sortOrder","sortTypes","auto","_autoSort","bind","string","_stringSort","number","_numberSort","date","_dateSort","boolean","_booleanSort","beforeSortData","_sortServer","_sortClient","currentDirection","currentIndex","nextDirection","warn","find","_compareValues","sortFunction","sortType","numA","parseFloat","numB","dateA","Date","dateB","isDateLike","str","test","String","strA","trim","strB","localeCompare","sensitivity","boolA","Boolean","boolB","getSortState","setOptions","newOptions","sortable","ColumnManager","formatters","Map","supportedFormats","initializeColumns","prepareColumn","compileFormatters","prepared","formatter","createFormatter","set","locale","formatOptions","formatText","formatDate","formatCurrency","currency","formatNumber","formatPercent","getColumn","get","formattedValue","getTime","Intl","DateTimeFormat","numericValue","Number","style","NumberFormat","registerFormat","formatType","formatterFactory","log","getSupportedFormats","FilterManager","serverFilterLoader","debounceDelay","showBadges","showTooltips","columnFilters","operators","label","apply","filterValue","startsWith","endsWith","debounceTimer","openDropdowns","Set","filterConfig","validateFilterConfig","beforeFilterData","getActiveFilters","config","isActive","isFilterActive","_filterServer","_filterClient","updateFilterIndicators","activeFilters","clearFilter","has","delete","clearAllFilters","filterState","getColumnUniqueValues","Array","from","getColumnFilter","hasColumnFilter","isArray","conditions","cond","operator","some","_testRowAgainstFilter","cellValue","condition","header","hasFilter","filterIndicator","_updateFilterBadge","badge","badgeText","activeConditions","className","registerOperator","getOperators","FilterUI","filterManager","activeDropdown","handleDocumentClick","handleFilterIconClick","destroy","removeEventListener","closeAllDropdowns","thContent","stopPropagation","sortIndicator","insertBefore","nextSibling","dropdown","createFilterDropdown","showDropdown","renderDropdownContent","bindDropdownEvents","currentFilter","renderValueFilterPanel","renderConditionFilterPanel","uniqueValues","selectedValues","isChecked","valueId","renderConditionRow","needsValue","op","tab","tabType","switchTab","bindValueFilterEvents","bindConditionFilterEvents","valuePanel","searchInput","searchTimeout","clearTimeout","setTimeout","filterValueList","selectAllCheckbox","toggleSelectAll","checked","checkbox","updateSelectAllState","conditionPanel","addButton","addCondition","bindConditionRowEvents","select","valueInput","parentElement","button","conditionRow","conditionsContainer","operatorSelect","toggle","panel","searchTerm","items","term","matches","display","checkboxes","visibleCheckboxes","checkedCount","indeterminate","newIndex","children","conditionHtml","insertAdjacentHTML","newCondition","lastElementChild","removeButton","activeTab","collectValueFilter","collectConditionFilter","conditionRows","triggerRect","getBoundingClientRect","dropdownRect","left","top","bottom","width","window","innerWidth","height","innerHeight","SearchManager","searchDelay","searchColumns","minLength","currentSearchTerm","handleSearchInput","handleSearchClear","source","performSearch","searchClear","clearSearch","updateClearButtonVisibility","previousTerm","hadFocus","beforeSearchData","willSearch","filterData","afterSearchData","resultsCount","totalCount","isSearchActive","searchPerformed","getSearchableColumns","stringValue","updateInputValue","setSearchTerm","getSearchTerm","getSearchInfo","configure","oldOptions","getConfiguration","SelectionManager","selectedRows","lastSelectedRow","rowIdMap","dataIdKey","dragSelection","startRowIndex","currentRowIndex","startRowId","originalSelection","isDragging","dragThreshold","eventListenersSetup","setupEventListeners","handleRowClick","setupDragSelection","clearSelection","updateSelectionAfterDataChange","updateUI","rowId","getRowId","hasOriginalEvent","ctrlKey","shiftKey","metaKey","timestamp","now","beforeSelectEvent","currentSelection","isCtrlClick","isShiftClick","isDragSelection","handleSingleSelection","handleMultiSelection","afterSelectEvent","selectedData","getSelectedData","selectionSize","handleRangeSelection","endRowId","fullData","getFullData","startIndex","findIndex","endIndex","minIndex","maxIndex","tableElement","startX","startY","clientX","clientY","deltaX","abs","deltaY","startDragSelection","updateDragSelection","completeDragSelection","cancelDragSelection","tableWrapper","startRowData","dragStart","applyDragSelection","dragComplete","resetDragSelection","createRowHash","JSON","stringify","hash","char","charCodeAt","allRows","hasVirtualIndexes","hasAttribute","virtualIndex","getAttribute","allDataRowIds","newSelection","allData","getSelectedIds","selectRows","rowIds","ids","id","deselectRows","hadSelection","isRowSelected","isRowSelectedByData","getSelectionCount","enable","disable","oldMode","lastSelected","VirtualScrollManager","buffer","rowHeight","throttleDelay","scrollContainer","tableBody","topSpacer","bottomSpacer","visibleStart","visibleEnd","renderedStart","renderedEnd","performanceData","renderTimes","scrollUpdates","lastMeasurement","throttledScrollHandler","throttle","handleScroll","immediateScrollHandler","updateScheduled","pendingUpdate","lastScrollTime","scrollVelocity","renderedData","setupScrollContainer","detectRowHeight","calculateViewport","scheduleUpdate","handleScrollImmediate","passive","handleScrollStart","handleScrollEnd","handleResize","setupEventDelegation","setupSelectionListeners","rowClickHandler","justFinishedDrag","eventType","element","updateSelectionStates","setupVirtualDragSelection","rowHoverHandler","createSpacers","existingTop","existingBottom","cssText","firstChild","sampleRow","renderSingleRow","rect","scrollTop","visibleRowCount","updateSpacers","topHeight","bottomHeight","performance","lastScrollTop","timeDelta","scrollDelta","isScrollbarDragging","scrollDragInterval","setInterval","clearInterval","isDragSelecting","dragStartIndex","dragStartX","dragStartY","applyVirtualDragSelection","handleMouseUp","endRowData","update","startTime","renderVisibleRows","endTime","trackPerformance","existingRows","fragment","createDocumentFragment","handleImageLoading","rows","images","img","complete","cloneNode","src","handleLoad","opacity","handleError","transition","originalIndex","tr","isSelected","td","rendered","updateData","scrollToRow","targetScrollTop","getVisibleRange","getRenderedData","renderTime","shift","getPerformanceStats","times","avg","reduce","averageRenderTime","toFixed","maxRenderTime","minRenderTime","visibleRows","renderedRows","func","limit","inThrottle","args","arguments","context","debug","Table","sorting","filtering","export","selection","initialData","dataToRender","_fetchFromUrl","fetch","response","ok","status","statusText","json","getPaginationInfo","setPaginationEnabled","setPaginationMode","clearEvents","getOriginalData","getOptions","enableSelection","disableSelection","setSelectionMode","selectAllRows","allIds","selectedIds","count","_paginationClickHandler","version"],"mappings":"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"}