{"version":3,"file":"tablix.jquery.min.js","sources":["../src/core/DataManager.js","../src/core/Renderer.js","../src/core/EventManager.js","../src/core/PaginationManager.js","../src/core/SortingManager.js","../src/core/ColumnManager.js","../src/core/FilterManager.js","../src/core/FilterUI.js","../src/core/SearchManager.js","../src/core/SelectionManager.js","../src/core/VirtualScroll.js","../src/core/Localization.js","../src/locales/fr.js","../src/locales/es.js","../src/locales/sr.js","../src/core/Table.js","../src/jquery/index.js","../src/jquery/tablixjs-jquery-bundled.js"],"sourcesContent":["export default class DataManager {\r\n  constructor(table, data = []) {\r\n    this.table = table;\r\n    this.originalData = data;   // full data set\r\n    this.filteredData = [...data];  // filtered data\r\n    this.currentFilters = {};   // current filter criteria\r\n    this.currentSorts = [];     // current sort criteria (deprecated - use SortingManager)\r\n    this.serverTotalRows = null; // for server-side pagination\r\n  }\r\n\r\n  getData() {\r\n    return this.filteredData;\r\n  }\r\n\r\n  setData(data) {\r\n    this.originalData = data;\r\n    this.filteredData = [...data];\r\n    \r\n    // Update pagination info after data change\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.updatePaginationInfo();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set data from server (for server-side operations)\r\n   */\r\n  setServerData(data, totalRows = null) {\r\n    this.originalData = data;\r\n    this.filteredData = [...data];\r\n    this.serverTotalRows = totalRows;\r\n    \r\n    // Update pagination info after data change\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.updatePaginationInfo(totalRows);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get total rows (for server-side pagination)\r\n   */\r\n  getTotalRows() {\r\n    return this.serverTotalRows !== null ? this.serverTotalRows : this.originalData.length;\r\n  }\r\n\r\n  applyFilter(criteria) {\r\n    this.currentFilters = criteria;\r\n    \r\n    if (Object.keys(criteria).length === 0) {\r\n      // No filters, show all data\r\n      this.filteredData = [...this.originalData];\r\n    } else {\r\n      // Simple filtering: supports multiple criteria (legacy format)\r\n      this.filteredData = this.originalData.filter(item => {\r\n        return Object.entries(criteria).every(([key, value]) => {\r\n          const itemValue = (item[key] + '').toLowerCase();\r\n          const searchValue = (value + '').toLowerCase();\r\n          return itemValue.includes(searchValue);\r\n        });\r\n      });\r\n    }\r\n\r\n    // Reset pagination to first page after filtering\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.resetToFirstPage();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Apply filtering from FilterManager (this will be called by FilterManager)\r\n   * @param {Array} filteredData - Pre-filtered data from FilterManager\r\n   */\r\n  setFilteredData(filteredData) {\r\n    this.filteredData = filteredData;\r\n    \r\n    // Reset pagination to first page after filtering\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.resetToFirstPage();\r\n    }\r\n  }\r\n\r\n  applySorting(sorts) {\r\n    this.currentSorts = sorts;\r\n    \r\n    if (!sorts || sorts.length === 0) {\r\n      return;\r\n    }\r\n\r\n    // Use SortingManager if available, otherwise fall back to basic sorting\r\n    if (this.table.sortingManager && this.table.sortingManager.currentSorts.length > 0) {\r\n      this.table.sortingManager._applySorting();\r\n    } else {\r\n      // Legacy sorting implementation\r\n      this.filteredData.sort((a, b) => {\r\n        for (const sort of sorts) {\r\n          const { column, direction } = sort;\r\n          const aVal = a[column];\r\n          const bVal = b[column];\r\n          \r\n          let comparison = 0;\r\n          if (aVal < bVal) comparison = -1;\r\n          else if (aVal > bVal) comparison = 1;\r\n          \r\n          if (comparison !== 0) {\r\n            return direction === 'desc' ? -comparison : comparison;\r\n          }\r\n        }\r\n        return 0;\r\n      });\r\n    }\r\n\r\n    // Reset pagination to first page after sorting\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.resetToFirstPage();\r\n    }\r\n  }\r\n\r\n  clearFilters() {\r\n    this.currentFilters = {};\r\n    this.filteredData = [...this.originalData];\r\n    \r\n    // Reset pagination to first page\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.resetToFirstPage();\r\n    }\r\n  }\r\n\r\n  clearSorting() {\r\n    this.currentSorts = [];\r\n    // Don't change the filtered data order, just clear the sort state\r\n    \r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.resetToFirstPage();\r\n    }\r\n  }\r\n\r\n  // Legacy method for backward compatibility\r\n  getPageData(page = 1) {\r\n    const pageSize = this.table.paginationManager ? \r\n      this.table.paginationManager.pageSize : 10;\r\n    const start = (page - 1) * pageSize;\r\n    return this.filteredData.slice(start, start + pageSize);\r\n  }\r\n}","export default class Renderer {\r\n  constructor(table) {\r\n    this.table = table;\r\n  }\r\n\r\n  renderTable(data, virtualMode = false) {\r\n    const columns = this.table.columnManager ? this.table.columnManager.getColumns() : (this.table.options.columns || []);\r\n    const controlsOptions = this.table.options.controls;\r\n    const isVirtualScrollEnabled = this.table.virtualScrollManager && this.table.virtualScrollManager.isEnabled();\r\n\r\n    // Preserve search input value and focus state before re-rendering\r\n    let preservedSearchValue = '';\r\n    let searchInputHadFocus = false;\r\n    let cursorPosition = 0;\r\n    const existingSearchInput = this.table.container.querySelector('.tablix-search-input');\r\n    if (existingSearchInput) {\r\n      preservedSearchValue = existingSearchInput.value;\r\n      searchInputHadFocus = document.activeElement === existingSearchInput;\r\n      cursorPosition = existingSearchInput.selectionStart || 0;\r\n    }\r\n\r\n    // Determine selection attributes\r\n    const selectionEnabled = this.table.selectionManager && this.table.selectionManager.options.enabled;\r\n    const selectionAttributes = selectionEnabled \r\n      ? `data-selection-enabled data-selection-mode=\"${this.table.selectionManager.options.mode}\"` \r\n      : 'data-selection-disabled';\r\n\r\n    let html = `<div class=\"tablix-wrapper\" ${selectionAttributes}>`;\r\n    \r\n    // Top controls\r\n    if (controlsOptions.enabled && (controlsOptions.position === 'top' || controlsOptions.position === 'both')) {\r\n      html += this.renderControls('top');\r\n    }\r\n    \r\n    // Virtual scroll container (if enabled)\r\n    if (isVirtualScrollEnabled) {\r\n      const containerHeight = this.table.options.virtualScroll.containerHeight || 400;\r\n      html += `<div class=\"tablix-scroll-container\" style=\"height: ${containerHeight}px; overflow: auto; position: relative; border: 1px solid #ddd;\">`;\r\n    }\r\n    \r\n    // Table\r\n    html += '<table class=\"tablix-table\" style=\"width:100%; border-collapse:collapse;\">';\r\n\r\n    // Header\r\n    html += '<thead class=\"tablix-thead\"><tr class=\"tablix-header-row\">';\r\n    columns.forEach(col => {\r\n      const isSortable = this._isColumnSortable(col);\r\n      const sortDirection = this._getSortDirection(col.name);\r\n      const sortClass = isSortable ? ' tablix-sortable' : '';\r\n      const sortDirectionClass = sortDirection ? ` tablix-sorted tablix-sorted-${sortDirection}` : '';\r\n      \r\n      html += `<th class=\"tablix-th${sortClass}${sortDirectionClass}\" data-column=\"${col.name}\">`;\r\n      html += `<div class=\"tablix-th-content\">`;\r\n      html += `<span class=\"tablix-th-text\">${col.title || col.name}</span>`;\r\n      \r\n      if (isSortable) {\r\n        html += `<span class=\"tablix-sort-indicator\">`;\r\n        if (sortDirection === 'asc') {\r\n          html += `<span class=\"tablix-sort-arrow tablix-sort-asc\" aria-label=\"${this.table.t('sort.sortedAscending')}\">↑</span>`;\r\n        } else if (sortDirection === 'desc') {\r\n          html += `<span class=\"tablix-sort-arrow tablix-sort-desc\" aria-label=\"${this.table.t('sort.sortedDescending')}\">↓</span>`;\r\n        } else {\r\n          html += `<span class=\"tablix-sort-arrow tablix-sort-none\" aria-label=\"${this.table.t('sort.notSorted')}\">↕</span>`;\r\n        }\r\n        html += `</span>`;\r\n      }\r\n      \r\n      html += `</div>`;\r\n      html += `</th>`;\r\n    });\r\n    html += '</tr></thead>';\r\n\r\n    // Body\r\n    html += '<tbody class=\"tablix-tbody\">';\r\n    \r\n    // For virtual scrolling, only render empty structure or limited rows\r\n    if (isVirtualScrollEnabled && virtualMode) {\r\n      // Empty body for virtual scrolling - rows will be added by VirtualScrollManager\r\n      html += `<tr class=\"tablix-placeholder-row\" style=\"display: none;\"><td colspan=\"${columns.length}\"></td></tr>`;\r\n    } else if (data.length === 0) {\r\n      html += `<tr class=\"tablix-empty-row\"><td colspan=\"${columns.length}\" class=\"tablix-empty-cell\">${this.table.t('general.noData')}</td></tr>`;\r\n    } else {\r\n      data.forEach((row, index) => {\r\n        // Calculate global row index for pagination\r\n        let globalIndex = index;\r\n        if (this.table.paginationManager && this.table.paginationManager.options.mode === 'client') {\r\n          const currentPage = this.table.paginationManager.currentPage;\r\n          const pageSize = this.table.paginationManager.pageSize;\r\n          globalIndex = (currentPage - 1) * pageSize + index;\r\n        }\r\n        \r\n        html += `<tr class=\"tablix-row\" data-row-index=\"${globalIndex}\">`;\r\n        columns.forEach(col => {\r\n          const cell = row[col.name];\r\n          let renderedCell;\r\n          \r\n          // Use ColumnManager for formatting if available\r\n          if (this.table.columnManager) {\r\n            const result = this.table.columnManager.formatCellValue(col.name, cell, row);\r\n            if (result.isHtml) {\r\n              // Custom renderer returned HTML - use as is\r\n              renderedCell = result.value;\r\n            } else {\r\n              // Formatted or raw value - escape for safety\r\n              renderedCell = this.escapeHtml(result.value);\r\n            }\r\n          } else {\r\n            // Fallback to original renderer logic\r\n            renderedCell = col.renderer ? col.renderer(cell, row) : this.escapeHtml(cell);\r\n          }\r\n          \r\n          html += `<td class=\"tablix-td\">${renderedCell}</td>`;\r\n        });\r\n        html += '</tr>';\r\n      });\r\n    }\r\n    html += '</tbody>';\r\n    html += '</table>';\r\n    \r\n    // Close virtual scroll container if enabled\r\n    if (isVirtualScrollEnabled) {\r\n      html += '</div>'; // Close tablix-scroll-container\r\n    }\r\n\r\n    // Pagination will be rendered separately\r\n    html += '<div class=\"tablix-pagination-container\"></div>';\r\n    \r\n    // Bottom controls\r\n    if (controlsOptions.enabled && (controlsOptions.position === 'bottom' || controlsOptions.position === 'both')) {\r\n      html += this.renderControls('bottom');\r\n    }\r\n    \r\n    html += '</div>';\r\n\r\n    // Update DOM\r\n    this.table.container.innerHTML = html;\r\n    \r\n    // Restore search input value immediately after DOM update\r\n    if (preservedSearchValue) {\r\n      const newSearchInput = this.table.container.querySelector('.tablix-search-input');\r\n      if (newSearchInput) {\r\n        newSearchInput.value = preservedSearchValue;\r\n      }\r\n    }\r\n    \r\n    // Render pagination controls if pagination is enabled\r\n    this.renderPagination();\r\n    \r\n    // Bind control events\r\n    if (controlsOptions.enabled) {\r\n      this.bindControlEvents();\r\n    }\r\n\r\n    // Bind search events if search is enabled\r\n    if (this.table.searchManager) {\r\n      this.table.searchManager.bindEvents();\r\n    }\r\n\r\n    // Bind sort events if sorting is enabled\r\n    if (this.table.sortingManager) {\r\n      this.bindSortEvents();\r\n    }\r\n\r\n    // Bind row click events if selection is enabled\r\n    if (this.table.selectionManager && this.table.selectionManager.options.enabled) {\r\n      this.bindRowClickEvents();\r\n    }\r\n\r\n    // Render filter icons and bind events if filtering is enabled\r\n    if (this.table.filterUI) {\r\n      this.table.filterUI.renderFilterIcons();\r\n    }\r\n\r\n    // Restore focus AFTER all event binding is complete\r\n    if (searchInputHadFocus) {\r\n      const newSearchInput = this.table.container.querySelector('.tablix-search-input');\r\n      if (newSearchInput) {\r\n        // Use requestAnimationFrame to ensure focus happens after all DOM operations\r\n        requestAnimationFrame(() => {\r\n          newSearchInput.focus();\r\n          // Restore cursor position\r\n          if (cursorPosition > 0) {\r\n            newSearchInput.setSelectionRange(cursorPosition, cursorPosition);\r\n          }\r\n        });\r\n      }\r\n    }\r\n\r\n    // Trigger afterRender event\r\n    this.table.eventManager.trigger('afterRender');\r\n  }\r\n\r\n  renderPagination() {\r\n    const paginationContainer = this.table.container.querySelector('.tablix-pagination-container');\r\n    if (!paginationContainer || !this.table.paginationManager) {\r\n      return;\r\n    }\r\n\r\n    const paginationManager = this.table.paginationManager;\r\n    const info = paginationManager.getInfo();\r\n    \r\n    if (!paginationManager.options.enabled && paginationManager.options.enabled !== undefined) {\r\n      paginationContainer.innerHTML = '';\r\n      return;\r\n    }\r\n\r\n    // Don't show pagination if there's only one page and no custom page sizes\r\n    if (info.totalPages <= 1 && !paginationManager.options.showPageSizes) {\r\n      paginationContainer.innerHTML = '';\r\n      return;\r\n    }\r\n\r\n    let html = '<div class=\"tablix-pagination\">';\r\n    \r\n    // Page info\r\n    html += `<div class=\"tablix-pagination-info\">`;\r\n    if (info.totalRows === 0) {\r\n      html += this.table.t('pagination.noRecords');\r\n    } else {\r\n      html += this.table.t('pagination.showingRecords', {\r\n        startRow: info.startRow,\r\n        endRow: info.endRow,\r\n        totalRows: info.totalRows\r\n      });\r\n    }\r\n    html += '</div>';\r\n\r\n    // Page size selector\r\n    if (paginationManager.options.showPageSizes && paginationManager.options.pageSizeOptions.length > 1) {\r\n      html += '<div class=\"tablix-pagination-page-size\">';\r\n      html += this.table.t('general.show') + ' ';\r\n      html += '<select class=\"tablix-page-size-select\">';\r\n      paginationManager.options.pageSizeOptions.forEach(size => {\r\n        const selected = size === info.pageSize ? ' selected' : '';\r\n        html += `<option value=\"${size}\"${selected}>${size}</option>`;\r\n      });\r\n      html += '</select>';\r\n      html += ' ' + this.table.t('general.records') + ' ' + this.table.t('general.perPage');\r\n      html += '</div>';\r\n    }\r\n\r\n    // Navigation controls\r\n    if (info.totalPages > 1) {\r\n      html += '<div class=\"tablix-pagination-nav\">';\r\n      \r\n      // First page\r\n      if (paginationManager.options.showFirstLast) {\r\n        const disabled = info.currentPage === 1 ? ' disabled' : '';\r\n        html += `<button class=\"tablix-pagination-btn tablix-pagination-first\" data-page=\"1\"${disabled}>${this.table.t('pagination.first')}</button>`;\r\n      }\r\n      \r\n      // Previous page\r\n      if (paginationManager.options.showPrevNext) {\r\n        const disabled = !info.hasPrevPage ? ' disabled' : '';\r\n        html += `<button class=\"tablix-pagination-btn tablix-pagination-prev\" data-page=\"${info.currentPage - 1}\"${disabled}>${this.table.t('pagination.previous')}</button>`;\r\n      }\r\n      \r\n      // Page numbers\r\n      if (paginationManager.options.showPageNumbers) {\r\n        const pageNumbers = paginationManager.getPageNumbers();\r\n        pageNumbers.forEach(page => {\r\n          if (page === '...') {\r\n            html += '<span class=\"tablix-pagination-ellipsis\">...</span>';\r\n          } else {\r\n            const active = page === info.currentPage ? ' active' : '';\r\n            html += `<button class=\"tablix-pagination-btn tablix-pagination-page${active}\" data-page=\"${page}\">${page}</button>`;\r\n          }\r\n        });\r\n      }\r\n      \r\n      // Next page\r\n      if (paginationManager.options.showPrevNext) {\r\n        const disabled = !info.hasNextPage ? ' disabled' : '';\r\n        html += `<button class=\"tablix-pagination-btn tablix-pagination-next\" data-page=\"${info.currentPage + 1}\"${disabled}>${this.table.t('pagination.next')}</button>`;\r\n      }\r\n      \r\n      // Last page\r\n      if (paginationManager.options.showFirstLast) {\r\n        const disabled = info.currentPage === info.totalPages ? ' disabled' : '';\r\n        html += `<button class=\"tablix-pagination-btn tablix-pagination-last\" data-page=\"${info.totalPages}\"${disabled}>${this.table.t('pagination.last')}</button>`;\r\n      }\r\n      \r\n      html += '</div>';\r\n    }\r\n\r\n    // Loading indicator\r\n    if (info.isLoading) {\r\n      html += `<div class=\"tablix-pagination-loading\">${this.table.t('general.loading')}</div>`;\r\n    }\r\n    \r\n    html += '</div>';\r\n\r\n    paginationContainer.innerHTML = html;\r\n    this.bindPaginationEvents();\r\n  }\r\n\r\n  bindPaginationEvents() {\r\n    const paginationContainer = this.table.container.querySelector('.tablix-pagination');\r\n    if (!paginationContainer) {\r\n      return;\r\n    }\r\n\r\n    // Page navigation buttons\r\n    paginationContainer.addEventListener('click', async (e) => {\r\n      if (e.target.classList.contains('tablix-pagination-btn') && !e.target.disabled) {\r\n        e.preventDefault();\r\n        const page = parseInt(e.target.dataset.page);\r\n        if (!isNaN(page)) {\r\n          try {\r\n            await this.table.paginationManager.goToPage(page);\r\n          } catch (error) {\r\n            console.error('Failed to navigate to page:', error);\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    // Page size selector\r\n    const pageSizeSelect = paginationContainer.querySelector('.tablix-page-size-select');\r\n    if (pageSizeSelect) {\r\n      pageSizeSelect.addEventListener('change', async (e) => {\r\n        try {\r\n          const newPageSize = parseInt(e.target.value);\r\n          await this.table.paginationManager.changePageSize(newPageSize);\r\n        } catch (error) {\r\n          console.error('Failed to change page size:', error);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Escape HTML to prevent XSS attacks\r\n   */\r\n  escapeHtml(text) {\r\n    if (text == null) return '';\r\n    const div = document.createElement('div');\r\n    div.textContent = text.toString();\r\n    return div.innerHTML;\r\n  }\r\n\r\n  /**\r\n   * Render loading state\r\n   */\r\n  renderLoading() {\r\n    this.table.container.innerHTML = `<div class=\"tablix-loading\">${this.table.t('general.loading')}</div>`;\r\n  }\r\n\r\n  /**\r\n   * Render error state\r\n   */\r\n  renderError(error) {\r\n    this.table.container.innerHTML = `<div class=\"tablix-error\">${this.table.t('general.error')}: ${this.escapeHtml(error.message || error)}</div>`;\r\n  }\r\n\r\n  /**\r\n   * Render control panel\r\n   */\r\n  renderControls(position) {\r\n    const controlsOptions = this.table.options.controls;\r\n    const searchOptions = this.table.options.search || { enabled: false, placeholder: null };\r\n    \r\n    let html = `<div class=\"tablix-controls tablix-controls-${position}\">`;\r\n    \r\n    // Left side controls\r\n    html += '<div class=\"tablix-controls-left\">';\r\n    \r\n    // Pagination controls\r\n    if (controlsOptions.pagination && this.table.paginationManager) {\r\n      html += '<div class=\"tablix-control-group tablix-pagination-controls\">';\r\n      html += `<button type=\"button\" class=\"tablix-btn tablix-control-btn\" data-action=\"firstPage\">${this.table.t('pagination.first')}</button>`;\r\n      html += `<button type=\"button\" class=\"tablix-btn tablix-control-btn\" data-action=\"prevPage\">${this.table.t('pagination.previous')}</button>`;\r\n      html += `<button type=\"button\" class=\"tablix-btn tablix-control-btn\" data-action=\"nextPage\">${this.table.t('pagination.next')}</button>`;\r\n      html += `<button type=\"button\" class=\"tablix-btn tablix-control-btn\" data-action=\"lastPage\">${this.table.t('pagination.last')}</button>`;\r\n      html += '</div>';\r\n    }\r\n    \r\n    // Page size control\r\n    if (controlsOptions.pageSize && this.table.paginationManager) {\r\n      const pageSizeOptions = this.table.paginationManager.options.pageSizeOptions;\r\n      const currentPageSize = this.table.paginationManager.pageSize;\r\n      \r\n      html += '<div class=\"tablix-control-group tablix-page-size-group\">';\r\n      html += `<label for=\"tablix-page-size-select\">${this.table.t('general.show')}:</label>`;\r\n      html += '<select class=\"tablix-page-size-select\" id=\"tablix-page-size-select\">';\r\n      pageSizeOptions.forEach(size => {\r\n        const selected = size === currentPageSize ? ' selected' : '';\r\n        html += `<option value=\"${size}\"${selected}>${size}</option>`;\r\n      });\r\n      html += '</select>';\r\n      html += `<span>${this.table.t('general.entries')}</span>`;\r\n      html += '</div>';\r\n    }\r\n    \r\n    // Refresh control\r\n    if (controlsOptions.refresh) {\r\n      html += '<div class=\"tablix-control-group tablix-refresh-group\">';\r\n      html += `<button type=\"button\" class=\"tablix-btn tablix-control-btn\" data-action=\"refresh\" title=\"${this.table.t('controls.refresh')}\">⟳</button>`;\r\n      html += '</div>';\r\n    }\r\n    \r\n    html += '</div>'; // Close left controls\r\n    \r\n    // Right side controls\r\n    html += '<div class=\"tablix-controls-right\">';\r\n    \r\n    // Search control\r\n    if (controlsOptions.search && searchOptions.enabled) {\r\n      // Use localized placeholder or provided one\r\n      const placeholderText = searchOptions.placeholder || this.table.t('search.placeholder');\r\n      \r\n      html += '<div class=\"tablix-control-group tablix-search-group\">';\r\n      html += `<input type=\"text\" \r\n                      class=\"tablix-search-input\" \r\n                      id=\"tablix-search-input\" \r\n                      name=\"table-search\"\r\n                      placeholder=\"${placeholderText}\" />`;\r\n      html += `<button type=\"button\" class=\"tablix-btn tablix-search-clear\" title=\"${this.table.t('search.clear')}\" style=\"display: none;\">✕</button>`;\r\n      html += '</div>';\r\n    }\r\n    \r\n    html += '</div>'; // Close right controls\r\n    \r\n    html += '</div>'; // Close main controls container\r\n    \r\n    return html;\r\n  }\r\n\r\n  /**\r\n   * Bind control panel events\r\n   */\r\n  bindControlEvents() {\r\n    const wrapper = this.table.container.querySelector('.tablix-wrapper');\r\n    if (!wrapper) return;\r\n\r\n    // Page size selector\r\n    const pageSizeSelect = wrapper.querySelector('.tablix-page-size-select');\r\n    if (pageSizeSelect) {\r\n      pageSizeSelect.addEventListener('change', async (e) => {\r\n        try {\r\n          const newPageSize = parseInt(e.target.value);\r\n          await this.table.changePageSize(newPageSize);\r\n        } catch (error) {\r\n          console.error('Failed to change page size:', error);\r\n        }\r\n      });\r\n    }\r\n\r\n    // Control buttons\r\n    wrapper.addEventListener('click', async (e) => {\r\n      if (e.target.classList.contains('tablix-control-btn')) {\r\n        e.preventDefault();\r\n        const action = e.target.dataset.action;\r\n        \r\n        try {\r\n          switch (action) {\r\n            case 'firstPage':\r\n              await this.table.firstPage();\r\n              break;\r\n            case 'prevPage':\r\n              await this.table.prevPage();\r\n              break;\r\n            case 'nextPage':\r\n              await this.table.nextPage();\r\n              break;\r\n            case 'lastPage':\r\n              await this.table.lastPage();\r\n              break;\r\n            case 'refresh':\r\n              await this.handleRefresh();\r\n              break;\r\n            case 'export':\r\n              this.handleExport();\r\n              break;\r\n          }\r\n        } catch (error) {\r\n          console.error(`Failed to execute action ${action}:`, error);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Handle refresh functionality\r\n   */\r\n  async handleRefresh() {\r\n    this.table.eventManager.trigger('beforeRefresh');\r\n    \r\n    if (this.table.options.onRefresh && typeof this.table.options.onRefresh === 'function') {\r\n      // Custom refresh handler\r\n      try {\r\n        const newData = await this.table.options.onRefresh();\r\n        if (newData) {\r\n          await this.table.loadData(newData);\r\n        }\r\n      } catch (error) {\r\n        console.error('Custom refresh failed:', error);\r\n      }\r\n    } else if (this.table.paginationManager && this.table.paginationManager.options.mode === 'server') {\r\n      // Server-side refresh\r\n      await this.table.paginationManager.refreshTable();\r\n    } else {\r\n      // Client-side refresh - just re-render current data\r\n      await this.table.refreshTable();\r\n    }\r\n    \r\n    this.table.eventManager.trigger('afterRefresh');\r\n  }\r\n\r\n  /**\r\n   * Handle export functionality\r\n   */\r\n  handleExport() {\r\n    const data = this.table.getData();\r\n    const columns = this.table.options.columns || [];\r\n    \r\n    // Simple CSV export\r\n    let csv = columns.map(col => col.title || col.name).join(',') + '\\n';\r\n    \r\n    data.forEach(row => {\r\n      const values = columns.map(col => {\r\n        const value = row[col.name];\r\n        // Simple CSV escaping\r\n        return typeof value === 'string' && value.includes(',') \r\n          ? `\"${value.replace(/\"/g, '\"\"')}\"` \r\n          : value;\r\n      });\r\n      csv += values.join(',') + '\\n';\r\n    });\r\n    \r\n    // Download CSV\r\n    const blob = new Blob([csv], { type: 'text/csv' });\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = 'table-data.csv';\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    document.body.removeChild(a);\r\n    URL.revokeObjectURL(url);\r\n    \r\n    this.table.eventManager.trigger('afterExport', { data, format: 'csv' });\r\n  }\r\n\r\n  /**\r\n   * Bind sorting events to header columns\r\n   */\r\n  bindSortEvents() {\r\n    const headerRow = this.table.container.querySelector('.tablix-header-row');\r\n    if (!headerRow) return;\r\n\r\n    headerRow.addEventListener('click', async (e) => {\r\n      const th = e.target.closest('.tablix-sortable');\r\n      if (!th) return;\r\n\r\n      e.preventDefault();\r\n      \r\n      const columnName = th.dataset.column;\r\n      \r\n      try {\r\n        await this.table.toggleSort(columnName);\r\n      } catch (error) {\r\n        console.error('Failed to sort column:', error);\r\n      }\r\n    });\r\n\r\n    // Keyboard support for accessibility\r\n    headerRow.addEventListener('keydown', async (e) => {\r\n      const th = e.target.closest('.tablix-sortable');\r\n      if (!th || (e.key !== 'Enter' && e.key !== ' ')) return;\r\n\r\n      e.preventDefault();\r\n      \r\n      const columnName = th.dataset.column;\r\n      \r\n      try {\r\n        await this.table.toggleSort(columnName);\r\n      } catch (error) {\r\n        console.error('Failed to sort column:', error);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Bind row click events for selection\r\n   */\r\n  bindRowClickEvents() {\r\n    const tbody = this.table.container.querySelector('.tablix-tbody');\r\n    if (!tbody) return;\r\n\r\n    tbody.addEventListener('click', (e) => {\r\n      const row = e.target.closest('.tablix-row');\r\n      if (!row || row.classList.contains('tablix-empty-row')) return;\r\n\r\n      const globalRowIndex = parseInt(row.dataset.rowIndex, 10);\r\n      if (isNaN(globalRowIndex)) return;\r\n\r\n      // Convert global index to local index for current page data\r\n      let localRowIndex = globalRowIndex;\r\n      if (this.table.paginationManager && this.table.paginationManager.options.mode === 'client') {\r\n        const currentPage = this.table.paginationManager.currentPage;\r\n        const pageSize = this.table.paginationManager.pageSize;\r\n        localRowIndex = globalRowIndex - (currentPage - 1) * pageSize;\r\n      }\r\n\r\n      // Get current page data to find the clicked row\r\n      const currentData = this.getCurrentPageData();\r\n      if (localRowIndex >= 0 && localRowIndex < currentData.length) {\r\n        const rowData = currentData[localRowIndex];\r\n        \r\n        // Trigger row click event for SelectionManager with global index\r\n        this.table.eventManager.trigger('rowClick', {\r\n          rowData,\r\n          rowIndex: globalRowIndex, // Pass global index\r\n          localRowIndex: localRowIndex, // Also pass local index if needed\r\n          originalEvent: e\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get current page data (same logic as SelectionManager)\r\n   */\r\n  getCurrentPageData() {\r\n    if (this.table.paginationManager) {\r\n      return this.table.paginationManager.getCurrentPageData() || [];\r\n    }\r\n    return this.table.dataManager.getData();\r\n  }\r\n\r\n  /**\r\n   * Update sort indicators in headers\r\n   */\r\n  updateSortIndicators(currentSort) {\r\n    const headers = this.table.container.querySelectorAll('.tablix-th[data-column]');\r\n    \r\n    headers.forEach(th => {\r\n      const columnName = th.dataset.column;\r\n      const isSorted = currentSort && currentSort.column === columnName;\r\n      \r\n      // Remove all sort classes\r\n      th.classList.remove('tablix-sorted', 'tablix-sorted-asc', 'tablix-sorted-desc');\r\n      \r\n      const indicator = th.querySelector('.tablix-sort-indicator');\r\n      if (!indicator) return;\r\n\r\n      const arrow = indicator.querySelector('.tablix-sort-arrow');\r\n      if (!arrow) return;\r\n\r\n      if (isSorted) {\r\n        // Column is sorted\r\n        th.classList.add('tablix-sorted', `tablix-sorted-${currentSort.direction}`);\r\n        arrow.classList.remove('tablix-sort-none', 'tablix-sort-asc', 'tablix-sort-desc');\r\n        arrow.classList.add(`tablix-sort-${currentSort.direction}`);\r\n        arrow.textContent = currentSort.direction === 'asc' ? '↑' : '↓';\r\n        arrow.setAttribute('aria-label', `${this.table.t('sort.sorted')}${currentSort.direction === 'asc' ? this.table.t('sort.sortedAscending') : this.table.t('sort.sortedDescending')}`);\r\n        arrow.removeAttribute('data-sort-order');\r\n      } else {\r\n        // Column is not sorted\r\n        arrow.classList.remove('tablix-sort-asc', 'tablix-sort-desc');\r\n        arrow.classList.add('tablix-sort-none');\r\n        arrow.textContent = '↕';\r\n        arrow.setAttribute('aria-label', this.table.t('sort.notSorted'));\r\n        arrow.removeAttribute('data-sort-order');\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Check if a column is sortable\r\n   */\r\n  _isColumnSortable(column) {\r\n    if (!this.table.sortingManager) return false;\r\n    return this.table.sortingManager.isColumnSortable(column.name);\r\n  }\r\n\r\n  /**\r\n   * Get sort direction for a column\r\n   */\r\n  _getSortDirection(columnName) {\r\n    if (!this.table.sortingManager) return null;\r\n    return this.table.sortingManager.getSortDirection(columnName);\r\n  }\r\n}","export default class EventManager {\r\n  constructor() {\r\n    this.events = {};\r\n  }\r\n\r\n  on(event, callback) {\r\n    if (!this.events[event]) this.events[event] = [];\r\n    this.events[event].push(callback);\r\n  }\r\n\r\n  off(event, callback) {\r\n    if (this.events[event]) {\r\n      const index = this.events[event].indexOf(callback);\r\n      if (index > -1) {\r\n        this.events[event].splice(index, 1);\r\n      }\r\n    }\r\n  }\r\n\r\n  clear(event) {\r\n    if (event) {\r\n      this.events[event] = [];\r\n    } else {\r\n      this.events = {};\r\n    }\r\n  }\r\n\r\n  trigger(event, payload) {\r\n    (this.events[event] || []).forEach(cb => cb(payload));\r\n  }\r\n}","/**\r\n * PaginationManager handles both client-side and server-side pagination\r\n * \r\n * Features:\r\n * - Client-side: slices filtered data locally\r\n * - Server-side: calls async data loader with pagination params\r\n * - Consistent API regardless of pagination mode\r\n * - Event emission for page changes\r\n * - Customizable pagination controls\r\n */\r\nexport default class PaginationManager {\r\n  constructor(table, options = {}) {\r\n    this.table = table;\r\n    this.options = {\r\n      pageSize: 10,\r\n      mode: 'client', // 'client' or 'server'\r\n      showPageNumbers: true,\r\n      maxPageNumbers: 5,\r\n      showFirstLast: true,\r\n      showPrevNext: true,\r\n      showPageSizes: false,\r\n      pageSizeOptions: [10, 25, 50, 100],\r\n      serverDataLoader: null, // async function for server-side pagination\r\n      ...options\r\n    };\r\n\r\n    // Pagination state\r\n    this.currentPage = 1;\r\n    this.totalPages = 1;\r\n    this.totalRows = 0;\r\n    this.pageSize = this.options.pageSize;\r\n    this.isLoading = false;\r\n\r\n    // Event bindings\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.updatePaginationInfo();\r\n  }\r\n\r\n  /**\r\n   * Update pagination information based on current data\r\n   */\r\n  updatePaginationInfo(totalRows = null) {\r\n    if (this.options.mode === 'client') {\r\n      // For client-side pagination, calculate from filtered data\r\n      this.totalRows = this.table.dataManager.filteredData.length;\r\n    } else {\r\n      // For server-side pagination, total rows should be provided\r\n      this.totalRows = totalRows || this.totalRows;\r\n    }\r\n\r\n    this.totalPages = Math.ceil(this.totalRows / this.pageSize) || 1;\r\n    \r\n    // Ensure current page is within bounds\r\n    if (this.currentPage > this.totalPages) {\r\n      this.currentPage = this.totalPages;\r\n    }\r\n    if (this.currentPage < 1) {\r\n      this.currentPage = 1;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current page data\r\n   * For client-side: slice the filtered data\r\n   * For server-side: return cached data or trigger load\r\n   */\r\n  async getPageData() {\r\n    if (this.options.mode === 'client') {\r\n      return this.getClientPageData();\r\n    } else {\r\n      return await this.getServerPageData();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get page data for client-side pagination\r\n   */\r\n  getClientPageData() {\r\n    const start = (this.currentPage - 1) * this.pageSize;\r\n    const end = start + this.pageSize;\r\n    return this.table.dataManager.filteredData.slice(start, end);\r\n  }\r\n\r\n  /**\r\n   * Get current page data synchronously (for selection and other features)\r\n   * Returns the data that is currently displayed on the page\r\n   */\r\n  getCurrentPageData() {\r\n    if (this.options.mode === 'client') {\r\n      return this.getClientPageData();\r\n    } else {\r\n      // For server-side pagination, return the currently cached data\r\n      // This assumes the data has already been loaded by a previous getPageData call\r\n      return this.table.dataManager.getData();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get page data for server-side pagination\r\n   */\r\n  async getServerPageData() {\r\n    if (!this.options.serverDataLoader) {\r\n      throw new Error('Server data loader not configured for server-side pagination');\r\n    }\r\n\r\n    this.isLoading = true;\r\n    this.table.eventManager.trigger('beforePageLoad', {\r\n      page: this.currentPage,\r\n      pageSize: this.pageSize\r\n    });\r\n\r\n    try {\r\n      const result = await this.options.serverDataLoader({\r\n        page: this.currentPage,\r\n        pageSize: this.pageSize,\r\n        // Include current filter/sort state if available\r\n        filters: this.table.dataManager.currentFilters || {},\r\n        sorts: this.table.dataManager.currentSorts || []\r\n      });\r\n\r\n      // Expect result to have: { data: [], totalRows: number }\r\n      if (result.totalRows !== undefined) {\r\n        this.updatePaginationInfo(result.totalRows);\r\n      }\r\n\r\n      this.isLoading = false;\r\n      this.table.eventManager.trigger('afterPageLoad', {\r\n        page: this.currentPage,\r\n        pageSize: this.pageSize,\r\n        data: result.data,\r\n        totalRows: result.totalRows\r\n      });\r\n\r\n      return result.data;\r\n    } catch (error) {\r\n      this.isLoading = false;\r\n      this.table.eventManager.trigger('pageLoadError', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Navigate to specific page\r\n   */\r\n  async goToPage(pageNumber) {\r\n    const targetPage = Math.max(1, Math.min(pageNumber, this.totalPages));\r\n    \r\n    if (targetPage === this.currentPage) {\r\n      return;\r\n    }\r\n\r\n    const oldPage = this.currentPage;\r\n    this.currentPage = targetPage;\r\n\r\n    this.table.eventManager.trigger('beforePageChange', {\r\n      oldPage,\r\n      newPage: this.currentPage,\r\n      pageSize: this.pageSize\r\n    });\r\n\r\n    try {\r\n      await this.refreshTable();\r\n      \r\n      this.table.eventManager.trigger('afterPageChange', {\r\n        oldPage,\r\n        newPage: this.currentPage,\r\n        pageSize: this.pageSize\r\n      });\r\n    } catch (error) {\r\n      // Revert page change on error\r\n      this.currentPage = oldPage;\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to next page\r\n   */\r\n  async nextPage() {\r\n    if (this.currentPage < this.totalPages) {\r\n      await this.goToPage(this.currentPage + 1);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to previous page\r\n   */\r\n  async prevPage() {\r\n    if (this.currentPage > 1) {\r\n      await this.goToPage(this.currentPage - 1);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to first page\r\n   */\r\n  async firstPage() {\r\n    await this.goToPage(1);\r\n  }\r\n\r\n  /**\r\n   * Go to last page\r\n   */\r\n  async lastPage() {\r\n    await this.goToPage(this.totalPages);\r\n  }\r\n\r\n  /**\r\n   * Change page size\r\n   */\r\n  async changePageSize(newPageSize) {\r\n    if (newPageSize === this.pageSize) {\r\n      return;\r\n    }\r\n\r\n    const oldPageSize = this.pageSize;\r\n    this.pageSize = newPageSize;\r\n\r\n    // Try to maintain current position in the dataset\r\n    const currentRow = (this.currentPage - 1) * oldPageSize;\r\n    const newPage = Math.floor(currentRow / newPageSize) + 1;\r\n\r\n    this.updatePaginationInfo();\r\n    \r\n    this.table.eventManager.trigger('beforePageSizeChange', {\r\n      oldPageSize,\r\n      newPageSize: this.pageSize,\r\n      oldPage: this.currentPage,\r\n      newPage\r\n    });\r\n\r\n    this.currentPage = newPage;\r\n    await this.refreshTable();\r\n\r\n    this.table.eventManager.trigger('afterPageSizeChange', {\r\n      oldPageSize,\r\n      newPageSize: this.pageSize,\r\n      page: this.currentPage\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Refresh the table with current pagination settings\r\n   */\r\n  async refreshTable() {\r\n    const pageData = await this.getPageData();\r\n    this.table.renderer.renderTable(pageData);\r\n    this.table.renderer.renderPagination();\r\n  }\r\n\r\n  /**\r\n   * Reset pagination to first page (useful after filtering/sorting)\r\n   */\r\n  async resetToFirstPage() {\r\n    this.currentPage = 1;\r\n    this.updatePaginationInfo();\r\n    await this.refreshTable();\r\n  }\r\n\r\n  /**\r\n   * Get pagination state info\r\n   */\r\n  getInfo() {\r\n    const start = this.totalRows === 0 ? 0 : (this.currentPage - 1) * this.pageSize + 1;\r\n    const end = Math.min(this.currentPage * this.pageSize, this.totalRows);\r\n\r\n    return {\r\n      currentPage: this.currentPage,\r\n      totalPages: this.totalPages,\r\n      pageSize: this.pageSize,\r\n      totalRows: this.totalRows,\r\n      startRow: start,\r\n      endRow: end,\r\n      hasNextPage: this.currentPage < this.totalPages,\r\n      hasPrevPage: this.currentPage > 1,\r\n      isLoading: this.isLoading\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get page numbers to display in pagination controls\r\n   */\r\n  getPageNumbers() {\r\n    const maxPages = this.options.maxPageNumbers;\r\n    const pages = [];\r\n\r\n    if (this.totalPages <= maxPages) {\r\n      // Show all pages\r\n      for (let i = 1; i <= this.totalPages; i++) {\r\n        pages.push(i);\r\n      }\r\n    } else {\r\n      // Show truncated page numbers\r\n      const half = Math.floor(maxPages / 2);\r\n      let start = Math.max(1, this.currentPage - half);\r\n      let end = Math.min(this.totalPages, start + maxPages - 1);\r\n\r\n      // Adjust if we're near the end\r\n      if (end - start + 1 < maxPages) {\r\n        start = Math.max(1, end - maxPages + 1);\r\n      }\r\n\r\n      for (let i = start; i <= end; i++) {\r\n        pages.push(i);\r\n      }\r\n\r\n      // Add ellipsis indicators\r\n      if (start > 1) {\r\n        if (start > 2) pages.unshift('...');\r\n        pages.unshift(1);\r\n      }\r\n      if (end < this.totalPages) {\r\n        if (end < this.totalPages - 1) pages.push('...');\r\n        pages.push(this.totalPages);\r\n      }\r\n    }\r\n\r\n    return pages;\r\n  }\r\n\r\n  /**\r\n   * Enable/disable pagination\r\n   */\r\n  setEnabled(enabled) {\r\n    this.options.enabled = enabled;\r\n    this.table.renderer.renderPagination();\r\n  }\r\n\r\n  /**\r\n   * Switch between client and server mode\r\n   */\r\n  async setMode(mode, serverDataLoader = null) {\r\n    if (mode === this.options.mode) {\r\n      return;\r\n    }\r\n\r\n    this.options.mode = mode;\r\n    if (mode === 'server' && serverDataLoader) {\r\n      this.options.serverDataLoader = serverDataLoader;\r\n    }\r\n\r\n    // Reset to first page when switching modes\r\n    this.currentPage = 1;\r\n    this.updatePaginationInfo();\r\n    await this.refreshTable();\r\n  }\r\n}\r\n","/**\r\n * SortingManager - Handles all sorting functionality for TablixJS\r\n * Supports client-side and server-side sorting with custom sort functions\r\n */\r\nexport default class SortingManager {\r\n  constructor(table, options = {}) {\r\n    this.table = table;\r\n    this.options = {\r\n      enabled: true,\r\n      mode: 'client', // 'client' or 'server'\r\n      serverSortLoader: null, // Function to load data from server with sorting\r\n      defaultSortType: 'auto', // 'auto', 'string', 'number', 'date'\r\n      caseSensitive: false,\r\n      nullsFirst: false,\r\n      ...options\r\n    };\r\n\r\n    // Current sort state - single column only\r\n    this.currentSort = null; // { column: 'name', direction: 'asc' }\r\n    this.sortOrder = ['asc', 'desc', null]; // Click cycle order\r\n\r\n    // Predefined sort types\r\n    this.sortTypes = {\r\n      auto: this._autoSort.bind(this),\r\n      string: this._stringSort.bind(this),\r\n      number: this._numberSort.bind(this),\r\n      date: this._dateSort.bind(this),\r\n      boolean: this._booleanSort.bind(this)\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Sort by a column\r\n   * @param {string} columnName - Column to sort by\r\n   * @param {string|null} direction - 'asc', 'desc', or null (unsorted)\r\n   */\r\n  async sort(columnName, direction = 'asc') {\r\n    // Trigger beforeSort event\r\n    const beforeSortData = { columnName, direction, currentSort: this.currentSort };\r\n    this.table.eventManager.trigger('beforeSort', beforeSortData);\r\n\r\n    if (this.options.mode === 'server') {\r\n      await this._sortServer(columnName, direction);\r\n    } else {\r\n      this._sortClient(columnName, direction);\r\n    }\r\n\r\n    // Update UI\r\n    this.table.renderer.updateSortIndicators(this.currentSort);\r\n    \r\n    // Refresh table display\r\n    await this.table.refreshTable();\r\n\r\n    // Trigger afterSort event\r\n    this.table.eventManager.trigger('afterSort', {\r\n      columnName,\r\n      direction,\r\n      currentSort: this.currentSort\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Toggle sort for a column (handles click cycling)\r\n   */\r\n  async toggleSort(columnName) {\r\n    const currentDirection = this.currentSort && this.currentSort.column === columnName \r\n      ? this.currentSort.direction \r\n      : null;\r\n    \r\n    // Get next direction in cycle\r\n    const currentIndex = this.sortOrder.indexOf(currentDirection);\r\n    const nextDirection = this.sortOrder[(currentIndex + 1) % this.sortOrder.length];\r\n    \r\n    await this.sort(columnName, nextDirection);\r\n  }\r\n\r\n  /**\r\n   * Client-side sorting\r\n   */\r\n  _sortClient(columnName, direction) {\r\n    // Set current sort\r\n    if (direction !== null) {\r\n      this.currentSort = { column: columnName, direction };\r\n    } else {\r\n      this.currentSort = null;\r\n    }\r\n\r\n    // Apply sorting to data\r\n    this._applySorting();\r\n  }\r\n\r\n  /**\r\n   * Server-side sorting\r\n   */\r\n  async _sortServer(columnName, direction) {\r\n    if (!this.options.serverSortLoader) {\r\n      console.warn('Server-side sorting enabled but no serverSortLoader provided');\r\n      return;\r\n    }\r\n\r\n    // Set current sort\r\n    if (direction !== null) {\r\n      this.currentSort = { column: columnName, direction };\r\n    } else {\r\n      this.currentSort = null;\r\n    }\r\n\r\n    try {\r\n      // Load data from server with current sort state\r\n      const result = await this.options.serverSortLoader({\r\n        sort: this.currentSort,\r\n        filters: this.table.dataManager.currentFilters,\r\n        page: this.table.paginationManager ? this.table.paginationManager.currentPage : 1,\r\n        pageSize: this.table.paginationManager ? this.table.paginationManager.pageSize : 10\r\n      });\r\n\r\n      // Update data manager with new data\r\n      this.table.dataManager.setServerData(result.data, result.totalRows);\r\n      \r\n    } catch (error) {\r\n      console.error('Failed to load sorted data from server:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Apply current sort to filtered data\r\n   */\r\n  _applySorting() {\r\n    if (!this.currentSort) return;\r\n    \r\n    const columns = this.table.options.columns || [];\r\n    \r\n    this.table.dataManager.filteredData.sort((a, b) => {\r\n      // Support both 'name' and 'key' properties for column identification\r\n      const column = columns.find(col => (col.name === this.currentSort.column) || (col.key === this.currentSort.column));\r\n      const comparison = this._compareValues(\r\n        a[this.currentSort.column], \r\n        b[this.currentSort.column], \r\n        column\r\n      );\r\n      \r\n      return this.currentSort.direction === 'desc' ? -comparison : comparison;\r\n    });\r\n\r\n    // Reset pagination to first page after sorting\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.resetToFirstPage();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Compare two values based on column configuration\r\n   */\r\n  _compareValues(a, b, column) {\r\n    // Handle null/undefined values\r\n    if (a == null && b == null) return 0;\r\n    if (a == null) return this.options.nullsFirst ? -1 : 1;\r\n    if (b == null) return this.options.nullsFirst ? 1 : -1;\r\n\r\n    // Use custom sort function if provided\r\n    if (column && column.sortFunction) {\r\n      return column.sortFunction(a, b);\r\n    }\r\n\r\n    // Use specified sort type or auto-detect\r\n    const sortType = (column && column.sortType) || this.options.defaultSortType;\r\n    \r\n    if (this.sortTypes[sortType]) {\r\n      return this.sortTypes[sortType](a, b);\r\n    }\r\n\r\n    // Fallback to auto sort\r\n    return this._autoSort(a, b);\r\n  }\r\n\r\n  /**\r\n   * Auto-detect sort type and compare\r\n   */\r\n  _autoSort(a, b) {\r\n    // Try number comparison first\r\n    const numA = parseFloat(a);\r\n    const numB = parseFloat(b);\r\n    \r\n    if (!isNaN(numA) && !isNaN(numB)) {\r\n      return numA - numB;\r\n    }\r\n\r\n    // Try date comparison - be more strict about what constitutes a date\r\n    const dateA = new Date(a);\r\n    const dateB = new Date(b);\r\n    \r\n    // More strict date validation - check if it looks like a real date format\r\n    const isDateLike = (str) => {\r\n      return /^\\d{4}-\\d{2}-\\d{2}/.test(str) || /^\\d{1,2}\\/\\d{1,2}\\/\\d{4}/.test(str) || /^\\d{1,2}-\\d{1,2}-\\d{4}/.test(str);\r\n    };\r\n    \r\n    if (dateA.toString() !== 'Invalid Date' && dateB.toString() !== 'Invalid Date' && \r\n        isDateLike(String(a)) && isDateLike(String(b))) {\r\n      return dateA - dateB;\r\n    }\r\n\r\n    // Fall back to string comparison\r\n    return this._stringSort(a, b);\r\n  }\r\n\r\n  /**\r\n   * String comparison\r\n   */\r\n  _stringSort(a, b) {\r\n    const strA = String(a).trim();\r\n    const strB = String(b).trim();\r\n    \r\n    if (this.options.caseSensitive) {\r\n      return strA.localeCompare(strB);\r\n    }\r\n    \r\n    return strA.localeCompare(strB, undefined, { sensitivity: 'base' });\r\n  }\r\n\r\n  /**\r\n   * Number comparison\r\n   */\r\n  _numberSort(a, b) {\r\n    const numA = parseFloat(a);\r\n    const numB = parseFloat(b);\r\n    \r\n    if (isNaN(numA) && isNaN(numB)) return 0;\r\n    if (isNaN(numA)) return 1;\r\n    if (isNaN(numB)) return -1;\r\n    \r\n    return numA - numB;\r\n  }\r\n\r\n  /**\r\n   * Date comparison\r\n   */\r\n  _dateSort(a, b) {\r\n    const dateA = new Date(a);\r\n    const dateB = new Date(b);\r\n    \r\n    if (dateA.toString() === 'Invalid Date' && dateB.toString() === 'Invalid Date') return 0;\r\n    if (dateA.toString() === 'Invalid Date') return 1;\r\n    if (dateB.toString() === 'Invalid Date') return -1;\r\n    \r\n    return dateA - dateB;\r\n  }\r\n\r\n  /**\r\n   * Boolean comparison\r\n   */\r\n  _booleanSort(a, b) {\r\n    const boolA = Boolean(a);\r\n    const boolB = Boolean(b);\r\n    \r\n    if (boolA === boolB) return 0;\r\n    return boolA ? 1 : -1;\r\n  }\r\n\r\n  /**\r\n   * Clear all sorting\r\n   */  async clearSorting() {\r\n    this.currentSort = null;\r\n\r\n    if (this.options.mode === 'server') {\r\n      // Reload data without sorting\r\n      if (this.options.serverSortLoader) {\r\n        try {\r\n          const result = await this.options.serverSortLoader({\r\n            sort: null,\r\n            filters: this.table.dataManager.currentFilters,\r\n            page: this.table.paginationManager ? this.table.paginationManager.currentPage : 1,\r\n            pageSize: this.table.paginationManager ? this.table.paginationManager.pageSize : 10\r\n          });\r\n          \r\n          this.table.dataManager.setServerData(result.data, result.totalRows);\r\n        } catch (error) {\r\n          console.error('Failed to clear server sorting:', error);\r\n        }\r\n      }\r\n    }\r\n\r\n    // Update UI and refresh table\r\n    this.table.renderer.updateSortIndicators(null);\r\n    await this.table.refreshTable();\r\n    \r\n    this.table.eventManager.trigger('afterSort', { currentSort: null });\r\n  }\r\n\r\n  /**\r\n   * Get current sort state\r\n   */\r\n  getSortState() {\r\n    return {\r\n      sort: this.currentSort,\r\n      mode: this.options.mode\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Set sorting options\r\n   */\r\n  setOptions(newOptions) {\r\n    this.options = { ...this.options, ...newOptions };\r\n  }\r\n\r\n  /**\r\n   * Check if a column is sortable\r\n   */\r\n  isColumnSortable(columnName) {\r\n    if (!this.options.enabled) return false;\r\n    \r\n    const columns = this.table.options.columns || [];\r\n    const column = columns.find(col => col.name === columnName);\r\n    \r\n    return column && column.sortable !== false;\r\n  }\r\n\r\n  /**\r\n   * Get sort direction for a column\r\n   */\r\n  getSortDirection(columnName) {\r\n    return this.currentSort && this.currentSort.column === columnName \r\n      ? this.currentSort.direction \r\n      : null;\r\n  }\r\n}\r\n","/**\r\n * ColumnManager - Enhanced column formatting system for TablixJS\r\n * \r\n * Features:\r\n * - Flexible formatting with optional locale and formatOptions\r\n * - Supports text, date, currency, number, percent formats\r\n * - Custom renderer priority over formatting\r\n * - Extensible design for future format types\r\n * - Performance-optimized with cached formatters\r\n */\r\nexport default class ColumnManager {\r\n  constructor(table) {\r\n    this.table = table;\r\n    this.columns = [];\r\n    this.formatters = new Map(); // Cache for compiled formatters\r\n    this.supportedFormats = ['text', 'date', 'currency', 'number', 'percent'];\r\n  }\r\n\r\n  /**\r\n   * Initialize columns and prepare formatters\r\n   * @param {Array} columns - Array of column definitions\r\n   */\r\n  initializeColumns(columns = []) {\r\n    this.columns = columns.map(col => this.prepareColumn(col));\r\n    this.compileFormatters();\r\n    return this.columns;\r\n  }\r\n\r\n  /**\r\n   * Prepare and validate a single column definition\r\n   * @param {Object} column - Column definition\r\n   * @returns {Object} Prepared column\r\n   */\r\n  prepareColumn(column) {\r\n    const prepared = { ...column };\r\n\r\n    // Validate format if provided\r\n    if (prepared.format && !this.supportedFormats.includes(prepared.format)) {\r\n      console.warn(`TablixJS: Unsupported format type '${prepared.format}' for column '${prepared.name}'. Falling back to no formatting.`);\r\n      delete prepared.format;\r\n    }\r\n\r\n    // Ensure name property exists\r\n    if (!prepared.name) {\r\n      throw new Error('TablixJS: Column must have a \"name\" property');\r\n    }\r\n\r\n    // Set default title if not provided\r\n    if (!prepared.title) {\r\n      prepared.title = prepared.name;\r\n    }\r\n\r\n    return prepared;\r\n  }\r\n\r\n  /**\r\n   * Compile and cache formatter functions for columns with format specified\r\n   */\r\n  compileFormatters() {\r\n    this.formatters.clear();\r\n\r\n    this.columns.forEach(column => {\r\n      if (column.format) {\r\n        const formatter = this.createFormatter(column);\r\n        if (formatter) {\r\n          this.formatters.set(column.name, formatter);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Create a formatter function for a column\r\n   * @param {Object} column - Column definition\r\n   * @returns {Function|null} Formatter function\r\n   */\r\n  createFormatter(column) {\r\n    const { format, locale, formatOptions = {} } = column;\r\n\r\n    switch (format) {\r\n      case 'text':\r\n        return (value) => this.formatText(value);\r\n\r\n      case 'date':\r\n        return (value) => this.formatDate(value, locale, formatOptions);\r\n\r\n      case 'currency':\r\n        return (value) => this.formatCurrency(value, locale, formatOptions, column.currency);\r\n\r\n      case 'number':\r\n        return (value) => this.formatNumber(value, locale, formatOptions);\r\n\r\n      case 'percent':\r\n        return (value) => this.formatPercent(value, locale, formatOptions);\r\n\r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Format a cell value for a specific column\r\n   * @param {string} columnName - Column name\r\n   * @param {*} value - Cell value\r\n   * @param {Object} row - Full row data (for context)\r\n   * @returns {Object} Object with formatted value and metadata\r\n   */\r\n  formatCellValue(columnName, value, row) {\r\n    const column = this.getColumn(columnName);\r\n    \r\n    // Priority 1: Custom renderer (overrides everything)\r\n    if (column && column.renderer) {\r\n      // If renderer wants formatted value, provide it\r\n      const formatter = this.formatters.get(columnName);\r\n      const formattedValue = formatter ? formatter(value) : value;\r\n      const result = column.renderer(value, row, formattedValue);\r\n      return {\r\n        value: result,\r\n        isHtml: true // Custom renderers can return HTML\r\n      };\r\n    }\r\n\r\n    // Priority 2: Format using cached formatter\r\n    const formatter = this.formatters.get(columnName);\r\n    if (formatter) {\r\n      return {\r\n        value: formatter(value),\r\n        isHtml: false // Formatted values are safe text\r\n      };\r\n    }\r\n\r\n    // Priority 3: Return raw value\r\n    return {\r\n      value: value,\r\n      isHtml: false // Raw values need escaping\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get column definition by name\r\n   * @param {string} columnName - Column name\r\n   * @returns {Object|null} Column definition\r\n   */\r\n  getColumn(columnName) {\r\n    return this.columns.find(col => col.name === columnName) || null;\r\n  }\r\n\r\n  /**\r\n   * Get all columns\r\n   * @returns {Array} Array of column definitions\r\n   */\r\n  getColumns() {\r\n    return this.columns;\r\n  }\r\n\r\n  // =============================================================================\r\n  // FORMAT IMPLEMENTATIONS\r\n  // =============================================================================\r\n\r\n  /**\r\n   * Format text (basic string conversion with null/undefined handling)\r\n   * @param {*} value - Value to format\r\n   * @returns {string} Formatted text\r\n   */\r\n  formatText(value) {\r\n    if (value == null) return '';\r\n    return String(value);\r\n  }\r\n\r\n  /**\r\n   * Format date using Intl.DateTimeFormat\r\n   * @param {*} value - Date value (string, Date, timestamp)\r\n   * @param {string} locale - Locale string (optional)\r\n   * @param {Object} options - Intl.DateTimeFormat options\r\n   * @returns {string} Formatted date\r\n   */\r\n  formatDate(value, locale, options = {}) {\r\n    if (value == null) return '';\r\n\r\n    try {\r\n      const date = value instanceof Date ? value : new Date(value);\r\n      \r\n      if (isNaN(date.getTime())) {\r\n        return String(value); // Return original if invalid date\r\n      }\r\n\r\n      const formatter = new Intl.DateTimeFormat(locale, options);\r\n      return formatter.format(date);\r\n    } catch (error) {\r\n      console.warn('TablixJS: Date formatting error:', error);\r\n      return String(value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Format currency using Intl.NumberFormat\r\n   * @param {*} value - Numeric value\r\n   * @param {string} locale - Locale string (optional)\r\n   * @param {Object} options - Intl.NumberFormat options\r\n   * @param {string} currency - Currency code (e.g., 'USD', 'EUR')\r\n   * @returns {string} Formatted currency\r\n   */\r\n  formatCurrency(value, locale, options = {}, currency = 'USD') {\r\n    if (value == null) return '';\r\n\r\n    const numericValue = Number(value);\r\n    if (isNaN(numericValue)) {\r\n      return String(value);\r\n    }\r\n\r\n    try {\r\n      const formatOptions = {\r\n        style: 'currency',\r\n        currency: currency,\r\n        ...options\r\n      };\r\n\r\n      const formatter = new Intl.NumberFormat(locale, formatOptions);\r\n      return formatter.format(numericValue);\r\n    } catch (error) {\r\n      console.warn('TablixJS: Currency formatting error:', error);\r\n      return String(value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Format number using Intl.NumberFormat\r\n   * @param {*} value - Numeric value\r\n   * @param {string} locale - Locale string (optional)\r\n   * @param {Object} options - Intl.NumberFormat options\r\n   * @returns {string} Formatted number\r\n   */\r\n  formatNumber(value, locale, options = {}) {\r\n    if (value == null) return '';\r\n\r\n    const numericValue = Number(value);\r\n    if (isNaN(numericValue)) {\r\n      return String(value);\r\n    }\r\n\r\n    try {\r\n      const formatter = new Intl.NumberFormat(locale, options);\r\n      return formatter.format(numericValue);\r\n    } catch (error) {\r\n      console.warn('TablixJS: Number formatting error:', error);\r\n      return String(value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Format percentage using Intl.NumberFormat\r\n   * @param {*} value - Numeric value (0.5 = 50%)\r\n   * @param {string} locale - Locale string (optional)\r\n   * @param {Object} options - Intl.NumberFormat options\r\n   * @returns {string} Formatted percentage\r\n   */\r\n  formatPercent(value, locale, options = {}) {\r\n    if (value == null) return '';\r\n\r\n    const numericValue = Number(value);\r\n    if (isNaN(numericValue)) {\r\n      return String(value);\r\n    }\r\n\r\n    try {\r\n      const formatOptions = {\r\n        style: 'percent',\r\n        ...options\r\n      };\r\n\r\n      const formatter = new Intl.NumberFormat(locale, formatOptions);\r\n      return formatter.format(numericValue);\r\n    } catch (error) {\r\n      console.warn('TablixJS: Percent formatting error:', error);\r\n      return String(value);\r\n    }\r\n  }\r\n\r\n  // =============================================================================\r\n  // EXTENSIBILITY METHODS\r\n  // =============================================================================\r\n\r\n  /**\r\n   * Register a custom format type (for future extensibility)\r\n   * @param {string} formatType - Format type name\r\n   * @param {Function} formatterFactory - Function that creates formatter\r\n   */\r\n  registerFormat(formatType, formatterFactory) {\r\n    if (this.supportedFormats.includes(formatType)) {\r\n      console.warn(`TablixJS: Format type '${formatType}' already exists and will be overridden.`);\r\n    }\r\n\r\n    this.supportedFormats.push(formatType);\r\n    \r\n    // You would extend createFormatter method to handle this\r\n    // This is a placeholder for future plugin architecture\r\n    console.log(`TablixJS: Custom format '${formatType}' registered.`);\r\n  }\r\n\r\n  /**\r\n   * Get supported format types\r\n   * @returns {Array} Array of supported format type strings\r\n   */\r\n  getSupportedFormats() {\r\n    return [...this.supportedFormats];\r\n  }\r\n}\r\n","/**\r\n * FilterManager - Advanced column filtering system for TablixJS\r\n * \r\n * Features:\r\n * - Multi-column filtering with independent filter states\r\n * - Two filter types: \"value\" (checkbox selection) and \"condition\" (operators)\r\n * - Supports multiple conditions per column\r\n * - Extensible operator system for custom filters\r\n * - Integration with sorting and pagination\r\n */\r\nexport default class FilterManager {\r\n  constructor(table, options = {}) {\r\n    this.table = table;\r\n    this.options = {\r\n      enabled: true,\r\n      mode: 'client', // 'client' or 'server'\r\n      serverFilterLoader: null, // Function to load filtered data from server\r\n      debounceDelay: 300, // Debounce delay for input filters\r\n      showBadges: true, // Show filter count badges\r\n      showTooltips: true, // Show filter summary tooltips\r\n      ...options\r\n    };\r\n\r\n    // Filter state per column\r\n    this.columnFilters = new Map(); // { columnName: { type, config, isActive } }\r\n    \r\n    // Supported filter operators\r\n    this.operators = {\r\n      'none': { label: 'None', apply: () => true },\r\n      'isEmpty': { label: 'Is empty', apply: (value) => value === null || value === undefined || value === '' },\r\n      'isNotEmpty': { label: 'Is not empty', apply: (value) => value !== null && value !== undefined && value !== '' },\r\n      'equals': { label: 'Is equal to', apply: (value, filterValue) => String(value).toLowerCase() === String(filterValue).toLowerCase() },\r\n      'notEquals': { label: 'Is not equal to', apply: (value, filterValue) => String(value).toLowerCase() !== String(filterValue).toLowerCase() },\r\n      'beginsWith': { label: 'Begins with', apply: (value, filterValue) => String(value).toLowerCase().startsWith(String(filterValue).toLowerCase()) },\r\n      'endsWith': { label: 'Ends with', apply: (value, filterValue) => String(value).toLowerCase().endsWith(String(filterValue).toLowerCase()) },\r\n      'contains': { label: 'Contains', apply: (value, filterValue) => String(value).toLowerCase().includes(String(filterValue).toLowerCase()) },\r\n      'notContains': { label: 'Does not contain', apply: (value, filterValue) => !String(value).toLowerCase().includes(String(filterValue).toLowerCase()) }\r\n    };\r\n\r\n    // Debounce timer for input filtering\r\n    this.debounceTimer = null;\r\n\r\n    // Track open filter dropdowns\r\n    this.openDropdowns = new Set();\r\n  }\r\n\r\n  /**\r\n   * Apply filter to a specific column\r\n   * @param {string} columnName - Column to filter\r\n   * @param {Object} filterConfig - Filter configuration\r\n   */\r\n  async applyFilter(columnName, filterConfig) {\r\n    // Validate filter config\r\n    if (!this.validateFilterConfig(filterConfig)) {\r\n      console.warn(`TablixJS: Invalid filter config for column '${columnName}'`);\r\n      return;\r\n    }\r\n\r\n    // Trigger beforeFilter hook\r\n    const beforeFilterData = { \r\n      columnName, \r\n      filterConfig, \r\n      currentFilters: this.getActiveFilters() \r\n    };\r\n    this.table.eventManager.trigger('beforeFilter', beforeFilterData);\r\n\r\n    // Store filter state\r\n    this.columnFilters.set(columnName, {\r\n      type: filterConfig.type,\r\n      config: filterConfig,\r\n      isActive: this.isFilterActive(filterConfig)\r\n    });\r\n\r\n    if (this.options.mode === 'server') {\r\n      await this._filterServer();\r\n    } else {\r\n      this._filterClient();\r\n    }\r\n\r\n    // Update UI indicators\r\n    this.updateFilterIndicators();\r\n    \r\n    // Refresh table display\r\n    await this.table.refreshTable();\r\n\r\n    // Trigger afterFilter hook\r\n    this.table.eventManager.trigger('afterFilter', {\r\n      columnName,\r\n      filterConfig,\r\n      filteredData: this.table.dataManager.getData(),\r\n      activeFilters: this.getActiveFilters()\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Clear filter for a specific column\r\n   * @param {string} columnName - Column to clear filter for\r\n   */\r\n  async clearFilter(columnName) {\r\n    if (!this.columnFilters.has(columnName)) return;\r\n\r\n    const beforeFilterData = { \r\n      columnName, \r\n      filterConfig: null, \r\n      currentFilters: this.getActiveFilters() \r\n    };\r\n    this.table.eventManager.trigger('beforeFilter', beforeFilterData);\r\n\r\n    this.columnFilters.delete(columnName);\r\n\r\n    if (this.options.mode === 'server') {\r\n      await this._filterServer();\r\n    } else {\r\n      this._filterClient();\r\n    }\r\n\r\n    this.updateFilterIndicators();\r\n    await this.table.refreshTable();\r\n\r\n    this.table.eventManager.trigger('afterFilter', {\r\n      columnName,\r\n      filterConfig: null,\r\n      filteredData: this.table.dataManager.getData(),\r\n      activeFilters: this.getActiveFilters()\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Clear all filters\r\n   */\r\n  async clearAllFilters() {\r\n    if (this.columnFilters.size === 0) return;\r\n\r\n    const beforeFilterData = { \r\n      columnName: null, \r\n      filterConfig: null, \r\n      currentFilters: this.getActiveFilters() \r\n    };\r\n    this.table.eventManager.trigger('beforeFilter', beforeFilterData);\r\n\r\n    this.columnFilters.clear();\r\n\r\n    if (this.options.mode === 'server') {\r\n      await this._filterServer();\r\n    } else {\r\n      this._filterClient();\r\n    }\r\n\r\n    this.updateFilterIndicators();\r\n    await this.table.refreshTable();\r\n\r\n    this.table.eventManager.trigger('afterFilter', {\r\n      columnName: null,\r\n      filterConfig: null,\r\n      filteredData: this.table.dataManager.getData(),\r\n      activeFilters: this.getActiveFilters()\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get active filters\r\n   * @returns {Object} Active filters by column\r\n   */\r\n  getActiveFilters() {\r\n    const activeFilters = {};\r\n    for (const [columnName, filterState] of this.columnFilters) {\r\n      if (filterState.isActive) {\r\n        activeFilters[columnName] = filterState.config;\r\n      }\r\n    }\r\n    return activeFilters;\r\n  }\r\n\r\n  /**\r\n   * Get unique values for a column (for value filtering)\r\n   * @param {string} columnName - Column name\r\n   * @returns {Array} Unique values\r\n   */\r\n  getColumnUniqueValues(columnName) {\r\n    const data = this.table.dataManager.originalData;\r\n    const values = new Set();\r\n    \r\n    data.forEach(row => {\r\n      const value = row[columnName];\r\n      if (value !== null && value !== undefined) {\r\n        values.add(String(value));\r\n      }\r\n    });\r\n    \r\n    return Array.from(values).sort();\r\n  }\r\n\r\n  /**\r\n   * Get filter state for a column\r\n   * @param {string} columnName - Column name\r\n   * @returns {Object|null} Filter state\r\n   */\r\n  getColumnFilter(columnName) {\r\n    return this.columnFilters.get(columnName) || null;\r\n  }\r\n\r\n  /**\r\n   * Check if column has active filter\r\n   * @param {string} columnName - Column name\r\n   * @returns {boolean} Whether column has active filter\r\n   */\r\n  hasColumnFilter(columnName) {\r\n    const filter = this.columnFilters.get(columnName);\r\n    return filter && filter.isActive;\r\n  }\r\n\r\n  /**\r\n   * Validate filter configuration\r\n   * @param {Object} filterConfig - Filter configuration\r\n   * @returns {boolean} Whether config is valid\r\n   */\r\n  validateFilterConfig(filterConfig) {\r\n    if (!filterConfig || !filterConfig.type) return false;\r\n    \r\n    if (filterConfig.type === 'value') {\r\n      return Array.isArray(filterConfig.values);\r\n    }\r\n    \r\n    if (filterConfig.type === 'condition') {\r\n      return Array.isArray(filterConfig.conditions) && \r\n             filterConfig.conditions.every(cond => \r\n               cond.operator && this.operators[cond.operator]\r\n             );\r\n    }\r\n    \r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Check if filter config represents an active filter\r\n   * @param {Object} filterConfig - Filter configuration\r\n   * @returns {boolean} Whether filter is active\r\n   */\r\n  isFilterActive(filterConfig) {\r\n    if (!filterConfig) return false;\r\n    \r\n    if (filterConfig.type === 'value') {\r\n      return filterConfig.values && filterConfig.values.length > 0;\r\n    }\r\n    \r\n    if (filterConfig.type === 'condition') {\r\n      return filterConfig.conditions && \r\n             filterConfig.conditions.some(cond => \r\n               cond.operator && cond.operator !== 'none' && \r\n               (cond.operator === 'isEmpty' || cond.operator === 'isNotEmpty' || cond.value !== undefined)\r\n             );\r\n    }\r\n    \r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Client-side filtering\r\n   * @private\r\n   */\r\n  _filterClient() {\r\n    const originalData = this.table.dataManager.originalData;\r\n    const activeFilters = this.getActiveFilters();\r\n    \r\n    let filteredData;\r\n    if (Object.keys(activeFilters).length === 0) {\r\n      // No filters, show all data\r\n      filteredData = [...originalData];\r\n    } else {\r\n      // Apply all active filters\r\n      filteredData = originalData.filter(row => {\r\n        return Object.entries(activeFilters).every(([columnName, filterConfig]) => {\r\n          return this._testRowAgainstFilter(row, columnName, filterConfig);\r\n        });\r\n      });\r\n    }\r\n\r\n    // Update DataManager with filtered data\r\n    this.table.dataManager.setFilteredData(filteredData);\r\n  }\r\n\r\n  /**\r\n   * Server-side filtering\r\n   * @private\r\n   */\r\n  async _filterServer() {\r\n    if (!this.options.serverFilterLoader) {\r\n      console.warn('TablixJS: Server-side filtering enabled but no serverFilterLoader provided');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const result = await this.options.serverFilterLoader({\r\n        filters: this.getActiveFilters(),\r\n        sort: this.table.sortingManager ? this.table.sortingManager.currentSort : null,\r\n        page: this.table.paginationManager ? this.table.paginationManager.currentPage : 1,\r\n        pageSize: this.table.paginationManager ? this.table.paginationManager.pageSize : 10\r\n      });\r\n\r\n      this.table.dataManager.setServerData(result.data, result.totalRows);\r\n    } catch (error) {\r\n      console.error('Failed to load filtered data from server:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Test a row against a filter\r\n   * @param {Object} row - Data row\r\n   * @param {string} columnName - Column name\r\n   * @param {Object} filterConfig - Filter configuration\r\n   * @returns {boolean} Whether row passes filter\r\n   * @private\r\n   */\r\n  _testRowAgainstFilter(row, columnName, filterConfig) {\r\n    const cellValue = row[columnName];\r\n    \r\n    if (filterConfig.type === 'value') {\r\n      // Value filter: check if cell value is in selected values\r\n      return filterConfig.values.includes(String(cellValue));\r\n    }\r\n    \r\n    if (filterConfig.type === 'condition') {\r\n      // Condition filter: test all conditions (AND logic)\r\n      return filterConfig.conditions.every(condition => {\r\n        const operator = this.operators[condition.operator];\r\n        if (!operator) return true; // Unknown operator, pass\r\n        \r\n        return operator.apply(cellValue, condition.value);\r\n      });\r\n    }\r\n    \r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Update filter indicators in the UI\r\n   */\r\n  updateFilterIndicators() {\r\n    const headers = this.table.container.querySelectorAll('.tablix-th');\r\n    \r\n    headers.forEach(header => {\r\n      const columnName = header.dataset.column;\r\n      const hasFilter = this.hasColumnFilter(columnName);\r\n      const filterIndicator = header.querySelector('.tablix-filter-indicator');\r\n      \r\n      if (hasFilter) {\r\n        header.classList.add('tablix-filtered');\r\n        if (filterIndicator) {\r\n          filterIndicator.classList.add('tablix-filter-active');\r\n          \r\n          // Update badge if enabled\r\n          if (this.options.showBadges) {\r\n            this._updateFilterBadge(header, columnName);\r\n          }\r\n        }\r\n      } else {\r\n        header.classList.remove('tablix-filtered');\r\n        if (filterIndicator) {\r\n          filterIndicator.classList.remove('tablix-filter-active');\r\n          const badge = filterIndicator.querySelector('.tablix-filter-badge');\r\n          if (badge) badge.remove();\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Update filter badge for a column\r\n   * @param {Element} header - Header element\r\n   * @param {string} columnName - Column name\r\n   * @private\r\n   */\r\n  _updateFilterBadge(header, columnName) {\r\n    const filterIndicator = header.querySelector('.tablix-filter-indicator');\r\n    if (!filterIndicator) return;\r\n    \r\n    const filter = this.getColumnFilter(columnName);\r\n    if (!filter || !filter.isActive) return;\r\n    \r\n    let badgeText = '';\r\n    if (filter.type === 'value') {\r\n      badgeText = filter.config.values.length.toString();\r\n    } else if (filter.type === 'condition') {\r\n      const activeConditions = filter.config.conditions.filter(cond => \r\n        cond.operator && cond.operator !== 'none'\r\n      );\r\n      badgeText = activeConditions.length.toString();\r\n    }\r\n    \r\n    let badge = filterIndicator.querySelector('.tablix-filter-badge');\r\n    if (!badge && badgeText) {\r\n      badge = document.createElement('span');\r\n      badge.className = 'tablix-filter-badge';\r\n      filterIndicator.appendChild(badge);\r\n    }\r\n    \r\n    if (badge) {\r\n      badge.textContent = badgeText;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Register a custom filter operator\r\n   * @param {string} name - Operator name\r\n   * @param {Object} operator - Operator definition\r\n   */\r\n  registerOperator(name, operator) {\r\n    if (!operator.label || typeof operator.apply !== 'function') {\r\n      throw new Error('TablixJS: Custom operator must have label and apply function');\r\n    }\r\n    \r\n    this.operators[name] = operator;\r\n  }\r\n\r\n  /**\r\n   * Get available operators\r\n   * @returns {Object} Available operators\r\n   */\r\n  getOperators() {\r\n    return { ...this.operators };\r\n  }\r\n}\r\n","/**\r\n * FilterUI - User interface components for TablixJS filtering\r\n * Handles dropdown creation, event binding, and filter interactions\r\n */\r\nexport default class FilterUI {\r\n  constructor(filterManager) {\r\n    this.filterManager = filterManager;\r\n    this.table = filterManager.table;\r\n    \r\n    // Track open dropdowns\r\n    this.activeDropdown = null;\r\n    \r\n    // Bind methods to preserve context\r\n    this.handleDocumentClick = this.handleDocumentClick.bind(this);\r\n    this.handleFilterIconClick = this.handleFilterIconClick.bind(this);\r\n    \r\n    // Initialize event listeners\r\n    this.init();\r\n  }\r\n\r\n  /**\r\n   * Initialize the FilterUI\r\n   */\r\n  init() {\r\n    // Add document click listener to close dropdowns\r\n    document.addEventListener('click', this.handleDocumentClick);\r\n  }\r\n\r\n  /**\r\n   * Destroy FilterUI and clean up event listeners\r\n   */\r\n  destroy() {\r\n    document.removeEventListener('click', this.handleDocumentClick);\r\n    this.closeAllDropdowns();\r\n  }\r\n\r\n  /**\r\n   * Render filter icons in table headers\r\n   */\r\n  renderFilterIcons() {\r\n    const headers = this.table.container.querySelectorAll('.tablix-th');\r\n    \r\n    headers.forEach(header => {\r\n      const columnName = header.dataset.column;\r\n      if (!columnName) return;\r\n      \r\n      const thContent = header.querySelector('.tablix-th-content');\r\n      if (!thContent) return;\r\n      \r\n      // Check if filter icon already exists\r\n      let filterIndicator = header.querySelector('.tablix-filter-indicator');\r\n      \r\n      if (filterIndicator) {\r\n        // Update existing filter indicator with new translations\r\n        const filterIcon = filterIndicator.querySelector('.tablix-filter-icon');\r\n        if (filterIcon) {\r\n          filterIcon.title = this.table.t('filter.filterColumn');\r\n        }\r\n        return;\r\n      }\r\n      \r\n      // Create new filter indicator\r\n      filterIndicator = document.createElement('span');\r\n      filterIndicator.className = 'tablix-filter-indicator';\r\n      filterIndicator.innerHTML = `\r\n        <span class=\"tablix-filter-icon\" title=\"${this.table.t('filter.filterColumn')}\">⚪</span>\r\n      `;\r\n      \r\n      // Add click handler\r\n      filterIndicator.addEventListener('click', (e) => {\r\n        e.stopPropagation();\r\n        this.handleFilterIconClick(columnName, filterIndicator);\r\n      });\r\n      \r\n      // Insert after sort indicator or at end\r\n      const sortIndicator = thContent.querySelector('.tablix-sort-indicator');\r\n      if (sortIndicator) {\r\n        thContent.insertBefore(filterIndicator, sortIndicator.nextSibling);\r\n      } else {\r\n        thContent.appendChild(filterIndicator);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Handle filter icon click\r\n   * @param {string} columnName - Column name\r\n   * @param {Element} filterIndicator - Filter indicator element\r\n   */\r\n  handleFilterIconClick(columnName, filterIndicator) {\r\n    // Close any existing dropdown\r\n    this.closeAllDropdowns();\r\n    \r\n    // Create and show dropdown\r\n    const dropdown = this.createFilterDropdown(columnName);\r\n    this.showDropdown(dropdown, filterIndicator);\r\n    this.activeDropdown = { dropdown, columnName };\r\n  }\r\n\r\n  /**\r\n   * Handle document clicks to close dropdowns\r\n   * @param {Event} event - Click event\r\n   */\r\n  handleDocumentClick(event) {\r\n    if (this.activeDropdown) {\r\n      const dropdown = this.activeDropdown.dropdown;\r\n      if (!dropdown.contains(event.target)) {\r\n        this.closeAllDropdowns();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create filter dropdown for a column\r\n   * @param {string} columnName - Column name\r\n   * @returns {Element} Dropdown element\r\n   */\r\n  createFilterDropdown(columnName) {\r\n    const dropdown = document.createElement('div');\r\n    dropdown.className = 'tablix-filter-dropdown';\r\n    dropdown.innerHTML = this.renderDropdownContent(columnName);\r\n    \r\n    // Add event listeners\r\n    this.bindDropdownEvents(dropdown, columnName);\r\n    \r\n    return dropdown;\r\n  }\r\n\r\n  /**\r\n   * Render dropdown content\r\n   * @param {string} columnName - Column name\r\n   * @returns {string} HTML content\r\n   */\r\n  renderDropdownContent(columnName) {\r\n    const currentFilter = this.filterManager.getColumnFilter(columnName);\r\n    \r\n    return `\r\n      <div class=\"tablix-filter-dropdown-header\">\r\n        <h4>${this.table.t('filter.filter')}: ${columnName}</h4>\r\n        <button class=\"tablix-filter-close\" type=\"button\">×</button>\r\n      </div>\r\n      \r\n      <div class=\"tablix-filter-tabs\">\r\n        <button class=\"tablix-filter-tab ${!currentFilter || currentFilter.type === 'value' ? 'active' : ''}\" \r\n                data-tab=\"value\">${this.table.t('filter.filterByValue')}</button>\r\n        <button class=\"tablix-filter-tab ${currentFilter && currentFilter.type === 'condition' ? 'active' : ''}\" \r\n                data-tab=\"condition\">${this.table.t('filter.filterByCondition')}</button>\r\n      </div>\r\n      \r\n      <div class=\"tablix-filter-content\">\r\n        <div class=\"tablix-filter-panel tablix-filter-value-panel ${!currentFilter || currentFilter.type === 'value' ? 'active' : ''}\">\r\n          ${this.renderValueFilterPanel(columnName, currentFilter)}\r\n        </div>\r\n        \r\n        <div class=\"tablix-filter-panel tablix-filter-condition-panel ${currentFilter && currentFilter.type === 'condition' ? 'active' : ''}\">\r\n          ${this.renderConditionFilterPanel(columnName, currentFilter)}\r\n        </div>\r\n      </div>\r\n      \r\n      <div class=\"tablix-filter-actions\">\r\n        <button class=\"tablix-filter-apply\" type=\"button\">${this.table.t('filter.apply')}</button>\r\n        <button class=\"tablix-filter-clear\" type=\"button\">${this.table.t('filter.clear')}</button>\r\n        <button class=\"tablix-filter-cancel\" type=\"button\">${this.table.t('filter.cancel')}</button>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  /**\r\n   * Render value filter panel (checkbox list)\r\n   * @param {string} columnName - Column name\r\n   * @param {Object|null} currentFilter - Current filter state\r\n   * @returns {string} HTML content\r\n   */\r\n  renderValueFilterPanel(columnName, currentFilter) {\r\n    const uniqueValues = this.filterManager.getColumnUniqueValues(columnName);\r\n    const selectedValues = currentFilter && currentFilter.type === 'value' ? \r\n      currentFilter.config.values : [];\r\n    \r\n    if (uniqueValues.length === 0) {\r\n      return `<p class=\"tablix-filter-empty\">${this.table.t('filter.noValuesAvailable')}</p>`;\r\n    }\r\n    \r\n    let html = `\r\n      <div class=\"tablix-filter-search\">\r\n        <input type=\"text\" \r\n               id=\"tablix-filter-search-${columnName}\" \r\n               name=\"filter-search-${columnName}\"\r\n               placeholder=\"${this.table.t('filter.searchValues')}\" \r\n               class=\"tablix-filter-search-input\">\r\n      </div>\r\n      <div class=\"tablix-filter-select-all\">\r\n        <label>\r\n          <input type=\"checkbox\" \r\n                 id=\"tablix-filter-select-all-${columnName}\" \r\n                 name=\"filter-select-all-${columnName}\"\r\n                 class=\"tablix-filter-select-all-checkbox\"> ${this.table.t('filter.selectAll')}\r\n        </label>\r\n      </div>\r\n      <div class=\"tablix-filter-values\">\r\n    `;\r\n    \r\n    uniqueValues.forEach((value, index) => {\r\n      const isChecked = selectedValues.includes(value);\r\n      const valueId = `tablix-filter-value-${columnName}-${index}`;\r\n      html += `\r\n        <label class=\"tablix-filter-value-item\">\r\n          <input type=\"checkbox\" \r\n                 id=\"${valueId}\" \r\n                 name=\"filter-value-${columnName}\" \r\n                 value=\"${this.escapeHtml(value)}\" \r\n                 ${isChecked ? 'checked' : ''}>\r\n          <span class=\"tablix-filter-value-text\">${this.escapeHtml(value)}</span>\r\n        </label>\r\n      `;\r\n    });\r\n    \r\n    html += '</div>';\r\n    return html;\r\n  }\r\n\r\n  /**\r\n   * Render condition filter panel\r\n   * @param {string} columnName - Column name\r\n   * @param {Object|null} currentFilter - Current filter state\r\n   * @returns {string} HTML content\r\n   */\r\n  renderConditionFilterPanel(columnName, currentFilter) {\r\n    const conditions = currentFilter && currentFilter.type === 'condition' ? \r\n      currentFilter.config.conditions : [{ operator: 'none', value: '' }];\r\n    \r\n    let html = '<div class=\"tablix-filter-conditions\">';\r\n    \r\n    conditions.forEach((condition, index) => {\r\n      html += this.renderConditionRow(condition, index);\r\n    });\r\n    \r\n    html += `\r\n      </div>\r\n      <button class=\"tablix-filter-add-condition\" type=\"button\">+ ${this.table.t('filter.addCondition')}</button>\r\n    `;\r\n    \r\n    return html;\r\n  }\r\n\r\n  /**\r\n   * Render a single condition row\r\n   * @param {Object} condition - Condition object\r\n   * @param {number} index - Condition index\r\n   * @returns {string} HTML content\r\n   */\r\n  renderConditionRow(condition, index) {\r\n    const operators = this.filterManager.getOperators();\r\n    const needsValue = condition.operator && \r\n      !['none', 'isEmpty', 'isNotEmpty'].includes(condition.operator);\r\n    \r\n    let html = `\r\n      <div class=\"tablix-filter-condition\" data-index=\"${index}\">\r\n        <select class=\"tablix-filter-operator\" \r\n                id=\"tablix-filter-operator-${index}\" \r\n                name=\"filter-operator-${index}\">\r\n    `;\r\n    \r\n    Object.entries(operators).forEach(([key, op]) => {\r\n      const selected = condition.operator === key ? ' selected' : '';\r\n      html += `<option value=\"${key}\"${selected}>${op.label}</option>`;\r\n    });\r\n    \r\n    html += `\r\n        </select>\r\n        <input type=\"text\" \r\n               id=\"tablix-filter-value-${index}\" \r\n               name=\"filter-value-${index}\"\r\n               class=\"tablix-filter-value\" \r\n               placeholder=\"${this.table.t('filter.value')}\" \r\n               value=\"${this.escapeHtml(condition.value || '')}\"\r\n               ${needsValue ? '' : 'disabled'}>\r\n        <button class=\"tablix-filter-remove-condition\" \r\n                type=\"button\" \r\n                data-index=\"${index}\"\r\n                title=\"${this.table.t('filter.removeCondition')}\">×</button>\r\n      </div>\r\n    `;\r\n    \r\n    return html;\r\n  }\r\n\r\n  /**\r\n   * Bind dropdown event listeners\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @param {string} columnName - Column name\r\n   */\r\n  bindDropdownEvents(dropdown, columnName) {\r\n    // Tab switching\r\n    dropdown.querySelectorAll('.tablix-filter-tab').forEach(tab => {\r\n      tab.addEventListener('click', (e) => {\r\n        const tabType = e.target.dataset.tab;\r\n        this.switchTab(dropdown, tabType);\r\n      });\r\n    });\r\n\r\n    // Close button\r\n    dropdown.querySelector('.tablix-filter-close').addEventListener('click', () => {\r\n      this.closeAllDropdowns();\r\n    });\r\n\r\n    // Action buttons\r\n    dropdown.querySelector('.tablix-filter-apply').addEventListener('click', () => {\r\n      this.applyFilter(dropdown, columnName);\r\n    });\r\n\r\n    dropdown.querySelector('.tablix-filter-clear').addEventListener('click', () => {\r\n      this.clearFilter(columnName);\r\n    });\r\n\r\n    dropdown.querySelector('.tablix-filter-cancel').addEventListener('click', () => {\r\n      this.closeAllDropdowns();\r\n    });\r\n\r\n    // Value filter events\r\n    this.bindValueFilterEvents(dropdown, columnName);\r\n    \r\n    // Condition filter events\r\n    this.bindConditionFilterEvents(dropdown, columnName);\r\n  }\r\n\r\n  /**\r\n   * Bind value filter events\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @param {string} columnName - Column name\r\n   */\r\n  bindValueFilterEvents(dropdown, columnName) {\r\n    const valuePanel = dropdown.querySelector('.tablix-filter-value-panel');\r\n    if (!valuePanel) return;\r\n\r\n    // Search input with debouncing\r\n    const searchInput = valuePanel.querySelector('.tablix-filter-search-input');\r\n    if (searchInput) {\r\n      let searchTimeout;\r\n      searchInput.addEventListener('input', (e) => {\r\n        clearTimeout(searchTimeout);\r\n        searchTimeout = setTimeout(() => {\r\n          this.filterValueList(valuePanel, e.target.value);\r\n        }, this.filterManager.options.debounceDelay || 150);\r\n      });\r\n    }\r\n\r\n    // Select all checkbox\r\n    const selectAllCheckbox = valuePanel.querySelector('.tablix-filter-select-all-checkbox');\r\n    if (selectAllCheckbox) {\r\n      selectAllCheckbox.addEventListener('change', (e) => {\r\n        this.toggleSelectAll(valuePanel, e.target.checked);\r\n      });\r\n    }\r\n\r\n    // Individual value checkboxes\r\n    valuePanel.querySelectorAll('.tablix-filter-value-item input[type=\"checkbox\"]').forEach(checkbox => {\r\n      checkbox.addEventListener('change', () => {\r\n        this.updateSelectAllState(valuePanel);\r\n      });\r\n    });\r\n\r\n    // Update select all state based on current selections\r\n    this.updateSelectAllState(valuePanel);\r\n  }\r\n\r\n  /**\r\n   * Bind condition filter events\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @param {string} columnName - Column name\r\n   */\r\n  bindConditionFilterEvents(dropdown, columnName) {\r\n    const conditionPanel = dropdown.querySelector('.tablix-filter-condition-panel');\r\n    if (!conditionPanel) return;\r\n\r\n    // Add condition button\r\n    const addButton = conditionPanel.querySelector('.tablix-filter-add-condition');\r\n    if (addButton) {\r\n      addButton.addEventListener('click', () => {\r\n        this.addCondition(conditionPanel);\r\n      });\r\n    }\r\n\r\n    // Operator and value changes\r\n    this.bindConditionRowEvents(conditionPanel);\r\n  }\r\n\r\n  /**\r\n   * Bind events for condition rows\r\n   * @param {Element} conditionPanel - Condition panel element\r\n   */\r\n  bindConditionRowEvents(conditionPanel) {\r\n    // Operator changes\r\n    conditionPanel.querySelectorAll('.tablix-filter-operator').forEach(select => {\r\n      select.addEventListener('change', (e) => {\r\n        const valueInput = e.target.parentElement.querySelector('.tablix-filter-value');\r\n        const needsValue = !['none', 'isEmpty', 'isNotEmpty'].includes(e.target.value);\r\n        valueInput.disabled = !needsValue;\r\n        if (!needsValue) valueInput.value = '';\r\n      });\r\n    });\r\n\r\n    // Remove condition buttons\r\n    conditionPanel.querySelectorAll('.tablix-filter-remove-condition').forEach(button => {\r\n      button.addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        e.stopPropagation(); // Prevent dropdown from closing\r\n        \r\n        const conditionRow = e.target.closest('.tablix-filter-condition');\r\n        const conditionsContainer = conditionPanel.querySelector('.tablix-filter-conditions');\r\n        \r\n        if (conditionsContainer.querySelectorAll('.tablix-filter-condition').length > 1) {\r\n          conditionRow.remove();\r\n        } else {\r\n          // If it's the last condition, reset it to \"none\" instead of removing\r\n          const operatorSelect = conditionRow.querySelector('.tablix-filter-operator');\r\n          const valueInput = conditionRow.querySelector('.tablix-filter-value');\r\n          operatorSelect.value = 'none';\r\n          valueInput.value = '';\r\n          valueInput.disabled = true;\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Switch between filter tabs\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @param {string} tabType - Tab type ('value' or 'condition')\r\n   */\r\n  switchTab(dropdown, tabType) {\r\n    // Update tab buttons\r\n    dropdown.querySelectorAll('.tablix-filter-tab').forEach(tab => {\r\n      tab.classList.toggle('active', tab.dataset.tab === tabType);\r\n    });\r\n\r\n    // Update panels\r\n    dropdown.querySelectorAll('.tablix-filter-panel').forEach(panel => {\r\n      const isActive = panel.classList.contains(`tablix-filter-${tabType}-panel`);\r\n      panel.classList.toggle('active', isActive);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Filter value list based on search\r\n   * @param {Element} valuePanel - Value panel element\r\n   * @param {string} searchTerm - Search term\r\n   */\r\n  filterValueList(valuePanel, searchTerm) {\r\n    const items = valuePanel.querySelectorAll('.tablix-filter-value-item');\r\n    const term = searchTerm.toLowerCase();\r\n    \r\n    items.forEach(item => {\r\n      const text = item.querySelector('.tablix-filter-value-text').textContent.toLowerCase();\r\n      const matches = text.includes(term);\r\n      item.style.display = matches ? '' : 'none';\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Toggle select all checkboxes\r\n   * @param {Element} valuePanel - Value panel element\r\n   * @param {boolean} checked - Whether to check all\r\n   */\r\n  toggleSelectAll(valuePanel, checked) {\r\n    const checkboxes = valuePanel.querySelectorAll('.tablix-filter-value-item input[type=\"checkbox\"]');\r\n    checkboxes.forEach(checkbox => {\r\n      const item = checkbox.closest('.tablix-filter-value-item');\r\n      if (item.style.display !== 'none') {\r\n        checkbox.checked = checked;\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Update select all checkbox state\r\n   * @param {Element} valuePanel - Value panel element\r\n   */\r\n  updateSelectAllState(valuePanel) {\r\n    const selectAllCheckbox = valuePanel.querySelector('.tablix-filter-select-all-checkbox');\r\n    if (!selectAllCheckbox) return;\r\n\r\n    const checkboxes = valuePanel.querySelectorAll('.tablix-filter-value-item input[type=\"checkbox\"]');\r\n    const visibleCheckboxes = Array.from(checkboxes).filter(cb => \r\n      cb.closest('.tablix-filter-value-item').style.display !== 'none'\r\n    );\r\n    \r\n    const checkedCount = visibleCheckboxes.filter(cb => cb.checked).length;\r\n    \r\n    selectAllCheckbox.checked = checkedCount > 0 && checkedCount === visibleCheckboxes.length;\r\n    selectAllCheckbox.indeterminate = checkedCount > 0 && checkedCount < visibleCheckboxes.length;\r\n  }\r\n\r\n  /**\r\n   * Add a new condition row\r\n   * @param {Element} conditionPanel - Condition panel element\r\n   */\r\n  addCondition(conditionPanel) {\r\n    const conditionsContainer = conditionPanel.querySelector('.tablix-filter-conditions');\r\n    const newIndex = conditionsContainer.children.length;\r\n    \r\n    const conditionHtml = this.renderConditionRow({ operator: 'none', value: '' }, newIndex);\r\n    conditionsContainer.insertAdjacentHTML('beforeend', conditionHtml);\r\n    \r\n    // Bind events for the new condition only\r\n    const newCondition = conditionsContainer.lastElementChild;\r\n    \r\n    // Bind operator change event\r\n    const operatorSelect = newCondition.querySelector('.tablix-filter-operator');\r\n    operatorSelect.addEventListener('change', (e) => {\r\n      const valueInput = e.target.parentElement.querySelector('.tablix-filter-value');\r\n      const needsValue = !['none', 'isEmpty', 'isNotEmpty'].includes(e.target.value);\r\n      valueInput.disabled = !needsValue;\r\n      if (!needsValue) valueInput.value = '';\r\n    });\r\n\r\n    // Bind remove button event\r\n    const removeButton = newCondition.querySelector('.tablix-filter-remove-condition');\r\n    removeButton.addEventListener('click', (e) => {\r\n      e.preventDefault();\r\n      e.stopPropagation(); // Prevent dropdown from closing\r\n      \r\n      const conditionRow = e.target.closest('.tablix-filter-condition');\r\n      const conditionsContainer = conditionPanel.querySelector('.tablix-filter-conditions');\r\n      \r\n      if (conditionsContainer.querySelectorAll('.tablix-filter-condition').length > 1) {\r\n        conditionRow.remove();\r\n      } else {\r\n        // If it's the last condition, reset it to \"none\" instead of removing\r\n        const operatorSelect = conditionRow.querySelector('.tablix-filter-operator');\r\n        const valueInput = conditionRow.querySelector('.tablix-filter-value');\r\n        operatorSelect.value = 'none';\r\n        valueInput.value = '';\r\n        valueInput.disabled = true;\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Apply current filter settings\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @param {string} columnName - Column name\r\n   */\r\n  async applyFilter(dropdown, columnName) {\r\n    const activeTab = dropdown.querySelector('.tablix-filter-tab.active').dataset.tab;\r\n    let filterConfig;\r\n\r\n    if (activeTab === 'value') {\r\n      filterConfig = this.collectValueFilter(dropdown);\r\n    } else {\r\n      filterConfig = this.collectConditionFilter(dropdown);\r\n    }\r\n\r\n    await this.filterManager.applyFilter(columnName, filterConfig);\r\n    this.closeAllDropdowns();\r\n  }\r\n\r\n  /**\r\n   * Collect value filter configuration\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @returns {Object} Filter configuration\r\n   */\r\n  collectValueFilter(dropdown) {\r\n    const valuePanel = dropdown.querySelector('.tablix-filter-value-panel');\r\n    const checkboxes = valuePanel.querySelectorAll('.tablix-filter-value-item input[type=\"checkbox\"]:checked');\r\n    const values = Array.from(checkboxes).map(cb => cb.value);\r\n    \r\n    return {\r\n      type: 'value',\r\n      values: values\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Collect condition filter configuration\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @returns {Object} Filter configuration\r\n   */\r\n  collectConditionFilter(dropdown) {\r\n    const conditionPanel = dropdown.querySelector('.tablix-filter-condition-panel');\r\n    const conditionRows = conditionPanel.querySelectorAll('.tablix-filter-condition');\r\n    \r\n    const conditions = Array.from(conditionRows).map(row => {\r\n      const operator = row.querySelector('.tablix-filter-operator').value;\r\n      const value = row.querySelector('.tablix-filter-value').value;\r\n      \r\n      return { operator, value };\r\n    }).filter(cond => cond.operator !== 'none');\r\n    \r\n    return {\r\n      type: 'condition',\r\n      conditions: conditions\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Clear filter for column\r\n   * @param {string} columnName - Column name\r\n   */\r\n  async clearFilter(columnName) {\r\n    await this.filterManager.clearFilter(columnName);\r\n    this.closeAllDropdowns();\r\n  }\r\n\r\n  /**\r\n   * Show dropdown positioned relative to trigger element\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @param {Element} trigger - Trigger element\r\n   */\r\n  showDropdown(dropdown, trigger) {\r\n    document.body.appendChild(dropdown);\r\n    \r\n    // Make dropdown visible but off-screen to measure it\r\n    dropdown.style.position = 'absolute';\r\n    dropdown.style.top = '-9999px';\r\n    dropdown.style.left = '-9999px';\r\n    dropdown.style.display = 'block';\r\n    dropdown.style.visibility = 'hidden';\r\n    \r\n    // Force reflow to ensure accurate measurements\r\n    dropdown.offsetHeight;\r\n    \r\n    // Get accurate measurements\r\n    const triggerRect = trigger.getBoundingClientRect();\r\n    const dropdownRect = dropdown.getBoundingClientRect();\r\n    \r\n    let left = triggerRect.left + window.scrollX;\r\n    let top = triggerRect.bottom + window.scrollY + 5;\r\n    \r\n    // Adjust if dropdown goes off screen\r\n    if (left + dropdownRect.width > window.innerWidth + window.scrollX) {\r\n      left = window.innerWidth + window.scrollX - dropdownRect.width - 10;\r\n    }\r\n    \r\n    if (top + dropdownRect.height > window.innerHeight + window.scrollY) {\r\n      top = triggerRect.top + window.scrollY - dropdownRect.height - 5;\r\n    }\r\n    \r\n    // Ensure dropdown stays within viewport\r\n    left = Math.max(window.scrollX + 10, left);\r\n    top = Math.max(window.scrollY + 10, top);\r\n    \r\n    // Apply final positioning and make visible\r\n    dropdown.style.left = `${left}px`;\r\n    dropdown.style.top = `${top}px`;\r\n    dropdown.style.visibility = 'visible';\r\n  }\r\n\r\n  /**\r\n   * Close all open dropdowns\r\n   */\r\n  closeAllDropdowns() {\r\n    if (this.activeDropdown) {\r\n      this.activeDropdown.dropdown.remove();\r\n      this.activeDropdown = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Escape HTML to prevent XSS\r\n   * @param {string} text - Text to escape\r\n   * @returns {string} Escaped text\r\n   */\r\n  escapeHtml(text) {\r\n    const div = document.createElement('div');\r\n    div.textContent = text;\r\n    return div.innerHTML;\r\n  }\r\n}\r\n","/**\r\n * SearchManager - Global search functionality for TablixJS\r\n * Provides real-time search across all table columns\r\n */\r\nexport default class SearchManager {\r\n  constructor(table, options = {}) {\r\n    this.table = table;\r\n    this.options = {\r\n      enabled: true,\r\n      placeholder: 'Search...',\r\n      searchDelay: 300, // Debounce delay in milliseconds\r\n      caseSensitive: false,\r\n      searchColumns: [], // Empty array means search all columns\r\n      minLength: 1, // Minimum characters before search starts (changed from 0 to 1)\r\n      ...options\r\n    };\r\n\r\n    // Ensure placeholder is never undefined to prevent \"undefined\" from showing in UI\r\n    if (!this.options.placeholder) {\r\n      this.options.placeholder = 'Search...';\r\n    }\r\n\r\n    // Current search state\r\n    this.currentSearchTerm = '';\r\n    this.searchTimeout = null;\r\n    this.originalData = null;\r\n\r\n    // Bind methods to preserve context\r\n    this.handleSearchInput = this.handleSearchInput.bind(this);\r\n    this.handleSearchClear = this.handleSearchClear.bind(this);\r\n  }\r\n\r\n  /**\r\n   * Initialize search functionality\r\n   */\r\n  init() {\r\n    // Store reference to original data\r\n    this.originalData = this.table.dataManager.originalData;\r\n    \r\n    // Listen for data changes\r\n    this.table.eventManager.on('afterLoad', (data) => {\r\n      this.originalData = data.data || data.source;\r\n      // Reapply search if there's an active search term\r\n      if (this.currentSearchTerm) {\r\n        this.performSearch(this.currentSearchTerm);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Bind search events to UI elements\r\n   */\r\n  bindEvents() {\r\n    const searchInput = this.table.container.querySelector('.tablix-search-input');\r\n    const searchClear = this.table.container.querySelector('.tablix-search-clear');\r\n\r\n    if (searchInput) {\r\n      // Ensure input value matches current search term\r\n      if (this.currentSearchTerm && searchInput.value !== this.currentSearchTerm) {\r\n        searchInput.value = this.currentSearchTerm;\r\n      }\r\n      \r\n      searchInput.addEventListener('input', this.handleSearchInput);\r\n      searchInput.addEventListener('keydown', (e) => {\r\n        if (e.key === 'Escape') {\r\n          this.clearSearch();\r\n        }\r\n      });\r\n    }\r\n\r\n    if (searchClear) {\r\n      searchClear.addEventListener('click', this.handleSearchClear);\r\n    }\r\n\r\n    // Update clear button visibility\r\n    this.updateClearButtonVisibility();\r\n  }\r\n\r\n  /**\r\n   * Handle search input with debouncing\r\n   * @param {Event} event - Input event\r\n   */\r\n  handleSearchInput(event) {\r\n    const searchTerm = event.target.value;\r\n    \r\n    // Clear existing timeout\r\n    if (this.searchTimeout) {\r\n      clearTimeout(this.searchTimeout);\r\n    }\r\n\r\n    // Debounce search based on configurable delay\r\n    this.searchTimeout = setTimeout(() => {\r\n      this.performSearch(searchTerm);\r\n    }, this.options.searchDelay);\r\n  }\r\n\r\n  /**\r\n   * Handle search clear button\r\n   * @param {Event} event - Click event\r\n   */\r\n  handleSearchClear(event) {\r\n    event.preventDefault();\r\n    this.clearSearch();\r\n  }\r\n\r\n  /**\r\n   * Perform the actual search\r\n   * @param {string} searchTerm - Search term\r\n   */\r\n  async performSearch(searchTerm) {\r\n    const previousTerm = this.currentSearchTerm;\r\n    \r\n    // Capture focus state before performing search\r\n    const searchInput = this.table.container.querySelector('.tablix-search-input');\r\n    const hadFocus = searchInput && document.activeElement === searchInput;\r\n    const cursorPosition = searchInput ? searchInput.selectionStart || 0 : 0;\r\n    \r\n    // Trigger beforeSearch event with more detailed information\r\n    const beforeSearchData = { \r\n      searchTerm, \r\n      previousTerm,\r\n      minLength: this.options.minLength,\r\n      searchDelay: this.options.searchDelay,\r\n      willSearch: searchTerm.length >= this.options.minLength\r\n    };\r\n    \r\n    this.table.eventManager.trigger('beforeSearch', beforeSearchData);\r\n\r\n    this.currentSearchTerm = searchTerm;\r\n\r\n    // If search term is below minimum length, show all data\r\n    if (searchTerm.length < this.options.minLength) {\r\n      this.table.dataManager.filteredData = [...this.originalData];\r\n    } else {\r\n      // Filter data based on search term\r\n      const filteredData = this.filterData(searchTerm);\r\n      this.table.dataManager.filteredData = filteredData;\r\n    }\r\n\r\n    // Reset pagination to first page\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.resetToFirstPage();\r\n    }\r\n\r\n    // Refresh table display\r\n    await this.table.refreshTable();\r\n\r\n    // Restore focus after table refresh if it had focus before\r\n    if (hadFocus) {\r\n      requestAnimationFrame(() => {\r\n        const newSearchInput = this.table.container.querySelector('.tablix-search-input');\r\n        if (newSearchInput) {\r\n          newSearchInput.focus();\r\n          if (cursorPosition > 0 && cursorPosition <= newSearchInput.value.length) {\r\n            newSearchInput.setSelectionRange(cursorPosition, cursorPosition);\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    // Trigger afterSearch event with detailed results\r\n    const afterSearchData = {\r\n      searchTerm,\r\n      previousTerm,\r\n      resultsCount: this.table.dataManager.filteredData.length,\r\n      totalCount: this.originalData.length,\r\n      isActive: this.isSearchActive(),\r\n      searchPerformed: searchTerm.length >= this.options.minLength\r\n    };\r\n    \r\n    this.table.eventManager.trigger('afterSearch', afterSearchData);\r\n\r\n    // Update search clear button visibility\r\n    this.updateClearButtonVisibility();\r\n  }\r\n\r\n  /**\r\n   * Filter data based on search term\r\n   * @param {string} searchTerm - Search term\r\n   * @returns {Array} Filtered data\r\n   */\r\n  filterData(searchTerm) {\r\n    if (!searchTerm || searchTerm.trim() === '') {\r\n      return [...this.originalData];\r\n    }\r\n\r\n    const term = this.options.caseSensitive ? searchTerm : searchTerm.toLowerCase();\r\n    const columns = this.getSearchableColumns();\r\n\r\n    return this.originalData.filter(row => {\r\n      return columns.some(columnName => {\r\n        const cellValue = row[columnName];\r\n        if (cellValue === null || cellValue === undefined) {\r\n          return false;\r\n        }\r\n\r\n        const stringValue = this.options.caseSensitive ? \r\n          String(cellValue) : \r\n          String(cellValue).toLowerCase();\r\n\r\n        return stringValue.includes(term);\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get columns to search in\r\n   * @returns {Array} Array of column names\r\n   */\r\n  getSearchableColumns() {\r\n    // If specific columns are configured, use those\r\n    if (this.options.searchColumns && this.options.searchColumns.length > 0) {\r\n      return this.options.searchColumns;\r\n    }\r\n\r\n    // Otherwise, search all available columns\r\n    const columns = this.table.columnManager ? \r\n      this.table.columnManager.getColumns() : \r\n      (this.table.options.columns || []);\r\n\r\n    return columns.map(col => col.name || col.key).filter(name => name);\r\n  }\r\n\r\n  /**\r\n   * Clear search\r\n   */\r\n  async clearSearch() {\r\n    // Clear search input using the helper method\r\n    this.updateInputValue('');\r\n\r\n    // Clear search timeout\r\n    if (this.searchTimeout) {\r\n      clearTimeout(this.searchTimeout);\r\n      this.searchTimeout = null;\r\n    }\r\n\r\n    // Perform empty search to reset data\r\n    await this.performSearch('');\r\n  }\r\n\r\n  /**\r\n   * Update clear button visibility\r\n   */\r\n  updateClearButtonVisibility() {\r\n    const searchClear = this.table.container.querySelector('.tablix-search-clear');\r\n    if (searchClear) {\r\n      searchClear.style.display = this.currentSearchTerm ? 'block' : 'none';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update input value without triggering search\r\n   * @param {string} value - Value to set\r\n   */\r\n  updateInputValue(value) {\r\n    const searchInput = this.table.container.querySelector('.tablix-search-input');\r\n    if (searchInput && searchInput.value !== value) {\r\n      searchInput.value = value;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set search term programmatically\r\n   * @param {string} searchTerm - Search term\r\n   */\r\n  async setSearchTerm(searchTerm) {\r\n    // Update input value\r\n    this.updateInputValue(searchTerm);\r\n    \r\n    // Clear any pending search timeout\r\n    if (this.searchTimeout) {\r\n      clearTimeout(this.searchTimeout);\r\n      this.searchTimeout = null;\r\n    }\r\n    \r\n    // Perform search immediately\r\n    await this.performSearch(searchTerm);\r\n  }\r\n\r\n  /**\r\n   * Get current search term\r\n   * @returns {string} Current search term\r\n   */\r\n  getSearchTerm() {\r\n    return this.currentSearchTerm;\r\n  }\r\n\r\n  /**\r\n   * Check if search is active\r\n   * @returns {boolean} Whether search is active\r\n   */\r\n  isSearchActive() {\r\n    return this.currentSearchTerm && this.currentSearchTerm.length >= this.options.minLength;\r\n  }\r\n\r\n  /**\r\n   * Get search results count\r\n   * @returns {Object} Search results information\r\n   */\r\n  getSearchInfo() {\r\n    return {\r\n      searchTerm: this.currentSearchTerm,\r\n      resultsCount: this.table.dataManager.filteredData.length,\r\n      totalCount: this.originalData.length,\r\n      isActive: this.isSearchActive()\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Configure search options\r\n   * @param {Object} newOptions - New options to merge\r\n   */\r\n  configure(newOptions) {\r\n    const oldOptions = { ...this.options };\r\n    this.options = { ...this.options, ...newOptions };\r\n    \r\n    // Ensure placeholder is never undefined\r\n    if (!this.options.placeholder) {\r\n      this.options.placeholder = 'Search...';\r\n    }\r\n    \r\n    // Update placeholder if it changed\r\n    if (newOptions.placeholder && newOptions.placeholder !== oldOptions.placeholder) {\r\n      const searchInput = this.table.container.querySelector('.tablix-search-input');\r\n      if (searchInput) {\r\n        searchInput.placeholder = this.options.placeholder;\r\n      }\r\n    }\r\n    \r\n    // If minLength changed and we have an active search, re-evaluate\r\n    if (newOptions.minLength !== undefined && this.currentSearchTerm) {\r\n      this.performSearch(this.currentSearchTerm);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current search configuration\r\n   * @returns {Object} Current search options\r\n   */\r\n  getConfiguration() {\r\n    return { ...this.options };\r\n  }\r\n\r\n  /**\r\n   * Destroy search manager and clean up\r\n   */\r\n  destroy() {\r\n    if (this.searchTimeout) {\r\n      clearTimeout(this.searchTimeout);\r\n    }\r\n\r\n    const searchInput = this.table.container.querySelector('.tablix-search-input');\r\n    const searchClear = this.table.container.querySelector('.tablix-search-clear');\r\n\r\n    if (searchInput) {\r\n      searchInput.removeEventListener('input', this.handleSearchInput);\r\n    }\r\n\r\n    if (searchClear) {\r\n      searchClear.removeEventListener('click', this.handleSearchClear);\r\n    }\r\n  }\r\n}\r\n","export default class SelectionManager {\r\n  constructor(table, options = {}) {\r\n    this.table = table;\r\n    this.options = {\r\n      enabled: false,\r\n      mode: 'single', // 'single' or 'multi'\r\n      ...options\r\n    };\r\n    \r\n    // Selection state - use stable data IDs/keys, not row indexes\r\n    this.selectedRows = new Set(); // Set of row IDs/keys\r\n    this.lastSelectedRow = null; // For range selection with shift+click\r\n    \r\n    // Track row ID mapping for stable selection across pagination/sorting/filtering\r\n    this.rowIdMap = new Map(); // Maps data objects to their stable IDs\r\n    this.dataIdKey = options.dataIdKey || 'id'; // Key to use as stable row ID\r\n    \r\n    // Drag selection state\r\n    this.dragSelection = {\r\n      isActive: false,\r\n      startRowIndex: null,\r\n      currentRowIndex: null,\r\n      startRowId: null,\r\n      originalSelection: null, // Backup of selection before drag started\r\n      isDragging: false,\r\n      dragThreshold: 3 // Minimum pixels to move before considering it a drag\r\n    };\r\n    \r\n    // Track event listeners for proper cleanup\r\n    this.eventListeners = [];\r\n    \r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.eventListenersSetup = false; // Track if event listeners are already set up\r\n    \r\n    if (this.options.enabled) {\r\n      this.setupEventListeners();\r\n    }\r\n  }\r\n\r\n  setupEventListeners() {\r\n    // Prevent setting up listeners multiple times\r\n    if (this.eventListenersSetup) {\r\n      return;\r\n    }\r\n    \r\n    this.eventListenersSetup = true;\r\n    \r\n    // Listen for row clicks\r\n    this.table.eventManager.on('rowClick', (event) => {\r\n      this.handleRowClick(event);\r\n    });\r\n    \r\n    // Listen for drag selection events (only in multi mode and when NOT using virtual scrolling)\r\n    if (this.options.mode === 'multi' && !this.table.virtualScrollManager) {\r\n      this.setupDragSelection();\r\n    }\r\n    \r\n    // Clear selection when data changes\r\n    this.table.eventManager.on('beforeLoad', () => {\r\n      this.clearSelection();\r\n    });\r\n    \r\n    // Update selection state after data operations\r\n    this.table.eventManager.on('afterLoad', () => {\r\n      this.updateSelectionAfterDataChange();\r\n    });\r\n    \r\n    // Update selection UI after rendering\r\n    this.table.eventManager.on('afterRender', () => {\r\n      this.updateUI();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Handle row click events for selection\r\n   * @param {Object} event - Row click event data\r\n   */\r\n  handleRowClick(event) {\r\n    // Safety check - ensure table and managers are still available\r\n    if (!this.table || !this.options.enabled) {\r\n      return;\r\n    }\r\n\r\n    // If this was a drag operation, don't process as a click\r\n    if (this.dragSelection.isDragging) {\r\n      this.dragSelection.isDragging = false;\r\n      return;\r\n    }\r\n\r\n    const { rowData, rowIndex, originalEvent } = event;\r\n    const rowId = this.getRowId(rowData);\r\n    \r\n    // Debug logging for modifier keys\r\n    console.log('SelectionManager handleRowClick:', {\r\n      rowId,\r\n      hasOriginalEvent: !!originalEvent,\r\n      ctrlKey: originalEvent ? originalEvent.ctrlKey : 'no event',\r\n      shiftKey: originalEvent ? originalEvent.shiftKey : 'no event',\r\n      metaKey: originalEvent ? originalEvent.metaKey : 'no event',\r\n      timestamp: Date.now()\r\n    });\r\n    \r\n    // Prevent default and stop propagation to avoid duplicate events\r\n    if (originalEvent) {\r\n      originalEvent.preventDefault();\r\n      originalEvent.stopPropagation();\r\n    }\r\n\r\n    // Fire beforeSelect event\r\n    const beforeSelectEvent = {\r\n      rowData,\r\n      rowId,\r\n      currentSelection: Array.from(this.selectedRows),\r\n      isCtrlClick: originalEvent && (originalEvent.ctrlKey || originalEvent.metaKey),\r\n      isShiftClick: originalEvent && originalEvent.shiftKey,\r\n      isDragSelection: false\r\n    };\r\n    \r\n    if (this.table && this.table.eventManager) {\r\n      this.table.eventManager.trigger('beforeSelect', beforeSelectEvent);\r\n    }\r\n\r\n    if (this.options.mode === 'single') {\r\n      this.handleSingleSelection(rowId, rowData);\r\n    } else if (this.options.mode === 'multi') {\r\n      this.handleMultiSelection(rowId, rowData, originalEvent);\r\n    }\r\n\r\n    this.updateUI();\r\n    \r\n    // Fire afterSelect event\r\n    const afterSelectEvent = {\r\n      rowData,\r\n      rowId,\r\n      selectedRows: Array.from(this.selectedRows),\r\n      selectedData: this.getSelectedData(),\r\n      isDragSelection: false\r\n    };\r\n    \r\n    if (this.table && this.table.eventManager) {\r\n      this.table.eventManager.trigger('afterSelect', afterSelectEvent);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle single row selection\r\n   * @param {String} rowId - Stable row identifier\r\n   * @param {Object} rowData - Row data object\r\n   */\r\n  handleSingleSelection(rowId, rowData) {\r\n    // In single mode, if the row is already selected, deselect it\r\n    if (this.selectedRows.has(rowId)) {\r\n      this.selectedRows.clear();\r\n      this.lastSelectedRow = null;\r\n    } else {\r\n      // Otherwise, select only the clicked row\r\n      this.selectedRows.clear();\r\n      this.selectedRows.add(rowId);\r\n      this.lastSelectedRow = rowId;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle multi row selection with ctrl+click and shift+click\r\n   * @param {String} rowId - Stable row identifier\r\n   * @param {Object} rowData - Row data object\r\n   * @param {Event} originalEvent - Original mouse event\r\n   */\r\n  handleMultiSelection(rowId, rowData, originalEvent) {\r\n    const isCtrlClick = originalEvent && (originalEvent.ctrlKey || originalEvent.metaKey);\r\n    const isShiftClick = originalEvent && originalEvent.shiftKey;\r\n\r\n    console.log('handleMultiSelection DETAILED:', {\r\n      rowId,\r\n      isCtrlClick,\r\n      isShiftClick,\r\n      'originalEvent.ctrlKey': originalEvent ? originalEvent.ctrlKey : 'no event',\r\n      'originalEvent.metaKey': originalEvent ? originalEvent.metaKey : 'no event',\r\n      'originalEvent.shiftKey': originalEvent ? originalEvent.shiftKey : 'no event',\r\n      lastSelectedRow: this.lastSelectedRow,\r\n      currentSelection: Array.from(this.selectedRows),\r\n      selectionSize: this.selectedRows.size\r\n    });\r\n\r\n    if (isShiftClick && this.lastSelectedRow) {\r\n      // Range selection: select all rows between last selected and current\r\n      console.log('Executing range selection from', this.lastSelectedRow, 'to', rowId);\r\n      this.handleRangeSelection(rowId);\r\n    } else if (isCtrlClick) {\r\n      // Toggle selection of individual row\r\n      console.log('Executing ctrl+click toggle for', rowId);\r\n      if (this.selectedRows.has(rowId)) {\r\n        this.selectedRows.delete(rowId);\r\n        console.log('Ctrl+click: Deselected', rowId);\r\n        // Update lastSelectedRow to another selected row or null\r\n        this.lastSelectedRow = this.selectedRows.size > 0 ? Array.from(this.selectedRows)[0] : null;\r\n      } else {\r\n        this.selectedRows.add(rowId);\r\n        this.lastSelectedRow = rowId;\r\n        console.log('Ctrl+click: Added', rowId, 'to selection. Total selected:', this.selectedRows.size);\r\n      }\r\n    } else {\r\n      // Normal click: select only this row (clear previous selection)\r\n      console.log('Executing normal click for', rowId);\r\n      this.selectedRows.clear();\r\n      this.selectedRows.add(rowId);\r\n      this.lastSelectedRow = rowId;\r\n      console.log('Normal click: Selected only', rowId);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle range selection with shift+click\r\n   * @param {String} endRowId - End row ID for range selection\r\n   */\r\n  handleRangeSelection(endRowId) {\r\n    const fullData = this.getFullData();\r\n    \r\n    // Find indices in the full dataset\r\n    const startIndex = fullData.findIndex(row => this.getRowId(row) === this.lastSelectedRow);\r\n    const endIndex = fullData.findIndex(row => this.getRowId(row) === endRowId);\r\n\r\n    if (startIndex === -1 || endIndex === -1) {\r\n      // Fallback to single selection if we can't find the range\r\n      this.selectedRows.clear();\r\n      this.selectedRows.add(endRowId);\r\n      this.lastSelectedRow = endRowId;\r\n      return;\r\n    }\r\n\r\n    // Select all rows in range\r\n    const minIndex = Math.min(startIndex, endIndex);\r\n    const maxIndex = Math.max(startIndex, endIndex);\r\n    \r\n    for (let i = minIndex; i <= maxIndex; i++) {\r\n      const rowId = this.getRowId(fullData[i]);\r\n      this.selectedRows.add(rowId);\r\n    }\r\n  }\r\n\r\n  // ===== DRAG SELECTION METHODS =====\r\n\r\n  /**\r\n   * Setup drag selection event listeners\r\n   */\r\n  setupDragSelection() {\r\n    const tableElement = this.table.container;\r\n    if (!tableElement) return;\r\n\r\n    let startX, startY;\r\n\r\n    // Mouse down on table body\r\n    tableElement.addEventListener('mousedown', (e) => {\r\n      if (!this.table || !this.options.enabled || this.options.mode !== 'multi') return;\r\n      \r\n      const row = e.target.closest('.tablix-row');\r\n      if (!row || row.classList.contains('tablix-empty-row')) return;\r\n\r\n      const globalRowIndex = parseInt(row.dataset.rowIndex, 10);\r\n      if (isNaN(globalRowIndex)) return;\r\n\r\n      // Only start drag selection if not using modifier keys\r\n      if (e.ctrlKey || e.metaKey || e.shiftKey) return;\r\n\r\n      startX = e.clientX;\r\n      startY = e.clientY;\r\n\r\n      this.dragSelection.isActive = true;\r\n      this.dragSelection.startRowIndex = globalRowIndex; // Store global index\r\n      this.dragSelection.currentRowIndex = globalRowIndex;\r\n      this.dragSelection.isDragging = false;\r\n      \r\n      // Store original selection for potential restoration\r\n      this.dragSelection.originalSelection = new Set(this.selectedRows);\r\n\r\n      // Get start row data using global index\r\n      const fullData = this.getFullData();\r\n      if (globalRowIndex < fullData.length) {\r\n        this.dragSelection.startRowId = this.getRowId(fullData[globalRowIndex]);\r\n      }\r\n\r\n      e.preventDefault();\r\n    });\r\n\r\n    // Mouse move - handle drag selection\r\n    tableElement.addEventListener('mousemove', (e) => {\r\n      if (!this.table || !this.dragSelection.isActive) return;\r\n\r\n      const deltaX = Math.abs(e.clientX - startX);\r\n      const deltaY = Math.abs(e.clientY - startY);\r\n\r\n      // Check if we've moved enough to consider it a drag\r\n      if (!this.dragSelection.isDragging && \r\n          (deltaX > this.dragSelection.dragThreshold || deltaY > this.dragSelection.dragThreshold)) {\r\n        this.dragSelection.isDragging = true;\r\n        this.startDragSelection();\r\n      }\r\n\r\n      if (this.dragSelection.isDragging) {\r\n        this.updateDragSelection(e);\r\n      }\r\n    });\r\n\r\n    // Mouse up - complete drag selection\r\n    tableElement.addEventListener('mouseup', (e) => {\r\n      if (!this.table || !this.dragSelection.isActive) return;\r\n      this.completeDragSelection();\r\n    });\r\n\r\n    // Mouse leave - cancel drag selection\r\n    tableElement.addEventListener('mouseleave', (e) => {\r\n      if (!this.table || !this.dragSelection.isActive) return;\r\n      this.cancelDragSelection();\r\n    });\r\n\r\n    // Prevent text selection during drag\r\n    tableElement.addEventListener('selectstart', (e) => {\r\n      if (this.dragSelection.isDragging) {\r\n        e.preventDefault();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Start drag selection\r\n   */\r\n  startDragSelection() {\r\n    if (!this.table || !this.table.container) {\r\n      console.warn('SelectionManager: Cannot start drag selection - table not available');\r\n      return;\r\n    }\r\n    \r\n    // Add drag selection class to table for styling\r\n    const tableWrapper = this.table.container.querySelector('.tablix-wrapper');\r\n    if (tableWrapper) {\r\n      tableWrapper.classList.add('tablix-drag-selecting');\r\n    }\r\n\r\n    // Fire beforeSelect event for drag start\r\n    const fullData = this.getFullData();\r\n    if (this.dragSelection.startRowIndex < fullData.length) {\r\n      const startRowData = fullData[this.dragSelection.startRowIndex];\r\n      const beforeSelectEvent = {\r\n        rowData: startRowData,\r\n        rowId: this.dragSelection.startRowId,\r\n        currentSelection: Array.from(this.selectedRows),\r\n        isCtrlClick: false,\r\n        isShiftClick: false,\r\n        isDragSelection: true,\r\n        dragStart: true\r\n      };\r\n      \r\n      this.table.eventManager.trigger('beforeSelect', beforeSelectEvent);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update drag selection based on current mouse position\r\n   */\r\n  updateDragSelection(event) {\r\n    const row = event.target.closest('.tablix-row');\r\n    if (!row || row.classList.contains('tablix-empty-row')) return;\r\n\r\n    const globalRowIndex = parseInt(row.dataset.rowIndex, 10);\r\n    if (isNaN(globalRowIndex)) return;\r\n\r\n    if (globalRowIndex !== this.dragSelection.currentRowIndex) {\r\n      this.dragSelection.currentRowIndex = globalRowIndex;\r\n      this.applyDragSelection();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Apply current drag selection range\r\n   */\r\n  applyDragSelection() {\r\n    // Always use full dataset for drag selection (global indices)\r\n    const fullData = this.getFullData();\r\n    \r\n    // Calculate selection range using global indices\r\n    const startIndex = this.dragSelection.startRowIndex;\r\n    const endIndex = this.dragSelection.currentRowIndex;\r\n    const minIndex = Math.min(startIndex, endIndex);\r\n    const maxIndex = Math.max(startIndex, endIndex);\r\n\r\n    // Start with original selection (preserve existing selections)\r\n    this.selectedRows = new Set(this.dragSelection.originalSelection);\r\n\r\n    // Add drag range to selection\r\n    for (let i = minIndex; i <= maxIndex; i++) {\r\n      if (i < fullData.length) {\r\n        const rowId = this.getRowId(fullData[i]);\r\n        this.selectedRows.add(rowId);\r\n      }\r\n    }\r\n\r\n    // Update last selected row\r\n    if (endIndex < fullData.length) {\r\n      this.lastSelectedRow = this.getRowId(fullData[endIndex]);\r\n    }\r\n\r\n    // Update UI immediately for responsive feedback\r\n    this.updateUI();\r\n  }\r\n\r\n  /**\r\n   * Complete drag selection\r\n   */\r\n  completeDragSelection() {\r\n    if (!this.table || !this.table.container) {\r\n      console.warn('SelectionManager: Cannot complete drag selection - table not available');\r\n      return;\r\n    }\r\n    \r\n    const tableWrapper = this.table.container.querySelector('.tablix-wrapper');\r\n    if (tableWrapper) {\r\n      tableWrapper.classList.remove('tablix-drag-selecting');\r\n    }\r\n\r\n    if (this.dragSelection.isDragging) {\r\n      // Fire final afterSelect event\r\n      const afterSelectEvent = {\r\n        selectedRows: Array.from(this.selectedRows),\r\n        selectedData: this.getSelectedData(),\r\n        isDragSelection: true,\r\n        dragComplete: true\r\n      };\r\n      \r\n      this.table.eventManager.trigger('afterSelect', afterSelectEvent);\r\n    }\r\n\r\n    this.resetDragSelection();\r\n  }\r\n\r\n  /**\r\n   * Cancel drag selection and restore original state\r\n   */\r\n  cancelDragSelection() {\r\n    if (!this.table || !this.table.container) {\r\n      console.warn('SelectionManager: Cannot cancel drag selection - table not available');\r\n      return;\r\n    }\r\n    \r\n    const tableWrapper = this.table.container.querySelector('.tablix-wrapper');\r\n    if (tableWrapper) {\r\n      tableWrapper.classList.remove('tablix-drag-selecting');\r\n    }\r\n\r\n    // Restore original selection\r\n    this.selectedRows = new Set(this.dragSelection.originalSelection);\r\n    this.updateUI();\r\n\r\n    this.resetDragSelection();\r\n  }\r\n\r\n  /**\r\n   * Reset drag selection state\r\n   */\r\n  resetDragSelection() {\r\n    this.dragSelection.isActive = false;\r\n    this.dragSelection.startRowIndex = null;\r\n    this.dragSelection.currentRowIndex = null;\r\n    this.dragSelection.startRowId = null;\r\n    this.dragSelection.originalSelection = null;\r\n    this.dragSelection.isDragging = false;\r\n  }\r\n\r\n  /**\r\n   * Get stable row ID from row data\r\n   * @param {Object} rowData - Row data object\r\n   * @returns {String} Stable row identifier\r\n   */\r\n  getRowId(rowData) {\r\n    if (typeof rowData[this.dataIdKey] !== 'undefined') {\r\n      return String(rowData[this.dataIdKey]);\r\n    }\r\n    \r\n    // Fallback: create a hash of the row data for identification\r\n    return this.createRowHash(rowData);\r\n  }\r\n\r\n  /**\r\n   * Create a simple hash from row data for identification\r\n   * @param {Object} rowData - Row data object\r\n   * @returns {String} Hash string\r\n   */\r\n  createRowHash(rowData) {\r\n    const str = JSON.stringify(rowData);\r\n    let hash = 0;\r\n    for (let i = 0; i < str.length; i++) {\r\n      const char = str.charCodeAt(i);\r\n      hash = ((hash << 5) - hash) + char;\r\n      hash = hash & hash; // Convert to 32-bit integer\r\n    }\r\n    return String(hash);\r\n  }\r\n\r\n  /**\r\n   * Get current page data for range selection\r\n   * @returns {Array} Current page data\r\n   */\r\n  getCurrentPageData() {\r\n    if (!this.table || !this.table.dataManager) {\r\n      console.warn('SelectionManager: Table or dataManager is not available');\r\n      return [];\r\n    }\r\n    \r\n    // If using virtual scrolling, return full dataset\r\n    if (this.table.virtualScrollManager) {\r\n      return this.table.dataManager.getData();\r\n    }\r\n    // Otherwise use pagination if available\r\n    if (this.table.paginationManager) {\r\n      return this.table.paginationManager.getCurrentPageData() || [];\r\n    }\r\n    return this.table.dataManager.getData();\r\n  }\r\n\r\n  /**\r\n   * Get the full dataset for virtual scrolling operations\r\n   * @returns {Array} Full dataset\r\n   */\r\n  getFullData() {\r\n    if (!this.table || !this.table.dataManager) {\r\n      console.warn('SelectionManager: Table or dataManager is not available');\r\n      return [];\r\n    }\r\n    return this.table.dataManager.getData();\r\n  }\r\n\r\n  /**\r\n   * Update UI to reflect current selection\r\n   */\r\n  updateUI() {\r\n    if (!this.options.enabled || !this.table || !this.table.container) {\r\n      return;\r\n    }\r\n\r\n    const tableElement = this.table.container.querySelector('.tablix-table');\r\n    if (!tableElement) {\r\n      return;\r\n    }\r\n\r\n    // Remove existing selection classes\r\n    const allRows = tableElement.querySelectorAll('.tablix-row');\r\n    allRows.forEach(row => {\r\n      row.classList.remove('tablix-selected', 'tablix-last-selected');\r\n    });\r\n\r\n    // Check if we're in virtual scroll mode by looking for data-virtual-index attributes\r\n    const hasVirtualIndexes = allRows.length > 0 && allRows[0].hasAttribute('data-virtual-index');\r\n    \r\n    if (hasVirtualIndexes) {\r\n      // Virtual scrolling mode: use data-virtual-index to match against full dataset\r\n      const fullData = this.getFullData();\r\n      allRows.forEach((row) => {\r\n        const virtualIndex = parseInt(row.getAttribute('data-virtual-index'));\r\n        if (!isNaN(virtualIndex) && virtualIndex < fullData.length) {\r\n          const rowData = fullData[virtualIndex];\r\n          const rowId = this.getRowId(rowData);\r\n          \r\n          if (this.selectedRows.has(rowId)) {\r\n            row.classList.add('tablix-selected');\r\n            \r\n            // Mark the last selected row for special styling\r\n            if (rowId === this.lastSelectedRow) {\r\n              row.classList.add('tablix-last-selected');\r\n            }\r\n          }\r\n        }\r\n      });\r\n    } else {\r\n      // Regular mode: match by global row index with full dataset\r\n      const fullData = this.getFullData();\r\n      allRows.forEach((row) => {\r\n        // Get global row index from data attribute\r\n        const globalRowIndex = row.hasAttribute('data-row-index') ? \r\n          parseInt(row.getAttribute('data-row-index')) : -1;\r\n          \r\n        if (globalRowIndex >= 0 && globalRowIndex < fullData.length) {\r\n          const rowData = fullData[globalRowIndex];\r\n          const rowId = this.getRowId(rowData);\r\n          \r\n          if (this.selectedRows.has(rowId)) {\r\n            row.classList.add('tablix-selected');\r\n            \r\n            // Mark the last selected row for special styling\r\n            if (rowId === this.lastSelectedRow) {\r\n              row.classList.add('tablix-last-selected');\r\n            }\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update selection state after data changes (pagination, filtering, sorting)\r\n   */\r\n  updateSelectionAfterDataChange() {\r\n    if (!this.options.enabled) {\r\n      return;\r\n    }\r\n\r\n    if (this.table.virtualScrollManager) {\r\n      // For virtual scrolling: keep all selections as the data is the same, just rendered differently\r\n      // Only need to update UI\r\n      this.updateUI();\r\n    } else {\r\n      // For pagination: keep all selections, but validate they still exist in the full dataset\r\n      const fullData = this.getFullData();\r\n      const allDataRowIds = new Set(fullData.map(row => this.getRowId(row)));\r\n      \r\n      // Remove selections for rows that no longer exist in the dataset at all\r\n      const newSelection = new Set();\r\n      this.selectedRows.forEach(rowId => {\r\n        if (allDataRowIds.has(rowId)) {\r\n          newSelection.add(rowId);\r\n        }\r\n      });\r\n      \r\n      this.selectedRows = newSelection;\r\n      \r\n      // Update last selected row if it no longer exists in the dataset\r\n      if (this.lastSelectedRow && !allDataRowIds.has(this.lastSelectedRow)) {\r\n        this.lastSelectedRow = this.selectedRows.size > 0 ? Array.from(this.selectedRows)[0] : null;\r\n      }\r\n      \r\n      this.updateUI();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get selected row data\r\n   * @returns {Array} Array of selected row data objects\r\n   */\r\n  getSelectedData() {\r\n    if (!this.options.enabled || this.selectedRows.size === 0) {\r\n      return [];\r\n    }\r\n\r\n    // Get all data (including filtered/sorted) to find selected rows\r\n    const allData = this.getFullData();\r\n    return allData.filter(row => this.selectedRows.has(this.getRowId(row)));\r\n  }\r\n\r\n  /**\r\n   * Get selected row IDs\r\n   * @returns {Array} Array of selected row IDs\r\n   */\r\n  getSelectedIds() {\r\n    return Array.from(this.selectedRows);\r\n  }\r\n\r\n  /**\r\n   * Programmatically select rows by ID\r\n   * @param {String|Array} rowIds - Single row ID or array of row IDs\r\n   */\r\n  selectRows(rowIds) {\r\n    if (!this.options.enabled) {\r\n      return;\r\n    }\r\n\r\n    const ids = Array.isArray(rowIds) ? rowIds : [rowIds];\r\n    \r\n    if (this.options.mode === 'single' && ids.length > 1) {\r\n      console.warn('SelectionManager: Cannot select multiple rows in single mode');\r\n      return;\r\n    }\r\n\r\n    if (this.options.mode === 'single') {\r\n      this.selectedRows.clear();\r\n    }\r\n\r\n    ids.forEach(id => {\r\n      this.selectedRows.add(String(id));\r\n    });\r\n\r\n    if (ids.length > 0) {\r\n      this.lastSelectedRow = String(ids[ids.length - 1]);\r\n    }\r\n\r\n    this.updateUI();\r\n    \r\n    // Fire afterSelect event\r\n    this.table.eventManager.trigger('afterSelect', {\r\n      selectedRows: Array.from(this.selectedRows),\r\n      selectedData: this.getSelectedData()\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Programmatically deselect rows by ID\r\n   * @param {String|Array} rowIds - Single row ID or array of row IDs\r\n   */\r\n  deselectRows(rowIds) {\r\n    if (!this.options.enabled) {\r\n      return;\r\n    }\r\n\r\n    const ids = Array.isArray(rowIds) ? rowIds : [rowIds];\r\n    \r\n    ids.forEach(id => {\r\n      this.selectedRows.delete(String(id));\r\n    });\r\n\r\n    // Update last selected row if it was deselected\r\n    if (ids.includes(this.lastSelectedRow)) {\r\n      this.lastSelectedRow = this.selectedRows.size > 0 ? Array.from(this.selectedRows)[0] : null;\r\n    }\r\n\r\n    this.updateUI();\r\n    \r\n    // Fire afterSelect event\r\n    this.table.eventManager.trigger('afterSelect', {\r\n      selectedRows: Array.from(this.selectedRows),\r\n      selectedData: this.getSelectedData()\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Clear all selections\r\n   */\r\n  clearSelection() {\r\n    if (!this.options.enabled) {\r\n      return;\r\n    }\r\n\r\n    const hadSelection = this.selectedRows.size > 0;\r\n    this.selectedRows.clear();\r\n    this.lastSelectedRow = null;\r\n    \r\n    this.updateUI();\r\n\r\n    if (hadSelection) {\r\n      // Fire afterSelect event\r\n      this.table.eventManager.trigger('afterSelect', {\r\n        selectedRows: [],\r\n        selectedData: []\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if a row is selected\r\n   * @param {String} rowId - Row ID to check\r\n   * @returns {Boolean} True if row is selected\r\n   */\r\n  isRowSelected(rowId) {\r\n    return this.selectedRows.has(String(rowId));\r\n  }\r\n\r\n  /**\r\n   * Check if a row is selected by its data object (for virtual scrolling)\r\n   * @param {Object} rowData - Row data object to check\r\n   * @returns {Boolean} True if row is selected\r\n   */\r\n  isRowSelectedByData(rowData) {\r\n    const rowId = this.getRowId(rowData);\r\n    return this.selectedRows.has(String(rowId));\r\n  }\r\n\r\n  /**\r\n   * Get selection count\r\n   * @returns {Number} Number of selected rows\r\n   */\r\n  getSelectionCount() {\r\n    return this.selectedRows.size;\r\n  }\r\n\r\n  /**\r\n   * Enable selection\r\n   */\r\n  enable() {\r\n    this.options.enabled = true;\r\n    if (!this.eventListenersSetup) {\r\n      this.setupEventListeners();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Disable selection\r\n   */\r\n  disable() {\r\n    this.options.enabled = false;\r\n    this.clearSelection();\r\n  }\r\n\r\n  /**\r\n   * Set selection mode\r\n   * @param {String} mode - 'single' or 'multi'\r\n   */\r\n  setMode(mode) {\r\n    if (mode !== 'single' && mode !== 'multi') {\r\n      console.warn('SelectionManager: Invalid mode. Use \"single\" or \"multi\"');\r\n      return;\r\n    }\r\n\r\n    const oldMode = this.options.mode;\r\n    this.options.mode = mode;\r\n    \r\n    // If switching to single mode and multiple rows are selected, keep only the last selected\r\n    if (mode === 'single' && this.selectedRows.size > 1) {\r\n      const lastSelected = this.lastSelectedRow;\r\n      this.selectedRows.clear();\r\n      if (lastSelected) {\r\n        this.selectedRows.add(lastSelected);\r\n      }\r\n      this.updateUI();\r\n    }\r\n\r\n    // Setup or remove drag selection based on mode change\r\n    if (oldMode !== mode && this.options.enabled) {\r\n      if (mode === 'multi') {\r\n        this.setupDragSelection();\r\n      }\r\n      // Note: We don't need to explicitly remove drag listeners as they check mode internally\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Destroy the selection manager\r\n   */\r\n  destroy() {\r\n    this.clearSelection();\r\n    \r\n    // Clear references to prevent memory leaks and null reference errors\r\n    this.table = null;\r\n    this.selectedRows.clear();\r\n    this.rowIdMap.clear();\r\n    this.lastSelectedRow = null;\r\n    \r\n    // Reset drag selection state\r\n    this.dragSelection.isActive = false;\r\n    this.dragSelection.isDragging = false;\r\n    this.dragSelection.startRowIndex = null;\r\n    this.dragSelection.currentRowIndex = null;\r\n    this.dragSelection.startRowId = null;\r\n    this.dragSelection.originalSelection = null;\r\n  }\r\n}\r\n","/**\r\n * VirtualScrollManager - High-performance virtual scrolling for large datasets\r\n * \r\n * Features:\r\n * - Dynamic row height detection\r\n * - Configurable buffer zones\r\n * - Smooth scrolling with no visual gaps\r\n * - Selection state preservation\r\n * - Performance optimizations for 100k+ rows\r\n */\r\nexport default class VirtualScrollManager {\r\n  constructor(table, options = {}) {\r\n    this.table = table;\r\n    this.options = {\r\n      enabled: false,\r\n      buffer: 10, // Number of rows to render above/below viewport\r\n      rowHeight: null, // Auto-detected if null\r\n      throttleDelay: 8, // Reduced from 16ms for better responsiveness (~120fps)\r\n      ...options\r\n    };\r\n\r\n    // State tracking\r\n    this.scrollContainer = null;\r\n    this.tableBody = null;\r\n    this.topSpacer = null;\r\n    this.bottomSpacer = null;\r\n    \r\n    // Measurements\r\n    this.rowHeight = this.options.rowHeight || 35; // Default fallback\r\n    this.containerHeight = 0;\r\n    this.totalRows = 0;\r\n    this.visibleStart = 0;\r\n    this.visibleEnd = 0;\r\n    this.renderedStart = 0;\r\n    this.renderedEnd = 0;\r\n    \r\n    // Performance tracking\r\n    this.performanceData = {\r\n      renderTimes: [],\r\n      scrollUpdates: 0,\r\n      lastMeasurement: 0\r\n    };\r\n\r\n    // Throttled scroll handler\r\n    this.throttledScrollHandler = this.throttle(this.handleScroll.bind(this), this.options.throttleDelay);\r\n    this.immediateScrollHandler = this.handleScroll.bind(this);\r\n    \r\n    // RAF-based update handler for smooth rendering\r\n    this.updateScheduled = false;\r\n    this.pendingUpdate = false;\r\n    this.lastScrollTime = 0;\r\n    this.scrollVelocity = 0;\r\n\r\n    // Data reference\r\n    this.data = [];\r\n    this.renderedData = [];\r\n  }\r\n\r\n  /**\r\n   * Initialize virtual scrolling\r\n   */\r\n  init(data = []) {\r\n    if (!this.options.enabled) {\r\n      return;\r\n    }\r\n\r\n    this.data = data;\r\n    this.totalRows = data.length;\r\n    \r\n    this.setupScrollContainer();\r\n    this.detectRowHeight();\r\n    this.calculateViewport();\r\n    this.scheduleUpdate();\r\n    \r\n    // Bind scroll events with both throttled and immediate handling\r\n    this.scrollContainer.addEventListener('scroll', this.handleScrollImmediate.bind(this), { passive: true });\r\n    this.scrollContainer.addEventListener('scroll', this.throttledScrollHandler, { passive: true });\r\n    \r\n    // Handle scrollbar dragging specifically\r\n    this.scrollContainer.addEventListener('mousedown', this.handleScrollStart.bind(this));\r\n    document.addEventListener('mouseup', this.handleScrollEnd.bind(this));\r\n    \r\n    // Handle window resize\r\n    window.addEventListener('resize', this.throttle(this.handleResize.bind(this), 100));\r\n    \r\n    // Set up event delegation for row interactions\r\n    this.setupEventDelegation();\r\n    \r\n    // Listen for selection changes\r\n    this.setupSelectionListeners();\r\n    \r\n    this.log('Virtual scroll initialized', {\r\n      totalRows: this.totalRows,\r\n      rowHeight: this.rowHeight,\r\n      buffer: this.options.buffer\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Set up event delegation for dynamically rendered rows\r\n   */\r\n  setupEventDelegation() {\r\n    if (!this.scrollContainer || !this.table.eventManager) return;\r\n\r\n    // Delegate row click events\r\n    this.rowClickHandler = (event) => {\r\n      const row = event.target.closest('.tablix-row');\r\n      if (!row) return;\r\n\r\n      // Skip click handling if we just finished a drag\r\n      if (this.justFinishedDrag) {\r\n        console.log('Skipping click - just finished drag');\r\n        return;\r\n      }\r\n\r\n      const virtualIndex = parseInt(row.getAttribute('data-virtual-index'));\r\n      const rowData = this.data[virtualIndex];\r\n      \r\n      if (rowData) {\r\n        console.log('VirtualScroll rowClickHandler triggered:', { \r\n          virtualIndex, \r\n          rowId: rowData.id,\r\n          ctrlKey: event.ctrlKey,\r\n          shiftKey: event.shiftKey,\r\n          metaKey: event.metaKey,\r\n          eventType: event.type,\r\n          timestamp: Date.now()\r\n        });\r\n        \r\n        // Trigger row click event for selection manager\r\n        this.table.eventManager.trigger('rowClick', {\r\n          rowData,\r\n          rowIndex: virtualIndex, // Use virtual index as row index\r\n          originalEvent: event,\r\n          element: row\r\n        });\r\n        \r\n        // Immediately update selection states after click\r\n        setTimeout(() => this.updateSelectionStates(), 0);\r\n      }\r\n    };\r\n\r\n    this.scrollContainer.addEventListener('click', this.rowClickHandler);\r\n\r\n    // Set up drag selection for virtual scrolling (if selection is enabled and in multi mode)\r\n    if (this.table.selectionManager && \r\n        this.table.selectionManager.options.enabled && \r\n        this.table.selectionManager.options.mode === 'multi') {\r\n      this.setupVirtualDragSelection();\r\n    }\r\n\r\n    // Delegate row hover events\r\n    this.rowHoverHandler = (event) => {\r\n      const row = event.target.closest('.tablix-row');\r\n      if (!row) return;\r\n\r\n      const virtualIndex = parseInt(row.getAttribute('data-virtual-index'));\r\n      const rowData = this.data[virtualIndex];\r\n      \r\n      if (rowData) {\r\n        this.table.eventManager.trigger('rowHover', {\r\n          rowData,\r\n          rowIndex: virtualIndex,\r\n          originalEvent: event,\r\n          element: row\r\n        });\r\n      }\r\n    };\r\n\r\n    this.scrollContainer.addEventListener('mouseover', this.rowHoverHandler);\r\n  }\r\n\r\n  /**\r\n   * Set up listeners for selection changes\r\n   */\r\n  setupSelectionListeners() {\r\n    if (!this.table.eventManager) return;\r\n\r\n    // Listen for selection changes to update row visual states\r\n    this.table.eventManager.on('afterSelect', () => {\r\n      this.updateSelectionStates();\r\n    });\r\n\r\n    this.table.eventManager.on('selectionCleared', () => {\r\n      this.updateSelectionStates();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Setup the scroll container structure\r\n   */\r\n  setupScrollContainer() {\r\n    const tableWrapper = this.table.container.querySelector('.tablix-wrapper');\r\n    if (!tableWrapper) {\r\n      throw new Error('Table wrapper not found for virtual scrolling');\r\n    }\r\n\r\n    // Find existing scroll container\r\n    let scrollContainer = tableWrapper.querySelector('.tablix-scroll-container');\r\n    if (!scrollContainer) {\r\n      // Create scroll container - it should already exist from renderer\r\n      scrollContainer = tableWrapper.querySelector('.tablix-scroll-container');\r\n      if (!scrollContainer) {\r\n        console.warn('Scroll container not found - virtual scrolling may not work properly');\r\n        return;\r\n      }\r\n    }\r\n\r\n    this.scrollContainer = scrollContainer;\r\n    this.tableBody = scrollContainer.querySelector('.tablix-tbody');\r\n    \r\n    // Create spacer elements for maintaining scroll height\r\n    this.createSpacers();\r\n  }\r\n\r\n  /**\r\n   * Create top and bottom spacer elements\r\n   */\r\n  createSpacers() {\r\n    if (!this.tableBody) return;\r\n\r\n    // Remove existing spacers\r\n    const existingTop = this.tableBody.querySelector('.tablix-top-spacer');\r\n    const existingBottom = this.tableBody.querySelector('.tablix-bottom-spacer');\r\n    if (existingTop) existingTop.remove();\r\n    if (existingBottom) existingBottom.remove();\r\n\r\n    // Create new spacers\r\n    this.topSpacer = document.createElement('tr');\r\n    this.topSpacer.className = 'tablix-top-spacer';\r\n    this.topSpacer.style.cssText = 'height: 0px; border: none;';\r\n    this.topSpacer.innerHTML = `<td colspan=\"100\" style=\"padding: 0; border: none; height: 0;\"></td>`;\r\n\r\n    this.bottomSpacer = document.createElement('tr');\r\n    this.bottomSpacer.className = 'tablix-bottom-spacer';\r\n    this.bottomSpacer.style.cssText = 'height: 0px; border: none;';\r\n    this.bottomSpacer.innerHTML = `<td colspan=\"100\" style=\"padding: 0; border: none; height: 0;\"></td>`;\r\n\r\n    this.tableBody.insertBefore(this.topSpacer, this.tableBody.firstChild);\r\n    this.tableBody.appendChild(this.bottomSpacer);\r\n  }\r\n\r\n  /**\r\n   * Detect row height dynamically by measuring a sample row\r\n   */\r\n  detectRowHeight() {\r\n    if (this.options.rowHeight) {\r\n      this.rowHeight = this.options.rowHeight;\r\n      return;\r\n    }\r\n\r\n    if (!this.tableBody || this.data.length === 0) {\r\n      return;\r\n    }\r\n\r\n    // Render a single sample row to measure height\r\n    const sampleRow = this.renderSingleRow(this.data[0], 0);\r\n    this.tableBody.appendChild(sampleRow);\r\n    \r\n    // Measure the row height\r\n    const rect = sampleRow.getBoundingClientRect();\r\n    this.rowHeight = Math.max(rect.height, 25); // Minimum height of 25px\r\n    \r\n    // Remove sample row\r\n    sampleRow.remove();\r\n    \r\n    this.log('Row height detected', { rowHeight: this.rowHeight });\r\n  }\r\n\r\n  /**\r\n   * Calculate viewport dimensions and visible range\r\n   */\r\n  calculateViewport() {\r\n    if (!this.scrollContainer) return;\r\n\r\n    const rect = this.scrollContainer.getBoundingClientRect();\r\n    this.containerHeight = rect.height;\r\n    \r\n    const scrollTop = this.scrollContainer.scrollTop;\r\n    const visibleRowCount = Math.ceil(this.containerHeight / this.rowHeight);\r\n    \r\n    // Calculate visible range\r\n    this.visibleStart = Math.floor(scrollTop / this.rowHeight);\r\n    this.visibleEnd = Math.min(this.visibleStart + visibleRowCount, this.totalRows);\r\n    \r\n    // Calculate rendered range with buffer\r\n    this.renderedStart = Math.max(0, this.visibleStart - this.options.buffer);\r\n    this.renderedEnd = Math.min(this.totalRows, this.visibleEnd + this.options.buffer);\r\n    \r\n    // Update spacer heights\r\n    this.updateSpacers();\r\n  }\r\n\r\n  /**\r\n   * Update spacer heights to maintain scroll position\r\n   */\r\n  updateSpacers() {\r\n    if (!this.topSpacer || !this.bottomSpacer) return;\r\n\r\n    const topHeight = this.renderedStart * this.rowHeight;\r\n    const bottomHeight = (this.totalRows - this.renderedEnd) * this.rowHeight;\r\n    \r\n    this.topSpacer.style.height = `${topHeight}px`;\r\n    this.bottomSpacer.style.height = `${bottomHeight}px`;\r\n  }\r\n\r\n  /**\r\n   * Handle immediate scroll events (for fast scrolling detection)\r\n   */\r\n  handleScrollImmediate() {\r\n    const now = performance.now();\r\n    const scrollTop = this.scrollContainer.scrollTop;\r\n    \r\n    // Calculate scroll velocity\r\n    if (this.lastScrollTime && this.lastScrollTop !== undefined) {\r\n      const timeDelta = now - this.lastScrollTime;\r\n      const scrollDelta = Math.abs(scrollTop - this.lastScrollTop);\r\n      this.scrollVelocity = timeDelta > 0 ? scrollDelta / timeDelta : 0;\r\n    }\r\n    \r\n    this.lastScrollTime = now;\r\n    this.lastScrollTop = scrollTop;\r\n    \r\n    // For very fast scrolling, schedule immediate update\r\n    if (this.scrollVelocity > 2) { // High velocity threshold\r\n      this.scheduleUpdate();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle scroll start (mousedown on scrollbar)\r\n   */\r\n  handleScrollStart(event) {\r\n    // Only trigger scrollbar dragging for actual scrollbar clicks\r\n    // Check if the click was on the scrollbar area, not on table content\r\n    const target = event.target;\r\n    if (target.closest('.tablix-row') || target.closest('.tablix-table')) {\r\n      // This is a click on table content, not scrollbar - ignore\r\n      return;\r\n    }\r\n    \r\n    this.isScrollbarDragging = true;\r\n    \r\n    // Schedule more frequent updates during scrollbar dragging\r\n    this.scrollDragInterval = setInterval(() => {\r\n      if (this.isScrollbarDragging) {\r\n        this.scheduleUpdate();\r\n      }\r\n    }, 8); // ~120fps during dragging\r\n  }\r\n\r\n  /**\r\n   * Handle scroll end (mouseup)\r\n   */\r\n  handleScrollEnd() {\r\n    this.isScrollbarDragging = false;\r\n    if (this.scrollDragInterval) {\r\n      clearInterval(this.scrollDragInterval);\r\n      this.scrollDragInterval = null;\r\n    }\r\n    // Final update to ensure everything is rendered\r\n    this.scheduleUpdate();\r\n  }\r\n\r\n  /**\r\n   * Setup drag selection for virtual scrolling\r\n   */\r\n  setupVirtualDragSelection() {\r\n    let isDragSelecting = false;\r\n    let dragStartIndex = null;\r\n    let dragStartX = null;\r\n    let dragStartY = null;\r\n    let originalSelection = null;\r\n    const dragThreshold = 3;\r\n\r\n    // Flag to prevent click handling immediately after drag\r\n    this.justFinishedDrag = false;\r\n\r\n    // Mouse down to potentially start drag selection\r\n    this.scrollContainer.addEventListener('mousedown', (event) => {\r\n      // Skip if clicked on scrollbar area or using modifier keys\r\n      if (event.ctrlKey || event.metaKey || event.shiftKey) return;\r\n      \r\n      const row = event.target.closest('.tablix-row');\r\n      if (!row || row.classList.contains('tablix-empty-row')) return;\r\n\r\n      const virtualIndex = parseInt(row.getAttribute('data-virtual-index'));\r\n      if (isNaN(virtualIndex)) return;\r\n\r\n      dragStartIndex = virtualIndex;\r\n      dragStartX = event.clientX;\r\n      dragStartY = event.clientY;\r\n      isDragSelecting = false;\r\n      \r\n      // Store original selection\r\n      originalSelection = new Set(this.table.selectionManager.selectedRows);\r\n\r\n      // Don't prevent default here - let the click event fire normally\r\n      // event.preventDefault();\r\n    });\r\n\r\n    // Mouse move to handle drag selection\r\n    this.scrollContainer.addEventListener('mousemove', (event) => {\r\n      if (dragStartIndex === null) return;\r\n\r\n      const deltaX = Math.abs(event.clientX - dragStartX);\r\n      const deltaY = Math.abs(event.clientY - dragStartY);\r\n\r\n      // Start dragging if moved enough\r\n      if (!isDragSelecting && (deltaX > dragThreshold || deltaY > dragThreshold)) {\r\n        isDragSelecting = true;\r\n        this.scrollContainer.classList.add('tablix-drag-selecting');\r\n      }\r\n\r\n      if (isDragSelecting) {\r\n        const row = event.target.closest('.tablix-row');\r\n        if (row) {\r\n          const currentIndex = parseInt(row.getAttribute('data-virtual-index'));\r\n          if (!isNaN(currentIndex)) {\r\n            this.applyVirtualDragSelection(dragStartIndex, currentIndex, originalSelection);\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    // Mouse up to complete or cancel drag selection\r\n    const handleMouseUp = (event) => {\r\n      if (dragStartIndex !== null) {\r\n        this.scrollContainer.classList.remove('tablix-drag-selecting');\r\n        \r\n        if (!isDragSelecting) {\r\n          // This was just a click, not a drag - don't interfere with click handling\r\n          // Reset drag state and let the normal click handler process this\r\n          dragStartIndex = null;\r\n          isDragSelecting = false;\r\n          originalSelection = null;\r\n          return;\r\n        }\r\n\r\n        // This was actually a drag selection - complete it\r\n        this.table.eventManager.trigger('afterSelect', {\r\n          selectedRows: Array.from(this.table.selectionManager.selectedRows),\r\n          selectedData: this.table.selectionManager.getSelectedData(),\r\n          isDragSelection: true,\r\n          dragComplete: true\r\n        });\r\n\r\n        // Set flag to prevent immediate click handling\r\n        this.justFinishedDrag = true;\r\n        setTimeout(() => {\r\n          this.justFinishedDrag = false;\r\n        }, 50);\r\n\r\n        // Reset drag state\r\n        dragStartIndex = null;\r\n        isDragSelecting = false;\r\n        originalSelection = null;\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mouseup', handleMouseUp);\r\n    this.scrollContainer.addEventListener('mouseleave', handleMouseUp);\r\n\r\n    // Prevent text selection during drag\r\n    this.scrollContainer.addEventListener('selectstart', (event) => {\r\n      if (isDragSelecting) {\r\n        event.preventDefault();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Apply drag selection in virtual scrolling\r\n   */\r\n  applyVirtualDragSelection(startIndex, endIndex, originalSelection) {\r\n    const minIndex = Math.min(startIndex, endIndex);\r\n    const maxIndex = Math.max(startIndex, endIndex);\r\n\r\n    // Start with original selection\r\n    this.table.selectionManager.selectedRows = new Set(originalSelection);\r\n\r\n    // Add drag range to selection\r\n    for (let i = minIndex; i <= maxIndex; i++) {\r\n      if (i < this.data.length) {\r\n        const rowData = this.data[i];\r\n        const rowId = this.table.selectionManager.getRowId(rowData);\r\n        this.table.selectionManager.selectedRows.add(rowId);\r\n      }\r\n    }\r\n\r\n    // Update last selected row\r\n    if (endIndex < this.data.length) {\r\n      const endRowData = this.data[endIndex];\r\n      this.table.selectionManager.lastSelectedRow = this.table.selectionManager.getRowId(endRowData);\r\n    }\r\n\r\n    // Update UI immediately\r\n    this.table.selectionManager.updateUI();\r\n  }\r\n\r\n  /**\r\n   * Handle scroll events\r\n   */\r\n  handleScroll() {\r\n    if (!this.options.enabled || this.updateScheduled) return;\r\n\r\n    this.scheduleUpdate();\r\n  }\r\n\r\n  /**\r\n   * Handle window resize\r\n   */\r\n  handleResize() {\r\n    if (!this.options.enabled) return;\r\n\r\n    this.calculateViewport();\r\n    this.scheduleUpdate();\r\n  }\r\n\r\n  /**\r\n   * Schedule an update using requestAnimationFrame\r\n   */\r\n  scheduleUpdate() {\r\n    if (this.updateScheduled) return;\r\n\r\n    this.updateScheduled = true;\r\n    requestAnimationFrame(() => {\r\n      this.update();\r\n      this.updateScheduled = false;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Main update method - calculates viewport and renders visible rows\r\n   */\r\n  update() {\r\n    const startTime = performance.now();\r\n    \r\n    this.calculateViewport();\r\n    this.renderVisibleRows();\r\n    \r\n    const endTime = performance.now();\r\n    this.trackPerformance(endTime - startTime);\r\n    \r\n    this.performanceData.scrollUpdates++;\r\n  }\r\n\r\n  /**\r\n   * Render only the visible rows plus buffer\r\n   */\r\n  renderVisibleRows() {\r\n    if (!this.tableBody) return;\r\n\r\n    // Clear existing rows (except spacers)\r\n    const existingRows = this.tableBody.querySelectorAll('.tablix-row');\r\n    existingRows.forEach(row => row.remove());\r\n\r\n    // Render new rows\r\n    const fragment = document.createDocumentFragment();\r\n    \r\n    for (let i = this.renderedStart; i < this.renderedEnd; i++) {\r\n      if (i < this.data.length) {\r\n        const row = this.renderSingleRow(this.data[i], i);\r\n        fragment.appendChild(row);\r\n      }\r\n    }\r\n\r\n    // Insert rows between spacers\r\n    this.tableBody.insertBefore(fragment, this.bottomSpacer);\r\n\r\n    // Store currently rendered data slice for other managers\r\n    this.renderedData = this.data.slice(this.renderedStart, this.renderedEnd);\r\n    \r\n    // Handle image loading for the newly rendered rows\r\n    this.handleImageLoading();\r\n    \r\n    // Update selection states for the newly rendered rows\r\n    this.updateSelectionStates();\r\n  }\r\n\r\n  /**\r\n   * Update selection states for currently rendered rows\r\n   */\r\n  updateSelectionStates() {\r\n    if (!this.table.selectionManager || !this.tableBody) return;\r\n\r\n    const rows = this.tableBody.querySelectorAll('.tablix-row');\r\n    rows.forEach(row => {\r\n      const virtualIndex = parseInt(row.getAttribute('data-virtual-index'));\r\n      const rowData = this.data[virtualIndex];\r\n      \r\n      if (rowData && this.table.selectionManager.isRowSelectedByData(rowData)) {\r\n        row.classList.add('tablix-selected');\r\n      } else {\r\n        row.classList.remove('tablix-selected');\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Handle image loading optimization\r\n   */\r\n  handleImageLoading() {\r\n    if (!this.tableBody) return;\r\n\r\n    // Find all images in the rendered rows\r\n    const images = this.tableBody.querySelectorAll('.tablix-row img');\r\n    \r\n    images.forEach((img, index) => {\r\n      // Skip if image is already loaded or loading\r\n      if (img.complete || img.classList.contains('loading')) return;\r\n      \r\n      img.classList.add('loading');\r\n      \r\n      // Create a placeholder while loading\r\n      const placeholder = img.cloneNode();\r\n      placeholder.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSIjZjBmMGYwIi8+CjxwYXRoIGQ9Ik0xNiA4TDIwIDEySDEyTDE2IDhaIiBmaWxsPSIjY2NjY2NjIi8+CjxwYXRoIGQ9Ik04IDIwSDI0VjE2SDhWMjBaIiBmaWxsPSIjY2NjY2NjIi8+Cjwvc3ZnPgo=';\r\n      placeholder.classList.add('image-placeholder');\r\n      \r\n      // Handle successful load\r\n      const handleLoad = () => {\r\n        img.classList.remove('loading');\r\n        img.style.opacity = '1';\r\n        img.removeEventListener('load', handleLoad);\r\n        img.removeEventListener('error', handleError);\r\n      };\r\n      \r\n      // Handle load error\r\n      const handleError = () => {\r\n        img.classList.remove('loading');\r\n        img.src = placeholder.src; // Use placeholder as fallback\r\n        img.removeEventListener('load', handleLoad);\r\n        img.removeEventListener('error', handleError);\r\n      };\r\n      \r\n      img.addEventListener('load', handleLoad);\r\n      img.addEventListener('error', handleError);\r\n      \r\n      // Set initial opacity for fade-in effect\r\n      img.style.opacity = '0.5';\r\n      img.style.transition = 'opacity 0.2s ease';\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Render a single row element\r\n   */\r\n  renderSingleRow(rowData, originalIndex) {\r\n    const columns = this.table.columnManager ? \r\n      this.table.columnManager.getColumns() : \r\n      (this.table.options.columns || []);\r\n\r\n    const tr = document.createElement('tr');\r\n    tr.className = 'tablix-row';\r\n    tr.setAttribute('data-row-index', originalIndex); // Keep for compatibility\r\n    tr.setAttribute('data-virtual-index', originalIndex); // Virtual scroll index\r\n    \r\n    // Add a unique identifier for debugging\r\n    tr.setAttribute('data-row-id', this.table.selectionManager ? \r\n      this.table.selectionManager.getRowId(rowData) : originalIndex);\r\n\r\n    // Apply initial selection state\r\n    const isSelected = this.table.selectionManager && \r\n      this.table.selectionManager.isRowSelectedByData(rowData);\r\n    \r\n    if (isSelected) {\r\n      tr.classList.add('tablix-selected');\r\n      console.log('Row initially selected:', originalIndex, rowData.id);\r\n    }\r\n\r\n    // Render cells\r\n    columns.forEach(col => {\r\n      const td = document.createElement('td');\r\n      td.className = 'tablix-td';\r\n      \r\n      const cellValue = rowData[col.name];\r\n\r\n      // Use ColumnManager for formatting if available\r\n      if (this.table.columnManager) {\r\n        const result = this.table.columnManager.formatCellValue(col.name, cellValue, rowData);\r\n        if (result.isHtml) {\r\n          td.innerHTML = result.value;\r\n        } else {\r\n          td.textContent = result.value;\r\n        }\r\n      } else {\r\n        // Fallback to original renderer logic\r\n        if (col.renderer && typeof col.renderer === 'function') {\r\n          const rendered = col.renderer(cellValue, rowData);\r\n          if (typeof rendered === 'string' && rendered.includes('<')) {\r\n            td.innerHTML = rendered;\r\n          } else {\r\n            td.textContent = rendered;\r\n          }\r\n        } else {\r\n          td.textContent = cellValue != null ? String(cellValue) : '';\r\n        }\r\n      }\r\n\r\n      tr.appendChild(td);\r\n    });\r\n\r\n    return tr;\r\n  }\r\n\r\n  /**\r\n   * Update data and refresh virtual scrolling\r\n   */\r\n  updateData(newData) {\r\n    this.data = newData;\r\n    this.totalRows = newData.length;\r\n    \r\n    if (this.options.enabled) {\r\n      this.calculateViewport();\r\n      this.scheduleUpdate();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Scroll to a specific row index\r\n   */\r\n  scrollToRow(index) {\r\n    if (!this.scrollContainer || !this.options.enabled) return;\r\n\r\n    const targetScrollTop = index * this.rowHeight;\r\n    this.scrollContainer.scrollTop = targetScrollTop;\r\n    \r\n    // Force immediate update\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * Get the currently visible row indices\r\n   */\r\n  getVisibleRange() {\r\n    return {\r\n      start: this.visibleStart,\r\n      end: this.visibleEnd,\r\n      renderedStart: this.renderedStart,\r\n      renderedEnd: this.renderedEnd\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get the currently rendered data slice\r\n   */\r\n  getRenderedData() {\r\n    return this.renderedData;\r\n  }\r\n\r\n  /**\r\n   * Check if virtual scrolling is active\r\n   */\r\n  isEnabled() {\r\n    return this.options.enabled;\r\n  }\r\n\r\n  /**\r\n   * Enable/disable virtual scrolling\r\n   */\r\n  setEnabled(enabled) {\r\n    this.options.enabled = enabled;\r\n    \r\n    if (enabled && this.data.length > 0) {\r\n      this.init(this.data);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Track performance metrics\r\n   */\r\n  trackPerformance(renderTime) {\r\n    this.performanceData.renderTimes.push(renderTime);\r\n    this.performanceData.lastMeasurement = renderTime;\r\n\r\n    // Keep only last 100 measurements\r\n    if (this.performanceData.renderTimes.length > 100) {\r\n      this.performanceData.renderTimes.shift();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get performance statistics\r\n   */\r\n  getPerformanceStats() {\r\n    const times = this.performanceData.renderTimes;\r\n    if (times.length === 0) return null;\r\n\r\n    const avg = times.reduce((a, b) => a + b, 0) / times.length;\r\n    const max = Math.max(...times);\r\n    const min = Math.min(...times);\r\n\r\n    return {\r\n      averageRenderTime: avg.toFixed(2),\r\n      maxRenderTime: max.toFixed(2),\r\n      minRenderTime: min.toFixed(2),\r\n      scrollUpdates: this.performanceData.scrollUpdates,\r\n      totalRows: this.totalRows,\r\n      visibleRows: this.visibleEnd - this.visibleStart,\r\n      renderedRows: this.renderedEnd - this.renderedStart\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Utility: Throttle function\r\n   */\r\n  throttle(func, limit) {\r\n    let inThrottle;\r\n    return function() {\r\n      const args = arguments;\r\n      const context = this;\r\n      if (!inThrottle) {\r\n        func.apply(context, args);\r\n        inThrottle = true;\r\n        setTimeout(() => inThrottle = false, limit);\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Utility: Logging for performance tracking\r\n   */\r\n  log(message, data = {}) {\r\n    if (this.table.options.debug) {\r\n      console.log(`[VirtualScroll] ${message}`, data);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clean up event listeners and resources\r\n   */\r\n  destroy() {\r\n    if (this.scrollContainer) {\r\n      this.scrollContainer.removeEventListener('scroll', this.throttledScrollHandler);\r\n      this.scrollContainer.removeEventListener('scroll', this.handleScrollImmediate);\r\n      this.scrollContainer.removeEventListener('mousedown', this.handleScrollStart);\r\n    }\r\n    document.removeEventListener('mouseup', this.handleScrollEnd);\r\n    window.removeEventListener('resize', this.handleResize);\r\n    \r\n    // Clean up scroll drag interval\r\n    if (this.scrollDragInterval) {\r\n      clearInterval(this.scrollDragInterval);\r\n      this.scrollDragInterval = null;\r\n    }\r\n    \r\n    this.scrollContainer = null;\r\n    this.tableBody = null;\r\n    this.topSpacer = null;\r\n    this.bottomSpacer = null;\r\n  }\r\n}\r\n","/**\r\n * TablixJS Localization Module\r\n * Provides internationalization support for the table library\r\n */\r\n\r\nexport default class Localization {\r\n  constructor() {\r\n    this.currentLanguage = 'en';\r\n    this.translations = new Map();\r\n    this.fallbackLanguage = 'en';\r\n    \r\n    // Initialize with English defaults\r\n    this.addTranslations('en', this.getDefaultEnglishTranslations());\r\n  }\r\n\r\n  /**\r\n   * Get default English translations (fallback language pack)\r\n   * @returns {Object} English translations object\r\n   */\r\n  getDefaultEnglishTranslations() {\r\n    return {\r\n      // General\r\n      'general.loading': 'Loading...',\r\n      'general.error': 'Error',\r\n      'general.noData': 'No data available',\r\n      'general.show': 'Show',\r\n      'general.entries': 'entries',\r\n      'general.of': 'of',\r\n      'general.to': 'to',\r\n      'general.records': 'records',\r\n      'general.perPage': 'per page',\r\n      'general.showing': 'Showing',\r\n      'general.total': 'Total',\r\n      'general.rows': 'rows',\r\n\r\n      // Search\r\n      'search.placeholder': 'Search...',\r\n      'search.clear': 'Clear search',\r\n      'search.noResults': 'No results found',\r\n      'search.resultsFound': 'results found',\r\n\r\n      // Pagination\r\n      'pagination.first': 'First',\r\n      'pagination.previous': 'Previous',\r\n      'pagination.next': 'Next',\r\n      'pagination.last': 'Last',\r\n      'pagination.page': 'Page',\r\n      'pagination.pageOf': 'Page {currentPage} of {totalPages}',\r\n      'pagination.showingRecords': 'Showing {startRow}-{endRow} of {totalRows} records',\r\n      'pagination.noRecords': 'No records found',\r\n      'pagination.pageSize': 'Records per page',\r\n\r\n      // Sorting\r\n      'sort.sortAscending': 'Sort ascending',\r\n      'sort.sortDescending': 'Sort descending',\r\n      'sort.sortedAscending': 'Sorted ascending',\r\n      'sort.sortedDescending': 'Sorted descending',\r\n      'sort.notSorted': 'Not sorted',\r\n      'sort.clearSort': 'Clear sorting',\r\n\r\n      // Selection\r\n      'selection.selectRow': 'Select row',\r\n      'selection.deselectRow': 'Deselect row',\r\n      'selection.selectAll': 'Select all',\r\n      'selection.deselectAll': 'Deselect all',\r\n      'selection.selectedCount': '{count} selected',\r\n      'selection.selectAllVisible': 'Select all visible rows',\r\n      'selection.clearSelection': 'Clear selection',\r\n\r\n      // Filtering\r\n      'filter.filter': 'Filter',\r\n      'filter.clearFilter': 'Clear filter',\r\n      'filter.clearAllFilters': 'Clear all filters',\r\n      'filter.applyFilter': 'Apply filter',\r\n      'filter.filterBy': 'Filter by',\r\n      'filter.filterColumn': 'Filter column',\r\n      'filter.filterByValue': 'Filter by Value',\r\n      'filter.filterByCondition': 'Filter by Condition',\r\n      'filter.searchValues': 'Search values...',\r\n      'filter.selectAll': 'Select All',\r\n      'filter.noValuesAvailable': 'No values available',\r\n      'filter.addCondition': 'Add Condition',\r\n      'filter.removeCondition': 'Remove condition',\r\n      'filter.value': 'Value',\r\n      'filter.apply': 'Apply',\r\n      'filter.clear': 'Clear',\r\n      'filter.cancel': 'Cancel',\r\n      'filter.contains': 'Contains',\r\n      'filter.startsWith': 'Starts with',\r\n      'filter.endsWith': 'Ends with',\r\n      'filter.equals': 'Equals',\r\n      'filter.notEquals': 'Not equals',\r\n      'filter.greaterThan': 'Greater than',\r\n      'filter.lessThan': 'Less than',\r\n      'filter.greaterThanOrEqual': 'Greater than or equal',\r\n      'filter.lessThanOrEqual': 'Less than or equal',\r\n      'filter.between': 'Between',\r\n      'filter.isEmpty': 'Is empty',\r\n      'filter.isNotEmpty': 'Is not empty',\r\n      'filter.selectValues': 'Select values',\r\n      'filter.noOptionsAvailable': 'No options available',\r\n\r\n      // Controls\r\n      'controls.refresh': 'Refresh data',\r\n      'controls.export': 'Export data',\r\n      'controls.settings': 'Settings',\r\n      'controls.columns': 'Columns',\r\n      'controls.showColumns': 'Show/Hide columns',\r\n\r\n      // Virtual Scrolling\r\n      'virtualScroll.loadingMoreRows': 'Loading more rows...',\r\n      'virtualScroll.scrollToTop': 'Scroll to top',\r\n      'virtualScroll.scrollToBottom': 'Scroll to bottom',\r\n\r\n      // Error Messages\r\n      'error.loadingData': 'Failed to load data',\r\n      'error.networkError': 'Network error occurred',\r\n      'error.invalidData': 'Invalid data format',\r\n      'error.serverError': 'Server error occurred',\r\n      'error.timeout': 'Request timed out',\r\n      'error.unknown': 'An unknown error occurred',\r\n      'error.retry': 'Retry',\r\n\r\n      // Data Types\r\n      'dataType.string': 'Text',\r\n      'dataType.number': 'Number',\r\n      'dataType.date': 'Date',\r\n      'dataType.boolean': 'Boolean',\r\n      'dataType.currency': 'Currency',\r\n      'dataType.percentage': 'Percentage',\r\n\r\n      // Accessibility\r\n      'accessibility.table': 'Data table',\r\n      'accessibility.sortableColumn': 'Sortable column',\r\n      'accessibility.selectableRow': 'Selectable row',\r\n      'accessibility.rowSelected': 'Row selected',\r\n      'accessibility.rowNotSelected': 'Row not selected',\r\n      'accessibility.pageNavigation': 'Page navigation',\r\n      'accessibility.searchInput': 'Search table data',\r\n      'accessibility.filterColumn': 'Filter column',\r\n\r\n      // Actions\r\n      'action.apply': 'Apply',\r\n      'action.cancel': 'Cancel',\r\n      'action.close': 'Close',\r\n      'action.save': 'Save',\r\n      'action.reset': 'Reset',\r\n      'action.ok': 'OK',\r\n      'action.yes': 'Yes',\r\n      'action.no': 'No',\r\n\r\n      // Time and Date\r\n      'date.today': 'Today',\r\n      'date.yesterday': 'Yesterday',\r\n      'date.thisWeek': 'This week',\r\n      'date.lastWeek': 'Last week',\r\n      'date.thisMonth': 'This month',\r\n      'date.lastMonth': 'Last month',\r\n\r\n      // Numbers and Formatting\r\n      'format.currency.symbol': '$',\r\n      'format.decimal.separator': '.',\r\n      'format.thousand.separator': ',',\r\n      'format.percentage.symbol': '%'\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Set the current language\r\n   * @param {string} language - Language code (e.g., 'en', 'fr', 'es')\r\n   */\r\n  setLanguage(language) {\r\n    if (typeof language !== 'string' || language.trim() === '') {\r\n      console.warn('TablixJS Localization: Invalid language code provided. Using fallback.');\r\n      return;\r\n    }\r\n\r\n    this.currentLanguage = language.toLowerCase().trim();\r\n  }\r\n\r\n  /**\r\n   * Add translations for a specific language\r\n   * @param {string} language - Language code\r\n   * @param {Object} translations - Translations object\r\n   */\r\n  addTranslations(language, translations) {\r\n    if (typeof language !== 'string' || !translations || typeof translations !== 'object') {\r\n      console.warn('TablixJS Localization: Invalid parameters for addTranslations.');\r\n      return;\r\n    }\r\n\r\n    const languageCode = language.toLowerCase().trim();\r\n    \r\n    if (!this.translations.has(languageCode)) {\r\n      this.translations.set(languageCode, {});\r\n    }\r\n\r\n    // Merge with existing translations for this language\r\n    const existing = this.translations.get(languageCode);\r\n    this.translations.set(languageCode, { ...existing, ...translations });\r\n  }\r\n\r\n  /**\r\n   * Get localized string by key\r\n   * @param {string} key - Translation key (e.g., 'pagination.next')\r\n   * @param {Object} params - Parameters to substitute in the translation\r\n   * @returns {string} Localized string or fallback\r\n   */\r\n  t(key, params = {}) {\r\n    if (typeof key !== 'string') {\r\n      console.warn('TablixJS Localization: Translation key must be a string.');\r\n      return key;\r\n    }\r\n\r\n    // Try current language first\r\n    let translation = this.getTranslationFromLanguage(this.currentLanguage, key);\r\n    \r\n    // Fallback to English if not found\r\n    if (translation === null && this.currentLanguage !== this.fallbackLanguage) {\r\n      translation = this.getTranslationFromLanguage(this.fallbackLanguage, key);\r\n    }\r\n\r\n    // Final fallback: return the key itself\r\n    if (translation === null) {\r\n      console.warn(`TablixJS Localization: Translation not found for key: ${key}`);\r\n      return key;\r\n    }\r\n\r\n    // Substitute parameters in the translation\r\n    return this.substituteParameters(translation, params);\r\n  }\r\n\r\n  /**\r\n   * Get translation from a specific language\r\n   * @private\r\n   * @param {string} language - Language code\r\n   * @param {string} key - Translation key\r\n   * @returns {string|null} Translation or null if not found\r\n   */\r\n  getTranslationFromLanguage(language, key) {\r\n    const languageTranslations = this.translations.get(language);\r\n    \r\n    if (!languageTranslations) {\r\n      return null;\r\n    }\r\n\r\n    // First try direct key lookup (for flat structure like 'pagination.first')\r\n    if (key in languageTranslations && typeof languageTranslations[key] === 'string') {\r\n      return languageTranslations[key];\r\n    }\r\n\r\n    // Fallback to nested key lookup (for nested structure)\r\n    const keys = key.split('.');\r\n    let current = languageTranslations;\r\n\r\n    for (const k of keys) {\r\n      if (current && typeof current === 'object' && k in current) {\r\n        current = current[k];\r\n      } else {\r\n        return null;\r\n      }\r\n    }\r\n\r\n    return typeof current === 'string' ? current : null;\r\n  }\r\n\r\n  /**\r\n   * Substitute parameters in translation string\r\n   * @private\r\n   * @param {string} translation - Translation string with placeholders\r\n   * @param {Object} params - Parameters to substitute\r\n   * @returns {string} Translation with substituted parameters\r\n   */\r\n  substituteParameters(translation, params) {\r\n    if (!params || typeof params !== 'object') {\r\n      return translation;\r\n    }\r\n\r\n    let result = translation;\r\n    \r\n    // Replace {paramName} with actual values\r\n    Object.keys(params).forEach(key => {\r\n      const regex = new RegExp(`\\\\{${key}\\\\}`, 'g');\r\n      result = result.replace(regex, params[key]);\r\n    });\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Get current language code\r\n   * @returns {string} Current language code\r\n   */\r\n  getCurrentLanguage() {\r\n    return this.currentLanguage;\r\n  }\r\n\r\n  /**\r\n   * Get available languages\r\n   * @returns {Array<string>} Array of available language codes\r\n   */\r\n  getAvailableLanguages() {\r\n    return Array.from(this.translations.keys());\r\n  }\r\n\r\n  /**\r\n   * Check if a language is available\r\n   * @param {string} language - Language code to check\r\n   * @returns {boolean} True if language is available\r\n   */\r\n  hasLanguage(language) {\r\n    return this.translations.has(language.toLowerCase().trim());\r\n  }\r\n\r\n  /**\r\n   * Get all translations for current language\r\n   * @returns {Object} All translations for current language\r\n   */\r\n  getAllTranslations() {\r\n    return this.translations.get(this.currentLanguage) || {};\r\n  }\r\n\r\n  /**\r\n   * Remove translations for a specific language\r\n   * @param {string} language - Language code to remove\r\n   */\r\n  removeLanguage(language) {\r\n    const languageCode = language.toLowerCase().trim();\r\n    if (languageCode === this.fallbackLanguage) {\r\n      console.warn('TablixJS Localization: Cannot remove fallback language.');\r\n      return;\r\n    }\r\n    \r\n    this.translations.delete(languageCode);\r\n    \r\n    // If we removed the current language, switch to fallback\r\n    if (this.currentLanguage === languageCode) {\r\n      this.currentLanguage = this.fallbackLanguage;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear all translations except fallback\r\n   */\r\n  clearTranslations() {\r\n    const fallbackTranslations = this.translations.get(this.fallbackLanguage);\r\n    this.translations.clear();\r\n    this.translations.set(this.fallbackLanguage, fallbackTranslations);\r\n    this.currentLanguage = this.fallbackLanguage;\r\n  }\r\n\r\n  /**\r\n   * Format number based on current locale\r\n   * @param {number} number - Number to format\r\n   * @param {Object} options - Formatting options\r\n   * @returns {string} Formatted number\r\n   */\r\n  formatNumber(number, options = {}) {\r\n    const {\r\n      style = 'decimal',\r\n      currency = 'USD',\r\n      minimumFractionDigits,\r\n      maximumFractionDigits\r\n    } = options;\r\n\r\n    try {\r\n      const formatter = new Intl.NumberFormat(this.getLocaleCode(), {\r\n        style,\r\n        currency: style === 'currency' ? currency : undefined,\r\n        minimumFractionDigits,\r\n        maximumFractionDigits\r\n      });\r\n      \r\n      return formatter.format(number);\r\n    } catch (error) {\r\n      // Fallback formatting if Intl is not available\r\n      return this.fallbackNumberFormat(number, options);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Format date based on current locale\r\n   * @param {Date|string|number} date - Date to format\r\n   * @param {Object} options - Formatting options\r\n   * @returns {string} Formatted date\r\n   */\r\n  formatDate(date, options = {}) {\r\n    const dateObj = date instanceof Date ? date : new Date(date);\r\n    \r\n    if (isNaN(dateObj.getTime())) {\r\n      return date.toString();\r\n    }\r\n\r\n    try {\r\n      const formatter = new Intl.DateTimeFormat(this.getLocaleCode(), options);\r\n      return formatter.format(dateObj);\r\n    } catch (error) {\r\n      // Fallback to simple date formatting\r\n      return dateObj.toLocaleDateString();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get locale code for Intl formatting\r\n   * @private\r\n   * @returns {string} Locale code\r\n   */\r\n  getLocaleCode() {\r\n    // Map language codes to locale codes\r\n    const languageToLocaleMap = {\r\n      'en': 'en-US',\r\n      'fr': 'fr-FR',\r\n      'es': 'es-ES',\r\n      'de': 'de-DE',\r\n      'it': 'it-IT',\r\n      'pt': 'pt-BR',\r\n      'ru': 'ru-RU',\r\n      'ja': 'ja-JP',\r\n      'ko': 'ko-KR',\r\n      'zh': 'zh-CN'\r\n    };\r\n\r\n    return languageToLocaleMap[this.currentLanguage] || this.currentLanguage || 'en-US';\r\n  }\r\n\r\n  /**\r\n   * Fallback number formatting when Intl is not available\r\n   * @private\r\n   * @param {number} number - Number to format\r\n   * @param {Object} options - Formatting options\r\n   * @returns {string} Formatted number\r\n   */\r\n  fallbackNumberFormat(number, options = {}) {\r\n    const { style } = options;\r\n    \r\n    if (style === 'currency') {\r\n      const symbol = this.t('format.currency.symbol');\r\n      return `${symbol}${number.toFixed(2)}`;\r\n    } else if (style === 'percent') {\r\n      const symbol = this.t('format.percentage.symbol');\r\n      return `${(number * 100).toFixed(1)}${symbol}`;\r\n    }\r\n    \r\n    return number.toString();\r\n  }\r\n\r\n  /**\r\n   * Pluralization helper\r\n   * @param {number} count - Count for pluralization\r\n   * @param {string} singularKey - Key for singular form\r\n   * @param {string} pluralKey - Key for plural form\r\n   * @param {Object} params - Additional parameters\r\n   * @returns {string} Pluralized string\r\n   */\r\n  pluralize(count, singularKey, pluralKey, params = {}) {\r\n    const key = count === 1 ? singularKey : pluralKey;\r\n    return this.t(key, { count, ...params });\r\n  }\r\n}\r\n","/**\r\n * French (fr) translations for TablixJS\r\n */\r\nexport const frenchTranslations = {\r\n  // General\r\n  'general.loading': 'Chargement...',\r\n  'general.error': 'Erreur',\r\n  'general.noData': 'Aucune donnée disponible',\r\n  'general.show': 'Afficher',\r\n  'general.entries': 'entrées',\r\n  'general.of': 'de',\r\n  'general.to': 'à',\r\n  'general.records': 'enregistrements',\r\n  'general.perPage': 'par page',\r\n  'general.showing': 'Affichage',\r\n  'general.total': 'Total',\r\n  'general.rows': 'lignes',\r\n\r\n  // Search\r\n  'search.placeholder': 'Rechercher...',\r\n  'search.clear': 'Effacer la recherche',\r\n  'search.noResults': 'Aucun résultat trouvé',\r\n  'search.resultsFound': 'résultats trouvés',\r\n\r\n  // Pagination\r\n  'pagination.first': 'Premier',\r\n  'pagination.previous': 'Précédent',\r\n  'pagination.next': 'Suivant',\r\n  'pagination.last': 'Dernier',\r\n  'pagination.page': 'Page',\r\n  'pagination.pageOf': 'Page {currentPage} sur {totalPages}',\r\n  'pagination.showingRecords': 'Affichage de {startRow} à {endRow} sur {totalRows} enregistrements',\r\n  'pagination.noRecords': 'Aucun enregistrement trouvé',\r\n  'pagination.pageSize': 'Enregistrements par page',\r\n\r\n  // Sorting\r\n  'sort.sortAscending': 'Trier croissant',\r\n  'sort.sortDescending': 'Trier décroissant',\r\n  'sort.sortedAscending': 'Trié croissant',\r\n  'sort.sortedDescending': 'Trié décroissant',\r\n  'sort.notSorted': 'Non trié',\r\n  'sort.clearSort': 'Effacer le tri',\r\n\r\n  // Selection\r\n  'selection.selectRow': 'Sélectionner la ligne',\r\n  'selection.deselectRow': 'Désélectionner la ligne',\r\n  'selection.selectAll': 'Tout sélectionner',\r\n  'selection.deselectAll': 'Tout désélectionner',\r\n  'selection.selectedCount': '{count} sélectionné(s)',\r\n  'selection.selectAllVisible': 'Sélectionner toutes les lignes visibles',\r\n  'selection.clearSelection': 'Effacer la sélection',\r\n\r\n  // Filtering\r\n  'filter.filter': 'Filtrer',\r\n  'filter.clearFilter': 'Effacer le filtre',\r\n  'filter.clearAllFilters': 'Effacer tous les filtres',\r\n  'filter.applyFilter': 'Appliquer le filtre',\r\n  'filter.filterBy': 'Filtrer par',\r\n  'filter.filterColumn': 'Filtrer la colonne',\r\n  'filter.filterByValue': 'Filtrer par valeur',\r\n  'filter.filterByCondition': 'Filtrer par condition',\r\n  'filter.searchValues': 'Rechercher des valeurs...',\r\n  'filter.selectAll': 'Tout sélectionner',\r\n  'filter.noValuesAvailable': 'Aucune valeur disponible',\r\n  'filter.addCondition': 'Ajouter une condition',\r\n  'filter.removeCondition': 'Supprimer la condition',\r\n  'filter.value': 'Valeur',\r\n  'filter.apply': 'Appliquer',\r\n  'filter.clear': 'Effacer',\r\n  'filter.cancel': 'Annuler',\r\n  'filter.contains': 'Contient',\r\n  'filter.startsWith': 'Commence par',\r\n  'filter.endsWith': 'Se termine par',\r\n  'filter.equals': 'Égal à',\r\n  'filter.notEquals': 'Différent de',\r\n  'filter.greaterThan': 'Supérieur à',\r\n  'filter.lessThan': 'Inférieur à',\r\n  'filter.greaterThanOrEqual': 'Supérieur ou égal à',\r\n  'filter.lessThanOrEqual': 'Inférieur ou égal à',\r\n  'filter.between': 'Entre',\r\n  'filter.isEmpty': 'Est vide',\r\n  'filter.isNotEmpty': 'N\\'est pas vide',\r\n  'filter.selectValues': 'Sélectionner les valeurs',\r\n  'filter.noOptionsAvailable': 'Aucune option disponible',\r\n\r\n  // Controls\r\n  'controls.refresh': 'Actualiser les données',\r\n  'controls.export': 'Exporter les données',\r\n  'controls.settings': 'Paramètres',\r\n  'controls.columns': 'Colonnes',\r\n  'controls.showColumns': 'Afficher/Masquer les colonnes',\r\n\r\n  // Virtual Scrolling\r\n  'virtualScroll.loadingMoreRows': 'Chargement de plus de lignes...',\r\n  'virtualScroll.scrollToTop': 'Faire défiler vers le haut',\r\n  'virtualScroll.scrollToBottom': 'Faire défiler vers le bas',\r\n\r\n  // Error Messages\r\n  'error.loadingData': 'Échec du chargement des données',\r\n  'error.networkError': 'Erreur réseau',\r\n  'error.invalidData': 'Format de données invalide',\r\n  'error.serverError': 'Erreur serveur',\r\n  'error.timeout': 'Délai d\\'attente dépassé',\r\n  'error.unknown': 'Une erreur inconnue s\\'est produite',\r\n  'error.retry': 'Réessayer',\r\n\r\n  // Data Types\r\n  'dataType.string': 'Texte',\r\n  'dataType.number': 'Nombre',\r\n  'dataType.date': 'Date',\r\n  'dataType.boolean': 'Booléen',\r\n  'dataType.currency': 'Devise',\r\n  'dataType.percentage': 'Pourcentage',\r\n\r\n  // Accessibility\r\n  'accessibility.table': 'Tableau de données',\r\n  'accessibility.sortableColumn': 'Colonne triable',\r\n  'accessibility.selectableRow': 'Ligne sélectionnable',\r\n  'accessibility.rowSelected': 'Ligne sélectionnée',\r\n  'accessibility.rowNotSelected': 'Ligne non sélectionnée',\r\n  'accessibility.pageNavigation': 'Navigation des pages',\r\n  'accessibility.searchInput': 'Rechercher dans les données du tableau',\r\n  'accessibility.filterColumn': 'Filtrer la colonne',\r\n\r\n  // Actions\r\n  'action.apply': 'Appliquer',\r\n  'action.cancel': 'Annuler',\r\n  'action.close': 'Fermer',\r\n  'action.save': 'Enregistrer',\r\n  'action.reset': 'Réinitialiser',\r\n  'action.ok': 'OK',\r\n  'action.yes': 'Oui',\r\n  'action.no': 'Non',\r\n\r\n  // Time and Date\r\n  'date.today': 'Aujourd\\'hui',\r\n  'date.yesterday': 'Hier',\r\n  'date.thisWeek': 'Cette semaine',\r\n  'date.lastWeek': 'La semaine dernière',\r\n  'date.thisMonth': 'Ce mois-ci',\r\n  'date.lastMonth': 'Le mois dernier',\r\n\r\n  // Numbers and Formatting\r\n  'format.currency.symbol': '€',\r\n  'format.decimal.separator': ',',\r\n  'format.thousand.separator': ' ',\r\n  'format.percentage.symbol': '%'\r\n};\r\n\r\nexport default frenchTranslations;\r\n","/**\r\n * Spanish (es) translations for TablixJS\r\n */\r\nexport const spanishTranslations = {\r\n  // General\r\n  'general.loading': 'Cargando...',\r\n  'general.error': 'Error',\r\n  'general.noData': 'No hay datos disponibles',\r\n  'general.show': 'Mostrar',\r\n  'general.entries': 'entradas',\r\n  'general.of': 'de',\r\n  'general.to': 'a',\r\n  'general.records': 'registros',\r\n  'general.perPage': 'por página',\r\n  'general.showing': 'Mostrando',\r\n  'general.total': 'Total',\r\n  'general.rows': 'filas',\r\n\r\n  // Search\r\n  'search.placeholder': 'Buscar...',\r\n  'search.clear': 'Limpiar búsqueda',\r\n  'search.noResults': 'No se encontraron resultados',\r\n  'search.resultsFound': 'resultados encontrados',\r\n\r\n  // Pagination\r\n  'pagination.first': 'Primero',\r\n  'pagination.previous': 'Anterior',\r\n  'pagination.next': 'Siguiente',\r\n  'pagination.last': 'Último',\r\n  'pagination.page': 'Página',\r\n  'pagination.pageOf': 'Página {currentPage} de {totalPages}',\r\n  'pagination.showingRecords': 'Mostrando {startRow} a {endRow} de {totalRows} registros',\r\n  'pagination.noRecords': 'No se encontraron registros',\r\n  'pagination.pageSize': 'Registros por página',\r\n\r\n  // Sorting\r\n  'sort.sortAscending': 'Ordenar ascendente',\r\n  'sort.sortDescending': 'Ordenar descendente',\r\n  'sort.sortedAscending': 'Ordenado ascendente',\r\n  'sort.sortedDescending': 'Ordenado descendente',\r\n  'sort.notSorted': 'Sin ordenar',\r\n  'sort.clearSort': 'Limpiar ordenación',\r\n\r\n  // Selection\r\n  'selection.selectRow': 'Seleccionar fila',\r\n  'selection.deselectRow': 'Deseleccionar fila',\r\n  'selection.selectAll': 'Seleccionar todo',\r\n  'selection.deselectAll': 'Deseleccionar todo',\r\n  'selection.selectedCount': '{count} seleccionado(s)',\r\n  'selection.selectAllVisible': 'Seleccionar todas las filas visibles',\r\n  'selection.clearSelection': 'Limpiar selección',\r\n\r\n  // Filtering\r\n  'filter.filter': 'Filtrar',\r\n  'filter.clearFilter': 'Limpiar filtro',\r\n  'filter.clearAllFilters': 'Limpiar todos los filtros',\r\n  'filter.applyFilter': 'Aplicar filtro',\r\n  'filter.filterBy': 'Filtrar por',\r\n  'filter.filterColumn': 'Filtrar columna',\r\n  'filter.filterByValue': 'Filtrar por valor',\r\n  'filter.filterByCondition': 'Filtrar por condición',\r\n  'filter.searchValues': 'Buscar valores...',\r\n  'filter.selectAll': 'Seleccionar todo',\r\n  'filter.noValuesAvailable': 'No hay valores disponibles',\r\n  'filter.addCondition': 'Agregar condición',\r\n  'filter.removeCondition': 'Eliminar condición',\r\n  'filter.value': 'Valor',\r\n  'filter.apply': 'Aplicar',\r\n  'filter.clear': 'Limpiar',\r\n  'filter.cancel': 'Cancelar',\r\n  'filter.contains': 'Contiene',\r\n  'filter.startsWith': 'Comienza con',\r\n  'filter.endsWith': 'Termina con',\r\n  'filter.equals': 'Igual a',\r\n  'filter.notEquals': 'No igual a',\r\n  'filter.greaterThan': 'Mayor que',\r\n  'filter.lessThan': 'Menor que',\r\n  'filter.greaterThanOrEqual': 'Mayor o igual a',\r\n  'filter.lessThanOrEqual': 'Menor o igual a',\r\n  'filter.between': 'Entre',\r\n  'filter.isEmpty': 'Está vacío',\r\n  'filter.isNotEmpty': 'No está vacío',\r\n  'filter.selectValues': 'Seleccionar valores',\r\n  'filter.noOptionsAvailable': 'No hay opciones disponibles',\r\n\r\n  // Controls\r\n  'controls.refresh': 'Actualizar datos',\r\n  'controls.export': 'Exportar datos',\r\n  'controls.settings': 'Configuración',\r\n  'controls.columns': 'Columnas',\r\n  'controls.showColumns': 'Mostrar/Ocultar columnas',\r\n\r\n  // Virtual Scrolling\r\n  'virtualScroll.loadingMoreRows': 'Cargando más filas...',\r\n  'virtualScroll.scrollToTop': 'Desplazar hacia arriba',\r\n  'virtualScroll.scrollToBottom': 'Desplazar hacia abajo',\r\n\r\n  // Error Messages\r\n  'error.loadingData': 'Error al cargar los datos',\r\n  'error.networkError': 'Error de red',\r\n  'error.invalidData': 'Formato de datos inválido',\r\n  'error.serverError': 'Error del servidor',\r\n  'error.timeout': 'Tiempo de espera agotado',\r\n  'error.unknown': 'Ocurrió un error desconocido',\r\n  'error.retry': 'Reintentar',\r\n\r\n  // Data Types\r\n  'dataType.string': 'Texto',\r\n  'dataType.number': 'Número',\r\n  'dataType.date': 'Fecha',\r\n  'dataType.boolean': 'Booleano',\r\n  'dataType.currency': 'Moneda',\r\n  'dataType.percentage': 'Porcentaje',\r\n\r\n  // Accessibility\r\n  'accessibility.table': 'Tabla de datos',\r\n  'accessibility.sortableColumn': 'Columna ordenable',\r\n  'accessibility.selectableRow': 'Fila seleccionable',\r\n  'accessibility.rowSelected': 'Fila seleccionada',\r\n  'accessibility.rowNotSelected': 'Fila no seleccionada',\r\n  'accessibility.pageNavigation': 'Navegación de páginas',\r\n  'accessibility.searchInput': 'Buscar en los datos de la tabla',\r\n  'accessibility.filterColumn': 'Filtrar columna',\r\n\r\n  // Actions\r\n  'action.apply': 'Aplicar',\r\n  'action.cancel': 'Cancelar',\r\n  'action.close': 'Cerrar',\r\n  'action.save': 'Guardar',\r\n  'action.reset': 'Restablecer',\r\n  'action.ok': 'OK',\r\n  'action.yes': 'Sí',\r\n  'action.no': 'No',\r\n\r\n  // Time and Date\r\n  'date.today': 'Hoy',\r\n  'date.yesterday': 'Ayer',\r\n  'date.thisWeek': 'Esta semana',\r\n  'date.lastWeek': 'La semana pasada',\r\n  'date.thisMonth': 'Este mes',\r\n  'date.lastMonth': 'El mes pasado',\r\n\r\n  // Numbers and Formatting\r\n  'format.currency.symbol': '€',\r\n  'format.decimal.separator': ',',\r\n  'format.thousand.separator': '.',\r\n  'format.percentage.symbol': '%'\r\n};\r\n\r\nexport default spanishTranslations;\r\n","/**\r\n * Serbian (sr) translations for TablixJS\r\n */\r\nexport const serbianTranslations = {\r\n  // General\r\n  'general.loading': 'Učitavanje...',\r\n  'general.error': 'Greška',\r\n  'general.noData': 'Nema dostupnih podataka',\r\n  'general.show': 'Prikaži',\r\n  'general.entries': 'unosa',\r\n  'general.of': 'od',\r\n  'general.to': 'do',\r\n  'general.records': 'zapisa',\r\n  'general.perPage': 'po stranici',\r\n  'general.showing': 'Prikazano',\r\n  'general.total': 'Ukupno',\r\n  'general.rows': 'redova',\r\n\r\n  // Search\r\n  'search.placeholder': 'Pretraga...',\r\n  'search.clear': 'Obriši pretragu',\r\n  'search.noResults': 'Nema rezultata',\r\n  'search.resultsFound': 'rezultata pronađeno',\r\n\r\n  // Pagination\r\n  'pagination.first': 'Prva',\r\n  'pagination.previous': 'Prethodna',\r\n  'pagination.next': 'Sledeća',\r\n  'pagination.last': 'Poslednja',\r\n  'pagination.page': 'Stranica',\r\n  'pagination.pageOf': 'Stranica {currentPage} od {totalPages}',\r\n  'pagination.showingRecords': 'Prikazano {startRow}-{endRow} od {totalRows} zapisa',\r\n  'pagination.noRecords': 'Nema zapisa',\r\n  'pagination.pageSize': 'Zapisa po stranici',\r\n\r\n  // Sorting\r\n  'sort.sortAscending': 'Sortiraj rastuće',\r\n  'sort.sortDescending': 'Sortiraj opadajuće',\r\n  'sort.sortedAscending': 'Sortirano rastuće',\r\n  'sort.sortedDescending': 'Sortirano opadajuće',\r\n  'sort.notSorted': 'Nije sortirano',\r\n  'sort.clearSort': 'Obriši sortiranje',\r\n\r\n  // Selection\r\n  'selection.selectRow': 'Izaberi red',\r\n  'selection.deselectRow': 'Poništi izbor reda',\r\n  'selection.selectAll': 'Izaberi sve',\r\n  'selection.deselectAll': 'Poništi sve',\r\n  'selection.selectedCount': '{count} izabrano',\r\n  'selection.selectAllVisible': 'Izaberi sve vidljive redove',\r\n  'selection.clearSelection': 'Obriši izbor',\r\n\r\n  // Filtering\r\n  'filter.filter': 'Filter',\r\n  'filter.clearFilter': 'Obriši filter',\r\n  'filter.clearAllFilters': 'Obriši sve filtere',\r\n  'filter.applyFilter': 'Primeni filter',\r\n  'filter.filterBy': 'Filtriraj po',\r\n  'filter.filterColumn': 'Filtriraj kolonu',\r\n  'filter.filterByValue': 'Filtriraj po vrednosti',\r\n  'filter.filterByCondition': 'Filtriraj po uslovu',\r\n  'filter.searchValues': 'Pretraži vrednosti...',\r\n  'filter.selectAll': 'Izaberi sve',\r\n  'filter.noValuesAvailable': 'Nema dostupnih vrednosti',\r\n  'filter.addCondition': 'Dodaj uslov',\r\n  'filter.removeCondition': 'Ukloni uslov',\r\n  'filter.value': 'Vrednost',\r\n  'filter.apply': 'Primeni',\r\n  'filter.clear': 'Obriši',\r\n  'filter.cancel': 'Otkaži',\r\n  'filter.contains': 'Sadrži',\r\n  'filter.startsWith': 'Počinje sa',\r\n  'filter.endsWith': 'Završava se sa',\r\n  'filter.equals': 'Jednako',\r\n  'filter.notEquals': 'Nije jednako',\r\n  'filter.greaterThan': 'Veće od',\r\n  'filter.lessThan': 'Manje od',\r\n  'filter.greaterThanOrEqual': 'Veće ili jednako',\r\n  'filter.lessThanOrEqual': 'Manje ili jednako',\r\n  'filter.between': 'Između',\r\n  'filter.isEmpty': 'Prazno',\r\n  'filter.isNotEmpty': 'Nije prazno',\r\n  'filter.selectValues': 'Izaberi vrednosti',\r\n  'filter.noOptionsAvailable': 'Nema dostupnih opcija',\r\n\r\n  // Controls\r\n  'controls.refresh': 'Osveži podatke',\r\n  'controls.export': 'Izvezi podatke',\r\n  'controls.settings': 'Podešavanja',\r\n  'controls.columns': 'Kolone',\r\n  'controls.showColumns': 'Prikaži/Sakrij kolone',\r\n\r\n  // Virtual Scrolling\r\n  'virtualScroll.loadingMoreRows': 'Učitavanje dodatnih redova...',\r\n  'virtualScroll.scrollToTop': 'Idi na vrh',\r\n  'virtualScroll.scrollToBottom': 'Idi na dno',\r\n\r\n  // Error Messages\r\n  'error.loadingData': 'Neuspešno učitavanje podataka',\r\n  'error.networkError': 'Došlo je do mrežne greške',\r\n  'error.invalidData': 'Neispravan format podataka',\r\n  'error.serverError': 'Došlo je do greške na serveru',\r\n  'error.timeout': 'Isteklo vreme zahteva',\r\n  'error.unknown': 'Došlo je do nepoznate greške',\r\n  'error.retry': 'Pokušaj ponovo',\r\n\r\n  // Data Types\r\n  'dataType.string': 'Tekst',\r\n  'dataType.number': 'Broj',\r\n  'dataType.date': 'Datum',\r\n  'dataType.boolean': 'Logička vrednost',\r\n  'dataType.currency': 'Valuta',\r\n  'dataType.percentage': 'Procenat',\r\n\r\n  // Accessibility\r\n  'accessibility.table': 'Tabela podataka',\r\n  'accessibility.sortableColumn': 'Kolona za sortiranje',\r\n  'accessibility.selectableRow': 'Red za izbor',\r\n  'accessibility.rowSelected': 'Red izabran',\r\n  'accessibility.rowNotSelected': 'Red nije izabran',\r\n  'accessibility.pageNavigation': 'Navigacija stranica',\r\n  'accessibility.searchInput': 'Pretraga podataka tabele',\r\n  'accessibility.filterColumn': 'Filtriraj kolonu',\r\n\r\n  // Actions\r\n  'action.apply': 'Primeni',\r\n  'action.cancel': 'Otkaži',\r\n  'action.close': 'Zatvori',\r\n  'action.save': 'Sačuvaj',\r\n  'action.reset': 'Resetuj',\r\n  'action.ok': 'U redu',\r\n  'action.yes': 'Da',\r\n  'action.no': 'Ne',\r\n\r\n  // Time and Date\r\n  'date.today': 'Danas',\r\n  'date.yesterday': 'Juče',\r\n  'date.thisWeek': 'Ove nedelje',\r\n  'date.lastWeek': 'Prošle nedelje',\r\n  'date.thisMonth': 'Ovog meseca',\r\n  'date.lastMonth': 'Prošlog meseca',\r\n\r\n  // Numbers and Formatting\r\n  'format.currency.symbol': 'RSD',\r\n  'format.decimal.separator': ',',\r\n  'format.thousand.separator': '.',\r\n  'format.percentage.symbol': '%'\r\n};\r\n\r\nexport default serbianTranslations;\r\n","import DataManager from './DataManager.js';\r\nimport Renderer from './Renderer.js';\r\nimport EventManager from './EventManager.js';\r\nimport PaginationManager from './PaginationManager.js';\r\nimport SortingManager from './SortingManager.js';\r\nimport ColumnManager from './ColumnManager.js';\r\nimport FilterManager from './FilterManager.js';\r\nimport FilterUI from './FilterUI.js';\r\nimport SearchManager from './SearchManager.js';\r\nimport SelectionManager from './SelectionManager.js';\r\nimport VirtualScrollManager from './VirtualScroll.js';\r\nimport Localization from './Localization.js';\r\nimport { frenchTranslations } from '../locales/fr.js';\r\nimport { spanishTranslations } from '../locales/es.js';\r\nimport { serbianTranslations } from '../locales/sr.js';\r\n\r\nexport default class Table {\r\n  constructor(container, options = {}) {\r\n    this.container = typeof container === 'string' ? document.querySelector(container) : container;\r\n    this.options = {\r\n      // Default options\r\n      pagination: {\r\n        enabled: true,\r\n        pageSize: 10,\r\n        mode: 'client', // 'client' or 'server'\r\n        showPageNumbers: true,\r\n        maxPageNumbers: 5,\r\n        showFirstLast: true,\r\n        showPrevNext: true,\r\n        showPageSizes: false,\r\n        pageSizeOptions: [10, 25, 50, 100],\r\n        serverDataLoader: null\r\n      },\r\n      // Sorting options\r\n      sorting: {\r\n        enabled: true,\r\n        mode: 'client', // 'client' or 'server'\r\n        serverSortLoader: null,\r\n        defaultSortType: 'auto',\r\n        caseSensitive: false,\r\n        nullsFirst: false\r\n      },\r\n      // Filtering options\r\n      filtering: {\r\n        enabled: true,\r\n        mode: 'client', // 'client' or 'server'\r\n        serverFilterLoader: null,\r\n        debounceDelay: 300,\r\n        showBadges: true,\r\n        showTooltips: true\r\n      },\r\n      // Control panels\r\n      controls: {\r\n        enabled: true,  // Enable by default to show search\r\n        search: true,\r\n        pagination: true,\r\n        pageSize: true,\r\n        refresh: true,\r\n        export: false,\r\n        position: 'top' // 'top', 'bottom', 'both'\r\n      },\r\n      search: {\r\n        enabled: true,\r\n        placeholder: null, // Will use localized string if not provided\r\n        searchDelay: 300, // Debounce delay in milliseconds\r\n        minLength: 1, // Minimum characters before search starts\r\n        caseSensitive: false\r\n      },\r\n      // Selection options\r\n      selection: {\r\n        enabled: false,  // Default: selection is disabled\r\n        mode: 'single',  // 'single' or 'multi'\r\n        dataIdKey: 'id'  // Key to use as stable row identifier\r\n      },\r\n      // Virtual scrolling options\r\n      virtualScroll: {\r\n        enabled: false,\r\n        buffer: 10, // Number of rows to render above/below viewport\r\n        rowHeight: null, // Auto-detected if null\r\n        containerHeight: 400 // Default container height in pixels\r\n      },\r\n      // Localization options\r\n      language: 'en',\r\n      translations: {},\r\n      ...options\r\n    };\r\n\r\n    // Initialize localization first (before other managers that might use it)\r\n    this.localization = new Localization();\r\n    \r\n    // Auto-load common language packs for developer convenience\r\n    this.localization.addTranslations('fr', frenchTranslations);\r\n    this.localization.addTranslations('es', spanishTranslations);\r\n    this.localization.addTranslations('sr', serbianTranslations);\r\n    \r\n    // Set language and translations if provided\r\n    if (this.options.language) {\r\n      this.localization.setLanguage(this.options.language);\r\n    }\r\n    \r\n    // Add custom translations if provided (these will override auto-loaded ones)\r\n    if (this.options.translations) {\r\n      Object.keys(this.options.translations).forEach(lang => {\r\n        this.localization.addTranslations(lang, this.options.translations[lang]);\r\n      });\r\n    }\r\n\r\n    // Initialize managers\r\n    this.eventManager = new EventManager();\r\n    this.columnManager = new ColumnManager(this);\r\n    this.dataManager = new DataManager(this, options.data || []);\r\n    this.renderer = new Renderer(this);\r\n    \r\n    // Initialize columns if provided\r\n    if (options.columns) {\r\n      this.columnManager.initializeColumns(options.columns);\r\n    }\r\n    \r\n    // Initialize pagination if enabled\r\n    if (this.options.pagination && this.options.pagination.enabled !== false) {\r\n      this.paginationManager = new PaginationManager(this, this.options.pagination);\r\n    }\r\n\r\n    // Initialize sorting if enabled\r\n    if (this.options.sorting && this.options.sorting.enabled !== false) {\r\n      this.sortingManager = new SortingManager(this, this.options.sorting);\r\n    }\r\n\r\n    // Initialize filtering if enabled\r\n    if (this.options.filtering && this.options.filtering.enabled !== false) {\r\n      this.filterManager = new FilterManager(this, this.options.filtering);\r\n      this.filterUI = new FilterUI(this.filterManager);\r\n    }\r\n\r\n    // Initialize search if enabled\r\n    if (this.options.search && this.options.search.enabled !== false) {\r\n      this.searchManager = new SearchManager(this, this.options.search);\r\n    }\r\n\r\n    // Initialize selection if enabled\r\n    if (this.options.selection) {\r\n      this.selectionManager = new SelectionManager(this, this.options.selection);\r\n    }\r\n\r\n    // Initialize virtual scrolling\r\n    if (this.options.virtualScroll) {\r\n      this.virtualScrollManager = new VirtualScrollManager(this, this.options.virtualScroll);\r\n    }\r\n\r\n    this.init();\r\n  }\r\n\r\n  async init() {\r\n    try {\r\n      // Initialize search manager\r\n      if (this.searchManager) {\r\n        this.searchManager.init();\r\n      }\r\n\r\n      // Get initial data\r\n      const initialData = this.dataManager.getData();\r\n      \r\n      // Trigger beforeLoad hook for initial data\r\n      this.eventManager.trigger('beforeLoad', { source: initialData });\r\n      \r\n      // Render table with first page of data\r\n      await this.refreshTable();\r\n      \r\n      // Trigger afterLoad hook with consistent payload format\r\n      this.eventManager.trigger('afterLoad', { data: initialData, source: initialData });\r\n    } catch (error) {\r\n      console.error('Failed to initialize table:', error);\r\n      this.eventManager.trigger('loadError', { error, source: 'initialization' });\r\n      if (this.renderer && this.renderer.renderError) {\r\n        this.renderer.renderError(error);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Refresh the table with current data and pagination\r\n   */\r\n  async refreshTable() {\r\n    let dataToRender;\r\n    \r\n    if (this.virtualScrollManager && this.virtualScrollManager.isEnabled()) {\r\n      // Virtual scrolling mode - get all data for virtual scrolling manager\r\n      dataToRender = this.dataManager.getData();\r\n      \r\n      // Initialize or update virtual scrolling with full dataset\r\n      this.virtualScrollManager.updateData(dataToRender);\r\n      \r\n      // Render the table structure first (without data rows)\r\n      this.renderer.renderTable([], true); // Pass empty array and virtualMode flag\r\n      \r\n      // Initialize virtual scrolling after table structure is ready\r\n      this.virtualScrollManager.init(dataToRender);\r\n    } else if (this.paginationManager) {\r\n      // Traditional pagination mode\r\n      dataToRender = await this.paginationManager.getPageData();\r\n      this.renderer.renderTable(dataToRender);\r\n    } else {\r\n      // No pagination, show all data (traditional mode)\r\n      dataToRender = this.dataManager.getData();\r\n      this.renderer.renderTable(dataToRender);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Load new data into the table\r\n   * Supports multiple data sources:\r\n   * - Array: loadData([{id: 1, name: 'John'}])\r\n   * - URL string: loadData('/api/data')\r\n   * - Async function: loadData(() => fetch('/api/data').then(r => r.json()))\r\n   * @param {Array|string|Function} source - Data source\r\n   */\r\n  async loadData(source) {\r\n    try {\r\n      // Trigger beforeLoad hook\r\n      this.eventManager.trigger('beforeLoad', { source });\r\n\r\n      let data;\r\n\r\n      // Handle different data source types\r\n      if (Array.isArray(source)) {\r\n        // Direct array data\r\n        data = source;\r\n      } else if (typeof source === 'string') {\r\n        // URL string - fetch data\r\n        data = await this._fetchFromUrl(source);\r\n      } else if (typeof source === 'function') {\r\n        // Custom async function\r\n        data = await source();\r\n      } else {\r\n        throw new Error('Invalid data source. Expected array, URL string, or function.');\r\n      }\r\n\r\n      // Validate data\r\n      if (!Array.isArray(data)) {\r\n        throw new Error('Data source must resolve to an array.');\r\n      }\r\n\r\n      // Update data and refresh table\r\n      this.dataManager.setData(data);\r\n      await this.refreshTable();\r\n      \r\n      // Trigger afterLoad hook\r\n      this.eventManager.trigger('afterLoad', { data, source });\r\n\r\n    } catch (error) {\r\n      // Handle loading errors\r\n      console.error('Error loading data:', error);\r\n      this.eventManager.trigger('loadError', { error, source });\r\n      \r\n      // Render error state\r\n      if (this.renderer && this.renderer.renderError) {\r\n        this.renderer.renderError(error);\r\n      }\r\n      \r\n      // Re-throw for caller handling\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Internal method to fetch data from URL\r\n   * @private\r\n   */\r\n  async _fetchFromUrl(url) {\r\n    if (typeof fetch === 'undefined') {\r\n      throw new Error('fetch is not available. Please use a modern browser or provide a polyfill.');\r\n    }\r\n\r\n    const response = await fetch(url);\r\n    \r\n    if (!response.ok) {\r\n      throw new Error(`HTTP error! status: ${response.status} - ${response.statusText}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    return data;\r\n  }\r\n\r\n  /**\r\n   * Filter data by criteria\r\n   */\r\n  async filter(criteria) {\r\n    this.dataManager.applyFilter(criteria);\r\n    await this.refreshTable();\r\n    this.eventManager.trigger('afterFilter', criteria);\r\n  }\r\n\r\n  /**\r\n   * Sort data by column\r\n   * @param {string} columnName - Column to sort by\r\n   * @param {string|null} direction - 'asc', 'desc', or null (unsorted)\r\n   */\r\n  async sort(columnName, direction = 'asc') {\r\n    if (this.sortingManager) {\r\n      await this.sortingManager.sort(columnName, direction);\r\n    } else {\r\n      // Fallback to legacy sorting\r\n      this.dataManager.applySorting([{ column: columnName, direction }]);\r\n      await this.refreshTable();\r\n      this.eventManager.trigger('afterSort', [{ column: columnName, direction }]);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Toggle sort for a column (handles click cycling)\r\n   */\r\n  async toggleSort(columnName) {\r\n    if (this.sortingManager) {\r\n      await this.sortingManager.toggleSort(columnName);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear all sorting\r\n   */\r\n  async clearSorting() {\r\n    if (this.sortingManager) {\r\n      await this.sortingManager.clearSorting();\r\n    } else {\r\n      // Fallback to legacy sorting\r\n      this.dataManager.clearSorting();\r\n      await this.refreshTable();\r\n      this.eventManager.trigger('afterSort', []);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current sort state\r\n   */\r\n  getSortState() {\r\n    if (this.sortingManager) {\r\n      return this.sortingManager.getSortState();\r\n    }\r\n    return { sort: null, mode: 'client' };\r\n  }\r\n\r\n  /**\r\n   * Clear all filters\r\n   */\r\n  async clearFilters() {\r\n    this.dataManager.clearFilters();\r\n    await this.refreshTable();\r\n    this.eventManager.trigger('afterFilter', {});\r\n  }\r\n\r\n  /**\r\n   * Clear all sorting\r\n   */\r\n  async clearSorting() {\r\n    if (this.sortingManager) {\r\n      await this.sortingManager.clearSorting();\r\n    } else {\r\n      // Fallback to legacy sorting\r\n      this.dataManager.clearSorting();\r\n      await this.refreshTable();\r\n      this.eventManager.trigger('afterSort', []);\r\n    }\r\n  }\r\n\r\n  // ===== FILTERING API =====\r\n\r\n  /**\r\n   * Apply filter to a specific column\r\n   * @param {string} columnName - Column to filter\r\n   * @param {Object} filterConfig - Filter configuration\r\n   * @example\r\n   * table.applyFilter('status', { type: 'value', values: ['Active', 'Pending'] });\r\n   * table.applyFilter('name', { type: 'condition', conditions: [{ operator: 'beginsWith', value: 'A' }] });\r\n   */\r\n  async applyFilter(columnName, filterConfig) {\r\n    if (this.filterManager) {\r\n      await this.filterManager.applyFilter(columnName, filterConfig);\r\n    } else {\r\n      console.warn('TablixJS: Filtering is not enabled. Set filtering.enabled to true in options.');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear filter for a specific column\r\n   * @param {string} columnName - Column to clear filter for\r\n   */\r\n  async clearFilter(columnName) {\r\n    if (this.filterManager) {\r\n      await this.filterManager.clearFilter(columnName);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear all filters\r\n   */\r\n  async clearAllFilters() {\r\n    if (this.filterManager) {\r\n      await this.filterManager.clearAllFilters();\r\n    } else {\r\n      // Fallback to legacy method\r\n      this.dataManager.clearFilters();\r\n      await this.refreshTable();\r\n      this.eventManager.trigger('afterFilter', {});\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get active filters\r\n   * @returns {Object} Active filters by column\r\n   */\r\n  getActiveFilters() {\r\n    return this.filterManager ? this.filterManager.getActiveFilters() : {};\r\n  }\r\n\r\n  /**\r\n   * Get filter state for a column\r\n   * @param {string} columnName - Column name\r\n   * @returns {Object|null} Filter state\r\n   */\r\n  getColumnFilter(columnName) {\r\n    return this.filterManager ? this.filterManager.getColumnFilter(columnName) : null;\r\n  }\r\n\r\n  // ===== SEARCH API =====\r\n\r\n  /**\r\n   * Set search term programmatically\r\n   * @param {string} searchTerm - Search term\r\n   */\r\n  async setSearchTerm(searchTerm) {\r\n    if (this.searchManager) {\r\n      await this.searchManager.setSearchTerm(searchTerm);\r\n    } else {\r\n      console.warn('TablixJS: Search is not enabled. Set search.enabled to true in options.');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current search term\r\n   * @returns {string} Current search term\r\n   */\r\n  getSearchTerm() {\r\n    return this.searchManager ? this.searchManager.getSearchTerm() : '';\r\n  }\r\n\r\n  /**\r\n   * Clear search\r\n   */\r\n  async clearSearch() {\r\n    if (this.searchManager) {\r\n      await this.searchManager.clearSearch();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get search information\r\n   * @returns {Object} Search results information\r\n   */\r\n  getSearchInfo() {\r\n    return this.searchManager ? this.searchManager.getSearchInfo() : null;\r\n  }\r\n\r\n  // ===== PAGINATION API =====\r\n\r\n  /**\r\n   * Go to next page\r\n   */\r\n  async nextPage() {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.nextPage();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to previous page\r\n   */\r\n  async prevPage() {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.prevPage();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to first page\r\n   */\r\n  async firstPage() {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.firstPage();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to last page\r\n   */\r\n  async lastPage() {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.lastPage();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to specific page\r\n   */\r\n  async goToPage(pageNumber) {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.goToPage(pageNumber);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Change page size\r\n   */\r\n  async changePageSize(pageSize) {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.changePageSize(pageSize);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get pagination information\r\n   */\r\n  getPaginationInfo() {\r\n    return this.paginationManager ? this.paginationManager.getInfo() : null;\r\n  }\r\n\r\n  /**\r\n   * Enable/disable pagination\r\n   */\r\n  async setPaginationEnabled(enabled) {\r\n    if (this.paginationManager) {\r\n      this.paginationManager.setEnabled(enabled);\r\n      await this.refreshTable();\r\n    } else if (enabled) {\r\n      // Create pagination manager if it doesn't exist\r\n      this.paginationManager = new PaginationManager(this, this.options.pagination);\r\n      await this.refreshTable();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Switch between client-side and server-side pagination\r\n   */\r\n  async setPaginationMode(mode, serverDataLoader = null) {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.setMode(mode, serverDataLoader);\r\n    }\r\n  }\r\n\r\n  // ===== EVENT MANAGEMENT =====\r\n\r\n  /**\r\n   * Register event callback\r\n   */\r\n  on(event, callback) {\r\n    this.eventManager.on(event, callback);\r\n  }\r\n\r\n  /**\r\n   * Remove event callback\r\n   */\r\n  off(event, callback) {\r\n    this.eventManager.off(event, callback);\r\n  }\r\n\r\n  /**\r\n   * Clear event listeners\r\n   */\r\n  clearEvents(event) {\r\n    this.eventManager.clear(event);\r\n  }\r\n\r\n  /**\r\n   * Trigger event\r\n   */\r\n  trigger(event, data) {\r\n    this.eventManager.trigger(event, data);\r\n  }\r\n\r\n  // ===== UTILITY METHODS =====\r\n\r\n  /**\r\n   * Get current filtered data\r\n   */\r\n  getData() {\r\n    return this.dataManager.getData();\r\n  }\r\n\r\n  /**\r\n   * Get original unfiltered data\r\n   */\r\n  getOriginalData() {\r\n    return this.dataManager.originalData;\r\n  }\r\n\r\n  /**\r\n   * Get table options\r\n   */\r\n  getOptions() {\r\n    return this.options;\r\n  }\r\n\r\n  /**\r\n   * Update table options\r\n   */\r\n  async setOptions(newOptions) {\r\n    this.options = { ...this.options, ...newOptions };\r\n    \r\n    // Update pagination options if provided\r\n    if (newOptions.pagination && this.paginationManager) {\r\n      this.paginationManager.options = { ...this.paginationManager.options, ...newOptions.pagination };\r\n    }\r\n    \r\n    // Update selection options if provided\r\n    if (newOptions.selection && this.selectionManager) {\r\n      this.selectionManager.options = { ...this.selectionManager.options, ...newOptions.selection };\r\n      \r\n      // Re-initialize if enabled state changed\r\n      if (newOptions.selection.enabled !== undefined) {\r\n        if (newOptions.selection.enabled) {\r\n          this.selectionManager.enable();\r\n        } else {\r\n          this.selectionManager.disable();\r\n        }\r\n      }\r\n      \r\n      // Update mode if provided\r\n      if (newOptions.selection.mode) {\r\n        this.selectionManager.setMode(newOptions.selection.mode);\r\n      }\r\n    }\r\n    \r\n    await this.refreshTable();\r\n  }\r\n\r\n  // ===== SELECTION API =====\r\n\r\n  /**\r\n   * Get selected row data\r\n   * @returns {Array} Array of selected row data objects\r\n   */\r\n  getSelectedData() {\r\n    return this.selectionManager ? this.selectionManager.getSelectedData() : [];\r\n  }\r\n\r\n  /**\r\n   * Get selected row IDs\r\n   * @returns {Array} Array of selected row IDs\r\n   */\r\n  getSelectedIds() {\r\n    return this.selectionManager ? this.selectionManager.getSelectedIds() : [];\r\n  }\r\n\r\n  /**\r\n   * Programmatically select rows by ID\r\n   * @param {String|Array} rowIds - Single row ID or array of row IDs\r\n   */\r\n  selectRows(rowIds) {\r\n    if (this.selectionManager) {\r\n      this.selectionManager.selectRows(rowIds);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Programmatically deselect rows by ID\r\n   * @param {String|Array} rowIds - Single row ID or array of row IDs\r\n   */\r\n  deselectRows(rowIds) {\r\n    if (this.selectionManager) {\r\n      this.selectionManager.deselectRows(rowIds);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear all selections\r\n   */\r\n  clearSelection() {\r\n    if (this.selectionManager) {\r\n      this.selectionManager.clearSelection();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if a row is selected\r\n   * @param {String} rowId - Row ID to check\r\n   * @returns {Boolean} True if row is selected\r\n   */\r\n  isRowSelected(rowId) {\r\n    return this.selectionManager ? this.selectionManager.isRowSelected(rowId) : false;\r\n  }\r\n\r\n  /**\r\n   * Get selection count\r\n   * @returns {Number} Number of selected rows\r\n   */\r\n  getSelectionCount() {\r\n    return this.selectionManager ? this.selectionManager.getSelectionCount() : 0;\r\n  }\r\n\r\n  /**\r\n   * Enable selection\r\n   */\r\n  enableSelection() {\r\n    if (this.selectionManager) {\r\n      this.selectionManager.enable();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Disable selection\r\n   */\r\n  disableSelection() {\r\n    if (this.selectionManager) {\r\n      this.selectionManager.disable();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set selection mode\r\n   * @param {String} mode - 'single' or 'multi'\r\n   */\r\n  setSelectionMode(mode) {\r\n    if (this.selectionManager) {\r\n      this.selectionManager.setMode(mode);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Select all rows (currently visible/filtered rows)\r\n   * This will select all rows that are currently visible based on applied filters and search\r\n   * @returns {Number} Number of rows selected\r\n   */\r\n  selectAllRows() {\r\n    if (!this.selectionManager) {\r\n      console.warn('TablixJS: Selection is not enabled. Set selection.enabled to true in options.');\r\n      return 0;\r\n    }\r\n\r\n    // Get currently visible/filtered data\r\n    const allData = this.getData();\r\n    \r\n    if (allData.length === 0) {\r\n      console.warn('TablixJS: No rows available to select.');\r\n      return 0;\r\n    }\r\n\r\n    // Extract all IDs from current data\r\n    const dataIdKey = this.options.selection.dataIdKey || 'id';\r\n    const allIds = allData.map(row => String(row[dataIdKey]));\r\n\r\n    // Select all rows\r\n    this.selectionManager.selectRows(allIds);\r\n\r\n    // Trigger custom event for select all action\r\n    this.eventManager.trigger('selectAll', { \r\n      selectedIds: allIds, \r\n      selectedData: allData,\r\n      count: allData.length \r\n    });\r\n\r\n    return allData.length;\r\n  }\r\n\r\n  // ===== LOCALIZATION API =====\r\n\r\n  /**\r\n   * Get localized string by key\r\n   * @param {string} key - Translation key (e.g., 'pagination.next')\r\n   * @param {Object} params - Parameters to substitute in the translation\r\n   * @returns {string} Localized string\r\n   */\r\n  t(key, params = {}) {\r\n    return this.localization.t(key, params);\r\n  }\r\n\r\n  /**\r\n   * Set the current language\r\n   * @param {string} language - Language code (e.g., 'en', 'fr', 'es')\r\n   */\r\n  setLanguage(language) {\r\n    // Close any open filter dropdowns before changing language\r\n    if (this.filterUI && this.filterUI.activeDropdown) {\r\n      this.filterUI.closeAllDropdowns();\r\n    }\r\n    \r\n    this.localization.setLanguage(language);\r\n    this.options.language = language;\r\n    \r\n    // Ensure language translations are available\r\n    this.ensureLanguageTranslations(language);\r\n    \r\n    // Re-render table to apply new translations\r\n    this.refreshTable();\r\n  }\r\n\r\n  /**\r\n   * Ensure language translations are loaded\r\n   * @private\r\n   * @param {string} language - Language code\r\n   */\r\n  ensureLanguageTranslations(language) {\r\n    // If translations are already available, no need to reload\r\n    if (this.localization.hasLanguage(language)) {\r\n      return;\r\n    }\r\n    \r\n    // Auto-load translations for common languages\r\n    const languageLoaders = {\r\n      'fr': () => frenchTranslations,\r\n      'es': () => spanishTranslations,\r\n      'sr': () => serbianTranslations\r\n    };\r\n    \r\n    if (languageLoaders[language]) {\r\n      try {\r\n        const translations = languageLoaders[language]();\r\n        this.localization.addTranslations(language, translations);\r\n        console.log(`TablixJS: Auto-loaded ${language} translations`);\r\n      } catch (error) {\r\n        console.warn(`TablixJS: Failed to auto-load ${language} translations:`, error);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add translations for a specific language\r\n   * @param {string} language - Language code\r\n   * @param {Object} translations - Translations object\r\n   */\r\n  addTranslations(language, translations) {\r\n    this.localization.addTranslations(language, translations);\r\n    // If we just added translations for the current language, re-render\r\n    if (language === this.localization.getCurrentLanguage()) {\r\n      this.refreshTable();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add a complete language pack (convenience method for developers)\r\n   * This method helps developers add a new language with all required translations\r\n   * @param {string} language - Language code (e.g., 'de', 'it', 'pt')\r\n   * @param {Object} translations - Complete translations object\r\n   * @param {boolean} setAsCurrent - Whether to immediately set this as the current language\r\n   */\r\n  addLanguagePack(language, translations, setAsCurrent = false) {\r\n    // Add the translations\r\n    this.addTranslations(language, translations);\r\n    \r\n    // Optionally set as current language\r\n    if (setAsCurrent) {\r\n      this.setLanguage(language);\r\n    }\r\n    \r\n    console.log(`TablixJS: Language pack '${language}' added successfully`);\r\n  }\r\n\r\n  /**\r\n   * Get current language\r\n   * @returns {string} Current language code\r\n   */\r\n  getCurrentLanguage() {\r\n    return this.localization.getCurrentLanguage();\r\n  }\r\n\r\n  /**\r\n   * Get available languages\r\n   * @returns {Array<string>} Array of available language codes\r\n   */\r\n  getAvailableLanguages() {\r\n    return this.localization.getAvailableLanguages();\r\n  }\r\n\r\n  /**\r\n   * Check if a language is available\r\n   * @param {string} language - Language code to check\r\n   * @returns {boolean} True if language is available\r\n   */\r\n  hasLanguage(language) {\r\n    return this.localization.hasLanguage(language);\r\n  }\r\n\r\n  /**\r\n   * Format number using current locale\r\n   * @param {number} number - Number to format\r\n   * @param {Object} options - Formatting options\r\n   * @returns {string} Formatted number\r\n   */\r\n  formatNumber(number, options = {}) {\r\n    return this.localization.formatNumber(number, options);\r\n  }\r\n\r\n  /**\r\n   * Format date using current locale\r\n   * @param {Date|string|number} date - Date to format\r\n   * @param {Object} options - Formatting options\r\n   * @returns {string} Formatted date\r\n   */\r\n  formatDate(date, options = {}) {\r\n    return this.localization.formatDate(date, options);\r\n  }\r\n\r\n  /**\r\n   * Destroy the table and clean up all resources\r\n   */\r\n  destroy() {\r\n    // Clean up virtual scrolling\r\n    if (this.virtualScrollManager) {\r\n      this.virtualScrollManager.destroy();\r\n    }\r\n\r\n    // Clean up other managers\r\n    if (this.selectionManager) {\r\n      this.selectionManager.destroy && this.selectionManager.destroy();\r\n    }\r\n\r\n    if (this.searchManager) {\r\n      this.searchManager.destroy && this.searchManager.destroy();\r\n    }\r\n\r\n    if (this.filterManager) {\r\n      this.filterManager.destroy && this.filterManager.destroy();\r\n    }\r\n\r\n    if (this.sortingManager) {\r\n      this.sortingManager.destroy && this.sortingManager.destroy();\r\n    }\r\n\r\n    if (this.paginationManager) {\r\n      this.paginationManager.destroy && this.paginationManager.destroy();\r\n    }\r\n\r\n    // Clear container\r\n    if (this.container) {\r\n      this.container.innerHTML = '';\r\n    }\r\n\r\n    // Clear references\r\n    this.virtualScrollManager = null;\r\n    this.selectionManager = null;\r\n    this.searchManager = null;\r\n    this.filterManager = null;\r\n    this.sortingManager = null;\r\n    this.paginationManager = null;\r\n    this.dataManager = null;\r\n    this.renderer = null;\r\n    this.eventManager = null;\r\n  }\r\n\r\n  /**\r\n   * Destroy table and clean up event listeners\r\n   */\r\n  destroy() {\r\n    // Clean up any event listeners\r\n    const paginationContainer = this.container.querySelector('.tablix-pagination');\r\n    if (paginationContainer) {\r\n      paginationContainer.removeEventListener('click', this._paginationClickHandler);\r\n    }\r\n\r\n    // Destroy managers\r\n    if (this.selectionManager) {\r\n      this.selectionManager.destroy();\r\n    }\r\n\r\n    // Clear container\r\n    this.container.innerHTML = '';\r\n    \r\n    // Clear references\r\n    this.dataManager = null;\r\n    this.renderer = null;\r\n    this.eventManager = null;\r\n    this.paginationManager = null;\r\n    this.sortingManager = null;\r\n    this.selectionManager = null;\r\n  }\r\n}","/**\r\n * TablixJS jQuery Wrapper Bundle\r\n * This file bundles TablixJS core with the jQuery wrapper for standalone use\r\n */\r\n\r\n// Import TablixJS core (default export is the Table class)\r\nimport Table from '../index.js';\r\n\r\n// Import the jQuery wrapper initializer\r\nimport { initializeJQueryWrapper } from './tablixjs-jquery-bundled.js';\r\n\r\n// Create TablixJS object with both the Table class and named export\r\nconst TablixJS = Table;\r\nTablixJS.Table = Table;\r\n\r\n// Expose TablixJS globally FIRST (before importing jQuery wrapper)\r\nif (typeof window !== 'undefined') {\r\n  window.TablixJS = TablixJS;\r\n} else if (typeof global !== 'undefined') {\r\n  global.TablixJS = TablixJS;\r\n}\r\n\r\n// Initialize the jQuery wrapper (this ensures the function is called and not tree-shaken)\r\nconst jQueryWrapperInitialized = initializeJQueryWrapper();\r\nconsole.log('TablixJS jQuery bundle initialized:', jQueryWrapperInitialized);\r\n\r\n// Export TablixJS as default (no named exports to avoid the warning)\r\nexport default TablixJS;\r\n","/**\r\n * TablixJS jQuery Wrapper for Bundled Version\r\n * This version directly imports the Table class instead of looking for globals\r\n */\r\n\r\n// Import the Table class directly\r\nimport Table from '../core/Table.js';\r\n\r\n/**\r\n * Initialize jQuery wrapper with direct Table class reference\r\n * This function is called by the bundle to set up the jQuery plugin\r\n */\r\nexport function initializeJQueryWrapper() {\r\n  // Get jQuery from various sources\r\n  const $ = (typeof window !== 'undefined' && (window.jQuery || window.$)) || \r\n            (typeof global !== 'undefined' && (global.jQuery || global.$)) ||\r\n            (typeof require === 'function' ? (() => {\r\n              try { return require('jquery'); } catch(e) { return null; }\r\n            })() : null);\r\n\r\n  if (!$) {\r\n    // jQuery not available - this is OK, just don't register the plugin\r\n    console.warn('TablixJS jQuery wrapper: jQuery is not available. The wrapper will not be registered.');\r\n    return false;\r\n  }\r\n\r\n  // Plugin name\r\n  const PLUGIN_NAME = 'tablixJS';\r\n  \r\n  // Data key for storing TablixJS instances\r\n  const DATA_KEY = 'tablixjs-instance';\r\n  \r\n  /**\r\n   * TablixJS jQuery Plugin\r\n   * @param {Object|String} options - Configuration options or method name\r\n   * @param {...*} args - Additional arguments for method calls\r\n   * @returns {jQuery|*} - jQuery chainable object or method result\r\n   */\r\n  $.fn[PLUGIN_NAME] = function(options, ...args) {\r\n    // Handle method calls on existing instances\r\n    if (typeof options === 'string') {\r\n      const method = options;\r\n      const $element = $(this.first()); // Use first element for method calls\r\n      const instance = $element.data(DATA_KEY);\r\n\r\n      if (!instance) {\r\n        console.error(`TablixJS: Cannot call method '${method}' - table not initialized`);\r\n        return this;\r\n      }\r\n\r\n      // Methods that return data (not chainable)\r\n      const dataReturningMethods = ['getData', 'getSelectedData', 'getSelectedIds', 'getPaginationInfo', 'getSearchTerm', 'getSearchInfo', 'getActiveFilters', 'getColumnFilter', 'getSortState', 'getSelectionCount', 'isRowSelected'];\r\n      \r\n      if (dataReturningMethods.includes(method)) {\r\n        switch (method) {\r\n          case 'getData':\r\n            return instance.getData();\r\n          case 'getSelectedData':\r\n            return instance.getSelectedData();\r\n          case 'getSelectedIds':\r\n            return instance.getSelectedIds();\r\n          case 'getPaginationInfo':\r\n            return instance.getPaginationInfo();\r\n          case 'getSearchTerm':\r\n            return instance.getSearchTerm();\r\n          case 'getSearchInfo':\r\n            return instance.getSearchInfo();\r\n          case 'getActiveFilters':\r\n            return instance.getActiveFilters();\r\n          case 'getColumnFilter':\r\n            return instance.getColumnFilter(args[0]);\r\n          case 'getSortState':\r\n            return instance.getSortState();\r\n          case 'getSelectionCount':\r\n            return instance.getSelectionCount();\r\n          case 'isRowSelected':\r\n            return instance.isRowSelected(args[0]);\r\n          default:\r\n            return undefined;\r\n        }\r\n      }\r\n\r\n      // Methods that don't return data (chainable)\r\n      switch (method) {\r\n        case 'destroy':\r\n          instance.destroy();\r\n          $element.removeData(DATA_KEY);\r\n          break;\r\n        case 'reload':\r\n        case 'loadData':\r\n          const newData = args[0];\r\n          if (newData) {\r\n            instance.loadData(newData);\r\n          }\r\n          break;\r\n        case 'clearSelection':\r\n          instance.clearSelection();\r\n          break;\r\n        case 'refresh':\r\n          instance.refreshTable();\r\n          break;\r\n        case 'selectRows':\r\n          instance.selectRows(args[0]);\r\n          break;\r\n        case 'deselectRows':\r\n          instance.deselectRows(args[0]);\r\n          break;\r\n        case 'selectAllRows':\r\n          instance.selectAllRows();\r\n          break;\r\n        case 'clearSearch':\r\n          instance.clearSearch();\r\n          break;\r\n        case 'setSearchTerm':\r\n          instance.setSearchTerm(args[0]);\r\n          break;\r\n        case 'applyFilter':\r\n          instance.applyFilter(args[0], args[1]);\r\n          break;\r\n        case 'clearFilter':\r\n          instance.clearFilter(args[0]);\r\n          break;\r\n        case 'clearAllFilters':\r\n          instance.clearAllFilters();\r\n          break;\r\n        case 'sort':\r\n          instance.sort(args[0], args[1]);\r\n          break;\r\n        case 'toggleSort':\r\n          instance.toggleSort(args[0]);\r\n          break;\r\n        case 'clearSorting':\r\n          instance.clearSorting();\r\n          break;\r\n        case 'nextPage':\r\n          instance.nextPage();\r\n          break;\r\n        case 'prevPage':\r\n          instance.prevPage();\r\n          break;\r\n        case 'firstPage':\r\n          instance.firstPage();\r\n          break;\r\n        case 'lastPage':\r\n          instance.lastPage();\r\n          break;\r\n        case 'goToPage':\r\n          instance.goToPage(args[0]);\r\n          break;\r\n        case 'changePageSize':\r\n          instance.changePageSize(args[0]);\r\n          break;\r\n        default:\r\n          console.warn(`TablixJS: Unknown method '${method}'`);\r\n      }\r\n      \r\n      // Return jQuery object for chaining for non-data methods\r\n      return this;\r\n    }\r\n\r\n    // Initialize new instances (chainable)\r\n    return this.each(function() {\r\n      const $element = $(this);\r\n      initializeTable($element, options);\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Initialize table instance\r\n   * @private\r\n   */\r\n  function initializeTable($element, options = {}) {\r\n    // Get existing instance\r\n    const existingInstance = $element.data(DATA_KEY);\r\n    \r\n    // If instance already exists, destroy it first\r\n    if (existingInstance) {\r\n      console.warn('TablixJS: Reinitializing existing table instance.');\r\n      existingInstance.destroy();\r\n    }\r\n    \r\n    // Normalize options structure\r\n    const normalizedOptions = normalizeOptions(options);\r\n    \r\n    try {\r\n      // Create new TablixJS instance using direct Table class reference\r\n      const instance = new Table($element[0], normalizedOptions);\r\n      \r\n      // Store instance reference\r\n      $element.data(DATA_KEY, instance);\r\n      \r\n      // Set up jQuery-specific event forwarding\r\n      setupJQueryEventForwarding($element, instance);\r\n      \r\n    } catch (error) {\r\n      console.error('TablixJS: Failed to initialize table:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Normalize options to handle jQuery-specific patterns\r\n   * @private\r\n   */\r\n  function normalizeOptions(options) {\r\n    // Handle jQuery-style option patterns\r\n    const normalized = { ...options };\r\n\r\n    // Convert jQuery elements to DOM elements\r\n    if (options.container && options.container.jquery) {\r\n      normalized.container = options.container[0];\r\n    }\r\n\r\n    return normalized;\r\n  }\r\n\r\n  /**\r\n   * Set up jQuery event forwarding\r\n   * @private\r\n   */\r\n  function setupJQueryEventForwarding($element, instance) {\r\n    // Forward TablixJS events as jQuery events\r\n    const eventsToForward = [\r\n      'beforeLoad', 'afterLoad', 'loadError',\r\n      'beforeSort', 'afterSort', \r\n      'beforeFilter', 'afterFilter',\r\n      'beforePageChange', 'afterPageChange',\r\n      'selectionChanged', 'selectAll'\r\n    ];\r\n\r\n    eventsToForward.forEach(eventName => {\r\n      instance.on(eventName, (data) => {\r\n        $element.trigger(`tablixjs:${eventName}`, data);\r\n      });\r\n    });\r\n  }\r\n\r\n  // jQuery plugin static methods\r\n  \r\n  /**\r\n   * Get TablixJS instance from element\r\n   * @param {jQuery|String} element - jQuery element or selector\r\n   * @returns {Object|null} - TablixJS instance or null\r\n   */\r\n  $.fn[PLUGIN_NAME].getInstance = function(element) {\r\n    const $el = $(element);\r\n    return $el.length > 0 ? $el.data(DATA_KEY) : null;\r\n  };\r\n\r\n  /**\r\n   * Check if element has TablixJS initialized\r\n   * @param {jQuery|String} element - jQuery element or selector\r\n   * @returns {Boolean} - True if initialized\r\n   */\r\n  $.fn[PLUGIN_NAME].isInitialized = function(element) {\r\n    const $el = $(element);\r\n    return $el.length > 0 && !!$el.data(DATA_KEY);\r\n  };\r\n\r\n  /**\r\n   * Destroy all TablixJS instances on the page\r\n   */\r\n  $.fn[PLUGIN_NAME].destroyAll = function() {\r\n    $(`[data-${DATA_KEY}]`).each(function() {\r\n      const $el = $(this);\r\n      const instance = $el.data(DATA_KEY);\r\n      if (instance) {\r\n        instance.destroy();\r\n        $el.removeData(DATA_KEY);\r\n      }\r\n    });\r\n  };\r\n\r\n  console.log('TablixJS jQuery plugin initialized successfully (bundled version)');\r\n  return true;\r\n}\r\n"],"names":["DataManager","constructor","table","data","this","originalData","filteredData","currentFilters","currentSorts","serverTotalRows","getData","setData","paginationManager","updatePaginationInfo","setServerData","totalRows","getTotalRows","length","applyFilter","criteria","Object","keys","filter","item","entries","every","key","value","toLowerCase","includes","resetToFirstPage","setFilteredData","applySorting","sorts","sortingManager","_applySorting","sort","a","b","column","direction","aVal","bVal","comparison","clearFilters","clearSorting","getPageData","page","pageSize","start","slice","Renderer","renderTable","virtualMode","columns","columnManager","getColumns","options","controlsOptions","controls","isVirtualScrollEnabled","virtualScrollManager","isEnabled","preservedSearchValue","searchInputHadFocus","cursorPosition","existingSearchInput","container","querySelector","document","activeElement","selectionStart","html","selectionManager","enabled","mode","position","renderControls","virtualScroll","containerHeight","forEach","col","isSortable","_isColumnSortable","sortDirection","_getSortDirection","name","title","t","row","index","globalIndex","currentPage","cell","renderedCell","result","formatCellValue","isHtml","escapeHtml","renderer","innerHTML","newSearchInput","renderPagination","bindControlEvents","searchManager","bindEvents","bindSortEvents","bindRowClickEvents","filterUI","renderFilterIcons","requestAnimationFrame","focus","setSelectionRange","eventManager","trigger","paginationContainer","info","getInfo","undefined","totalPages","showPageSizes","startRow","endRow","pageSizeOptions","size","showFirstLast","showPrevNext","hasPrevPage","showPageNumbers","getPageNumbers","hasNextPage","isLoading","bindPaginationEvents","addEventListener","async","e","target","classList","contains","disabled","preventDefault","parseInt","dataset","isNaN","goToPage","error","console","pageSizeSelect","newPageSize","changePageSize","text","div","createElement","textContent","renderLoading","renderError","message","searchOptions","search","placeholder","pagination","currentPageSize","refresh","placeholderText","wrapper","action","firstPage","prevPage","nextPage","lastPage","handleRefresh","handleExport","onRefresh","newData","loadData","refreshTable","csv","map","join","values","replace","blob","Blob","type","url","URL","createObjectURL","href","download","body","appendChild","click","removeChild","revokeObjectURL","format","headerRow","th","closest","columnName","toggleSort","tbody","globalRowIndex","rowIndex","localRowIndex","currentData","getCurrentPageData","rowData","originalEvent","dataManager","updateSortIndicators","currentSort","querySelectorAll","isSorted","remove","indicator","arrow","add","setAttribute","removeAttribute","isColumnSortable","getSortDirection","EventManager","events","on","event","callback","push","off","indexOf","splice","clear","payload","cb","PaginationManager","maxPageNumbers","serverDataLoader","init","Math","ceil","getClientPageData","getServerPageData","Error","filters","pageNumber","targetPage","max","min","oldPage","newPage","oldPageSize","floor","pageData","maxPages","pages","end","i","unshift","setEnabled","setMode","SortingManager","serverSortLoader","defaultSortType","caseSensitive","nullsFirst","sortOrder","sortTypes","auto","_autoSort","bind","string","_stringSort","number","_numberSort","date","_dateSort","boolean","_booleanSort","_sortServer","_sortClient","currentIndex","nextDirection","warn","find","_compareValues","sortFunction","sortType","numA","parseFloat","numB","dateA","Date","dateB","isDateLike","str","test","String","strA","trim","strB","localeCompare","sensitivity","boolA","getSortState","setOptions","newOptions","sortable","ColumnManager","formatters","Map","supportedFormats","initializeColumns","prepareColumn","compileFormatters","prepared","formatter","createFormatter","set","locale","formatOptions","formatText","formatDate","formatCurrency","currency","formatNumber","formatPercent","getColumn","get","formattedValue","getTime","Intl","DateTimeFormat","numericValue","Number","style","NumberFormat","registerFormat","formatType","formatterFactory","log","getSupportedFormats","FilterManager","serverFilterLoader","debounceDelay","showBadges","showTooltips","columnFilters","operators","none","label","apply","isEmpty","isNotEmpty","equals","filterValue","notEquals","beginsWith","startsWith","endsWith","notContains","debounceTimer","openDropdowns","Set","filterConfig","validateFilterConfig","beforeFilterData","getActiveFilters","config","isActive","isFilterActive","_filterServer","_filterClient","updateFilterIndicators","activeFilters","clearFilter","has","delete","clearAllFilters","filterState","getColumnUniqueValues","Array","from","getColumnFilter","hasColumnFilter","isArray","conditions","cond","operator","some","_testRowAgainstFilter","cellValue","condition","header","hasFilter","filterIndicator","_updateFilterBadge","badge","badgeText","activeConditions","className","registerOperator","getOperators","FilterUI","filterManager","activeDropdown","handleDocumentClick","handleFilterIconClick","destroy","removeEventListener","closeAllDropdowns","thContent","filterIcon","stopPropagation","sortIndicator","insertBefore","nextSibling","dropdown","createFilterDropdown","showDropdown","renderDropdownContent","bindDropdownEvents","currentFilter","renderValueFilterPanel","renderConditionFilterPanel","uniqueValues","selectedValues","isChecked","renderConditionRow","needsValue","op","tab","switchTab","bindValueFilterEvents","bindConditionFilterEvents","valuePanel","searchInput","searchTimeout","clearTimeout","setTimeout","filterValueList","selectAllCheckbox","toggleSelectAll","checked","checkbox","updateSelectAllState","conditionPanel","addButton","addCondition","bindConditionRowEvents","select","valueInput","parentElement","button","conditionRow","operatorSelect","tabType","toggle","panel","searchTerm","items","term","matches","display","checkboxes","visibleCheckboxes","checkedCount","indeterminate","conditionsContainer","conditionHtml","children","insertAdjacentHTML","newCondition","lastElementChild","collectValueFilter","collectConditionFilter","conditionRows","top","left","visibility","triggerRect","getBoundingClientRect","dropdownRect","window","scrollX","bottom","scrollY","width","innerWidth","height","innerHeight","SearchManager","searchDelay","searchColumns","minLength","currentSearchTerm","handleSearchInput","handleSearchClear","source","performSearch","searchClear","clearSearch","updateClearButtonVisibility","previousTerm","hadFocus","willSearch","filterData","afterSearchData","resultsCount","totalCount","isSearchActive","searchPerformed","getSearchableColumns","updateInputValue","setSearchTerm","getSearchTerm","getSearchInfo","configure","oldOptions","getConfiguration","SelectionManager","selectedRows","lastSelectedRow","rowIdMap","dataIdKey","dragSelection","startRowIndex","currentRowIndex","startRowId","originalSelection","isDragging","dragThreshold","eventListeners","eventListenersSetup","setupEventListeners","handleRowClick","setupDragSelection","clearSelection","updateSelectionAfterDataChange","updateUI","rowId","getRowId","hasOriginalEvent","ctrlKey","shiftKey","metaKey","timestamp","now","beforeSelectEvent","currentSelection","isCtrlClick","isShiftClick","isDragSelection","handleSingleSelection","handleMultiSelection","afterSelectEvent","selectedData","getSelectedData","selectionSize","handleRangeSelection","endRowId","fullData","getFullData","startIndex","findIndex","endIndex","minIndex","maxIndex","tableElement","startX","startY","clientX","clientY","abs","startDragSelection","updateDragSelection","completeDragSelection","cancelDragSelection","tableWrapper","dragStart","applyDragSelection","dragComplete","resetDragSelection","createRowHash","JSON","stringify","hash","charCodeAt","allRows","hasAttribute","virtualIndex","getAttribute","allDataRowIds","newSelection","getSelectedIds","selectRows","rowIds","ids","id","deselectRows","hadSelection","isRowSelected","isRowSelectedByData","getSelectionCount","enable","disable","oldMode","lastSelected","VirtualScrollManager","buffer","rowHeight","throttleDelay","scrollContainer","tableBody","topSpacer","bottomSpacer","visibleStart","visibleEnd","renderedStart","renderedEnd","performanceData","renderTimes","scrollUpdates","lastMeasurement","throttledScrollHandler","throttle","handleScroll","immediateScrollHandler","updateScheduled","pendingUpdate","lastScrollTime","scrollVelocity","renderedData","setupScrollContainer","detectRowHeight","calculateViewport","scheduleUpdate","handleScrollImmediate","passive","handleScrollStart","handleScrollEnd","handleResize","setupEventDelegation","setupSelectionListeners","rowClickHandler","justFinishedDrag","eventType","element","updateSelectionStates","setupVirtualDragSelection","rowHoverHandler","createSpacers","existingTop","existingBottom","cssText","firstChild","sampleRow","renderSingleRow","rect","scrollTop","visibleRowCount","updateSpacers","bottomHeight","performance","lastScrollTop","timeDelta","isScrollbarDragging","scrollDragInterval","setInterval","clearInterval","isDragSelecting","dragStartIndex","dragStartX","dragStartY","applyVirtualDragSelection","handleMouseUp","update","startTime","renderVisibleRows","endTime","trackPerformance","fragment","createDocumentFragment","handleImageLoading","img","complete","cloneNode","src","handleLoad","opacity","handleError","transition","originalIndex","tr","td","rendered","updateData","scrollToRow","getVisibleRange","getRenderedData","renderTime","shift","getPerformanceStats","times","avg","reduce","averageRenderTime","toFixed","maxRenderTime","minRenderTime","visibleRows","renderedRows","func","limit","inThrottle","arguments","debug","Localization","currentLanguage","translations","fallbackLanguage","addTranslations","getDefaultEnglishTranslations","setLanguage","language","languageCode","existing","params","translation","getTranslationFromLanguage","substituteParameters","languageTranslations","split","current","k","regex","RegExp","getCurrentLanguage","getAvailableLanguages","hasLanguage","getAllTranslations","removeLanguage","clearTranslations","fallbackTranslations","minimumFractionDigits","maximumFractionDigits","getLocaleCode","fallbackNumberFormat","dateObj","toLocaleDateString","en","fr","es","de","it","pt","ru","ja","ko","zh","symbol","pluralize","count","singularKey","pluralKey","frenchTranslations","spanishTranslations","serbianTranslations","Table","sorting","filtering","export","selection","localization","lang","initialData","dataToRender","_fetchFromUrl","fetch","response","ok","status","statusText","json","getPaginationInfo","setPaginationEnabled","setPaginationMode","clearEvents","getOriginalData","getOptions","enableSelection","disableSelection","setSelectionMode","selectAllRows","allData","allIds","selectedIds","ensureLanguageTranslations","languageLoaders","sr","addLanguagePack","setAsCurrent","_paginationClickHandler","TablixJS","global","jQueryWrapperInitialized","$","jQuery","require","PLUGIN_NAME","DATA_KEY","fn","args","method","$element","first","instance","removeData","each","existingInstance","normalizedOptions","normalized","jquery","normalizeOptions","eventName","setupJQueryEventForwarding","initializeTable","getInstance","$el","isInitialized","destroyAll","initializeJQueryWrapper"],"mappings":"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"}