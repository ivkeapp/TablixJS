{"version":3,"file":"tablix.jquery.min.js","sources":["../src/core/DataManager.js","../src/core/Renderer.js","../src/core/EventManager.js","../src/core/PaginationManager.js","../src/core/ValueResolver.js","../src/core/SortingManager.js","../src/core/ColumnManager.js","../src/core/FilterManager.js","../src/core/FilterUI.js","../src/core/SearchManager.js","../src/core/SelectionManager.js","../src/core/VirtualScroll.js","../src/core/Localization.js","../src/core/StateManager.js","../src/locales/fr.js","../src/locales/es.js","../src/locales/sr.js","../src/core/Table.js","../src/jquery/index.js","../src/jquery/tablixjs-jquery-bundled.js"],"sourcesContent":["export default class DataManager {\r\n  constructor(table, data = []) {\r\n    this.table = table;\r\n    this.originalData = data;   // full data set\r\n    this.filteredData = [...data];  // filtered data\r\n    this.currentFilters = {};   // current filter criteria\r\n    this.currentSorts = [];     // current sort criteria (deprecated - use SortingManager)\r\n    this.serverTotalRows = null; // for server-side pagination\r\n  }\r\n\r\n  getData() {\r\n    return this.filteredData;\r\n  }\r\n\r\n  setData(data) {\r\n    this.originalData = data;\r\n    this.filteredData = [...data];\r\n    \r\n    // Update pagination info after data change\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.updatePaginationInfo();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set data from server (for server-side operations)\r\n   */\r\n  setServerData(data, totalRows = null) {\r\n    this.originalData = data;\r\n    this.filteredData = [...data];\r\n    this.serverTotalRows = totalRows;\r\n    \r\n    // Update pagination info after data change\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.updatePaginationInfo(totalRows);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get total rows (for server-side pagination)\r\n   */\r\n  getTotalRows() {\r\n    return this.serverTotalRows !== null ? this.serverTotalRows : this.originalData.length;\r\n  }\r\n\r\n  applyFilter(criteria) {\r\n    this.currentFilters = criteria;\r\n    \r\n    if (Object.keys(criteria).length === 0) {\r\n      // No filters, show all data\r\n      this.filteredData = [...this.originalData];\r\n    } else {\r\n      // Simple filtering: supports multiple criteria (legacy format)\r\n      this.filteredData = this.originalData.filter(item => {\r\n        return Object.entries(criteria).every(([key, value]) => {\r\n          const itemValue = (item[key] + '').toLowerCase();\r\n          const searchValue = (value + '').toLowerCase();\r\n          return itemValue.includes(searchValue);\r\n        });\r\n      });\r\n    }\r\n\r\n    // Reset pagination to first page after filtering\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.resetToFirstPage();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Apply filtering from FilterManager (this will be called by FilterManager)\r\n   * @param {Array} filteredData - Pre-filtered data from FilterManager\r\n   */\r\n  setFilteredData(filteredData) {\r\n    this.filteredData = filteredData;\r\n    \r\n    // Reset pagination to first page after filtering\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.resetToFirstPage();\r\n    }\r\n  }\r\n\r\n  applySorting(sorts) {\r\n    this.currentSorts = sorts;\r\n    \r\n    if (!sorts || sorts.length === 0) {\r\n      return;\r\n    }\r\n\r\n    // Use SortingManager if available, otherwise fall back to basic sorting\r\n    if (this.table.sortingManager && this.table.sortingManager.currentSorts.length > 0) {\r\n      this.table.sortingManager._applySorting();\r\n    } else {\r\n      // Legacy sorting implementation\r\n      this.filteredData.sort((a, b) => {\r\n        for (const sort of sorts) {\r\n          const { column, direction } = sort;\r\n          const aVal = a[column];\r\n          const bVal = b[column];\r\n          \r\n          let comparison = 0;\r\n          if (aVal < bVal) comparison = -1;\r\n          else if (aVal > bVal) comparison = 1;\r\n          \r\n          if (comparison !== 0) {\r\n            return direction === 'desc' ? -comparison : comparison;\r\n          }\r\n        }\r\n        return 0;\r\n      });\r\n    }\r\n\r\n    // Reset pagination to first page after sorting\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.resetToFirstPage();\r\n    }\r\n  }\r\n\r\n  clearFilters() {\r\n    this.currentFilters = {};\r\n    this.filteredData = [...this.originalData];\r\n    \r\n    // Reset pagination to first page\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.resetToFirstPage();\r\n    }\r\n  }\r\n\r\n  clearSorting() {\r\n    this.currentSorts = [];\r\n    // Don't change the filtered data order, just clear the sort state\r\n    \r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.resetToFirstPage();\r\n    }\r\n  }\r\n\r\n  // Legacy method for backward compatibility\r\n  getPageData(page = 1) {\r\n    const pageSize = this.table.paginationManager ? \r\n      this.table.paginationManager.pageSize : 10;\r\n    const start = (page - 1) * pageSize;\r\n    return this.filteredData.slice(start, start + pageSize);\r\n  }\r\n}","export default class Renderer {\r\n  constructor(table) {\r\n    this.table = table;\r\n  }\r\n\r\n  renderTable(data, virtualMode = false) {\r\n    const columns = this.table.columnManager ? this.table.columnManager.getColumns() : (this.table.options.columns || []);\r\n    const controlsOptions = this.table.options.controls;\r\n    const isVirtualScrollEnabled = this.table.virtualScrollManager && this.table.virtualScrollManager.isEnabled();\r\n\r\n    // Preserve search input value and focus state before re-rendering\r\n    let preservedSearchValue = '';\r\n    let searchInputHadFocus = false;\r\n    let cursorPosition = 0;\r\n    const existingSearchInput = this.table.container.querySelector('.tablix-search-input');\r\n    if (existingSearchInput) {\r\n      preservedSearchValue = existingSearchInput.value;\r\n      searchInputHadFocus = document.activeElement === existingSearchInput;\r\n      cursorPosition = existingSearchInput.selectionStart || 0;\r\n    }\r\n\r\n    // Determine selection attributes\r\n    const selectionEnabled = this.table.selectionManager && this.table.selectionManager.options.enabled;\r\n    const selectionAttributes = selectionEnabled \r\n      ? `data-selection-enabled data-selection-mode=\"${this.table.selectionManager.options.mode}\"` \r\n      : 'data-selection-disabled';\r\n\r\n    let html = `<div class=\"tablix-wrapper\" ${selectionAttributes}>`;\r\n    \r\n    // Top controls\r\n    if (controlsOptions.enabled && (controlsOptions.position === 'top' || controlsOptions.position === 'both')) {\r\n      html += this.renderControls('top');\r\n    }\r\n    \r\n    // Virtual scroll container (if enabled)\r\n    if (isVirtualScrollEnabled) {\r\n      const containerHeight = this.table.options.virtualScroll.containerHeight || 400;\r\n      html += `<div class=\"tablix-scroll-container\" style=\"height: ${containerHeight}px; overflow: auto; position: relative; border: 1px solid #ddd;\">`;\r\n    }\r\n    \r\n    // Table wrapper for horizontal scrolling (mobile support)\r\n    html += '<div class=\"tablix-table-wrapper\" style=\"overflow-x: auto;\">';\r\n    \r\n    // Table\r\n    html += '<table class=\"tablix-table\" style=\"width:100%; border-collapse:collapse;\">';\r\n\r\n    // Header\r\n    html += '<thead class=\"tablix-thead\"><tr class=\"tablix-header-row\">';\r\n    columns.forEach(col => {\r\n      const isSortable = this._isColumnSortable(col);\r\n      const sortDirection = this._getSortDirection(col.name);\r\n      const sortClass = isSortable ? ' tablix-sortable' : '';\r\n      const sortDirectionClass = sortDirection ? ` tablix-sorted tablix-sorted-${sortDirection}` : '';\r\n      \r\n      html += `<th class=\"tablix-th${sortClass}${sortDirectionClass}\" data-column=\"${col.name}\">`;\r\n      html += `<div class=\"tablix-th-content\">`;\r\n      html += `<span class=\"tablix-th-text\">${col.title || col.name}</span>`;\r\n      \r\n      if (isSortable) {\r\n        html += `<span class=\"tablix-sort-indicator\">`;\r\n        if (sortDirection === 'asc') {\r\n          html += `<span class=\"tablix-sort-arrow tablix-sort-asc\" aria-label=\"${this.table.t('sort.sortedAscending')}\">↑</span>`;\r\n        } else if (sortDirection === 'desc') {\r\n          html += `<span class=\"tablix-sort-arrow tablix-sort-desc\" aria-label=\"${this.table.t('sort.sortedDescending')}\">↓</span>`;\r\n        } else {\r\n          html += `<span class=\"tablix-sort-arrow tablix-sort-none\" aria-label=\"${this.table.t('sort.notSorted')}\">↕</span>`;\r\n        }\r\n        html += `</span>`;\r\n      }\r\n      \r\n      html += `</div>`;\r\n      html += `</th>`;\r\n    });\r\n    html += '</tr></thead>';\r\n\r\n    // Body\r\n    html += '<tbody class=\"tablix-tbody\">';\r\n    \r\n    // For virtual scrolling, only render empty structure or limited rows\r\n    if (isVirtualScrollEnabled && virtualMode) {\r\n      // Empty body for virtual scrolling - rows will be added by VirtualScrollManager\r\n      html += `<tr class=\"tablix-placeholder-row\" style=\"display: none;\"><td colspan=\"${columns.length}\"></td></tr>`;\r\n    } else if (data.length === 0) {\r\n      html += `<tr class=\"tablix-empty-row\"><td colspan=\"${columns.length}\" class=\"tablix-empty-cell\">${this.table.t('general.noData')}</td></tr>`;\r\n    } else {\r\n      data.forEach((row, index) => {\r\n        // Calculate global row index for pagination\r\n        let globalIndex = index;\r\n        if (this.table.paginationManager && this.table.paginationManager.options.mode === 'client') {\r\n          const currentPage = this.table.paginationManager.currentPage;\r\n          const pageSize = this.table.paginationManager.pageSize;\r\n          globalIndex = (currentPage - 1) * pageSize + index;\r\n        }\r\n        \r\n        html += `<tr class=\"tablix-row\" data-row-index=\"${globalIndex}\">`;\r\n        columns.forEach(col => {\r\n          const cell = row[col.name];\r\n          let renderedCell;\r\n          \r\n          // Use ColumnManager for formatting if available\r\n          if (this.table.columnManager) {\r\n            // Pass the column object instead of just the name to support multiple columns with same field\r\n            const result = this.table.columnManager.formatCellValue(col, cell, row);\r\n            if (result.isHtml) {\r\n              // Custom renderer returned HTML - use as is\r\n              renderedCell = result.value;\r\n            } else {\r\n              // Formatted or raw value - escape for safety\r\n              renderedCell = this.escapeHtml(result.value);\r\n            }\r\n          } else {\r\n            // Fallback to original renderer logic\r\n            renderedCell = col.renderer ? col.renderer(cell, row) : this.escapeHtml(cell);\r\n          }\r\n          \r\n          html += `<td class=\"tablix-td\">${renderedCell}</td>`;\r\n        });\r\n        html += '</tr>';\r\n      });\r\n    }\r\n    html += '</tbody>';\r\n    html += '</table>';\r\n    html += '</div>'; // Close tablix-table-wrapper\r\n    \r\n    // Close virtual scroll container if enabled\r\n    if (isVirtualScrollEnabled) {\r\n      html += '</div>'; // Close tablix-scroll-container\r\n    }\r\n\r\n    // Pagination will be rendered separately\r\n    html += '<div class=\"tablix-pagination-container\"></div>';\r\n    \r\n    // Bottom controls\r\n    if (controlsOptions.enabled && (controlsOptions.position === 'bottom' || controlsOptions.position === 'both')) {\r\n      html += this.renderControls('bottom');\r\n    }\r\n    \r\n    html += '</div>';\r\n\r\n    // Update DOM\r\n    this.table.container.innerHTML = html;\r\n    \r\n    // Restore search input value immediately after DOM update\r\n    if (preservedSearchValue) {\r\n      const newSearchInput = this.table.container.querySelector('.tablix-search-input');\r\n      if (newSearchInput) {\r\n        newSearchInput.value = preservedSearchValue;\r\n      }\r\n    }\r\n    \r\n    // Render pagination controls if pagination is enabled\r\n    this.renderPagination();\r\n    \r\n    // Bind control events\r\n    if (controlsOptions.enabled) {\r\n      this.bindControlEvents();\r\n    }\r\n\r\n    // Bind search events if search is enabled\r\n    if (this.table.searchManager) {\r\n      this.table.searchManager.bindEvents();\r\n    }\r\n\r\n    // Bind sort events if sorting is enabled\r\n    if (this.table.sortingManager) {\r\n      this.bindSortEvents();\r\n    }\r\n\r\n    // Bind row click events if selection is enabled\r\n    if (this.table.selectionManager && this.table.selectionManager.options.enabled) {\r\n      this.bindRowClickEvents();\r\n    }\r\n\r\n    // Render filter icons and bind events if filtering is enabled\r\n    if (this.table.filterUI) {\r\n      this.table.filterUI.renderFilterIcons();\r\n    }\r\n\r\n    // Restore focus AFTER all event binding is complete\r\n    if (searchInputHadFocus) {\r\n      const newSearchInput = this.table.container.querySelector('.tablix-search-input');\r\n      if (newSearchInput) {\r\n        // Use requestAnimationFrame to ensure focus happens after all DOM operations\r\n        requestAnimationFrame(() => {\r\n          newSearchInput.focus();\r\n          // Restore cursor position\r\n          if (cursorPosition > 0) {\r\n            newSearchInput.setSelectionRange(cursorPosition, cursorPosition);\r\n          }\r\n        });\r\n      }\r\n    }\r\n\r\n    // Trigger afterRender event\r\n    this.table.eventManager.trigger('afterRender');\r\n  }\r\n\r\n  renderPagination() {\r\n    const paginationContainer = this.table.container.querySelector('.tablix-pagination-container');\r\n    if (!paginationContainer || !this.table.paginationManager) {\r\n      return;\r\n    }\r\n\r\n    const paginationManager = this.table.paginationManager;\r\n    const info = paginationManager.getInfo();\r\n    \r\n    if (!paginationManager.options.enabled && paginationManager.options.enabled !== undefined) {\r\n      paginationContainer.innerHTML = '';\r\n      return;\r\n    }\r\n\r\n    // Don't show pagination if there's only one page and no custom page sizes\r\n    if (info.totalPages <= 1 && !paginationManager.options.showPageSizes) {\r\n      paginationContainer.innerHTML = '';\r\n      return;\r\n    }\r\n\r\n    let html = '<div class=\"tablix-pagination\">';\r\n    \r\n    // Page info\r\n    html += `<div class=\"tablix-pagination-info\">`;\r\n    if (info.totalRows === 0) {\r\n      html += this.table.t('pagination.noRecords');\r\n    } else {\r\n      html += this.table.t('pagination.showingRecords', {\r\n        startRow: info.startRow,\r\n        endRow: info.endRow,\r\n        totalRows: info.totalRows\r\n      });\r\n    }\r\n    html += '</div>';\r\n\r\n    // Page size selector\r\n    if (paginationManager.options.showPageSizes && paginationManager.options.pageSizeOptions.length > 1) {\r\n      html += '<div class=\"tablix-pagination-page-size\">';\r\n      html += this.table.t('general.show') + ' ';\r\n      html += '<select class=\"tablix-page-size-select\">';\r\n      paginationManager.options.pageSizeOptions.forEach(size => {\r\n        const selected = size === info.pageSize ? ' selected' : '';\r\n        html += `<option value=\"${size}\"${selected}>${size}</option>`;\r\n      });\r\n      html += '</select>';\r\n      html += ' ' + this.table.t('general.records') + ' ' + this.table.t('general.perPage');\r\n      html += '</div>';\r\n    }\r\n\r\n    // Navigation controls\r\n    if (info.totalPages > 1) {\r\n      html += '<div class=\"tablix-pagination-nav\">';\r\n      \r\n      // First page\r\n      if (paginationManager.options.showFirstLast) {\r\n        const disabled = info.currentPage === 1 ? ' disabled' : '';\r\n        html += `<button class=\"tablix-pagination-btn tablix-pagination-first\" data-page=\"1\"${disabled}>${this.table.t('pagination.first')}</button>`;\r\n      }\r\n      \r\n      // Previous page\r\n      if (paginationManager.options.showPrevNext) {\r\n        const disabled = !info.hasPrevPage ? ' disabled' : '';\r\n        html += `<button class=\"tablix-pagination-btn tablix-pagination-prev\" data-page=\"${info.currentPage - 1}\"${disabled}>${this.table.t('pagination.previous')}</button>`;\r\n      }\r\n      \r\n      // Page numbers\r\n      if (paginationManager.options.showPageNumbers) {\r\n        const pageNumbers = paginationManager.getPageNumbers();\r\n        pageNumbers.forEach(page => {\r\n          if (page === '...') {\r\n            html += '<span class=\"tablix-pagination-ellipsis\">...</span>';\r\n          } else {\r\n            const active = page === info.currentPage ? ' active' : '';\r\n            html += `<button class=\"tablix-pagination-btn tablix-pagination-page${active}\" data-page=\"${page}\">${page}</button>`;\r\n          }\r\n        });\r\n      }\r\n      \r\n      // Next page\r\n      if (paginationManager.options.showPrevNext) {\r\n        const disabled = !info.hasNextPage ? ' disabled' : '';\r\n        html += `<button class=\"tablix-pagination-btn tablix-pagination-next\" data-page=\"${info.currentPage + 1}\"${disabled}>${this.table.t('pagination.next')}</button>`;\r\n      }\r\n      \r\n      // Last page\r\n      if (paginationManager.options.showFirstLast) {\r\n        const disabled = info.currentPage === info.totalPages ? ' disabled' : '';\r\n        html += `<button class=\"tablix-pagination-btn tablix-pagination-last\" data-page=\"${info.totalPages}\"${disabled}>${this.table.t('pagination.last')}</button>`;\r\n      }\r\n      \r\n      html += '</div>';\r\n    }\r\n\r\n    // Loading indicator\r\n    if (info.isLoading) {\r\n      html += `<div class=\"tablix-pagination-loading\">${this.table.t('general.loading')}</div>`;\r\n    }\r\n    \r\n    html += '</div>';\r\n\r\n    paginationContainer.innerHTML = html;\r\n    this.bindPaginationEvents();\r\n  }\r\n\r\n  bindPaginationEvents() {\r\n    const paginationContainer = this.table.container.querySelector('.tablix-pagination');\r\n    if (!paginationContainer) {\r\n      return;\r\n    }\r\n\r\n    // Page navigation buttons\r\n    paginationContainer.addEventListener('click', async (e) => {\r\n      if (e.target.classList.contains('tablix-pagination-btn') && !e.target.disabled) {\r\n        e.preventDefault();\r\n        const page = parseInt(e.target.dataset.page);\r\n        if (!isNaN(page)) {\r\n          try {\r\n            await this.table.paginationManager.goToPage(page);\r\n          } catch (error) {\r\n            console.error('Failed to navigate to page:', error);\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    // Page size selector\r\n    const pageSizeSelect = paginationContainer.querySelector('.tablix-page-size-select');\r\n    if (pageSizeSelect) {\r\n      pageSizeSelect.addEventListener('change', async (e) => {\r\n        try {\r\n          const newPageSize = parseInt(e.target.value);\r\n          await this.table.paginationManager.changePageSize(newPageSize);\r\n        } catch (error) {\r\n          console.error('Failed to change page size:', error);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Escape HTML to prevent XSS attacks\r\n   */\r\n  escapeHtml(text) {\r\n    if (text == null) return '';\r\n    const div = document.createElement('div');\r\n    div.textContent = text.toString();\r\n    return div.innerHTML;\r\n  }\r\n\r\n  /**\r\n   * Render loading state\r\n   */\r\n  renderLoading() {\r\n    this.table.container.innerHTML = `<div class=\"tablix-loading\">${this.table.t('general.loading')}</div>`;\r\n  }\r\n\r\n  /**\r\n   * Render error state\r\n   */\r\n  renderError(error) {\r\n    this.table.container.innerHTML = `<div class=\"tablix-error\">${this.table.t('general.error')}: ${this.escapeHtml(error.message || error)}</div>`;\r\n  }\r\n\r\n  /**\r\n   * Render control panel\r\n   */\r\n  renderControls(position) {\r\n    const controlsOptions = this.table.options.controls;\r\n    const searchOptions = this.table.options.search || { enabled: false, placeholder: null };\r\n    \r\n    let html = `<div class=\"tablix-controls tablix-controls-${position}\">`;\r\n    \r\n    // Left side controls\r\n    html += '<div class=\"tablix-controls-left\">';\r\n    \r\n    // Pagination controls\r\n    if (controlsOptions.pagination && this.table.paginationManager) {\r\n      html += '<div class=\"tablix-control-group tablix-pagination-controls\">';\r\n      html += `<button type=\"button\" class=\"tablix-btn tablix-control-btn\" data-action=\"firstPage\">${this.table.t('pagination.first')}</button>`;\r\n      html += `<button type=\"button\" class=\"tablix-btn tablix-control-btn\" data-action=\"prevPage\">${this.table.t('pagination.previous')}</button>`;\r\n      html += `<button type=\"button\" class=\"tablix-btn tablix-control-btn\" data-action=\"nextPage\">${this.table.t('pagination.next')}</button>`;\r\n      html += `<button type=\"button\" class=\"tablix-btn tablix-control-btn\" data-action=\"lastPage\">${this.table.t('pagination.last')}</button>`;\r\n      html += '</div>';\r\n    }\r\n    \r\n    // Page size control\r\n    if (controlsOptions.pageSize && this.table.paginationManager) {\r\n      const pageSizeOptions = this.table.paginationManager.options.pageSizeOptions;\r\n      const currentPageSize = this.table.paginationManager.pageSize;\r\n      \r\n      html += '<div class=\"tablix-control-group tablix-page-size-group\">';\r\n      html += `<label for=\"tablix-page-size-select\">${this.table.t('general.show')}:</label>`;\r\n      html += '<select class=\"tablix-page-size-select\" id=\"tablix-page-size-select\">';\r\n      pageSizeOptions.forEach(size => {\r\n        const selected = size === currentPageSize ? ' selected' : '';\r\n        html += `<option value=\"${size}\"${selected}>${size}</option>`;\r\n      });\r\n      html += '</select>';\r\n      html += `<span>${this.table.t('general.entries')}</span>`;\r\n      html += '</div>';\r\n    }\r\n    \r\n    // Refresh control\r\n    if (controlsOptions.refresh) {\r\n      html += '<div class=\"tablix-control-group tablix-refresh-group\">';\r\n      html += `<button type=\"button\" class=\"tablix-btn tablix-control-btn\" data-action=\"refresh\" title=\"${this.table.t('controls.refresh')}\">⟳</button>`;\r\n      html += '</div>';\r\n    }\r\n    \r\n    html += '</div>'; // Close left controls\r\n    \r\n    // Right side controls\r\n    html += '<div class=\"tablix-controls-right\">';\r\n    \r\n    // Search control\r\n    if (controlsOptions.search && searchOptions.enabled) {\r\n      // Use localized placeholder or provided one\r\n      const placeholderText = searchOptions.placeholder || this.table.t('search.placeholder');\r\n      \r\n      html += '<div class=\"tablix-control-group tablix-search-group\">';\r\n      html += `<input type=\"text\" \r\n                      class=\"tablix-search-input\" \r\n                      id=\"tablix-search-input\" \r\n                      name=\"table-search\"\r\n                      placeholder=\"${placeholderText}\" />`;\r\n      html += `<button type=\"button\" class=\"tablix-btn tablix-search-clear\" title=\"${this.table.t('search.clear')}\" style=\"display: none;\">✕</button>`;\r\n      html += '</div>';\r\n    }\r\n    \r\n    html += '</div>'; // Close right controls\r\n    \r\n    html += '</div>'; // Close main controls container\r\n    \r\n    return html;\r\n  }\r\n\r\n  /**\r\n   * Bind control panel events\r\n   */\r\n  bindControlEvents() {\r\n    const wrapper = this.table.container.querySelector('.tablix-wrapper');\r\n    if (!wrapper) return;\r\n\r\n    // Page size selector\r\n    const pageSizeSelect = wrapper.querySelector('.tablix-page-size-select');\r\n    if (pageSizeSelect) {\r\n      pageSizeSelect.addEventListener('change', async (e) => {\r\n        try {\r\n          const newPageSize = parseInt(e.target.value);\r\n          await this.table.changePageSize(newPageSize);\r\n        } catch (error) {\r\n          console.error('Failed to change page size:', error);\r\n        }\r\n      });\r\n    }\r\n\r\n    // Control buttons\r\n    wrapper.addEventListener('click', async (e) => {\r\n      if (e.target.classList.contains('tablix-control-btn')) {\r\n        e.preventDefault();\r\n        const action = e.target.dataset.action;\r\n        \r\n        try {\r\n          switch (action) {\r\n            case 'firstPage':\r\n              await this.table.firstPage();\r\n              break;\r\n            case 'prevPage':\r\n              await this.table.prevPage();\r\n              break;\r\n            case 'nextPage':\r\n              await this.table.nextPage();\r\n              break;\r\n            case 'lastPage':\r\n              await this.table.lastPage();\r\n              break;\r\n            case 'refresh':\r\n              await this.handleRefresh();\r\n              break;\r\n            case 'export':\r\n              this.handleExport();\r\n              break;\r\n          }\r\n        } catch (error) {\r\n          console.error(`Failed to execute action ${action}:`, error);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Handle refresh functionality\r\n   */\r\n  async handleRefresh() {\r\n    this.table.eventManager.trigger('beforeRefresh');\r\n    \r\n    if (this.table.options.onRefresh && typeof this.table.options.onRefresh === 'function') {\r\n      // Custom refresh handler\r\n      try {\r\n        const newData = await this.table.options.onRefresh();\r\n        if (newData) {\r\n          await this.table.loadData(newData);\r\n        }\r\n      } catch (error) {\r\n        console.error('Custom refresh failed:', error);\r\n      }\r\n    } else if (this.table.paginationManager && this.table.paginationManager.options.mode === 'server') {\r\n      // Server-side refresh\r\n      await this.table.paginationManager.refreshTable();\r\n    } else {\r\n      // Client-side refresh - just re-render current data\r\n      await this.table.refreshTable();\r\n    }\r\n    \r\n    this.table.eventManager.trigger('afterRefresh');\r\n  }\r\n\r\n  /**\r\n   * Handle export functionality\r\n   */\r\n  handleExport() {\r\n    const data = this.table.getData();\r\n    const columns = this.table.options.columns || [];\r\n    \r\n    // Simple CSV export\r\n    let csv = columns.map(col => col.title || col.name).join(',') + '\\n';\r\n    \r\n    data.forEach(row => {\r\n      const values = columns.map(col => {\r\n        const value = row[col.name];\r\n        \r\n        // Handle complex objects\r\n        if (typeof value === 'object' && value !== null && !(value instanceof Date)) {\r\n          return `\"${JSON.stringify(value).replace(/\"/g, '\"\"')}\"`;\r\n        }\r\n        \r\n        // Simple CSV escaping for strings\r\n        if (typeof value === 'string' && value.includes(',')) {\r\n          return `\"${value.replace(/\"/g, '\"\"')}\"`;\r\n        }\r\n        \r\n        return value;\r\n      });\r\n      csv += values.join(',') + '\\n';\r\n    });\r\n    \r\n    // Download CSV\r\n    const blob = new Blob([csv], { type: 'text/csv' });\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = 'table-data.csv';\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    document.body.removeChild(a);\r\n    URL.revokeObjectURL(url);\r\n    \r\n    this.table.eventManager.trigger('afterExport', { data, format: 'csv' });\r\n  }\r\n\r\n  /**\r\n   * Bind sorting events to header columns\r\n   */\r\n  bindSortEvents() {\r\n    const headerRow = this.table.container.querySelector('.tablix-header-row');\r\n    if (!headerRow) return;\r\n\r\n    headerRow.addEventListener('click', async (e) => {\r\n      const th = e.target.closest('.tablix-sortable');\r\n      if (!th) return;\r\n\r\n      e.preventDefault();\r\n      \r\n      const columnName = th.dataset.column;\r\n      \r\n      try {\r\n        await this.table.toggleSort(columnName);\r\n      } catch (error) {\r\n        console.error('Failed to sort column:', error);\r\n      }\r\n    });\r\n\r\n    // Keyboard support for accessibility\r\n    headerRow.addEventListener('keydown', async (e) => {\r\n      const th = e.target.closest('.tablix-sortable');\r\n      if (!th || (e.key !== 'Enter' && e.key !== ' ')) return;\r\n\r\n      e.preventDefault();\r\n      \r\n      const columnName = th.dataset.column;\r\n      \r\n      try {\r\n        await this.table.toggleSort(columnName);\r\n      } catch (error) {\r\n        console.error('Failed to sort column:', error);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Bind row click events for selection\r\n   */\r\n  bindRowClickEvents() {\r\n    const tbody = this.table.container.querySelector('.tablix-tbody');\r\n    if (!tbody) return;\r\n\r\n    tbody.addEventListener('click', (e) => {\r\n      const row = e.target.closest('.tablix-row');\r\n      if (!row || row.classList.contains('tablix-empty-row')) return;\r\n\r\n      const globalRowIndex = parseInt(row.dataset.rowIndex, 10);\r\n      if (isNaN(globalRowIndex)) return;\r\n\r\n      // Convert global index to local index for current page data\r\n      let localRowIndex = globalRowIndex;\r\n      if (this.table.paginationManager && this.table.paginationManager.options.mode === 'client') {\r\n        const currentPage = this.table.paginationManager.currentPage;\r\n        const pageSize = this.table.paginationManager.pageSize;\r\n        localRowIndex = globalRowIndex - (currentPage - 1) * pageSize;\r\n      }\r\n\r\n      // Get current page data to find the clicked row\r\n      const currentData = this.getCurrentPageData();\r\n      if (localRowIndex >= 0 && localRowIndex < currentData.length) {\r\n        const rowData = currentData[localRowIndex];\r\n        \r\n        // Trigger row click event for SelectionManager with global index\r\n        this.table.eventManager.trigger('rowClick', {\r\n          rowData,\r\n          rowIndex: globalRowIndex, // Pass global index\r\n          localRowIndex: localRowIndex, // Also pass local index if needed\r\n          originalEvent: e\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get current page data (same logic as SelectionManager)\r\n   */\r\n  getCurrentPageData() {\r\n    if (this.table.paginationManager) {\r\n      return this.table.paginationManager.getCurrentPageData() || [];\r\n    }\r\n    return this.table.dataManager.getData();\r\n  }\r\n\r\n  /**\r\n   * Update sort indicators in headers\r\n   */\r\n  updateSortIndicators(currentSort) {\r\n    const headers = this.table.container.querySelectorAll('.tablix-th[data-column]');\r\n    \r\n    headers.forEach(th => {\r\n      const columnName = th.dataset.column;\r\n      const isSorted = currentSort && currentSort.column === columnName;\r\n      \r\n      // Remove all sort classes\r\n      th.classList.remove('tablix-sorted', 'tablix-sorted-asc', 'tablix-sorted-desc');\r\n      \r\n      const indicator = th.querySelector('.tablix-sort-indicator');\r\n      if (!indicator) return;\r\n\r\n      const arrow = indicator.querySelector('.tablix-sort-arrow');\r\n      if (!arrow) return;\r\n\r\n      if (isSorted) {\r\n        // Column is sorted\r\n        th.classList.add('tablix-sorted', `tablix-sorted-${currentSort.direction}`);\r\n        arrow.classList.remove('tablix-sort-none', 'tablix-sort-asc', 'tablix-sort-desc');\r\n        arrow.classList.add(`tablix-sort-${currentSort.direction}`);\r\n        arrow.textContent = currentSort.direction === 'asc' ? '↑' : '↓';\r\n        arrow.setAttribute('aria-label', `${this.table.t('sort.sorted')}${currentSort.direction === 'asc' ? this.table.t('sort.sortedAscending') : this.table.t('sort.sortedDescending')}`);\r\n        arrow.removeAttribute('data-sort-order');\r\n      } else {\r\n        // Column is not sorted\r\n        arrow.classList.remove('tablix-sort-asc', 'tablix-sort-desc');\r\n        arrow.classList.add('tablix-sort-none');\r\n        arrow.textContent = '↕';\r\n        arrow.setAttribute('aria-label', this.table.t('sort.notSorted'));\r\n        arrow.removeAttribute('data-sort-order');\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Check if a column is sortable\r\n   */\r\n  _isColumnSortable(column) {\r\n    if (!this.table.sortingManager) return false;\r\n    return this.table.sortingManager.isColumnSortable(column.name);\r\n  }\r\n\r\n  /**\r\n   * Get sort direction for a column\r\n   */\r\n  _getSortDirection(columnName) {\r\n    if (!this.table.sortingManager) return null;\r\n    return this.table.sortingManager.getSortDirection(columnName);\r\n  }\r\n}","export default class EventManager {\r\n  constructor() {\r\n    this.events = {};\r\n  }\r\n\r\n  on(event, callback) {\r\n    if (!this.events[event]) this.events[event] = [];\r\n    this.events[event].push(callback);\r\n  }\r\n\r\n  off(event, callback) {\r\n    if (this.events[event]) {\r\n      const index = this.events[event].indexOf(callback);\r\n      if (index > -1) {\r\n        this.events[event].splice(index, 1);\r\n      }\r\n    }\r\n  }\r\n\r\n  clear(event) {\r\n    if (event) {\r\n      this.events[event] = [];\r\n    } else {\r\n      this.events = {};\r\n    }\r\n  }\r\n\r\n  trigger(event, payload) {\r\n    (this.events[event] || []).forEach(cb => cb(payload));\r\n  }\r\n}","/**\r\n * PaginationManager handles both client-side and server-side pagination\r\n * \r\n * Features:\r\n * - Client-side: slices filtered data locally\r\n * - Server-side: calls async data loader with pagination params\r\n * - Consistent API regardless of pagination mode\r\n * - Event emission for page changes\r\n * - Customizable pagination controls\r\n */\r\nexport default class PaginationManager {\r\n  constructor(table, options = {}) {\r\n    this.table = table;\r\n    this.options = {\r\n      pageSize: 10,\r\n      mode: 'client', // 'client' or 'server'\r\n      showPageNumbers: true,\r\n      maxPageNumbers: 5,\r\n      showFirstLast: true,\r\n      showPrevNext: true,\r\n      showPageSizes: false,\r\n      pageSizeOptions: [10, 25, 50, 100],\r\n      serverDataLoader: null, // async function for server-side pagination\r\n      ...options\r\n    };\r\n\r\n    // Pagination state\r\n    this.currentPage = 1;\r\n    this.totalPages = 1;\r\n    this.totalRows = 0;\r\n    this.pageSize = this.options.pageSize;\r\n    this.isLoading = false;\r\n\r\n    // Event bindings\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.updatePaginationInfo();\r\n  }\r\n\r\n  /**\r\n   * Update pagination information based on current data\r\n   */\r\n  updatePaginationInfo(totalRows = null) {\r\n    if (this.options.mode === 'client') {\r\n      // For client-side pagination, calculate from filtered data\r\n      this.totalRows = this.table.dataManager.filteredData.length;\r\n    } else {\r\n      // For server-side pagination, total rows should be provided\r\n      this.totalRows = totalRows || this.totalRows;\r\n    }\r\n\r\n    this.totalPages = Math.ceil(this.totalRows / this.pageSize) || 1;\r\n    \r\n    // Ensure current page is within bounds\r\n    if (this.currentPage > this.totalPages) {\r\n      this.currentPage = this.totalPages;\r\n    }\r\n    if (this.currentPage < 1) {\r\n      this.currentPage = 1;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current page data\r\n   * For client-side: slice the filtered data\r\n   * For server-side: return cached data or trigger load\r\n   */\r\n  async getPageData() {\r\n    if (this.options.mode === 'client') {\r\n      return this.getClientPageData();\r\n    } else {\r\n      return await this.getServerPageData();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get page data for client-side pagination\r\n   */\r\n  getClientPageData() {\r\n    const start = (this.currentPage - 1) * this.pageSize;\r\n    const end = start + this.pageSize;\r\n    return this.table.dataManager.filteredData.slice(start, end);\r\n  }\r\n\r\n  /**\r\n   * Get current page data synchronously (for selection and other features)\r\n   * Returns the data that is currently displayed on the page\r\n   */\r\n  getCurrentPageData() {\r\n    if (this.options.mode === 'client') {\r\n      return this.getClientPageData();\r\n    } else {\r\n      // For server-side pagination, return the currently cached data\r\n      // This assumes the data has already been loaded by a previous getPageData call\r\n      return this.table.dataManager.getData();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get page data for server-side pagination\r\n   * Now delegates to unified server loading\r\n   */\r\n  async getServerPageData() {\r\n    // Server-side pagination is now handled by the unified _loadServerData method\r\n    // Just return the current data from DataManager\r\n    // The actual loading happens in refreshTable() -> _loadServerData()\r\n    return this.table.dataManager.getData();\r\n  }\r\n\r\n  /**\r\n   * Navigate to specific page\r\n   */\r\n  async goToPage(pageNumber) {\r\n    const targetPage = Math.max(1, Math.min(pageNumber, this.totalPages));\r\n    \r\n    if (targetPage === this.currentPage) {\r\n      return;\r\n    }\r\n\r\n    const oldPage = this.currentPage;\r\n    this.currentPage = targetPage;\r\n\r\n    // Update state manager\r\n    if (this.table.stateManager) {\r\n      this.table.stateManager.updatePagination({ page: targetPage });\r\n    }\r\n\r\n    this.table.eventManager.trigger('beforePageChange', {\r\n      oldPage,\r\n      newPage: this.currentPage,\r\n      pageSize: this.pageSize\r\n    });\r\n\r\n    try {\r\n      await this.table.refreshTable();\r\n      \r\n      this.table.eventManager.trigger('afterPageChange', {\r\n        oldPage,\r\n        newPage: this.currentPage,\r\n        pageSize: this.pageSize\r\n      });\r\n    } catch (error) {\r\n      // Revert page change on error\r\n      this.currentPage = oldPage;\r\n      if (this.table.stateManager) {\r\n        this.table.stateManager.updatePagination({ page: oldPage });\r\n      }\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to next page\r\n   */\r\n  async nextPage() {\r\n    if (this.currentPage < this.totalPages) {\r\n      await this.goToPage(this.currentPage + 1);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to previous page\r\n   */\r\n  async prevPage() {\r\n    if (this.currentPage > 1) {\r\n      await this.goToPage(this.currentPage - 1);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to first page\r\n   */\r\n  async firstPage() {\r\n    await this.goToPage(1);\r\n  }\r\n\r\n  /**\r\n   * Go to last page\r\n   */\r\n  async lastPage() {\r\n    await this.goToPage(this.totalPages);\r\n  }\r\n\r\n  /**\r\n   * Change page size\r\n   */\r\n  async changePageSize(newPageSize) {\r\n    if (newPageSize === this.pageSize) {\r\n      return;\r\n    }\r\n\r\n    const oldPageSize = this.pageSize;\r\n    this.pageSize = newPageSize;\r\n\r\n    // Try to maintain current position in the dataset\r\n    const currentRow = (this.currentPage - 1) * oldPageSize;\r\n    const newPage = Math.floor(currentRow / newPageSize) + 1;\r\n\r\n    this.updatePaginationInfo();\r\n    \r\n    // Update state manager\r\n    if (this.table.stateManager) {\r\n      this.table.stateManager.updatePagination({ \r\n        pageSize: newPageSize,\r\n        page: newPage\r\n      });\r\n    }\r\n    \r\n    this.table.eventManager.trigger('beforePageSizeChange', {\r\n      oldPageSize,\r\n      newPageSize: this.pageSize,\r\n      oldPage: this.currentPage,\r\n      newPage\r\n    });\r\n\r\n    this.currentPage = newPage;\r\n    await this.table.refreshTable();\r\n\r\n    this.table.eventManager.trigger('afterPageSizeChange', {\r\n      oldPageSize,\r\n      newPageSize: this.pageSize,\r\n      page: this.currentPage\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Reset pagination to first page (useful after filtering/sorting)\r\n   */\r\n  async resetToFirstPage() {\r\n    this.currentPage = 1;\r\n    this.updatePaginationInfo();\r\n    \r\n    // Update state manager\r\n    if (this.table.stateManager) {\r\n      this.table.stateManager.updatePagination({ page: 1 });\r\n    }\r\n    \r\n    // Use table's refreshTable instead of local method\r\n    await this.table.refreshTable();\r\n  }\r\n\r\n  /**\r\n   * Get pagination state info\r\n   */\r\n  getInfo() {\r\n    const start = this.totalRows === 0 ? 0 : (this.currentPage - 1) * this.pageSize + 1;\r\n    const end = Math.min(this.currentPage * this.pageSize, this.totalRows);\r\n\r\n    return {\r\n      currentPage: this.currentPage,\r\n      totalPages: this.totalPages,\r\n      pageSize: this.pageSize,\r\n      totalRows: this.totalRows,\r\n      startRow: start,\r\n      endRow: end,\r\n      hasNextPage: this.currentPage < this.totalPages,\r\n      hasPrevPage: this.currentPage > 1,\r\n      isLoading: this.isLoading\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get page numbers to display in pagination controls\r\n   */\r\n  getPageNumbers() {\r\n    const maxPages = this.options.maxPageNumbers;\r\n    const pages = [];\r\n\r\n    if (this.totalPages <= maxPages) {\r\n      // Show all pages\r\n      for (let i = 1; i <= this.totalPages; i++) {\r\n        pages.push(i);\r\n      }\r\n    } else {\r\n      // Show truncated page numbers\r\n      const half = Math.floor(maxPages / 2);\r\n      let start = Math.max(1, this.currentPage - half);\r\n      let end = Math.min(this.totalPages, start + maxPages - 1);\r\n\r\n      // Adjust if we're near the end\r\n      if (end - start + 1 < maxPages) {\r\n        start = Math.max(1, end - maxPages + 1);\r\n      }\r\n\r\n      for (let i = start; i <= end; i++) {\r\n        pages.push(i);\r\n      }\r\n\r\n      // Add ellipsis indicators\r\n      if (start > 1) {\r\n        if (start > 2) pages.unshift('...');\r\n        pages.unshift(1);\r\n      }\r\n      if (end < this.totalPages) {\r\n        if (end < this.totalPages - 1) pages.push('...');\r\n        pages.push(this.totalPages);\r\n      }\r\n    }\r\n\r\n    return pages;\r\n  }\r\n\r\n  /**\r\n   * Enable/disable pagination\r\n   */\r\n  setEnabled(enabled) {\r\n    this.options.enabled = enabled;\r\n    this.table.renderer.renderPagination();\r\n  }\r\n\r\n  /**\r\n   * Switch between client and server mode\r\n   */\r\n  async setMode(mode, serverDataLoader = null) {\r\n    if (mode === this.options.mode) {\r\n      return;\r\n    }\r\n\r\n    this.options.mode = mode;\r\n    if (mode === 'server' && serverDataLoader) {\r\n      this.options.serverDataLoader = serverDataLoader;\r\n    }\r\n\r\n    // Reset to first page when switching modes\r\n    this.currentPage = 1;\r\n    this.updatePaginationInfo();\r\n    \r\n    // Update state manager\r\n    if (this.table.stateManager) {\r\n      this.table.stateManager.updatePagination({ page: 1 });\r\n    }\r\n    \r\n    await this.table.refreshTable();\r\n  }\r\n}\r\n","/**\r\n * ValueResolver - Centralized value resolution for non-primitive column data\r\n * \r\n * Provides a clean abstraction layer between raw cell data and the features\r\n * that consume it (filtering, sorting, editing, display). Each feature can\r\n * resolve a purpose-specific primitive value from complex objects using\r\n * column-level configuration (accessor functions, dot-path strings, etc.).\r\n * \r\n * Supported column options:\r\n *   - filterAccessor:  (value, row) => primitive   — custom filter value extractor\r\n *   - filterPath:      \"prop.nested.key\"           — dot-path shorthand for filterAccessor\r\n *   - sortAccessor:    (value, row) => primitive    — custom sort value extractor\r\n *   - sortPath:        \"prop.nested.key\"            — dot-path shorthand for sortAccessor\r\n *   - editAccessor:    (value, row) => primitive    — custom edit value extractor\r\n *   - editPath:        \"prop.nested.key\"            — dot-path shorthand for editAccessor\r\n *   - filterable:      false                        — disable filtering entirely\r\n *   - sortable:        false                        — disable sorting entirely\r\n *   - editable:        false                        — disable editing entirely\r\n */\r\n\r\n/**\r\n * Check whether a value is a non-null, non-Date object (i.e. an object or array\r\n * that is NOT a primitive wrapper and NOT a Date).\r\n * \r\n * @param {*} value \r\n * @returns {boolean}\r\n */\r\nexport function isComplexValue(value) {\r\n  return value !== null && value !== undefined &&\r\n    typeof value === 'object' && !(value instanceof Date);\r\n}\r\n\r\n/**\r\n * Navigate into an object using a dot-separated path string.\r\n * Returns `undefined` for any invalid / unreachable segment.\r\n * \r\n * Examples:\r\n *   getByPath({ a: { b: 2 } }, 'a.b')         => 2\r\n *   getByPath({ a: [10, 20] }, 'a.1')          => 20\r\n *   getByPath({ a: null }, 'a.b')              => undefined\r\n * \r\n * @param {*} obj   - The root object to traverse\r\n * @param {string} path - Dot-separated property path\r\n * @returns {*} The resolved value, or undefined\r\n */\r\nexport function getByPath(obj, path) {\r\n  if (obj == null || typeof path !== 'string' || path === '') {\r\n    return undefined;\r\n  }\r\n\r\n  const segments = path.split('.');\r\n  let current = obj;\r\n\r\n  for (const segment of segments) {\r\n    if (current == null || typeof current !== 'object') {\r\n      return undefined;\r\n    }\r\n    current = current[segment];\r\n  }\r\n\r\n  return current;\r\n}\r\n\r\n/**\r\n * Resolve the value a feature should operate on for a given column + row.\r\n * \r\n * Resolution order (per purpose):\r\n *   1. Purpose-specific accessor function   (e.g. `filterAccessor`)\r\n *   2. Purpose-specific dot-path string     (e.g. `filterPath`)\r\n *   3. Raw cell value — but ONLY if it is a primitive\r\n *   4. `undefined` if the raw value is complex and no accessor/path is configured\r\n * \r\n * For the \"display\" purpose the raw value is always returned (the Renderer /\r\n * ColumnManager already handles display formatting via `renderer` / `format`).\r\n * \r\n * @param {Object}  column  - Column definition object\r\n * @param {Object}  row     - Full data row\r\n * @param {'display'|'filter'|'sort'|'edit'} purpose\r\n * @returns {*} A primitive value suitable for the requested purpose, or undefined\r\n */\r\nexport function resolveColumnValue(column, row, purpose = 'display') {\r\n  if (!column || !row) return undefined;\r\n\r\n  const columnName = column.name || column.key;\r\n  const rawValue = row[columnName];\r\n\r\n  // \"display\" always returns the raw value — formatting is handled elsewhere\r\n  if (purpose === 'display') {\r\n    return rawValue;\r\n  }\r\n\r\n  // Map purpose → accessor / path property names\r\n  const accessorKey = `${purpose}Accessor`;   // e.g. \"filterAccessor\"\r\n  const pathKey     = `${purpose}Path`;        // e.g. \"filterPath\"\r\n\r\n  // 1. Purpose-specific accessor function\r\n  if (typeof column[accessorKey] === 'function') {\r\n    try {\r\n      return column[accessorKey](rawValue, row);\r\n    } catch (err) {\r\n      console.warn(`TablixJS: ${accessorKey} threw for column '${columnName}':`, err);\r\n      return undefined;\r\n    }\r\n  }\r\n\r\n  // 2. Purpose-specific dot-path\r\n  if (typeof column[pathKey] === 'string') {\r\n    return getByPath(rawValue, column[pathKey]);\r\n  }\r\n\r\n  // 3. If raw value is primitive — return as-is\r\n  if (!isComplexValue(rawValue)) {\r\n    return rawValue;\r\n  }\r\n\r\n  // 4. Complex value with no accessor/path — return undefined (feature should skip)\r\n  return undefined;\r\n}\r\n\r\n/**\r\n * Check whether a specific feature is enabled for a column.\r\n * \r\n * Rules:\r\n *  - If the column explicitly sets the flag (e.g. `filterable: false`) → honour it.\r\n *  - If the column has complex data but no accessor/path for the purpose,\r\n *    default to **disabled** (safe default).\r\n *  - Otherwise default to **enabled** (backward compat for primitive columns).\r\n * \r\n * @param {Object}  column   - Column definition\r\n * @param {'filter'|'sort'|'edit'} purpose\r\n * @param {Array}   [sampleData] - Optional sample rows to detect complex data\r\n * @returns {boolean}\r\n */\r\nexport function isFeatureEnabled(column, purpose, sampleData = []) {\r\n  if (!column) return false;\r\n\r\n  // Map purpose → explicit flag name\r\n  const flagMap = {\r\n    filter: 'filterable',\r\n    sort:   'sortable',\r\n    edit:   'editable'\r\n  };\r\n\r\n  const flag = flagMap[purpose];\r\n  if (!flag) return false;\r\n\r\n  // Explicit column-level flag takes priority\r\n  if (column[flag] !== undefined) {\r\n    return !!column[flag];\r\n  }\r\n\r\n  // Check if column has a purpose-specific accessor/path — that implies enabled\r\n  const accessorKey = `${purpose}Accessor`;\r\n  const pathKey     = `${purpose}Path`;\r\n  if (typeof column[accessorKey] === 'function' || typeof column[pathKey] === 'string') {\r\n    return true;\r\n  }\r\n\r\n  // Auto-detect: sample data to see if column holds complex values\r\n  const columnName = column.name || column.key;\r\n  const limit = Math.min(sampleData.length, 100);\r\n  for (let i = 0; i < limit; i++) {\r\n    const value = sampleData[i]?.[columnName];\r\n    if (isComplexValue(value)) {\r\n      // Complex data detected, no accessor → disable by default\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // Primitive data — enabled by default (backward compat)\r\n  return true;\r\n}\r\n","import { resolveColumnValue, isFeatureEnabled, isComplexValue } from './ValueResolver.js';\r\n\r\n/**\r\n * SortingManager - Handles all sorting functionality for TablixJS\r\n * Supports client-side and server-side sorting with custom sort functions.\r\n * Uses ValueResolver for safe sorting of complex/nested data columns.\r\n */\r\nexport default class SortingManager {\r\n  constructor(table, options = {}) {\r\n    this.table = table;\r\n    this.options = {\r\n      enabled: true,\r\n      mode: 'client', // 'client' or 'server'\r\n      serverSortLoader: null, // Function to load data from server with sorting\r\n      defaultSortType: 'auto', // 'auto', 'string', 'number', 'date'\r\n      caseSensitive: false,\r\n      nullsFirst: false,\r\n      ...options\r\n    };\r\n\r\n    // Current sort state - single column only\r\n    this.currentSort = null; // { column: 'name', direction: 'asc' }\r\n    this.sortOrder = ['asc', 'desc', null]; // Click cycle order\r\n\r\n    // Predefined sort types\r\n    this.sortTypes = {\r\n      auto: this._autoSort.bind(this),\r\n      string: this._stringSort.bind(this),\r\n      number: this._numberSort.bind(this),\r\n      date: this._dateSort.bind(this),\r\n      boolean: this._booleanSort.bind(this)\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Sort by a column\r\n   * @param {string} columnName - Column to sort by\r\n   * @param {string|null} direction - 'asc', 'desc', or null (unsorted)\r\n   */\r\n  async sort(columnName, direction = 'asc') {\r\n    // Trigger beforeSort event\r\n    const beforeSortData = { columnName, direction, currentSort: this.currentSort };\r\n    this.table.eventManager.trigger('beforeSort', beforeSortData);\r\n\r\n    // Set current sort state\r\n    if (direction !== null) {\r\n      this.currentSort = { column: columnName, direction };\r\n    } else {\r\n      this.currentSort = null;\r\n    }\r\n\r\n    // Update state manager\r\n    if (this.table.stateManager) {\r\n      this.table.stateManager.updateSort(this.currentSort);\r\n      // Reset to first page when sorting changes\r\n      this.table.stateManager.resetPage();\r\n    }\r\n\r\n    if (this.options.mode === 'server') {\r\n      // Server mode - update will be triggered by refreshTable via unified loader\r\n      await this.table.refreshTable();\r\n    } else {\r\n      // Client mode - apply sorting locally\r\n      this._applySorting();\r\n      await this.table.refreshTable();\r\n    }\r\n\r\n    // Update UI\r\n    this.table.renderer.updateSortIndicators(this.currentSort);\r\n\r\n    // Trigger afterSort event\r\n    this.table.eventManager.trigger('afterSort', {\r\n      columnName,\r\n      direction,\r\n      currentSort: this.currentSort\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Toggle sort for a column (handles click cycling)\r\n   */\r\n  async toggleSort(columnName) {\r\n    const currentDirection = this.currentSort && this.currentSort.column === columnName \r\n      ? this.currentSort.direction \r\n      : null;\r\n    \r\n    // Get next direction in cycle\r\n    const currentIndex = this.sortOrder.indexOf(currentDirection);\r\n    const nextDirection = this.sortOrder[(currentIndex + 1) % this.sortOrder.length];\r\n    \r\n    await this.sort(columnName, nextDirection);\r\n  }\r\n\r\n  /**\r\n   * Client-side sorting\r\n   */\r\n  _sortClient(columnName, direction) {\r\n    // Set current sort\r\n    if (direction !== null) {\r\n      this.currentSort = { column: columnName, direction };\r\n    } else {\r\n      this.currentSort = null;\r\n    }\r\n\r\n    // Apply sorting to data\r\n    this._applySorting();\r\n  }\r\n\r\n  /**\r\n   * Server-side sorting (DEPRECATED - now handled by unified loader)\r\n   * @deprecated Use unified _loadServerData in Table.js\r\n   */\r\n  async _sortServer(columnName, direction) {\r\n    // This method is deprecated and should not be called anymore\r\n    // Sorting in server mode is now handled by the unified _loadServerData method\r\n    console.warn('_sortServer is deprecated. Server sorting now uses unified data loading.');\r\n  }\r\n\r\n  /**\r\n   * Apply current sort to filtered data.\r\n   * Uses resolveColumnValue so that sortAccessor / sortPath are respected\r\n   * for columns containing complex/nested objects.\r\n   */\r\n  _applySorting() {\r\n    if (!this.currentSort) return;\r\n    \r\n    const columns = this.table.options.columns || [];\r\n    \r\n    this.table.dataManager.filteredData.sort((a, b) => {\r\n      // Support both 'name' and 'key' properties for column identification\r\n      const column = columns.find(col => (col.name === this.currentSort.column) || (col.key === this.currentSort.column));\r\n\r\n      // Resolve comparable values through accessor/path\r\n      const valA = column\r\n        ? resolveColumnValue(column, a, 'sort')\r\n        : a[this.currentSort.column];\r\n      const valB = column\r\n        ? resolveColumnValue(column, b, 'sort')\r\n        : b[this.currentSort.column];\r\n\r\n      const comparison = this._compareValues(valA, valB, column);\r\n      \r\n      return this.currentSort.direction === 'desc' ? -comparison : comparison;\r\n    });\r\n\r\n    // Reset pagination to first page after sorting\r\n    if (this.table.paginationManager) {\r\n      this.table.paginationManager.resetToFirstPage();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Compare two values based on column configuration\r\n   */\r\n  _compareValues(a, b, column) {\r\n    // Handle null/undefined values\r\n    if (a == null && b == null) return 0;\r\n    if (a == null) return this.options.nullsFirst ? -1 : 1;\r\n    if (b == null) return this.options.nullsFirst ? 1 : -1;\r\n\r\n    // Use custom sort function if provided\r\n    if (column && column.sortFunction) {\r\n      return column.sortFunction(a, b);\r\n    }\r\n\r\n    // Use specified sort type or auto-detect\r\n    const sortType = (column && column.sortType) || this.options.defaultSortType;\r\n    \r\n    if (this.sortTypes[sortType]) {\r\n      return this.sortTypes[sortType](a, b);\r\n    }\r\n\r\n    // Fallback to auto sort\r\n    return this._autoSort(a, b);\r\n  }\r\n\r\n  /**\r\n   * Auto-detect sort type and compare\r\n   */\r\n  _autoSort(a, b) {\r\n    // Try number comparison first\r\n    const numA = parseFloat(a);\r\n    const numB = parseFloat(b);\r\n    \r\n    if (!isNaN(numA) && !isNaN(numB)) {\r\n      return numA - numB;\r\n    }\r\n\r\n    // Try date comparison - be more strict about what constitutes a date\r\n    const dateA = new Date(a);\r\n    const dateB = new Date(b);\r\n    \r\n    // More strict date validation - check if it looks like a real date format\r\n    const isDateLike = (str) => {\r\n      return /^\\d{4}-\\d{2}-\\d{2}/.test(str) || /^\\d{1,2}\\/\\d{1,2}\\/\\d{4}/.test(str) || /^\\d{1,2}-\\d{1,2}-\\d{4}/.test(str);\r\n    };\r\n    \r\n    if (dateA.toString() !== 'Invalid Date' && dateB.toString() !== 'Invalid Date' && \r\n        isDateLike(String(a)) && isDateLike(String(b))) {\r\n      return dateA - dateB;\r\n    }\r\n\r\n    // Fall back to string comparison\r\n    return this._stringSort(a, b);\r\n  }\r\n\r\n  /**\r\n   * String comparison\r\n   */\r\n  _stringSort(a, b) {\r\n    const strA = String(a).trim();\r\n    const strB = String(b).trim();\r\n    \r\n    if (this.options.caseSensitive) {\r\n      return strA.localeCompare(strB);\r\n    }\r\n    \r\n    return strA.localeCompare(strB, undefined, { sensitivity: 'base' });\r\n  }\r\n\r\n  /**\r\n   * Number comparison\r\n   */\r\n  _numberSort(a, b) {\r\n    const numA = parseFloat(a);\r\n    const numB = parseFloat(b);\r\n    \r\n    if (isNaN(numA) && isNaN(numB)) return 0;\r\n    if (isNaN(numA)) return 1;\r\n    if (isNaN(numB)) return -1;\r\n    \r\n    return numA - numB;\r\n  }\r\n\r\n  /**\r\n   * Date comparison\r\n   */\r\n  _dateSort(a, b) {\r\n    const dateA = new Date(a);\r\n    const dateB = new Date(b);\r\n    \r\n    if (dateA.toString() === 'Invalid Date' && dateB.toString() === 'Invalid Date') return 0;\r\n    if (dateA.toString() === 'Invalid Date') return 1;\r\n    if (dateB.toString() === 'Invalid Date') return -1;\r\n    \r\n    return dateA - dateB;\r\n  }\r\n\r\n  /**\r\n   * Boolean comparison\r\n   */\r\n  _booleanSort(a, b) {\r\n    const boolA = Boolean(a);\r\n    const boolB = Boolean(b);\r\n    \r\n    if (boolA === boolB) return 0;\r\n    return boolA ? 1 : -1;\r\n  }\r\n\r\n  /**\r\n   * Clear all sorting\r\n   */  async clearSorting() {\r\n    this.currentSort = null;\r\n\r\n    if (this.options.mode === 'server') {\r\n      // Reload data without sorting\r\n      if (this.options.serverSortLoader) {\r\n        try {\r\n          const result = await this.options.serverSortLoader({\r\n            sort: null,\r\n            filters: this.table.dataManager.currentFilters,\r\n            page: this.table.paginationManager ? this.table.paginationManager.currentPage : 1,\r\n            pageSize: this.table.paginationManager ? this.table.paginationManager.pageSize : 10\r\n          });\r\n          \r\n          this.table.dataManager.setServerData(result.data, result.totalRows);\r\n        } catch (error) {\r\n          console.error('Failed to clear server sorting:', error);\r\n        }\r\n      }\r\n    }\r\n\r\n    // Update UI and refresh table\r\n    this.table.renderer.updateSortIndicators(null);\r\n    await this.table.refreshTable();\r\n    \r\n    this.table.eventManager.trigger('afterSort', { currentSort: null });\r\n  }\r\n\r\n  /**\r\n   * Get current sort state\r\n   */\r\n  getSortState() {\r\n    return {\r\n      sort: this.currentSort,\r\n      mode: this.options.mode\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Set sorting options\r\n   */\r\n  setOptions(newOptions) {\r\n    this.options = { ...this.options, ...newOptions };\r\n  }\r\n\r\n  /**\r\n   * Check if a column is sortable.\r\n   * Uses isFeatureEnabled to auto-detect complex data and respect sortAccessor/sortPath.\r\n   */\r\n  isColumnSortable(columnName) {\r\n    if (!this.options.enabled) return false;\r\n    \r\n    const columns = this.table.options.columns || [];\r\n    const column = columns.find(col => col.name === columnName);\r\n    if (!column) return false;\r\n\r\n    const sampleData = this.table.dataManager.originalData || [];\r\n    return isFeatureEnabled(column, 'sort', sampleData);\r\n  }\r\n\r\n  /**\r\n   * Get sort direction for a column\r\n   */\r\n  getSortDirection(columnName) {\r\n    return this.currentSort && this.currentSort.column === columnName \r\n      ? this.currentSort.direction \r\n      : null;\r\n  }\r\n}\r\n","import { isComplexValue, isFeatureEnabled } from './ValueResolver.js';\r\n\r\n/**\r\n * ColumnManager - Enhanced column formatting system for TablixJS\r\n * \r\n * Features:\r\n * - Flexible formatting with optional locale and formatOptions\r\n * - Supports text, date, currency, number, percent formats\r\n * - Custom renderer priority over formatting\r\n * - Extensible design for future format types\r\n * - Performance-optimized with cached formatters\r\n * - Auto-detects non-primitive column data and normalizes feature flags\r\n */\r\nexport default class ColumnManager {\r\n  constructor(table) {\r\n    this.table = table;\r\n    this.columns = [];\r\n    this.formatters = new Map(); // Cache for compiled formatters\r\n    this.supportedFormats = ['text', 'date', 'currency', 'number', 'percent'];\r\n  }\r\n\r\n  /**\r\n   * Initialize columns and prepare formatters.\r\n   * Normalizes feature flags (filterable, sortable, editable) based on\r\n   * data sampling when the table has initial data available.\r\n   * @param {Array} columns - Array of column definitions\r\n   */\r\n  initializeColumns(columns = []) {\r\n    this.columns = columns.map(col => this.prepareColumn(col));\r\n    this.compileFormatters();\r\n    return this.columns;\r\n  }\r\n\r\n  /**\r\n   * Prepare and validate a single column definition.\r\n   * Normalizes new properties: filterable, sortable, editable,\r\n   * filterAccessor, filterPath, sortAccessor, sortPath, editAccessor, editPath.\r\n   * @param {Object} column - Column definition\r\n   * @returns {Object} Prepared column\r\n   */\r\n  prepareColumn(column) {\r\n    const prepared = { ...column };\r\n\r\n    // Validate format if provided\r\n    if (prepared.format && !this.supportedFormats.includes(prepared.format)) {\r\n      console.warn(`TablixJS: Unsupported format type '${prepared.format}' for column '${prepared.name}'. Falling back to no formatting.`);\r\n      delete prepared.format;\r\n    }\r\n\r\n    // Ensure name property exists\r\n    if (!prepared.name) {\r\n      throw new Error('TablixJS: Column must have a \"name\" property');\r\n    }\r\n\r\n    // Set default title if not provided\r\n    if (!prepared.title) {\r\n      prepared.title = prepared.name;\r\n    }\r\n\r\n    // Validate accessor types\r\n    for (const key of ['filterAccessor', 'sortAccessor', 'editAccessor']) {\r\n      if (prepared[key] !== undefined && typeof prepared[key] !== 'function') {\r\n        console.warn(`TablixJS: Column '${prepared.name}' has non-function ${key}. Ignoring.`);\r\n        delete prepared[key];\r\n      }\r\n    }\r\n\r\n    // Validate path types\r\n    for (const key of ['filterPath', 'sortPath', 'editPath']) {\r\n      if (prepared[key] !== undefined && typeof prepared[key] !== 'string') {\r\n        console.warn(`TablixJS: Column '${prepared.name}' has non-string ${key}. Ignoring.`);\r\n        delete prepared[key];\r\n      }\r\n    }\r\n\r\n    return prepared;\r\n  }\r\n\r\n  /**\r\n   * Compile and cache formatter functions for columns with format specified\r\n   */\r\n  compileFormatters() {\r\n    this.formatters.clear();\r\n\r\n    this.columns.forEach(column => {\r\n      if (column.format) {\r\n        const formatter = this.createFormatter(column);\r\n        if (formatter) {\r\n          this.formatters.set(column.name, formatter);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Create a formatter function for a column\r\n   * @param {Object} column - Column definition\r\n   * @returns {Function|null} Formatter function\r\n   */\r\n  createFormatter(column) {\r\n    const { format, locale, formatOptions = {} } = column;\r\n\r\n    switch (format) {\r\n      case 'text':\r\n        return (value) => this.formatText(value);\r\n\r\n      case 'date':\r\n        return (value) => this.formatDate(value, locale, formatOptions);\r\n\r\n      case 'currency':\r\n        return (value) => this.formatCurrency(value, locale, formatOptions, column.currency);\r\n\r\n      case 'number':\r\n        return (value) => this.formatNumber(value, locale, formatOptions);\r\n\r\n      case 'percent':\r\n        return (value) => this.formatPercent(value, locale, formatOptions);\r\n\r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Format a cell value for a specific column\r\n   * @param {Object|string} column - Column object or column name (for backwards compatibility)\r\n   * @param {*} value - Cell value\r\n   * @param {Object} row - Full row data (for context)\r\n   * @returns {Object} Object with formatted value and metadata\r\n   */\r\n  formatCellValue(column, value, row) {\r\n    // Support both column object (new) and column name (backwards compatibility)\r\n    const columnObj = typeof column === 'string' ? this.getColumn(column) : column;\r\n    const columnName = columnObj ? columnObj.name : column;\r\n    \r\n    // Priority 1: Custom renderer (overrides everything)\r\n    if (columnObj && columnObj.renderer) {\r\n      // If renderer wants formatted value, provide it\r\n      const formatter = this.formatters.get(columnName);\r\n      const formattedValue = formatter ? formatter(value) : value;\r\n      const result = columnObj.renderer(value, row, formattedValue);\r\n      return {\r\n        value: result,\r\n        isHtml: true // Custom renderers can return HTML\r\n      };\r\n    }\r\n\r\n    // Priority 2: Format using cached formatter\r\n    const formatter = this.formatters.get(columnName);\r\n    if (formatter) {\r\n      return {\r\n        value: formatter(value),\r\n        isHtml: false // Formatted values are safe text\r\n      };\r\n    }\r\n\r\n    // Priority 3: Return raw value\r\n    return {\r\n      value: value,\r\n      isHtml: false // Raw values need escaping\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get column definition by name\r\n   * @param {string} columnName - Column name\r\n   * @returns {Object|null} Column definition\r\n   */\r\n  getColumn(columnName) {\r\n    return this.columns.find(col => col.name === columnName) || null;\r\n  }\r\n\r\n  /**\r\n   * Get all columns\r\n   * @returns {Array} Array of column definitions\r\n   */\r\n  getColumns() {\r\n    return this.columns;\r\n  }\r\n\r\n  // =============================================================================\r\n  // FORMAT IMPLEMENTATIONS\r\n  // =============================================================================\r\n\r\n  /**\r\n   * Format text (basic string conversion with null/undefined handling)\r\n   * @param {*} value - Value to format\r\n   * @returns {string} Formatted text\r\n   */\r\n  formatText(value) {\r\n    if (value == null) return '';\r\n    return String(value);\r\n  }\r\n\r\n  /**\r\n   * Format date using Intl.DateTimeFormat\r\n   * @param {*} value - Date value (string, Date, timestamp)\r\n   * @param {string} locale - Locale string (optional)\r\n   * @param {Object} options - Intl.DateTimeFormat options\r\n   * @returns {string} Formatted date\r\n   */\r\n  formatDate(value, locale, options = {}) {\r\n    if (value == null) return '';\r\n\r\n    try {\r\n      const date = value instanceof Date ? value : new Date(value);\r\n      \r\n      if (isNaN(date.getTime())) {\r\n        return String(value); // Return original if invalid date\r\n      }\r\n\r\n      const formatter = new Intl.DateTimeFormat(locale, options);\r\n      return formatter.format(date);\r\n    } catch (error) {\r\n      console.warn('TablixJS: Date formatting error:', error);\r\n      return String(value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Format currency using Intl.NumberFormat\r\n   * @param {*} value - Numeric value\r\n   * @param {string} locale - Locale string (optional)\r\n   * @param {Object} options - Intl.NumberFormat options\r\n   * @param {string} currency - Currency code (e.g., 'USD', 'EUR')\r\n   * @returns {string} Formatted currency\r\n   */\r\n  formatCurrency(value, locale, options = {}, currency = 'USD') {\r\n    if (value == null) return '';\r\n\r\n    const numericValue = Number(value);\r\n    if (isNaN(numericValue)) {\r\n      return String(value);\r\n    }\r\n\r\n    try {\r\n      const formatOptions = {\r\n        style: 'currency',\r\n        currency: currency,\r\n        ...options\r\n      };\r\n\r\n      const formatter = new Intl.NumberFormat(locale, formatOptions);\r\n      return formatter.format(numericValue);\r\n    } catch (error) {\r\n      console.warn('TablixJS: Currency formatting error:', error);\r\n      return String(value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Format number using Intl.NumberFormat\r\n   * @param {*} value - Numeric value\r\n   * @param {string} locale - Locale string (optional)\r\n   * @param {Object} options - Intl.NumberFormat options\r\n   * @returns {string} Formatted number\r\n   */\r\n  formatNumber(value, locale, options = {}) {\r\n    if (value == null) return '';\r\n\r\n    const numericValue = Number(value);\r\n    if (isNaN(numericValue)) {\r\n      return String(value);\r\n    }\r\n\r\n    try {\r\n      const formatter = new Intl.NumberFormat(locale, options);\r\n      return formatter.format(numericValue);\r\n    } catch (error) {\r\n      console.warn('TablixJS: Number formatting error:', error);\r\n      return String(value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Format percentage using Intl.NumberFormat\r\n   * @param {*} value - Numeric value (0.5 = 50%)\r\n   * @param {string} locale - Locale string (optional)\r\n   * @param {Object} options - Intl.NumberFormat options\r\n   * @returns {string} Formatted percentage\r\n   */\r\n  formatPercent(value, locale, options = {}) {\r\n    if (value == null) return '';\r\n\r\n    const numericValue = Number(value);\r\n    if (isNaN(numericValue)) {\r\n      return String(value);\r\n    }\r\n\r\n    try {\r\n      const formatOptions = {\r\n        style: 'percent',\r\n        ...options\r\n      };\r\n\r\n      const formatter = new Intl.NumberFormat(locale, formatOptions);\r\n      return formatter.format(numericValue);\r\n    } catch (error) {\r\n      console.warn('TablixJS: Percent formatting error:', error);\r\n      return String(value);\r\n    }\r\n  }\r\n\r\n  // =============================================================================\r\n  // EXTENSIBILITY METHODS\r\n  // =============================================================================\r\n\r\n  /**\r\n   * Register a custom format type (for future extensibility)\r\n   * @param {string} formatType - Format type name\r\n   * @param {Function} formatterFactory - Function that creates formatter\r\n   */\r\n  registerFormat(formatType, formatterFactory) {\r\n    if (this.supportedFormats.includes(formatType)) {\r\n      console.warn(`TablixJS: Format type '${formatType}' already exists and will be overridden.`);\r\n    }\r\n\r\n    this.supportedFormats.push(formatType);\r\n    \r\n    // You would extend createFormatter method to handle this\r\n    // This is a placeholder for future plugin architecture\r\n    console.log(`TablixJS: Custom format '${formatType}' registered.`);\r\n  }\r\n\r\n  /**\r\n   * Get supported format types\r\n   * @returns {Array} Array of supported format type strings\r\n   */\r\n  getSupportedFormats() {\r\n    return [...this.supportedFormats];\r\n  }\r\n}\r\n","import { resolveColumnValue, isFeatureEnabled, isComplexValue } from './ValueResolver.js';\r\n\r\n/**\r\n * FilterManager - Advanced column filtering system for TablixJS\r\n * \r\n * Features:\r\n * - Multi-column filtering with independent filter states\r\n * - Two filter types: \"value\" (checkbox selection) and \"condition\" (operators)\r\n * - Supports multiple conditions per column\r\n * - Extensible operator system for custom filters\r\n * - Integration with sorting and pagination\r\n * - Support for complex/nested data via filterAccessor, filterPath, and filterable flags\r\n */\r\nexport default class FilterManager {\r\n  constructor(table, options = {}) {\r\n    this.table = table;\r\n    this.options = {\r\n      enabled: true,\r\n      mode: 'client', // 'client' or 'server'\r\n      serverFilterLoader: null, // Function to load filtered data from server\r\n      debounceDelay: 300, // Debounce delay for input filters\r\n      showBadges: true, // Show filter count badges\r\n      showTooltips: true, // Show filter summary tooltips\r\n      ...options\r\n    };\r\n\r\n    // Filter state per column\r\n    this.columnFilters = new Map(); // { columnName: { type, config, isActive } }\r\n    \r\n    // Supported filter operators\r\n    this.operators = {\r\n      'none': { label: 'None', apply: () => true },\r\n      'isEmpty': { label: 'Is empty', apply: (value) => value === null || value === undefined || value === '' },\r\n      'isNotEmpty': { label: 'Is not empty', apply: (value) => value !== null && value !== undefined && value !== '' },\r\n      'equals': { label: 'Is equal to', apply: (value, filterValue) => String(value).toLowerCase() === String(filterValue).toLowerCase() },\r\n      'notEquals': { label: 'Is not equal to', apply: (value, filterValue) => String(value).toLowerCase() !== String(filterValue).toLowerCase() },\r\n      'beginsWith': { label: 'Begins with', apply: (value, filterValue) => String(value).toLowerCase().startsWith(String(filterValue).toLowerCase()) },\r\n      'endsWith': { label: 'Ends with', apply: (value, filterValue) => String(value).toLowerCase().endsWith(String(filterValue).toLowerCase()) },\r\n      'contains': { label: 'Contains', apply: (value, filterValue) => String(value).toLowerCase().includes(String(filterValue).toLowerCase()) },\r\n      'notContains': { label: 'Does not contain', apply: (value, filterValue) => !String(value).toLowerCase().includes(String(filterValue).toLowerCase()) }\r\n    };\r\n\r\n    // Debounce timer for input filtering\r\n    this.debounceTimer = null;\r\n\r\n    // Track open filter dropdowns\r\n    this.openDropdowns = new Set();\r\n  }\r\n\r\n  /**\r\n   * Apply filter to a specific column\r\n   * @param {string} columnName - Column to filter\r\n   * @param {Object} filterConfig - Filter configuration\r\n   */\r\n  async applyFilter(columnName, filterConfig) {\r\n    // Validate filter config\r\n    if (!this.validateFilterConfig(filterConfig)) {\r\n      console.warn(`TablixJS: Invalid filter config for column '${columnName}'`);\r\n      return;\r\n    }\r\n\r\n    // Trigger beforeFilter hook\r\n    const beforeFilterData = { \r\n      columnName, \r\n      filterConfig, \r\n      currentFilters: this.getActiveFilters() \r\n    };\r\n    this.table.eventManager.trigger('beforeFilter', beforeFilterData);\r\n\r\n    // Store filter state\r\n    this.columnFilters.set(columnName, {\r\n      type: filterConfig.type,\r\n      config: filterConfig,\r\n      isActive: this.isFilterActive(filterConfig)\r\n    });\r\n\r\n    // Update state manager with current filters\r\n    if (this.table.stateManager) {\r\n      this.table.stateManager.updateFilters(this.getActiveFilters());\r\n      // Reset to first page when filters change\r\n      this.table.stateManager.resetPage();\r\n    }\r\n\r\n    if (this.options.mode === 'server') {\r\n      // Server mode - update will be triggered by refreshTable via unified loader\r\n      await this.table.refreshTable();\r\n    } else {\r\n      // Client mode - apply filter locally\r\n      this._filterClient();\r\n      await this.table.refreshTable();\r\n    }\r\n\r\n    // Update UI indicators\r\n    this.updateFilterIndicators();\r\n\r\n    // Trigger afterFilter hook\r\n    this.table.eventManager.trigger('afterFilter', {\r\n      columnName,\r\n      filterConfig,\r\n      filteredData: this.table.dataManager.getData(),\r\n      activeFilters: this.getActiveFilters()\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Clear filter for a specific column\r\n   * @param {string} columnName - Column to clear filter for\r\n   */\r\n  async clearFilter(columnName) {\r\n    if (!this.columnFilters.has(columnName)) return;\r\n\r\n    const beforeFilterData = { \r\n      columnName, \r\n      filterConfig: null, \r\n      currentFilters: this.getActiveFilters() \r\n    };\r\n    this.table.eventManager.trigger('beforeFilter', beforeFilterData);\r\n\r\n    this.columnFilters.delete(columnName);\r\n\r\n    // Update state manager with current filters\r\n    if (this.table.stateManager) {\r\n      this.table.stateManager.updateFilters(this.getActiveFilters());\r\n      this.table.stateManager.resetPage();\r\n    }\r\n\r\n    if (this.options.mode === 'server') {\r\n      await this.table.refreshTable();\r\n    } else {\r\n      this._filterClient();\r\n      await this.table.refreshTable();\r\n    }\r\n\r\n    this.updateFilterIndicators();\r\n\r\n    this.table.eventManager.trigger('afterFilter', {\r\n      columnName,\r\n      filterConfig: null,\r\n      filteredData: this.table.dataManager.getData(),\r\n      activeFilters: this.getActiveFilters()\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Clear all filters\r\n   */\r\n  async clearAllFilters() {\r\n    if (this.columnFilters.size === 0) return;\r\n\r\n    const beforeFilterData = { \r\n      columnName: null, \r\n      filterConfig: null, \r\n      currentFilters: this.getActiveFilters() \r\n    };\r\n    this.table.eventManager.trigger('beforeFilter', beforeFilterData);\r\n\r\n    this.columnFilters.clear();\r\n\r\n    // Update state manager with empty filters\r\n    if (this.table.stateManager) {\r\n      this.table.stateManager.updateFilters({});\r\n      this.table.stateManager.resetPage();\r\n    }\r\n\r\n    if (this.options.mode === 'server') {\r\n      await this.table.refreshTable();\r\n    } else {\r\n      this._filterClient();\r\n      await this.table.refreshTable();\r\n    }\r\n\r\n    this.updateFilterIndicators();\r\n\r\n    this.table.eventManager.trigger('afterFilter', {\r\n      columnName: null,\r\n      filterConfig: null,\r\n      filteredData: this.table.dataManager.getData(),\r\n      activeFilters: this.getActiveFilters()\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get active filters\r\n   * @returns {Object} Active filters by column\r\n   */\r\n  getActiveFilters() {\r\n    const activeFilters = {};\r\n    for (const [columnName, filterState] of this.columnFilters) {\r\n      if (filterState.isActive) {\r\n        activeFilters[columnName] = filterState.config;\r\n      }\r\n    }\r\n    return activeFilters;\r\n  }\r\n\r\n  /**\r\n   * Check if filtering is enabled for a column.\r\n   * Respects the `filterable` flag, accessor/path config, and auto-detects complex data.\r\n   * @param {string} columnName - Column name\r\n   * @returns {boolean}\r\n   */\r\n  isColumnFilterable(columnName) {\r\n    const column = this._getColumnDef(columnName);\r\n    if (!column) return true; // Unknown column — allow (backward compat)\r\n\r\n    const sampleData = this.table.dataManager.originalData || [];\r\n    return isFeatureEnabled(column, 'filter', sampleData);\r\n  }\r\n\r\n  /**\r\n   * Get unique values for a column (for value filtering).\r\n   * Uses filterAccessor / filterPath when available so that complex data\r\n   * columns can still participate in value-based filtering.\r\n   * @param {string} columnName - Column name\r\n   * @returns {Array} Unique primitive string values\r\n   */\r\n  getColumnUniqueValues(columnName) {\r\n    // If column is explicitly non-filterable, return empty\r\n    if (!this.isColumnFilterable(columnName)) {\r\n      return [];\r\n    }\r\n\r\n    const column = this._getColumnDef(columnName);\r\n\r\n    // For server mode, use the current filtered data (what's loaded from server)\r\n    // For client mode, use the original data\r\n    const data = this.options.mode === 'server' \r\n      ? this.table.dataManager.filteredData \r\n      : this.table.dataManager.originalData;\r\n    \r\n    const values = new Set();\r\n    \r\n    data.forEach(row => {\r\n      // Resolve through accessor/path when available\r\n      const resolved = column\r\n        ? resolveColumnValue(column, row, 'filter')\r\n        : row[columnName];\r\n\r\n      if (resolved !== null && resolved !== undefined && !isComplexValue(resolved)) {\r\n        values.add(String(resolved));\r\n      }\r\n    });\r\n    \r\n    return Array.from(values).sort();\r\n  }\r\n\r\n  /**\r\n   * Get filter state for a column\r\n   * @param {string} columnName - Column name\r\n   * @returns {Object|null} Filter state\r\n   */\r\n  getColumnFilter(columnName) {\r\n    return this.columnFilters.get(columnName) || null;\r\n  }\r\n\r\n  /**\r\n   * Check if column has active filter\r\n   * @param {string} columnName - Column name\r\n   * @returns {boolean} Whether column has active filter\r\n   */\r\n  hasColumnFilter(columnName) {\r\n    const filter = this.columnFilters.get(columnName);\r\n    return filter && filter.isActive;\r\n  }\r\n\r\n  /**\r\n   * Validate filter configuration\r\n   * @param {Object} filterConfig - Filter configuration\r\n   * @returns {boolean} Whether config is valid\r\n   */\r\n  validateFilterConfig(filterConfig) {\r\n    if (!filterConfig || !filterConfig.type) return false;\r\n    \r\n    if (filterConfig.type === 'value') {\r\n      return Array.isArray(filterConfig.values);\r\n    }\r\n    \r\n    if (filterConfig.type === 'condition') {\r\n      return Array.isArray(filterConfig.conditions) && \r\n             filterConfig.conditions.every(cond => \r\n               cond.operator && this.operators[cond.operator]\r\n             );\r\n    }\r\n    \r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Check if filter config represents an active filter\r\n   * @param {Object} filterConfig - Filter configuration\r\n   * @returns {boolean} Whether filter is active\r\n   */\r\n  isFilterActive(filterConfig) {\r\n    if (!filterConfig) return false;\r\n    \r\n    if (filterConfig.type === 'value') {\r\n      return filterConfig.values && filterConfig.values.length > 0;\r\n    }\r\n    \r\n    if (filterConfig.type === 'condition') {\r\n      return filterConfig.conditions && \r\n             filterConfig.conditions.some(cond => \r\n               cond.operator && cond.operator !== 'none' && \r\n               (cond.operator === 'isEmpty' || cond.operator === 'isNotEmpty' || cond.value !== undefined)\r\n             );\r\n    }\r\n    \r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Client-side filtering\r\n   * @private\r\n   */\r\n  _filterClient() {\r\n    const originalData = this.table.dataManager.originalData;\r\n    const activeFilters = this.getActiveFilters();\r\n    \r\n    let filteredData;\r\n    if (Object.keys(activeFilters).length === 0) {\r\n      // No filters, show all data\r\n      filteredData = [...originalData];\r\n    } else {\r\n      // Apply all active filters\r\n      filteredData = originalData.filter(row => {\r\n        return Object.entries(activeFilters).every(([columnName, filterConfig]) => {\r\n          return this._testRowAgainstFilter(row, columnName, filterConfig);\r\n        });\r\n      });\r\n    }\r\n\r\n    // Update DataManager with filtered data\r\n    this.table.dataManager.setFilteredData(filteredData);\r\n  }\r\n\r\n  /**\r\n   * Server-side filtering (DEPRECATED - now handled by unified loader)\r\n   * @deprecated Use unified _loadServerData in Table.js\r\n   * @private\r\n   */\r\n  async _filterServer() {\r\n    // This method is deprecated and should not be called anymore\r\n    // Filtering in server mode is now handled by the unified _loadServerData method\r\n    console.warn('_filterServer is deprecated. Server filtering now uses unified data loading.');\r\n    if (!this.options.serverFilterLoader) {\r\n      console.warn('TablixJS: Server-side filtering enabled but no serverFilterLoader provided');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const result = await this.options.serverFilterLoader({\r\n        filters: this.getActiveFilters(),\r\n        sort: this.table.sortingManager ? this.table.sortingManager.currentSort : null,\r\n        page: this.table.paginationManager ? this.table.paginationManager.currentPage : 1,\r\n        pageSize: this.table.paginationManager ? this.table.paginationManager.pageSize : 10\r\n      });\r\n\r\n      this.table.dataManager.setServerData(result.data, result.totalRows);\r\n    } catch (error) {\r\n      console.error('Failed to load filtered data from server:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Test a row against a filter.\r\n   * Uses resolveColumnValue so that filterAccessor / filterPath are respected.\r\n   * @param {Object} row - Data row\r\n   * @param {string} columnName - Column name\r\n   * @param {Object} filterConfig - Filter configuration\r\n   * @returns {boolean} Whether row passes filter\r\n   * @private\r\n   */\r\n  _testRowAgainstFilter(row, columnName, filterConfig) {\r\n    const column = this._getColumnDef(columnName);\r\n    // Resolve value through accessor/path — falls back to raw primitive\r\n    const cellValue = column\r\n      ? resolveColumnValue(column, row, 'filter')\r\n      : row[columnName];\r\n    \r\n    if (filterConfig.type === 'value') {\r\n      // Value filter: compare resolved (primitive) value\r\n      const cellValueStr = this._valueToString(cellValue);\r\n      return filterConfig.values.includes(cellValueStr);\r\n    }\r\n    \r\n    if (filterConfig.type === 'condition') {\r\n      // Condition filter: test all conditions (AND logic)\r\n      return filterConfig.conditions.every(condition => {\r\n        const operator = this.operators[condition.operator];\r\n        if (!operator) return true; // Unknown operator, pass\r\n        \r\n        return operator.apply(cellValue, condition.value);\r\n      });\r\n    }\r\n    \r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Update filter indicators in the UI\r\n   */\r\n  updateFilterIndicators() {\r\n    const headers = this.table.container.querySelectorAll('.tablix-th');\r\n    \r\n    headers.forEach(header => {\r\n      const columnName = header.dataset.column;\r\n      const hasFilter = this.hasColumnFilter(columnName);\r\n      const filterIndicator = header.querySelector('.tablix-filter-indicator');\r\n      \r\n      if (hasFilter) {\r\n        header.classList.add('tablix-filtered');\r\n        if (filterIndicator) {\r\n          filterIndicator.classList.add('tablix-filter-active');\r\n          \r\n          // Update badge if enabled\r\n          if (this.options.showBadges) {\r\n            this._updateFilterBadge(header, columnName);\r\n          }\r\n        }\r\n      } else {\r\n        header.classList.remove('tablix-filtered');\r\n        if (filterIndicator) {\r\n          filterIndicator.classList.remove('tablix-filter-active');\r\n          const badge = filterIndicator.querySelector('.tablix-filter-badge');\r\n          if (badge) badge.remove();\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Update filter badge for a column\r\n   * @param {Element} header - Header element\r\n   * @param {string} columnName - Column name\r\n   * @private\r\n   */\r\n  _updateFilterBadge(header, columnName) {\r\n    const filterIndicator = header.querySelector('.tablix-filter-indicator');\r\n    if (!filterIndicator) return;\r\n    \r\n    const filter = this.getColumnFilter(columnName);\r\n    if (!filter || !filter.isActive) return;\r\n    \r\n    let badgeText = '';\r\n    if (filter.type === 'value') {\r\n      badgeText = filter.config.values.length.toString();\r\n    } else if (filter.type === 'condition') {\r\n      const activeConditions = filter.config.conditions.filter(cond => \r\n        cond.operator && cond.operator !== 'none'\r\n      );\r\n      badgeText = activeConditions.length.toString();\r\n    }\r\n    \r\n    let badge = filterIndicator.querySelector('.tablix-filter-badge');\r\n    if (!badge && badgeText) {\r\n      badge = document.createElement('span');\r\n      badge.className = 'tablix-filter-badge';\r\n      filterIndicator.appendChild(badge);\r\n    }\r\n    \r\n    if (badge) {\r\n      badge.textContent = badgeText;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Convert a value to string safely, handling complex objects\r\n   * @param {*} value - Value to convert\r\n   * @returns {string} String representation\r\n   * @private\r\n   */\r\n  _valueToString(value) {\r\n    if (value === null || value === undefined) {\r\n      return '';\r\n    }\r\n    if (typeof value === 'object' && !(value instanceof Date)) {\r\n      // For complex objects, use JSON stringify for comparison\r\n      return JSON.stringify(value);\r\n    }\r\n    return String(value);\r\n  }\r\n\r\n  /**\r\n   * Register a custom filter operator\r\n   * @param {string} name - Operator name\r\n   * @param {Object} operator - Operator definition\r\n   */\r\n  registerOperator(name, operator) {\r\n    if (!operator.label || typeof operator.apply !== 'function') {\r\n      throw new Error('TablixJS: Custom operator must have label and apply function');\r\n    }\r\n    \r\n    this.operators[name] = operator;\r\n  }\r\n\r\n  /**\r\n   * Get available operators\r\n   * @returns {Object} Available operators\r\n   */\r\n  getOperators() {\r\n    return { ...this.operators };\r\n  }\r\n\r\n  /**\r\n   * Look up a column definition by name.\r\n   * @param {string} columnName\r\n   * @returns {Object|null}\r\n   * @private\r\n   */\r\n  _getColumnDef(columnName) {\r\n    if (this.table.columnManager) {\r\n      return this.table.columnManager.getColumn(columnName);\r\n    }\r\n    const cols = this.table.options.columns || [];\r\n    return cols.find(c => c.name === columnName || c.key === columnName) || null;\r\n  }\r\n}\r\n","/**\r\n * FilterUI - User interface components for TablixJS filtering\r\n * Handles dropdown creation, event binding, and filter interactions\r\n */\r\nexport default class FilterUI {\r\n  constructor(filterManager) {\r\n    this.filterManager = filterManager;\r\n    this.table = filterManager.table;\r\n    \r\n    // Track open dropdowns\r\n    this.activeDropdown = null;\r\n    \r\n    // Bind methods to preserve context\r\n    this.handleDocumentClick = this.handleDocumentClick.bind(this);\r\n    this.handleFilterIconClick = this.handleFilterIconClick.bind(this);\r\n    \r\n    // Initialize event listeners\r\n    this.init();\r\n  }\r\n\r\n  /**\r\n   * Initialize the FilterUI\r\n   */\r\n  init() {\r\n    // Add document click listener to close dropdowns\r\n    document.addEventListener('click', this.handleDocumentClick);\r\n  }\r\n\r\n  /**\r\n   * Check if a column is filterable.\r\n   * Delegates to FilterManager.isColumnFilterable which uses ValueResolver\r\n   * to respect filterable flag, accessor/path, and auto-detect complex data.\r\n   * \r\n   * @param {string} columnName - Column name to check\r\n   * @returns {boolean} True if column supports filtering\r\n   */\r\n  _isColumnFilterable(columnName) {\r\n    return this.filterManager.isColumnFilterable(columnName);\r\n  }\r\n\r\n  /**\r\n   * Destroy FilterUI and clean up event listeners\r\n   */\r\n  destroy() {\r\n    document.removeEventListener('click', this.handleDocumentClick);\r\n    this.closeAllDropdowns();\r\n  }\r\n\r\n  /**\r\n   * Render filter icons in table headers\r\n   * Note: Filter icons are not rendered for columns with complex data (objects)\r\n   * as value-based filtering is not supported for such columns.\r\n   */\r\n  renderFilterIcons() {\r\n    const headers = this.table.container.querySelectorAll('.tablix-th');\r\n    \r\n    headers.forEach(header => {\r\n      const columnName = header.dataset.column;\r\n      if (!columnName) return;\r\n      \r\n      const thContent = header.querySelector('.tablix-th-content');\r\n      if (!thContent) return;\r\n      \r\n      // Skip rendering filter icon for non-filterable columns\r\n      // Respects filterable flag, accessor/path config, and auto-detects complex data\r\n      if (!this._isColumnFilterable(columnName)) {\r\n        return;\r\n      }\r\n      \r\n      // Check if filter icon already exists\r\n      let filterIndicator = header.querySelector('.tablix-filter-indicator');\r\n      \r\n      if (filterIndicator) {\r\n        // Update existing filter indicator with new translations\r\n        const filterIcon = filterIndicator.querySelector('.tablix-filter-icon');\r\n        if (filterIcon) {\r\n          filterIcon.title = this.table.t('filter.filterColumn');\r\n        }\r\n        return;\r\n      }\r\n      \r\n      // Create new filter indicator\r\n      filterIndicator = document.createElement('span');\r\n      filterIndicator.className = 'tablix-filter-indicator';\r\n      filterIndicator.innerHTML = `\r\n        <span class=\"tablix-filter-icon\" title=\"${this.table.t('filter.filterColumn')}\">🞃</span>\r\n      `;\r\n      \r\n      // Add click handler\r\n      filterIndicator.addEventListener('click', (e) => {\r\n        e.stopPropagation();\r\n        this.handleFilterIconClick(columnName, filterIndicator);\r\n      });\r\n      \r\n      // Insert after sort indicator or at end\r\n      const sortIndicator = thContent.querySelector('.tablix-sort-indicator');\r\n      if (sortIndicator) {\r\n        thContent.insertBefore(filterIndicator, sortIndicator.nextSibling);\r\n      } else {\r\n        thContent.appendChild(filterIndicator);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Handle filter icon click\r\n   * @param {string} columnName - Column name\r\n   * @param {Element} filterIndicator - Filter indicator element\r\n   */\r\n  handleFilterIconClick(columnName, filterIndicator) {\r\n    // Close any existing dropdown\r\n    this.closeAllDropdowns();\r\n    \r\n    // Create and show dropdown\r\n    const dropdown = this.createFilterDropdown(columnName);\r\n    this.showDropdown(dropdown, filterIndicator);\r\n    this.activeDropdown = { dropdown, columnName };\r\n  }\r\n\r\n  /**\r\n   * Handle document clicks to close dropdowns\r\n   * @param {Event} event - Click event\r\n   */\r\n  handleDocumentClick(event) {\r\n    if (this.activeDropdown) {\r\n      const dropdown = this.activeDropdown.dropdown;\r\n      if (!dropdown.contains(event.target)) {\r\n        this.closeAllDropdowns();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create filter dropdown for a column\r\n   * @param {string} columnName - Column name\r\n   * @returns {Element} Dropdown element\r\n   */\r\n  createFilterDropdown(columnName) {\r\n    const dropdown = document.createElement('div');\r\n    dropdown.className = 'tablix-filter-dropdown';\r\n    dropdown.innerHTML = this.renderDropdownContent(columnName);\r\n    \r\n    // Add event listeners\r\n    this.bindDropdownEvents(dropdown, columnName);\r\n    \r\n    return dropdown;\r\n  }\r\n\r\n  /**\r\n   * Render dropdown content\r\n   * @param {string} columnName - Column name\r\n   * @returns {string} HTML content\r\n   */\r\n  renderDropdownContent(columnName) {\r\n    const currentFilter = this.filterManager.getColumnFilter(columnName);\r\n    \r\n    return `\r\n      <div class=\"tablix-filter-dropdown-header\">\r\n        <h4>${this.table.t('filter.filter')}: ${columnName}</h4>\r\n        <button class=\"tablix-filter-close\" type=\"button\">×</button>\r\n      </div>\r\n      \r\n      <div class=\"tablix-filter-tabs\">\r\n        <button class=\"tablix-filter-tab ${!currentFilter || currentFilter.type === 'value' ? 'active' : ''}\" \r\n                data-tab=\"value\">${this.table.t('filter.filterByValue')}</button>\r\n        <button class=\"tablix-filter-tab ${currentFilter && currentFilter.type === 'condition' ? 'active' : ''}\" \r\n                data-tab=\"condition\">${this.table.t('filter.filterByCondition')}</button>\r\n      </div>\r\n      \r\n      <div class=\"tablix-filter-content\">\r\n        <div class=\"tablix-filter-panel tablix-filter-value-panel ${!currentFilter || currentFilter.type === 'value' ? 'active' : ''}\">\r\n          ${this.renderValueFilterPanel(columnName, currentFilter)}\r\n        </div>\r\n        \r\n        <div class=\"tablix-filter-panel tablix-filter-condition-panel ${currentFilter && currentFilter.type === 'condition' ? 'active' : ''}\">\r\n          ${this.renderConditionFilterPanel(columnName, currentFilter)}\r\n        </div>\r\n      </div>\r\n      \r\n      <div class=\"tablix-filter-actions\">\r\n        <button class=\"tablix-filter-apply\" type=\"button\">${this.table.t('filter.apply')}</button>\r\n        <button class=\"tablix-filter-clear\" type=\"button\">${this.table.t('filter.clear')}</button>\r\n        <button class=\"tablix-filter-cancel\" type=\"button\">${this.table.t('filter.cancel')}</button>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  /**\r\n   * Render value filter panel (checkbox list)\r\n   * @param {string} columnName - Column name\r\n   * @param {Object|null} currentFilter - Current filter state\r\n   * @returns {string} HTML content\r\n   */\r\n  renderValueFilterPanel(columnName, currentFilter) {\r\n    const uniqueValues = this.filterManager.getColumnUniqueValues(columnName);\r\n    const selectedValues = currentFilter && currentFilter.type === 'value' ? \r\n      currentFilter.config.values : [];\r\n    \r\n    if (uniqueValues.length === 0) {\r\n      // Check if the column contains complex data by sampling the first row\r\n      const data = this.table.dataManager.originalData;\r\n      const hasComplexData = data.length > 0 && \r\n        typeof data[0][columnName] === 'object' && \r\n        !(data[0][columnName] instanceof Date);\r\n      \r\n      const message = hasComplexData \r\n        ? this.table.t('filter.complexDataNotSupported') || 'Value filtering is not available for columns with complex data. Use Condition filtering instead.'\r\n        : this.table.t('filter.noValuesAvailable');\r\n      \r\n      return `<p class=\"tablix-filter-empty\">${message}</p>`;\r\n    }\r\n    \r\n    let html = `\r\n      <div class=\"tablix-filter-search\">\r\n        <input type=\"text\" \r\n               id=\"tablix-filter-search-${columnName}\" \r\n               name=\"filter-search-${columnName}\"\r\n               placeholder=\"${this.table.t('filter.searchValues')}\" \r\n               class=\"tablix-filter-search-input\">\r\n      </div>\r\n      <div class=\"tablix-filter-select-all\">\r\n        <label>\r\n          <input type=\"checkbox\" \r\n                 id=\"tablix-filter-select-all-${columnName}\" \r\n                 name=\"filter-select-all-${columnName}\"\r\n                 class=\"tablix-filter-select-all-checkbox\"> ${this.table.t('filter.selectAll')}\r\n        </label>\r\n      </div>\r\n      <div class=\"tablix-filter-values\">\r\n    `;\r\n    \r\n    uniqueValues.forEach((value, index) => {\r\n      const isChecked = selectedValues.includes(value);\r\n      const valueId = `tablix-filter-value-${columnName}-${index}`;\r\n      html += `\r\n        <label class=\"tablix-filter-value-item\">\r\n          <input type=\"checkbox\" \r\n                 id=\"${valueId}\" \r\n                 name=\"filter-value-${columnName}\" \r\n                 value=\"${this.escapeHtml(value)}\" \r\n                 ${isChecked ? 'checked' : ''}>\r\n          <span class=\"tablix-filter-value-text\">${this.escapeHtml(value)}</span>\r\n        </label>\r\n      `;\r\n    });\r\n    \r\n    html += '</div>';\r\n    return html;\r\n  }\r\n\r\n  /**\r\n   * Render condition filter panel\r\n   * @param {string} columnName - Column name\r\n   * @param {Object|null} currentFilter - Current filter state\r\n   * @returns {string} HTML content\r\n   */\r\n  renderConditionFilterPanel(columnName, currentFilter) {\r\n    const conditions = currentFilter && currentFilter.type === 'condition' ? \r\n      currentFilter.config.conditions : [{ operator: 'none', value: '' }];\r\n    \r\n    let html = '<div class=\"tablix-filter-conditions\">';\r\n    \r\n    conditions.forEach((condition, index) => {\r\n      html += this.renderConditionRow(condition, index);\r\n    });\r\n    \r\n    html += `\r\n      </div>\r\n      <button class=\"tablix-filter-add-condition\" type=\"button\">+ ${this.table.t('filter.addCondition')}</button>\r\n    `;\r\n    \r\n    return html;\r\n  }\r\n\r\n  /**\r\n   * Render a single condition row\r\n   * @param {Object} condition - Condition object\r\n   * @param {number} index - Condition index\r\n   * @returns {string} HTML content\r\n   */\r\n  renderConditionRow(condition, index) {\r\n    const operators = this.filterManager.getOperators();\r\n    const needsValue = condition.operator && \r\n      !['none', 'isEmpty', 'isNotEmpty'].includes(condition.operator);\r\n    \r\n    let html = `\r\n      <div class=\"tablix-filter-condition\" data-index=\"${index}\">\r\n        <select class=\"tablix-filter-operator\" \r\n                id=\"tablix-filter-operator-${index}\" \r\n                name=\"filter-operator-${index}\">\r\n    `;\r\n    \r\n    Object.entries(operators).forEach(([key, op]) => {\r\n      const selected = condition.operator === key ? ' selected' : '';\r\n      html += `<option value=\"${key}\"${selected}>${op.label}</option>`;\r\n    });\r\n    \r\n    html += `\r\n        </select>\r\n        <input type=\"text\" \r\n               id=\"tablix-filter-value-${index}\" \r\n               name=\"filter-value-${index}\"\r\n               class=\"tablix-filter-value\" \r\n               placeholder=\"${this.table.t('filter.value')}\" \r\n               value=\"${this.escapeHtml(condition.value || '')}\"\r\n               ${needsValue ? '' : 'disabled'}>\r\n        <button class=\"tablix-filter-remove-condition\" \r\n                type=\"button\" \r\n                data-index=\"${index}\"\r\n                title=\"${this.table.t('filter.removeCondition')}\">×</button>\r\n      </div>\r\n    `;\r\n    \r\n    return html;\r\n  }\r\n\r\n  /**\r\n   * Bind dropdown event listeners\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @param {string} columnName - Column name\r\n   */\r\n  bindDropdownEvents(dropdown, columnName) {\r\n    // Tab switching\r\n    dropdown.querySelectorAll('.tablix-filter-tab').forEach(tab => {\r\n      tab.addEventListener('click', (e) => {\r\n        const tabType = e.target.dataset.tab;\r\n        this.switchTab(dropdown, tabType);\r\n      });\r\n    });\r\n\r\n    // Close button\r\n    dropdown.querySelector('.tablix-filter-close').addEventListener('click', () => {\r\n      this.closeAllDropdowns();\r\n    });\r\n\r\n    // Action buttons\r\n    dropdown.querySelector('.tablix-filter-apply').addEventListener('click', () => {\r\n      this.applyFilter(dropdown, columnName);\r\n    });\r\n\r\n    dropdown.querySelector('.tablix-filter-clear').addEventListener('click', () => {\r\n      this.clearFilter(columnName);\r\n    });\r\n\r\n    dropdown.querySelector('.tablix-filter-cancel').addEventListener('click', () => {\r\n      this.closeAllDropdowns();\r\n    });\r\n\r\n    // Value filter events\r\n    this.bindValueFilterEvents(dropdown, columnName);\r\n    \r\n    // Condition filter events\r\n    this.bindConditionFilterEvents(dropdown, columnName);\r\n  }\r\n\r\n  /**\r\n   * Bind value filter events\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @param {string} columnName - Column name\r\n   */\r\n  bindValueFilterEvents(dropdown, columnName) {\r\n    const valuePanel = dropdown.querySelector('.tablix-filter-value-panel');\r\n    if (!valuePanel) return;\r\n\r\n    // Search input with debouncing\r\n    const searchInput = valuePanel.querySelector('.tablix-filter-search-input');\r\n    if (searchInput) {\r\n      let searchTimeout;\r\n      searchInput.addEventListener('input', (e) => {\r\n        clearTimeout(searchTimeout);\r\n        searchTimeout = setTimeout(() => {\r\n          this.filterValueList(valuePanel, e.target.value);\r\n        }, this.filterManager.options.debounceDelay || 150);\r\n      });\r\n    }\r\n\r\n    // Select all checkbox\r\n    const selectAllCheckbox = valuePanel.querySelector('.tablix-filter-select-all-checkbox');\r\n    if (selectAllCheckbox) {\r\n      selectAllCheckbox.addEventListener('change', (e) => {\r\n        this.toggleSelectAll(valuePanel, e.target.checked);\r\n      });\r\n    }\r\n\r\n    // Individual value checkboxes\r\n    valuePanel.querySelectorAll('.tablix-filter-value-item input[type=\"checkbox\"]').forEach(checkbox => {\r\n      checkbox.addEventListener('change', () => {\r\n        this.updateSelectAllState(valuePanel);\r\n      });\r\n    });\r\n\r\n    // Update select all state based on current selections\r\n    this.updateSelectAllState(valuePanel);\r\n  }\r\n\r\n  /**\r\n   * Bind condition filter events\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @param {string} columnName - Column name\r\n   */\r\n  bindConditionFilterEvents(dropdown, columnName) {\r\n    const conditionPanel = dropdown.querySelector('.tablix-filter-condition-panel');\r\n    if (!conditionPanel) return;\r\n\r\n    // Add condition button\r\n    const addButton = conditionPanel.querySelector('.tablix-filter-add-condition');\r\n    if (addButton) {\r\n      addButton.addEventListener('click', () => {\r\n        this.addCondition(conditionPanel);\r\n      });\r\n    }\r\n\r\n    // Operator and value changes\r\n    this.bindConditionRowEvents(conditionPanel);\r\n  }\r\n\r\n  /**\r\n   * Bind events for condition rows\r\n   * @param {Element} conditionPanel - Condition panel element\r\n   */\r\n  bindConditionRowEvents(conditionPanel) {\r\n    // Operator changes\r\n    conditionPanel.querySelectorAll('.tablix-filter-operator').forEach(select => {\r\n      select.addEventListener('change', (e) => {\r\n        const valueInput = e.target.parentElement.querySelector('.tablix-filter-value');\r\n        const needsValue = !['none', 'isEmpty', 'isNotEmpty'].includes(e.target.value);\r\n        valueInput.disabled = !needsValue;\r\n        if (!needsValue) valueInput.value = '';\r\n      });\r\n    });\r\n\r\n    // Remove condition buttons\r\n    conditionPanel.querySelectorAll('.tablix-filter-remove-condition').forEach(button => {\r\n      button.addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        e.stopPropagation(); // Prevent dropdown from closing\r\n        \r\n        const conditionRow = e.target.closest('.tablix-filter-condition');\r\n        const conditionsContainer = conditionPanel.querySelector('.tablix-filter-conditions');\r\n        \r\n        if (conditionsContainer.querySelectorAll('.tablix-filter-condition').length > 1) {\r\n          conditionRow.remove();\r\n        } else {\r\n          // If it's the last condition, reset it to \"none\" instead of removing\r\n          const operatorSelect = conditionRow.querySelector('.tablix-filter-operator');\r\n          const valueInput = conditionRow.querySelector('.tablix-filter-value');\r\n          operatorSelect.value = 'none';\r\n          valueInput.value = '';\r\n          valueInput.disabled = true;\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Switch between filter tabs\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @param {string} tabType - Tab type ('value' or 'condition')\r\n   */\r\n  switchTab(dropdown, tabType) {\r\n    // Update tab buttons\r\n    dropdown.querySelectorAll('.tablix-filter-tab').forEach(tab => {\r\n      tab.classList.toggle('active', tab.dataset.tab === tabType);\r\n    });\r\n\r\n    // Update panels\r\n    dropdown.querySelectorAll('.tablix-filter-panel').forEach(panel => {\r\n      const isActive = panel.classList.contains(`tablix-filter-${tabType}-panel`);\r\n      panel.classList.toggle('active', isActive);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Filter value list based on search\r\n   * @param {Element} valuePanel - Value panel element\r\n   * @param {string} searchTerm - Search term\r\n   */\r\n  filterValueList(valuePanel, searchTerm) {\r\n    const items = valuePanel.querySelectorAll('.tablix-filter-value-item');\r\n    const term = searchTerm.toLowerCase();\r\n    \r\n    items.forEach(item => {\r\n      const text = item.querySelector('.tablix-filter-value-text').textContent.toLowerCase();\r\n      const matches = text.includes(term);\r\n      item.style.display = matches ? '' : 'none';\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Toggle select all checkboxes\r\n   * @param {Element} valuePanel - Value panel element\r\n   * @param {boolean} checked - Whether to check all\r\n   */\r\n  toggleSelectAll(valuePanel, checked) {\r\n    const checkboxes = valuePanel.querySelectorAll('.tablix-filter-value-item input[type=\"checkbox\"]');\r\n    checkboxes.forEach(checkbox => {\r\n      const item = checkbox.closest('.tablix-filter-value-item');\r\n      if (item.style.display !== 'none') {\r\n        checkbox.checked = checked;\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Update select all checkbox state\r\n   * @param {Element} valuePanel - Value panel element\r\n   */\r\n  updateSelectAllState(valuePanel) {\r\n    const selectAllCheckbox = valuePanel.querySelector('.tablix-filter-select-all-checkbox');\r\n    if (!selectAllCheckbox) return;\r\n\r\n    const checkboxes = valuePanel.querySelectorAll('.tablix-filter-value-item input[type=\"checkbox\"]');\r\n    const visibleCheckboxes = Array.from(checkboxes).filter(cb => \r\n      cb.closest('.tablix-filter-value-item').style.display !== 'none'\r\n    );\r\n    \r\n    const checkedCount = visibleCheckboxes.filter(cb => cb.checked).length;\r\n    \r\n    selectAllCheckbox.checked = checkedCount > 0 && checkedCount === visibleCheckboxes.length;\r\n    selectAllCheckbox.indeterminate = checkedCount > 0 && checkedCount < visibleCheckboxes.length;\r\n  }\r\n\r\n  /**\r\n   * Add a new condition row\r\n   * @param {Element} conditionPanel - Condition panel element\r\n   */\r\n  addCondition(conditionPanel) {\r\n    const conditionsContainer = conditionPanel.querySelector('.tablix-filter-conditions');\r\n    const newIndex = conditionsContainer.children.length;\r\n    \r\n    const conditionHtml = this.renderConditionRow({ operator: 'none', value: '' }, newIndex);\r\n    conditionsContainer.insertAdjacentHTML('beforeend', conditionHtml);\r\n    \r\n    // Bind events for the new condition only\r\n    const newCondition = conditionsContainer.lastElementChild;\r\n    \r\n    // Bind operator change event\r\n    const operatorSelect = newCondition.querySelector('.tablix-filter-operator');\r\n    operatorSelect.addEventListener('change', (e) => {\r\n      const valueInput = e.target.parentElement.querySelector('.tablix-filter-value');\r\n      const needsValue = !['none', 'isEmpty', 'isNotEmpty'].includes(e.target.value);\r\n      valueInput.disabled = !needsValue;\r\n      if (!needsValue) valueInput.value = '';\r\n    });\r\n\r\n    // Bind remove button event\r\n    const removeButton = newCondition.querySelector('.tablix-filter-remove-condition');\r\n    removeButton.addEventListener('click', (e) => {\r\n      e.preventDefault();\r\n      e.stopPropagation(); // Prevent dropdown from closing\r\n      \r\n      const conditionRow = e.target.closest('.tablix-filter-condition');\r\n      const conditionsContainer = conditionPanel.querySelector('.tablix-filter-conditions');\r\n      \r\n      if (conditionsContainer.querySelectorAll('.tablix-filter-condition').length > 1) {\r\n        conditionRow.remove();\r\n      } else {\r\n        // If it's the last condition, reset it to \"none\" instead of removing\r\n        const operatorSelect = conditionRow.querySelector('.tablix-filter-operator');\r\n        const valueInput = conditionRow.querySelector('.tablix-filter-value');\r\n        operatorSelect.value = 'none';\r\n        valueInput.value = '';\r\n        valueInput.disabled = true;\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Apply current filter settings\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @param {string} columnName - Column name\r\n   */\r\n  async applyFilter(dropdown, columnName) {\r\n    const activeTab = dropdown.querySelector('.tablix-filter-tab.active').dataset.tab;\r\n    let filterConfig;\r\n\r\n    if (activeTab === 'value') {\r\n      filterConfig = this.collectValueFilter(dropdown);\r\n    } else {\r\n      filterConfig = this.collectConditionFilter(dropdown);\r\n    }\r\n\r\n    await this.filterManager.applyFilter(columnName, filterConfig);\r\n    this.closeAllDropdowns();\r\n  }\r\n\r\n  /**\r\n   * Collect value filter configuration\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @returns {Object} Filter configuration\r\n   */\r\n  collectValueFilter(dropdown) {\r\n    const valuePanel = dropdown.querySelector('.tablix-filter-value-panel');\r\n    const checkboxes = valuePanel.querySelectorAll('.tablix-filter-value-item input[type=\"checkbox\"]:checked');\r\n    const values = Array.from(checkboxes).map(cb => cb.value);\r\n    \r\n    return {\r\n      type: 'value',\r\n      values: values\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Collect condition filter configuration\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @returns {Object} Filter configuration\r\n   */\r\n  collectConditionFilter(dropdown) {\r\n    const conditionPanel = dropdown.querySelector('.tablix-filter-condition-panel');\r\n    const conditionRows = conditionPanel.querySelectorAll('.tablix-filter-condition');\r\n    \r\n    const conditions = Array.from(conditionRows).map(row => {\r\n      const operator = row.querySelector('.tablix-filter-operator').value;\r\n      const value = row.querySelector('.tablix-filter-value').value;\r\n      \r\n      return { operator, value };\r\n    }).filter(cond => cond.operator !== 'none');\r\n    \r\n    return {\r\n      type: 'condition',\r\n      conditions: conditions\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Clear filter for column\r\n   * @param {string} columnName - Column name\r\n   */\r\n  async clearFilter(columnName) {\r\n    await this.filterManager.clearFilter(columnName);\r\n    this.closeAllDropdowns();\r\n  }\r\n\r\n  /**\r\n   * Show dropdown positioned relative to trigger element\r\n   * @param {Element} dropdown - Dropdown element\r\n   * @param {Element} trigger - Trigger element\r\n   */\r\n  showDropdown(dropdown, trigger) {\r\n    document.body.appendChild(dropdown);\r\n    \r\n    // Make dropdown visible but off-screen to measure it\r\n    dropdown.style.position = 'absolute';\r\n    dropdown.style.top = '-9999px';\r\n    dropdown.style.left = '-9999px';\r\n    dropdown.style.display = 'block';\r\n    dropdown.style.visibility = 'hidden';\r\n    \r\n    // Force reflow to ensure accurate measurements\r\n    dropdown.offsetHeight;\r\n    \r\n    // Get accurate measurements\r\n    const triggerRect = trigger.getBoundingClientRect();\r\n    const dropdownRect = dropdown.getBoundingClientRect();\r\n    \r\n    let left = triggerRect.left + window.scrollX;\r\n    let top = triggerRect.bottom + window.scrollY + 5;\r\n    \r\n    // Adjust if dropdown goes off screen\r\n    if (left + dropdownRect.width > window.innerWidth + window.scrollX) {\r\n      left = window.innerWidth + window.scrollX - dropdownRect.width - 10;\r\n    }\r\n    \r\n    if (top + dropdownRect.height > window.innerHeight + window.scrollY) {\r\n      top = triggerRect.top + window.scrollY - dropdownRect.height - 5;\r\n    }\r\n    \r\n    // Ensure dropdown stays within viewport\r\n    left = Math.max(window.scrollX + 10, left);\r\n    top = Math.max(window.scrollY + 10, top);\r\n    \r\n    // Apply final positioning and make visible\r\n    dropdown.style.left = `${left}px`;\r\n    dropdown.style.top = `${top}px`;\r\n    dropdown.style.visibility = 'visible';\r\n  }\r\n\r\n  /**\r\n   * Close all open dropdowns\r\n   */\r\n  closeAllDropdowns() {\r\n    if (this.activeDropdown) {\r\n      this.activeDropdown.dropdown.remove();\r\n      this.activeDropdown = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Escape HTML to prevent XSS\r\n   * @param {string} text - Text to escape\r\n   * @returns {string} Escaped text\r\n   */\r\n  escapeHtml(text) {\r\n    const div = document.createElement('div');\r\n    div.textContent = text;\r\n    return div.innerHTML;\r\n  }\r\n}\r\n","/**\r\n * SearchManager - Global search functionality for TablixJS\r\n * Provides real-time search across all table columns\r\n */\r\nexport default class SearchManager {\r\n  constructor(table, options = {}) {\r\n    this.table = table;\r\n    this.options = {\r\n      enabled: true,\r\n      placeholder: 'Search...',\r\n      searchDelay: 300, // Debounce delay in milliseconds\r\n      caseSensitive: false,\r\n      searchColumns: [], // Empty array means search all columns\r\n      minLength: 1, // Minimum characters before search starts (changed from 0 to 1)\r\n      ...options\r\n    };\r\n\r\n    // Ensure placeholder is never undefined to prevent \"undefined\" from showing in UI\r\n    if (!this.options.placeholder) {\r\n      this.options.placeholder = 'Search...';\r\n    }\r\n\r\n    // Current search state\r\n    this.currentSearchTerm = '';\r\n    this.searchTimeout = null;\r\n    this.originalData = null;\r\n\r\n    // Bind methods to preserve context\r\n    this.handleSearchInput = this.handleSearchInput.bind(this);\r\n    this.handleSearchClear = this.handleSearchClear.bind(this);\r\n  }\r\n\r\n  /**\r\n   * Initialize search functionality\r\n   */\r\n  init() {\r\n    // Store reference to original data\r\n    this.originalData = this.table.dataManager.originalData;\r\n    \r\n    // Listen for data changes\r\n    this.table.eventManager.on('afterLoad', (data) => {\r\n      this.originalData = data.data || data.source;\r\n      // Reapply search if there's an active search term\r\n      if (this.currentSearchTerm) {\r\n        this.performSearch(this.currentSearchTerm);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Bind search events to UI elements\r\n   */\r\n  bindEvents() {\r\n    const searchInput = this.table.container.querySelector('.tablix-search-input');\r\n    const searchClear = this.table.container.querySelector('.tablix-search-clear');\r\n\r\n    if (searchInput) {\r\n      // Ensure input value matches current search term\r\n      if (this.currentSearchTerm && searchInput.value !== this.currentSearchTerm) {\r\n        searchInput.value = this.currentSearchTerm;\r\n      }\r\n      \r\n      searchInput.addEventListener('input', this.handleSearchInput);\r\n      searchInput.addEventListener('keydown', (e) => {\r\n        if (e.key === 'Escape') {\r\n          this.clearSearch();\r\n        }\r\n      });\r\n    }\r\n\r\n    if (searchClear) {\r\n      searchClear.addEventListener('click', this.handleSearchClear);\r\n    }\r\n\r\n    // Update clear button visibility\r\n    this.updateClearButtonVisibility();\r\n  }\r\n\r\n  /**\r\n   * Handle search input with debouncing\r\n   * @param {Event} event - Input event\r\n   */\r\n  handleSearchInput(event) {\r\n    const searchTerm = event.target.value;\r\n    \r\n    // Clear existing timeout\r\n    if (this.searchTimeout) {\r\n      clearTimeout(this.searchTimeout);\r\n    }\r\n\r\n    // Debounce search based on configurable delay\r\n    this.searchTimeout = setTimeout(() => {\r\n      this.performSearch(searchTerm);\r\n    }, this.options.searchDelay);\r\n  }\r\n\r\n  /**\r\n   * Handle search clear button\r\n   * @param {Event} event - Click event\r\n   */\r\n  handleSearchClear(event) {\r\n    event.preventDefault();\r\n    this.clearSearch();\r\n  }\r\n\r\n  /**\r\n   * Perform the actual search\r\n   * @param {string} searchTerm - Search term\r\n   */\r\n  async performSearch(searchTerm) {\r\n    const previousTerm = this.currentSearchTerm;\r\n    \r\n    // Capture focus state before performing search\r\n    const searchInput = this.table.container.querySelector('.tablix-search-input');\r\n    const hadFocus = searchInput && document.activeElement === searchInput;\r\n    const cursorPosition = searchInput ? searchInput.selectionStart || 0 : 0;\r\n    \r\n    // Trigger beforeSearch event with more detailed information\r\n    const beforeSearchData = { \r\n      searchTerm, \r\n      previousTerm,\r\n      minLength: this.options.minLength,\r\n      searchDelay: this.options.searchDelay,\r\n      willSearch: searchTerm.length >= this.options.minLength\r\n    };\r\n    \r\n    this.table.eventManager.trigger('beforeSearch', beforeSearchData);\r\n\r\n    this.currentSearchTerm = searchTerm;\r\n\r\n    // Update state manager with search term\r\n    if (this.table.stateManager) {\r\n      this.table.stateManager.updateSearch(searchTerm);\r\n      // Reset to first page when search changes\r\n      this.table.stateManager.resetPage();\r\n    }\r\n\r\n    // Check if we're in server mode\r\n    const isServerMode = this.table._isServerMode && this.table._isServerMode();\r\n\r\n    if (isServerMode) {\r\n      // Server mode - let refreshTable handle the server request with search param\r\n      // Reset pagination to first page\r\n      if (this.table.paginationManager) {\r\n        this.table.paginationManager.currentPage = 1;\r\n      }\r\n      await this.table.refreshTable();\r\n    } else {\r\n      // Client mode - filter data locally\r\n      if (searchTerm.length < this.options.minLength) {\r\n        this.table.dataManager.filteredData = [...this.originalData];\r\n      } else {\r\n        const filteredData = this.filterData(searchTerm);\r\n        this.table.dataManager.filteredData = filteredData;\r\n      }\r\n\r\n      // Reset pagination to first page\r\n      if (this.table.paginationManager) {\r\n        this.table.paginationManager.resetToFirstPage();\r\n      } else {\r\n        // If no pagination manager, just refresh\r\n        await this.table.refreshTable();\r\n      }\r\n    }\r\n\r\n    // Restore focus after table refresh if it had focus before\r\n    if (hadFocus) {\r\n      requestAnimationFrame(() => {\r\n        const newSearchInput = this.table.container.querySelector('.tablix-search-input');\r\n        if (newSearchInput) {\r\n          newSearchInput.focus();\r\n          if (cursorPosition > 0 && cursorPosition <= newSearchInput.value.length) {\r\n            newSearchInput.setSelectionRange(cursorPosition, cursorPosition);\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    // Trigger afterSearch event with detailed results\r\n    const afterSearchData = {\r\n      searchTerm,\r\n      previousTerm,\r\n      resultsCount: this.table.dataManager.filteredData.length,\r\n      totalCount: this.originalData.length,\r\n      isActive: this.isSearchActive(),\r\n      searchPerformed: searchTerm.length >= this.options.minLength\r\n    };\r\n    \r\n    this.table.eventManager.trigger('afterSearch', afterSearchData);\r\n\r\n    // Update search clear button visibility\r\n    this.updateClearButtonVisibility();\r\n  }\r\n\r\n  /**\r\n   * Filter data based on search term\r\n   * @param {string} searchTerm - Search term\r\n   * @returns {Array} Filtered data\r\n   */\r\n  filterData(searchTerm) {\r\n    if (!searchTerm || searchTerm.trim() === '') {\r\n      return [...this.originalData];\r\n    }\r\n\r\n    const term = this.options.caseSensitive ? searchTerm : searchTerm.toLowerCase();\r\n    const columns = this.getSearchableColumns();\r\n\r\n    return this.originalData.filter(row => {\r\n      return columns.some(columnName => {\r\n        const cellValue = row[columnName];\r\n        if (cellValue === null || cellValue === undefined) {\r\n          return false;\r\n        }\r\n\r\n        // Skip complex objects (not primitive values or Dates) in search\r\n        if (typeof cellValue === 'object' && !(cellValue instanceof Date)) {\r\n          return false;\r\n        }\r\n\r\n        const stringValue = this.options.caseSensitive ? \r\n          String(cellValue) : \r\n          String(cellValue).toLowerCase();\r\n\r\n        return stringValue.includes(term);\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get columns to search in\r\n   * @returns {Array} Array of column names\r\n   */\r\n  getSearchableColumns() {\r\n    // If specific columns are configured, use those\r\n    if (this.options.searchColumns && this.options.searchColumns.length > 0) {\r\n      return this.options.searchColumns;\r\n    }\r\n\r\n    // Otherwise, search all available columns\r\n    const columns = this.table.columnManager ? \r\n      this.table.columnManager.getColumns() : \r\n      (this.table.options.columns || []);\r\n\r\n    return columns.map(col => col.name || col.key).filter(name => name);\r\n  }\r\n\r\n  /**\r\n   * Clear search\r\n   */\r\n  async clearSearch() {\r\n    // Clear search input using the helper method\r\n    this.updateInputValue('');\r\n\r\n    // Clear search timeout\r\n    if (this.searchTimeout) {\r\n      clearTimeout(this.searchTimeout);\r\n      this.searchTimeout = null;\r\n    }\r\n\r\n    // Perform empty search to reset data\r\n    await this.performSearch('');\r\n  }\r\n\r\n  /**\r\n   * Update clear button visibility\r\n   */\r\n  updateClearButtonVisibility() {\r\n    const searchClear = this.table.container.querySelector('.tablix-search-clear');\r\n    if (searchClear) {\r\n      searchClear.style.display = this.currentSearchTerm ? 'block' : 'none';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update input value without triggering search\r\n   * @param {string} value - Value to set\r\n   */\r\n  updateInputValue(value) {\r\n    const searchInput = this.table.container.querySelector('.tablix-search-input');\r\n    if (searchInput && searchInput.value !== value) {\r\n      searchInput.value = value;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set search term programmatically\r\n   * @param {string} searchTerm - Search term\r\n   */\r\n  async setSearchTerm(searchTerm) {\r\n    // Update input value\r\n    this.updateInputValue(searchTerm);\r\n    \r\n    // Clear any pending search timeout\r\n    if (this.searchTimeout) {\r\n      clearTimeout(this.searchTimeout);\r\n      this.searchTimeout = null;\r\n    }\r\n    \r\n    // Perform search immediately\r\n    await this.performSearch(searchTerm);\r\n  }\r\n\r\n  /**\r\n   * Get current search term\r\n   * @returns {string} Current search term\r\n   */\r\n  getSearchTerm() {\r\n    return this.currentSearchTerm;\r\n  }\r\n\r\n  /**\r\n   * Check if search is active\r\n   * @returns {boolean} Whether search is active\r\n   */\r\n  isSearchActive() {\r\n    return this.currentSearchTerm && this.currentSearchTerm.length >= this.options.minLength;\r\n  }\r\n\r\n  /**\r\n   * Get search results count\r\n   * @returns {Object} Search results information\r\n   */\r\n  getSearchInfo() {\r\n    return {\r\n      searchTerm: this.currentSearchTerm,\r\n      resultsCount: this.table.dataManager.filteredData.length,\r\n      totalCount: this.originalData.length,\r\n      isActive: this.isSearchActive()\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Configure search options\r\n   * @param {Object} newOptions - New options to merge\r\n   */\r\n  configure(newOptions) {\r\n    const oldOptions = { ...this.options };\r\n    this.options = { ...this.options, ...newOptions };\r\n    \r\n    // Ensure placeholder is never undefined\r\n    if (!this.options.placeholder) {\r\n      this.options.placeholder = 'Search...';\r\n    }\r\n    \r\n    // Update placeholder if it changed\r\n    if (newOptions.placeholder && newOptions.placeholder !== oldOptions.placeholder) {\r\n      const searchInput = this.table.container.querySelector('.tablix-search-input');\r\n      if (searchInput) {\r\n        searchInput.placeholder = this.options.placeholder;\r\n      }\r\n    }\r\n    \r\n    // If minLength changed and we have an active search, re-evaluate\r\n    if (newOptions.minLength !== undefined && this.currentSearchTerm) {\r\n      this.performSearch(this.currentSearchTerm);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current search configuration\r\n   * @returns {Object} Current search options\r\n   */\r\n  getConfiguration() {\r\n    return { ...this.options };\r\n  }\r\n\r\n  /**\r\n   * Destroy search manager and clean up\r\n   */\r\n  destroy() {\r\n    if (this.searchTimeout) {\r\n      clearTimeout(this.searchTimeout);\r\n    }\r\n\r\n    const searchInput = this.table.container.querySelector('.tablix-search-input');\r\n    const searchClear = this.table.container.querySelector('.tablix-search-clear');\r\n\r\n    if (searchInput) {\r\n      searchInput.removeEventListener('input', this.handleSearchInput);\r\n    }\r\n\r\n    if (searchClear) {\r\n      searchClear.removeEventListener('click', this.handleSearchClear);\r\n    }\r\n  }\r\n}\r\n","export default class SelectionManager {\r\n  constructor(table, options = {}) {\r\n    this.table = table;\r\n    this.options = {\r\n      enabled: false,\r\n      mode: 'single', // 'single' or 'multi'\r\n      ...options\r\n    };\r\n    \r\n    // Selection state - use stable data IDs/keys, not row indexes\r\n    this.selectedRows = new Set(); // Set of row IDs/keys\r\n    this.lastSelectedRow = null; // For range selection with shift+click\r\n    \r\n    // Track row ID mapping for stable selection across pagination/sorting/filtering\r\n    this.rowIdMap = new Map(); // Maps data objects to their stable IDs\r\n    this.dataIdKey = options.dataIdKey || 'id'; // Key to use as stable row ID\r\n    \r\n    // Drag selection state\r\n    this.dragSelection = {\r\n      isActive: false,\r\n      startRowIndex: null,\r\n      currentRowIndex: null,\r\n      startRowId: null,\r\n      originalSelection: null, // Backup of selection before drag started\r\n      isDragging: false,\r\n      dragThreshold: 3 // Minimum pixels to move before considering it a drag\r\n    };\r\n    \r\n    // Track event listeners for proper cleanup\r\n    this.eventListeners = [];\r\n    \r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.eventListenersSetup = false; // Track if event listeners are already set up\r\n    \r\n    if (this.options.enabled) {\r\n      this.setupEventListeners();\r\n    }\r\n  }\r\n\r\n  setupEventListeners() {\r\n    // Prevent setting up listeners multiple times\r\n    if (this.eventListenersSetup) {\r\n      return;\r\n    }\r\n    \r\n    this.eventListenersSetup = true;\r\n    \r\n    // Listen for row clicks\r\n    this.table.eventManager.on('rowClick', (event) => {\r\n      this.handleRowClick(event);\r\n    });\r\n    \r\n    // Listen for drag selection events (only in multi mode and when NOT using virtual scrolling)\r\n    if (this.options.mode === 'multi' && !this.table.virtualScrollManager) {\r\n      this.setupDragSelection();\r\n    }\r\n    \r\n    // Clear selection when data changes\r\n    this.table.eventManager.on('beforeLoad', () => {\r\n      this.clearSelection();\r\n    });\r\n    \r\n    // Update selection state after data operations\r\n    this.table.eventManager.on('afterLoad', () => {\r\n      this.updateSelectionAfterDataChange();\r\n    });\r\n    \r\n    // Update selection UI after rendering\r\n    this.table.eventManager.on('afterRender', () => {\r\n      this.updateUI();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Handle row click events for selection\r\n   * @param {Object} event - Row click event data\r\n   */\r\n  handleRowClick(event) {\r\n    // Safety check - ensure table and managers are still available\r\n    if (!this.table || !this.options.enabled) {\r\n      return;\r\n    }\r\n\r\n    // If this was a drag operation, don't process as a click\r\n    if (this.dragSelection.isDragging) {\r\n      this.dragSelection.isDragging = false;\r\n      return;\r\n    }\r\n\r\n    const { rowData, rowIndex, originalEvent } = event;\r\n    const rowId = this.getRowId(rowData);\r\n    \r\n    // Debug logging for modifier keys\r\n    console.log('SelectionManager handleRowClick:', {\r\n      rowId,\r\n      hasOriginalEvent: !!originalEvent,\r\n      ctrlKey: originalEvent ? originalEvent.ctrlKey : 'no event',\r\n      shiftKey: originalEvent ? originalEvent.shiftKey : 'no event',\r\n      metaKey: originalEvent ? originalEvent.metaKey : 'no event',\r\n      timestamp: Date.now()\r\n    });\r\n    \r\n    // Prevent default and stop propagation to avoid duplicate events\r\n    if (originalEvent) {\r\n      originalEvent.preventDefault();\r\n      originalEvent.stopPropagation();\r\n    }\r\n\r\n    // Fire beforeSelect event\r\n    const beforeSelectEvent = {\r\n      rowData,\r\n      rowId,\r\n      currentSelection: Array.from(this.selectedRows),\r\n      isCtrlClick: originalEvent && (originalEvent.ctrlKey || originalEvent.metaKey),\r\n      isShiftClick: originalEvent && originalEvent.shiftKey,\r\n      isDragSelection: false\r\n    };\r\n    \r\n    if (this.table && this.table.eventManager) {\r\n      this.table.eventManager.trigger('beforeSelect', beforeSelectEvent);\r\n    }\r\n\r\n    if (this.options.mode === 'single') {\r\n      this.handleSingleSelection(rowId, rowData);\r\n    } else if (this.options.mode === 'multi') {\r\n      this.handleMultiSelection(rowId, rowData, originalEvent);\r\n    }\r\n\r\n    this.updateUI();\r\n    \r\n    // Fire afterSelect event\r\n    const afterSelectEvent = {\r\n      rowData,\r\n      rowId,\r\n      selectedRows: Array.from(this.selectedRows),\r\n      selectedData: this.getSelectedData(),\r\n      isDragSelection: false\r\n    };\r\n    \r\n    if (this.table && this.table.eventManager) {\r\n      this.table.eventManager.trigger('afterSelect', afterSelectEvent);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle single row selection\r\n   * @param {String} rowId - Stable row identifier\r\n   * @param {Object} rowData - Row data object\r\n   */\r\n  handleSingleSelection(rowId, rowData) {\r\n    // In single mode, if the row is already selected, deselect it\r\n    if (this.selectedRows.has(rowId)) {\r\n      this.selectedRows.clear();\r\n      this.lastSelectedRow = null;\r\n    } else {\r\n      // Otherwise, select only the clicked row\r\n      this.selectedRows.clear();\r\n      this.selectedRows.add(rowId);\r\n      this.lastSelectedRow = rowId;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle multi row selection with ctrl+click and shift+click\r\n   * @param {String} rowId - Stable row identifier\r\n   * @param {Object} rowData - Row data object\r\n   * @param {Event} originalEvent - Original mouse event\r\n   */\r\n  handleMultiSelection(rowId, rowData, originalEvent) {\r\n    const isCtrlClick = originalEvent && (originalEvent.ctrlKey || originalEvent.metaKey);\r\n    const isShiftClick = originalEvent && originalEvent.shiftKey;\r\n\r\n    console.log('handleMultiSelection DETAILED:', {\r\n      rowId,\r\n      isCtrlClick,\r\n      isShiftClick,\r\n      'originalEvent.ctrlKey': originalEvent ? originalEvent.ctrlKey : 'no event',\r\n      'originalEvent.metaKey': originalEvent ? originalEvent.metaKey : 'no event',\r\n      'originalEvent.shiftKey': originalEvent ? originalEvent.shiftKey : 'no event',\r\n      lastSelectedRow: this.lastSelectedRow,\r\n      currentSelection: Array.from(this.selectedRows),\r\n      selectionSize: this.selectedRows.size\r\n    });\r\n\r\n    if (isShiftClick && this.lastSelectedRow) {\r\n      // Range selection: select all rows between last selected and current\r\n      console.log('Executing range selection from', this.lastSelectedRow, 'to', rowId);\r\n      this.handleRangeSelection(rowId);\r\n    } else if (isCtrlClick) {\r\n      // Toggle selection of individual row\r\n      console.log('Executing ctrl+click toggle for', rowId);\r\n      if (this.selectedRows.has(rowId)) {\r\n        this.selectedRows.delete(rowId);\r\n        console.log('Ctrl+click: Deselected', rowId);\r\n        // Update lastSelectedRow to another selected row or null\r\n        this.lastSelectedRow = this.selectedRows.size > 0 ? Array.from(this.selectedRows)[0] : null;\r\n      } else {\r\n        this.selectedRows.add(rowId);\r\n        this.lastSelectedRow = rowId;\r\n        console.log('Ctrl+click: Added', rowId, 'to selection. Total selected:', this.selectedRows.size);\r\n      }\r\n    } else {\r\n      // Normal click: select only this row (clear previous selection)\r\n      console.log('Executing normal click for', rowId);\r\n      this.selectedRows.clear();\r\n      this.selectedRows.add(rowId);\r\n      this.lastSelectedRow = rowId;\r\n      console.log('Normal click: Selected only', rowId);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle range selection with shift+click\r\n   * @param {String} endRowId - End row ID for range selection\r\n   */\r\n  handleRangeSelection(endRowId) {\r\n    const fullData = this.getFullData();\r\n    \r\n    // Find indices in the full dataset\r\n    const startIndex = fullData.findIndex(row => this.getRowId(row) === this.lastSelectedRow);\r\n    const endIndex = fullData.findIndex(row => this.getRowId(row) === endRowId);\r\n\r\n    if (startIndex === -1 || endIndex === -1) {\r\n      // Fallback to single selection if we can't find the range\r\n      this.selectedRows.clear();\r\n      this.selectedRows.add(endRowId);\r\n      this.lastSelectedRow = endRowId;\r\n      return;\r\n    }\r\n\r\n    // Select all rows in range\r\n    const minIndex = Math.min(startIndex, endIndex);\r\n    const maxIndex = Math.max(startIndex, endIndex);\r\n    \r\n    for (let i = minIndex; i <= maxIndex; i++) {\r\n      const rowId = this.getRowId(fullData[i]);\r\n      this.selectedRows.add(rowId);\r\n    }\r\n  }\r\n\r\n  // ===== DRAG SELECTION METHODS =====\r\n\r\n  /**\r\n   * Setup drag selection event listeners\r\n   */\r\n  setupDragSelection() {\r\n    const tableElement = this.table.container;\r\n    if (!tableElement) return;\r\n\r\n    let startX, startY;\r\n\r\n    // Mouse down on table body\r\n    tableElement.addEventListener('mousedown', (e) => {\r\n      if (!this.table || !this.options.enabled || this.options.mode !== 'multi') return;\r\n      \r\n      const row = e.target.closest('.tablix-row');\r\n      if (!row || row.classList.contains('tablix-empty-row')) return;\r\n\r\n      const globalRowIndex = parseInt(row.dataset.rowIndex, 10);\r\n      if (isNaN(globalRowIndex)) return;\r\n\r\n      // Only start drag selection if not using modifier keys\r\n      if (e.ctrlKey || e.metaKey || e.shiftKey) return;\r\n\r\n      startX = e.clientX;\r\n      startY = e.clientY;\r\n\r\n      this.dragSelection.isActive = true;\r\n      this.dragSelection.startRowIndex = globalRowIndex; // Store global index\r\n      this.dragSelection.currentRowIndex = globalRowIndex;\r\n      this.dragSelection.isDragging = false;\r\n      \r\n      // Store original selection for potential restoration\r\n      this.dragSelection.originalSelection = new Set(this.selectedRows);\r\n\r\n      // Get start row data using global index\r\n      const fullData = this.getFullData();\r\n      if (globalRowIndex < fullData.length) {\r\n        this.dragSelection.startRowId = this.getRowId(fullData[globalRowIndex]);\r\n      }\r\n\r\n      e.preventDefault();\r\n    });\r\n\r\n    // Mouse move - handle drag selection\r\n    tableElement.addEventListener('mousemove', (e) => {\r\n      if (!this.table || !this.dragSelection.isActive) return;\r\n\r\n      const deltaX = Math.abs(e.clientX - startX);\r\n      const deltaY = Math.abs(e.clientY - startY);\r\n\r\n      // Check if we've moved enough to consider it a drag\r\n      if (!this.dragSelection.isDragging && \r\n          (deltaX > this.dragSelection.dragThreshold || deltaY > this.dragSelection.dragThreshold)) {\r\n        this.dragSelection.isDragging = true;\r\n        this.startDragSelection();\r\n      }\r\n\r\n      if (this.dragSelection.isDragging) {\r\n        this.updateDragSelection(e);\r\n      }\r\n    });\r\n\r\n    // Mouse up - complete drag selection\r\n    tableElement.addEventListener('mouseup', (e) => {\r\n      if (!this.table || !this.dragSelection.isActive) return;\r\n      this.completeDragSelection();\r\n    });\r\n\r\n    // Mouse leave - cancel drag selection\r\n    tableElement.addEventListener('mouseleave', (e) => {\r\n      if (!this.table || !this.dragSelection.isActive) return;\r\n      this.cancelDragSelection();\r\n    });\r\n\r\n    // Prevent text selection during drag\r\n    tableElement.addEventListener('selectstart', (e) => {\r\n      if (this.dragSelection.isDragging) {\r\n        e.preventDefault();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Start drag selection\r\n   */\r\n  startDragSelection() {\r\n    if (!this.table || !this.table.container) {\r\n      console.warn('SelectionManager: Cannot start drag selection - table not available');\r\n      return;\r\n    }\r\n    \r\n    // Add drag selection class to table for styling\r\n    const tableWrapper = this.table.container.querySelector('.tablix-wrapper');\r\n    if (tableWrapper) {\r\n      tableWrapper.classList.add('tablix-drag-selecting');\r\n    }\r\n\r\n    // Fire beforeSelect event for drag start\r\n    const fullData = this.getFullData();\r\n    if (this.dragSelection.startRowIndex < fullData.length) {\r\n      const startRowData = fullData[this.dragSelection.startRowIndex];\r\n      const beforeSelectEvent = {\r\n        rowData: startRowData,\r\n        rowId: this.dragSelection.startRowId,\r\n        currentSelection: Array.from(this.selectedRows),\r\n        isCtrlClick: false,\r\n        isShiftClick: false,\r\n        isDragSelection: true,\r\n        dragStart: true\r\n      };\r\n      \r\n      this.table.eventManager.trigger('beforeSelect', beforeSelectEvent);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update drag selection based on current mouse position\r\n   */\r\n  updateDragSelection(event) {\r\n    const row = event.target.closest('.tablix-row');\r\n    if (!row || row.classList.contains('tablix-empty-row')) return;\r\n\r\n    const globalRowIndex = parseInt(row.dataset.rowIndex, 10);\r\n    if (isNaN(globalRowIndex)) return;\r\n\r\n    if (globalRowIndex !== this.dragSelection.currentRowIndex) {\r\n      this.dragSelection.currentRowIndex = globalRowIndex;\r\n      this.applyDragSelection();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Apply current drag selection range\r\n   */\r\n  applyDragSelection() {\r\n    // Always use full dataset for drag selection (global indices)\r\n    const fullData = this.getFullData();\r\n    \r\n    // Calculate selection range using global indices\r\n    const startIndex = this.dragSelection.startRowIndex;\r\n    const endIndex = this.dragSelection.currentRowIndex;\r\n    const minIndex = Math.min(startIndex, endIndex);\r\n    const maxIndex = Math.max(startIndex, endIndex);\r\n\r\n    // Start with original selection (preserve existing selections)\r\n    this.selectedRows = new Set(this.dragSelection.originalSelection);\r\n\r\n    // Add drag range to selection\r\n    for (let i = minIndex; i <= maxIndex; i++) {\r\n      if (i < fullData.length) {\r\n        const rowId = this.getRowId(fullData[i]);\r\n        this.selectedRows.add(rowId);\r\n      }\r\n    }\r\n\r\n    // Update last selected row\r\n    if (endIndex < fullData.length) {\r\n      this.lastSelectedRow = this.getRowId(fullData[endIndex]);\r\n    }\r\n\r\n    // Update UI immediately for responsive feedback\r\n    this.updateUI();\r\n  }\r\n\r\n  /**\r\n   * Complete drag selection\r\n   */\r\n  completeDragSelection() {\r\n    if (!this.table || !this.table.container) {\r\n      console.warn('SelectionManager: Cannot complete drag selection - table not available');\r\n      return;\r\n    }\r\n    \r\n    const tableWrapper = this.table.container.querySelector('.tablix-wrapper');\r\n    if (tableWrapper) {\r\n      tableWrapper.classList.remove('tablix-drag-selecting');\r\n    }\r\n\r\n    if (this.dragSelection.isDragging) {\r\n      // Fire final afterSelect event\r\n      const afterSelectEvent = {\r\n        selectedRows: Array.from(this.selectedRows),\r\n        selectedData: this.getSelectedData(),\r\n        isDragSelection: true,\r\n        dragComplete: true\r\n      };\r\n      \r\n      this.table.eventManager.trigger('afterSelect', afterSelectEvent);\r\n    }\r\n\r\n    this.resetDragSelection();\r\n  }\r\n\r\n  /**\r\n   * Cancel drag selection and restore original state\r\n   */\r\n  cancelDragSelection() {\r\n    if (!this.table || !this.table.container) {\r\n      console.warn('SelectionManager: Cannot cancel drag selection - table not available');\r\n      return;\r\n    }\r\n    \r\n    const tableWrapper = this.table.container.querySelector('.tablix-wrapper');\r\n    if (tableWrapper) {\r\n      tableWrapper.classList.remove('tablix-drag-selecting');\r\n    }\r\n\r\n    // Restore original selection\r\n    this.selectedRows = new Set(this.dragSelection.originalSelection);\r\n    this.updateUI();\r\n\r\n    this.resetDragSelection();\r\n  }\r\n\r\n  /**\r\n   * Reset drag selection state\r\n   */\r\n  resetDragSelection() {\r\n    this.dragSelection.isActive = false;\r\n    this.dragSelection.startRowIndex = null;\r\n    this.dragSelection.currentRowIndex = null;\r\n    this.dragSelection.startRowId = null;\r\n    this.dragSelection.originalSelection = null;\r\n    this.dragSelection.isDragging = false;\r\n  }\r\n\r\n  /**\r\n   * Get stable row ID from row data\r\n   * @param {Object} rowData - Row data object\r\n   * @returns {String} Stable row identifier\r\n   */\r\n  getRowId(rowData) {\r\n    if (typeof rowData[this.dataIdKey] !== 'undefined') {\r\n      return String(rowData[this.dataIdKey]);\r\n    }\r\n    \r\n    // Fallback: create a hash of the row data for identification\r\n    return this.createRowHash(rowData);\r\n  }\r\n\r\n  /**\r\n   * Create a simple hash from row data for identification\r\n   * @param {Object} rowData - Row data object\r\n   * @returns {String} Hash string\r\n   */\r\n  createRowHash(rowData) {\r\n    const str = JSON.stringify(rowData);\r\n    let hash = 0;\r\n    for (let i = 0; i < str.length; i++) {\r\n      const char = str.charCodeAt(i);\r\n      hash = ((hash << 5) - hash) + char;\r\n      hash = hash & hash; // Convert to 32-bit integer\r\n    }\r\n    return String(hash);\r\n  }\r\n\r\n  /**\r\n   * Get current page data for range selection\r\n   * @returns {Array} Current page data\r\n   */\r\n  getCurrentPageData() {\r\n    if (!this.table || !this.table.dataManager) {\r\n      console.warn('SelectionManager: Table or dataManager is not available');\r\n      return [];\r\n    }\r\n    \r\n    // If using virtual scrolling, return full dataset\r\n    if (this.table.virtualScrollManager) {\r\n      return this.table.dataManager.getData();\r\n    }\r\n    // Otherwise use pagination if available\r\n    if (this.table.paginationManager) {\r\n      return this.table.paginationManager.getCurrentPageData() || [];\r\n    }\r\n    return this.table.dataManager.getData();\r\n  }\r\n\r\n  /**\r\n   * Get the full dataset for virtual scrolling operations\r\n   * @returns {Array} Full dataset\r\n   */\r\n  getFullData() {\r\n    if (!this.table || !this.table.dataManager) {\r\n      console.warn('SelectionManager: Table or dataManager is not available');\r\n      return [];\r\n    }\r\n    return this.table.dataManager.getData();\r\n  }\r\n\r\n  /**\r\n   * Update UI to reflect current selection\r\n   */\r\n  updateUI() {\r\n    if (!this.options.enabled || !this.table || !this.table.container) {\r\n      return;\r\n    }\r\n\r\n    const tableElement = this.table.container.querySelector('.tablix-table');\r\n    if (!tableElement) {\r\n      return;\r\n    }\r\n\r\n    // Remove existing selection classes\r\n    const allRows = tableElement.querySelectorAll('.tablix-row');\r\n    allRows.forEach(row => {\r\n      row.classList.remove('tablix-selected', 'tablix-last-selected');\r\n    });\r\n\r\n    // Check if we're in virtual scroll mode by looking for data-virtual-index attributes\r\n    const hasVirtualIndexes = allRows.length > 0 && allRows[0].hasAttribute('data-virtual-index');\r\n    \r\n    if (hasVirtualIndexes) {\r\n      // Virtual scrolling mode: use data-virtual-index to match against full dataset\r\n      const fullData = this.getFullData();\r\n      allRows.forEach((row) => {\r\n        const virtualIndex = parseInt(row.getAttribute('data-virtual-index'));\r\n        if (!isNaN(virtualIndex) && virtualIndex < fullData.length) {\r\n          const rowData = fullData[virtualIndex];\r\n          const rowId = this.getRowId(rowData);\r\n          \r\n          if (this.selectedRows.has(rowId)) {\r\n            row.classList.add('tablix-selected');\r\n            \r\n            // Mark the last selected row for special styling\r\n            if (rowId === this.lastSelectedRow) {\r\n              row.classList.add('tablix-last-selected');\r\n            }\r\n          }\r\n        }\r\n      });\r\n    } else {\r\n      // Regular mode: match by global row index with full dataset\r\n      const fullData = this.getFullData();\r\n      allRows.forEach((row) => {\r\n        // Get global row index from data attribute\r\n        const globalRowIndex = row.hasAttribute('data-row-index') ? \r\n          parseInt(row.getAttribute('data-row-index')) : -1;\r\n          \r\n        if (globalRowIndex >= 0 && globalRowIndex < fullData.length) {\r\n          const rowData = fullData[globalRowIndex];\r\n          const rowId = this.getRowId(rowData);\r\n          \r\n          if (this.selectedRows.has(rowId)) {\r\n            row.classList.add('tablix-selected');\r\n            \r\n            // Mark the last selected row for special styling\r\n            if (rowId === this.lastSelectedRow) {\r\n              row.classList.add('tablix-last-selected');\r\n            }\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update selection state after data changes (pagination, filtering, sorting)\r\n   */\r\n  updateSelectionAfterDataChange() {\r\n    if (!this.options.enabled) {\r\n      return;\r\n    }\r\n\r\n    if (this.table.virtualScrollManager) {\r\n      // For virtual scrolling: keep all selections as the data is the same, just rendered differently\r\n      // Only need to update UI\r\n      this.updateUI();\r\n    } else {\r\n      // For pagination: keep all selections, but validate they still exist in the full dataset\r\n      const fullData = this.getFullData();\r\n      const allDataRowIds = new Set(fullData.map(row => this.getRowId(row)));\r\n      \r\n      // Remove selections for rows that no longer exist in the dataset at all\r\n      const newSelection = new Set();\r\n      this.selectedRows.forEach(rowId => {\r\n        if (allDataRowIds.has(rowId)) {\r\n          newSelection.add(rowId);\r\n        }\r\n      });\r\n      \r\n      this.selectedRows = newSelection;\r\n      \r\n      // Update last selected row if it no longer exists in the dataset\r\n      if (this.lastSelectedRow && !allDataRowIds.has(this.lastSelectedRow)) {\r\n        this.lastSelectedRow = this.selectedRows.size > 0 ? Array.from(this.selectedRows)[0] : null;\r\n      }\r\n      \r\n      this.updateUI();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get selected row data\r\n   * @returns {Array} Array of selected row data objects\r\n   */\r\n  getSelectedData() {\r\n    if (!this.options.enabled || this.selectedRows.size === 0) {\r\n      return [];\r\n    }\r\n\r\n    // Get all data (including filtered/sorted) to find selected rows\r\n    const allData = this.getFullData();\r\n    return allData.filter(row => this.selectedRows.has(this.getRowId(row)));\r\n  }\r\n\r\n  /**\r\n   * Get selected row IDs\r\n   * @returns {Array} Array of selected row IDs\r\n   */\r\n  getSelectedIds() {\r\n    return Array.from(this.selectedRows);\r\n  }\r\n\r\n  /**\r\n   * Programmatically select rows by ID\r\n   * @param {String|Array} rowIds - Single row ID or array of row IDs\r\n   */\r\n  selectRows(rowIds) {\r\n    if (!this.options.enabled) {\r\n      return;\r\n    }\r\n\r\n    const ids = Array.isArray(rowIds) ? rowIds : [rowIds];\r\n    \r\n    if (this.options.mode === 'single' && ids.length > 1) {\r\n      console.warn('SelectionManager: Cannot select multiple rows in single mode');\r\n      return;\r\n    }\r\n\r\n    if (this.options.mode === 'single') {\r\n      this.selectedRows.clear();\r\n    }\r\n\r\n    ids.forEach(id => {\r\n      this.selectedRows.add(String(id));\r\n    });\r\n\r\n    if (ids.length > 0) {\r\n      this.lastSelectedRow = String(ids[ids.length - 1]);\r\n    }\r\n\r\n    this.updateUI();\r\n    \r\n    // Fire afterSelect event\r\n    this.table.eventManager.trigger('afterSelect', {\r\n      selectedRows: Array.from(this.selectedRows),\r\n      selectedData: this.getSelectedData()\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Programmatically deselect rows by ID\r\n   * @param {String|Array} rowIds - Single row ID or array of row IDs\r\n   */\r\n  deselectRows(rowIds) {\r\n    if (!this.options.enabled) {\r\n      return;\r\n    }\r\n\r\n    const ids = Array.isArray(rowIds) ? rowIds : [rowIds];\r\n    \r\n    ids.forEach(id => {\r\n      this.selectedRows.delete(String(id));\r\n    });\r\n\r\n    // Update last selected row if it was deselected\r\n    if (ids.includes(this.lastSelectedRow)) {\r\n      this.lastSelectedRow = this.selectedRows.size > 0 ? Array.from(this.selectedRows)[0] : null;\r\n    }\r\n\r\n    this.updateUI();\r\n    \r\n    // Fire afterSelect event\r\n    this.table.eventManager.trigger('afterSelect', {\r\n      selectedRows: Array.from(this.selectedRows),\r\n      selectedData: this.getSelectedData()\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Clear all selections\r\n   */\r\n  clearSelection() {\r\n    if (!this.options.enabled) {\r\n      return;\r\n    }\r\n\r\n    const hadSelection = this.selectedRows.size > 0;\r\n    this.selectedRows.clear();\r\n    this.lastSelectedRow = null;\r\n    \r\n    this.updateUI();\r\n\r\n    if (hadSelection) {\r\n      // Fire afterSelect event\r\n      this.table.eventManager.trigger('afterSelect', {\r\n        selectedRows: [],\r\n        selectedData: []\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if a row is selected\r\n   * @param {String} rowId - Row ID to check\r\n   * @returns {Boolean} True if row is selected\r\n   */\r\n  isRowSelected(rowId) {\r\n    return this.selectedRows.has(String(rowId));\r\n  }\r\n\r\n  /**\r\n   * Check if a row is selected by its data object (for virtual scrolling)\r\n   * @param {Object} rowData - Row data object to check\r\n   * @returns {Boolean} True if row is selected\r\n   */\r\n  isRowSelectedByData(rowData) {\r\n    const rowId = this.getRowId(rowData);\r\n    return this.selectedRows.has(String(rowId));\r\n  }\r\n\r\n  /**\r\n   * Get selection count\r\n   * @returns {Number} Number of selected rows\r\n   */\r\n  getSelectionCount() {\r\n    return this.selectedRows.size;\r\n  }\r\n\r\n  /**\r\n   * Enable selection\r\n   */\r\n  enable() {\r\n    this.options.enabled = true;\r\n    if (!this.eventListenersSetup) {\r\n      this.setupEventListeners();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Disable selection\r\n   */\r\n  disable() {\r\n    this.options.enabled = false;\r\n    this.clearSelection();\r\n  }\r\n\r\n  /**\r\n   * Set selection mode\r\n   * @param {String} mode - 'single' or 'multi'\r\n   */\r\n  setMode(mode) {\r\n    if (mode !== 'single' && mode !== 'multi') {\r\n      console.warn('SelectionManager: Invalid mode. Use \"single\" or \"multi\"');\r\n      return;\r\n    }\r\n\r\n    const oldMode = this.options.mode;\r\n    this.options.mode = mode;\r\n    \r\n    // If switching to single mode and multiple rows are selected, keep only the last selected\r\n    if (mode === 'single' && this.selectedRows.size > 1) {\r\n      const lastSelected = this.lastSelectedRow;\r\n      this.selectedRows.clear();\r\n      if (lastSelected) {\r\n        this.selectedRows.add(lastSelected);\r\n      }\r\n      this.updateUI();\r\n    }\r\n\r\n    // Setup or remove drag selection based on mode change\r\n    if (oldMode !== mode && this.options.enabled) {\r\n      if (mode === 'multi') {\r\n        this.setupDragSelection();\r\n      }\r\n      // Note: We don't need to explicitly remove drag listeners as they check mode internally\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Destroy the selection manager\r\n   */\r\n  destroy() {\r\n    this.clearSelection();\r\n    \r\n    // Clear references to prevent memory leaks and null reference errors\r\n    this.table = null;\r\n    this.selectedRows.clear();\r\n    this.rowIdMap.clear();\r\n    this.lastSelectedRow = null;\r\n    \r\n    // Reset drag selection state\r\n    this.dragSelection.isActive = false;\r\n    this.dragSelection.isDragging = false;\r\n    this.dragSelection.startRowIndex = null;\r\n    this.dragSelection.currentRowIndex = null;\r\n    this.dragSelection.startRowId = null;\r\n    this.dragSelection.originalSelection = null;\r\n  }\r\n}\r\n","/**\r\n * VirtualScrollManager - High-performance virtual scrolling for large datasets\r\n * \r\n * Features:\r\n * - Dynamic row height detection\r\n * - Configurable buffer zones\r\n * - Smooth scrolling with no visual gaps\r\n * - Selection state preservation\r\n * - Performance optimizations for 100k+ rows\r\n */\r\nexport default class VirtualScrollManager {\r\n  constructor(table, options = {}) {\r\n    this.table = table;\r\n    this.options = {\r\n      enabled: false,\r\n      buffer: 10, // Number of rows to render above/below viewport\r\n      rowHeight: null, // Auto-detected if null\r\n      throttleDelay: 8, // Reduced from 16ms for better responsiveness (~120fps)\r\n      ...options\r\n    };\r\n\r\n    // State tracking\r\n    this.scrollContainer = null;\r\n    this.tableBody = null;\r\n    this.topSpacer = null;\r\n    this.bottomSpacer = null;\r\n    \r\n    // Measurements\r\n    this.rowHeight = this.options.rowHeight || 35; // Default fallback\r\n    this.containerHeight = 0;\r\n    this.totalRows = 0;\r\n    this.visibleStart = 0;\r\n    this.visibleEnd = 0;\r\n    this.renderedStart = 0;\r\n    this.renderedEnd = 0;\r\n    \r\n    // Performance tracking\r\n    this.performanceData = {\r\n      renderTimes: [],\r\n      scrollUpdates: 0,\r\n      lastMeasurement: 0\r\n    };\r\n\r\n    // Throttled scroll handler\r\n    this.throttledScrollHandler = this.throttle(this.handleScroll.bind(this), this.options.throttleDelay);\r\n    this.immediateScrollHandler = this.handleScroll.bind(this);\r\n    \r\n    // RAF-based update handler for smooth rendering\r\n    this.updateScheduled = false;\r\n    this.pendingUpdate = false;\r\n    this.lastScrollTime = 0;\r\n    this.scrollVelocity = 0;\r\n\r\n    // Data reference\r\n    this.data = [];\r\n    this.renderedData = [];\r\n  }\r\n\r\n  /**\r\n   * Initialize virtual scrolling\r\n   */\r\n  init(data = []) {\r\n    if (!this.options.enabled) {\r\n      return;\r\n    }\r\n\r\n    this.data = data;\r\n    this.totalRows = data.length;\r\n    \r\n    this.setupScrollContainer();\r\n    this.detectRowHeight();\r\n    this.calculateViewport();\r\n    this.scheduleUpdate();\r\n    \r\n    // Bind scroll events with both throttled and immediate handling\r\n    this.scrollContainer.addEventListener('scroll', this.handleScrollImmediate.bind(this), { passive: true });\r\n    this.scrollContainer.addEventListener('scroll', this.throttledScrollHandler, { passive: true });\r\n    \r\n    // Handle scrollbar dragging specifically\r\n    this.scrollContainer.addEventListener('mousedown', this.handleScrollStart.bind(this));\r\n    document.addEventListener('mouseup', this.handleScrollEnd.bind(this));\r\n    \r\n    // Handle window resize\r\n    window.addEventListener('resize', this.throttle(this.handleResize.bind(this), 100));\r\n    \r\n    // Set up event delegation for row interactions\r\n    this.setupEventDelegation();\r\n    \r\n    // Listen for selection changes\r\n    this.setupSelectionListeners();\r\n    \r\n    this.log('Virtual scroll initialized', {\r\n      totalRows: this.totalRows,\r\n      rowHeight: this.rowHeight,\r\n      buffer: this.options.buffer\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Set up event delegation for dynamically rendered rows\r\n   */\r\n  setupEventDelegation() {\r\n    if (!this.scrollContainer || !this.table.eventManager) return;\r\n\r\n    // Delegate row click events\r\n    this.rowClickHandler = (event) => {\r\n      const row = event.target.closest('.tablix-row');\r\n      if (!row) return;\r\n\r\n      // Skip click handling if we just finished a drag\r\n      if (this.justFinishedDrag) {\r\n        console.log('Skipping click - just finished drag');\r\n        return;\r\n      }\r\n\r\n      const virtualIndex = parseInt(row.getAttribute('data-virtual-index'));\r\n      const rowData = this.data[virtualIndex];\r\n      \r\n      if (rowData) {\r\n        console.log('VirtualScroll rowClickHandler triggered:', { \r\n          virtualIndex, \r\n          rowId: rowData.id,\r\n          ctrlKey: event.ctrlKey,\r\n          shiftKey: event.shiftKey,\r\n          metaKey: event.metaKey,\r\n          eventType: event.type,\r\n          timestamp: Date.now()\r\n        });\r\n        \r\n        // Trigger row click event for selection manager\r\n        this.table.eventManager.trigger('rowClick', {\r\n          rowData,\r\n          rowIndex: virtualIndex, // Use virtual index as row index\r\n          originalEvent: event,\r\n          element: row\r\n        });\r\n        \r\n        // Immediately update selection states after click\r\n        setTimeout(() => this.updateSelectionStates(), 0);\r\n      }\r\n    };\r\n\r\n    this.scrollContainer.addEventListener('click', this.rowClickHandler);\r\n\r\n    // Set up drag selection for virtual scrolling (if selection is enabled and in multi mode)\r\n    if (this.table.selectionManager && \r\n        this.table.selectionManager.options.enabled && \r\n        this.table.selectionManager.options.mode === 'multi') {\r\n      this.setupVirtualDragSelection();\r\n    }\r\n\r\n    // Delegate row hover events\r\n    this.rowHoverHandler = (event) => {\r\n      const row = event.target.closest('.tablix-row');\r\n      if (!row) return;\r\n\r\n      const virtualIndex = parseInt(row.getAttribute('data-virtual-index'));\r\n      const rowData = this.data[virtualIndex];\r\n      \r\n      if (rowData) {\r\n        this.table.eventManager.trigger('rowHover', {\r\n          rowData,\r\n          rowIndex: virtualIndex,\r\n          originalEvent: event,\r\n          element: row\r\n        });\r\n      }\r\n    };\r\n\r\n    this.scrollContainer.addEventListener('mouseover', this.rowHoverHandler);\r\n  }\r\n\r\n  /**\r\n   * Set up listeners for selection changes\r\n   */\r\n  setupSelectionListeners() {\r\n    if (!this.table.eventManager) return;\r\n\r\n    // Listen for selection changes to update row visual states\r\n    this.table.eventManager.on('afterSelect', () => {\r\n      this.updateSelectionStates();\r\n    });\r\n\r\n    this.table.eventManager.on('selectionCleared', () => {\r\n      this.updateSelectionStates();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Setup the scroll container structure\r\n   */\r\n  setupScrollContainer() {\r\n    const tableWrapper = this.table.container.querySelector('.tablix-wrapper');\r\n    if (!tableWrapper) {\r\n      throw new Error('Table wrapper not found for virtual scrolling');\r\n    }\r\n\r\n    // Find existing scroll container\r\n    let scrollContainer = tableWrapper.querySelector('.tablix-scroll-container');\r\n    if (!scrollContainer) {\r\n      // Create scroll container - it should already exist from renderer\r\n      scrollContainer = tableWrapper.querySelector('.tablix-scroll-container');\r\n      if (!scrollContainer) {\r\n        console.warn('Scroll container not found - virtual scrolling may not work properly');\r\n        return;\r\n      }\r\n    }\r\n\r\n    this.scrollContainer = scrollContainer;\r\n    this.tableBody = scrollContainer.querySelector('.tablix-tbody');\r\n    \r\n    // Create spacer elements for maintaining scroll height\r\n    this.createSpacers();\r\n  }\r\n\r\n  /**\r\n   * Create top and bottom spacer elements\r\n   */\r\n  createSpacers() {\r\n    if (!this.tableBody) return;\r\n\r\n    // Remove existing spacers\r\n    const existingTop = this.tableBody.querySelector('.tablix-top-spacer');\r\n    const existingBottom = this.tableBody.querySelector('.tablix-bottom-spacer');\r\n    if (existingTop) existingTop.remove();\r\n    if (existingBottom) existingBottom.remove();\r\n\r\n    // Create new spacers\r\n    this.topSpacer = document.createElement('tr');\r\n    this.topSpacer.className = 'tablix-top-spacer';\r\n    this.topSpacer.style.cssText = 'height: 0px; border: none;';\r\n    this.topSpacer.innerHTML = `<td colspan=\"100\" style=\"padding: 0; border: none; height: 0;\"></td>`;\r\n\r\n    this.bottomSpacer = document.createElement('tr');\r\n    this.bottomSpacer.className = 'tablix-bottom-spacer';\r\n    this.bottomSpacer.style.cssText = 'height: 0px; border: none;';\r\n    this.bottomSpacer.innerHTML = `<td colspan=\"100\" style=\"padding: 0; border: none; height: 0;\"></td>`;\r\n\r\n    this.tableBody.insertBefore(this.topSpacer, this.tableBody.firstChild);\r\n    this.tableBody.appendChild(this.bottomSpacer);\r\n  }\r\n\r\n  /**\r\n   * Detect row height dynamically by measuring a sample row\r\n   */\r\n  detectRowHeight() {\r\n    if (this.options.rowHeight) {\r\n      this.rowHeight = this.options.rowHeight;\r\n      return;\r\n    }\r\n\r\n    if (!this.tableBody || this.data.length === 0) {\r\n      return;\r\n    }\r\n\r\n    // Render a single sample row to measure height\r\n    const sampleRow = this.renderSingleRow(this.data[0], 0);\r\n    this.tableBody.appendChild(sampleRow);\r\n    \r\n    // Measure the row height\r\n    const rect = sampleRow.getBoundingClientRect();\r\n    this.rowHeight = Math.max(rect.height, 25); // Minimum height of 25px\r\n    \r\n    // Remove sample row\r\n    sampleRow.remove();\r\n    \r\n    this.log('Row height detected', { rowHeight: this.rowHeight });\r\n  }\r\n\r\n  /**\r\n   * Calculate viewport dimensions and visible range\r\n   */\r\n  calculateViewport() {\r\n    if (!this.scrollContainer) return;\r\n\r\n    const rect = this.scrollContainer.getBoundingClientRect();\r\n    this.containerHeight = rect.height;\r\n    \r\n    const scrollTop = this.scrollContainer.scrollTop;\r\n    const visibleRowCount = Math.ceil(this.containerHeight / this.rowHeight);\r\n    \r\n    // Calculate visible range\r\n    this.visibleStart = Math.floor(scrollTop / this.rowHeight);\r\n    this.visibleEnd = Math.min(this.visibleStart + visibleRowCount, this.totalRows);\r\n    \r\n    // Calculate rendered range with buffer\r\n    this.renderedStart = Math.max(0, this.visibleStart - this.options.buffer);\r\n    this.renderedEnd = Math.min(this.totalRows, this.visibleEnd + this.options.buffer);\r\n    \r\n    // Update spacer heights\r\n    this.updateSpacers();\r\n  }\r\n\r\n  /**\r\n   * Update spacer heights to maintain scroll position\r\n   */\r\n  updateSpacers() {\r\n    if (!this.topSpacer || !this.bottomSpacer) return;\r\n\r\n    const topHeight = this.renderedStart * this.rowHeight;\r\n    const bottomHeight = (this.totalRows - this.renderedEnd) * this.rowHeight;\r\n    \r\n    this.topSpacer.style.height = `${topHeight}px`;\r\n    this.bottomSpacer.style.height = `${bottomHeight}px`;\r\n  }\r\n\r\n  /**\r\n   * Handle immediate scroll events (for fast scrolling detection)\r\n   */\r\n  handleScrollImmediate() {\r\n    const now = performance.now();\r\n    const scrollTop = this.scrollContainer.scrollTop;\r\n    \r\n    // Calculate scroll velocity\r\n    if (this.lastScrollTime && this.lastScrollTop !== undefined) {\r\n      const timeDelta = now - this.lastScrollTime;\r\n      const scrollDelta = Math.abs(scrollTop - this.lastScrollTop);\r\n      this.scrollVelocity = timeDelta > 0 ? scrollDelta / timeDelta : 0;\r\n    }\r\n    \r\n    this.lastScrollTime = now;\r\n    this.lastScrollTop = scrollTop;\r\n    \r\n    // For very fast scrolling, schedule immediate update\r\n    if (this.scrollVelocity > 2) { // High velocity threshold\r\n      this.scheduleUpdate();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle scroll start (mousedown on scrollbar)\r\n   */\r\n  handleScrollStart(event) {\r\n    // Only trigger scrollbar dragging for actual scrollbar clicks\r\n    // Check if the click was on the scrollbar area, not on table content\r\n    const target = event.target;\r\n    if (target.closest('.tablix-row') || target.closest('.tablix-table')) {\r\n      // This is a click on table content, not scrollbar - ignore\r\n      return;\r\n    }\r\n    \r\n    this.isScrollbarDragging = true;\r\n    \r\n    // Schedule more frequent updates during scrollbar dragging\r\n    this.scrollDragInterval = setInterval(() => {\r\n      if (this.isScrollbarDragging) {\r\n        this.scheduleUpdate();\r\n      }\r\n    }, 8); // ~120fps during dragging\r\n  }\r\n\r\n  /**\r\n   * Handle scroll end (mouseup)\r\n   */\r\n  handleScrollEnd() {\r\n    this.isScrollbarDragging = false;\r\n    if (this.scrollDragInterval) {\r\n      clearInterval(this.scrollDragInterval);\r\n      this.scrollDragInterval = null;\r\n    }\r\n    // Final update to ensure everything is rendered\r\n    this.scheduleUpdate();\r\n  }\r\n\r\n  /**\r\n   * Setup drag selection for virtual scrolling\r\n   */\r\n  setupVirtualDragSelection() {\r\n    let isDragSelecting = false;\r\n    let dragStartIndex = null;\r\n    let dragStartX = null;\r\n    let dragStartY = null;\r\n    let originalSelection = null;\r\n    const dragThreshold = 3;\r\n\r\n    // Flag to prevent click handling immediately after drag\r\n    this.justFinishedDrag = false;\r\n\r\n    // Mouse down to potentially start drag selection\r\n    this.scrollContainer.addEventListener('mousedown', (event) => {\r\n      // Skip if clicked on scrollbar area or using modifier keys\r\n      if (event.ctrlKey || event.metaKey || event.shiftKey) return;\r\n      \r\n      const row = event.target.closest('.tablix-row');\r\n      if (!row || row.classList.contains('tablix-empty-row')) return;\r\n\r\n      const virtualIndex = parseInt(row.getAttribute('data-virtual-index'));\r\n      if (isNaN(virtualIndex)) return;\r\n\r\n      dragStartIndex = virtualIndex;\r\n      dragStartX = event.clientX;\r\n      dragStartY = event.clientY;\r\n      isDragSelecting = false;\r\n      \r\n      // Store original selection\r\n      originalSelection = new Set(this.table.selectionManager.selectedRows);\r\n\r\n      // Don't prevent default here - let the click event fire normally\r\n      // event.preventDefault();\r\n    });\r\n\r\n    // Mouse move to handle drag selection\r\n    this.scrollContainer.addEventListener('mousemove', (event) => {\r\n      if (dragStartIndex === null) return;\r\n\r\n      const deltaX = Math.abs(event.clientX - dragStartX);\r\n      const deltaY = Math.abs(event.clientY - dragStartY);\r\n\r\n      // Start dragging if moved enough\r\n      if (!isDragSelecting && (deltaX > dragThreshold || deltaY > dragThreshold)) {\r\n        isDragSelecting = true;\r\n        this.scrollContainer.classList.add('tablix-drag-selecting');\r\n      }\r\n\r\n      if (isDragSelecting) {\r\n        const row = event.target.closest('.tablix-row');\r\n        if (row) {\r\n          const currentIndex = parseInt(row.getAttribute('data-virtual-index'));\r\n          if (!isNaN(currentIndex)) {\r\n            this.applyVirtualDragSelection(dragStartIndex, currentIndex, originalSelection);\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    // Mouse up to complete or cancel drag selection\r\n    const handleMouseUp = (event) => {\r\n      if (dragStartIndex !== null) {\r\n        this.scrollContainer.classList.remove('tablix-drag-selecting');\r\n        \r\n        if (!isDragSelecting) {\r\n          // This was just a click, not a drag - don't interfere with click handling\r\n          // Reset drag state and let the normal click handler process this\r\n          dragStartIndex = null;\r\n          isDragSelecting = false;\r\n          originalSelection = null;\r\n          return;\r\n        }\r\n\r\n        // This was actually a drag selection - complete it\r\n        this.table.eventManager.trigger('afterSelect', {\r\n          selectedRows: Array.from(this.table.selectionManager.selectedRows),\r\n          selectedData: this.table.selectionManager.getSelectedData(),\r\n          isDragSelection: true,\r\n          dragComplete: true\r\n        });\r\n\r\n        // Set flag to prevent immediate click handling\r\n        this.justFinishedDrag = true;\r\n        setTimeout(() => {\r\n          this.justFinishedDrag = false;\r\n        }, 50);\r\n\r\n        // Reset drag state\r\n        dragStartIndex = null;\r\n        isDragSelecting = false;\r\n        originalSelection = null;\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mouseup', handleMouseUp);\r\n    this.scrollContainer.addEventListener('mouseleave', handleMouseUp);\r\n\r\n    // Prevent text selection during drag\r\n    this.scrollContainer.addEventListener('selectstart', (event) => {\r\n      if (isDragSelecting) {\r\n        event.preventDefault();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Apply drag selection in virtual scrolling\r\n   */\r\n  applyVirtualDragSelection(startIndex, endIndex, originalSelection) {\r\n    const minIndex = Math.min(startIndex, endIndex);\r\n    const maxIndex = Math.max(startIndex, endIndex);\r\n\r\n    // Start with original selection\r\n    this.table.selectionManager.selectedRows = new Set(originalSelection);\r\n\r\n    // Add drag range to selection\r\n    for (let i = minIndex; i <= maxIndex; i++) {\r\n      if (i < this.data.length) {\r\n        const rowData = this.data[i];\r\n        const rowId = this.table.selectionManager.getRowId(rowData);\r\n        this.table.selectionManager.selectedRows.add(rowId);\r\n      }\r\n    }\r\n\r\n    // Update last selected row\r\n    if (endIndex < this.data.length) {\r\n      const endRowData = this.data[endIndex];\r\n      this.table.selectionManager.lastSelectedRow = this.table.selectionManager.getRowId(endRowData);\r\n    }\r\n\r\n    // Update UI immediately\r\n    this.table.selectionManager.updateUI();\r\n  }\r\n\r\n  /**\r\n   * Handle scroll events\r\n   */\r\n  handleScroll() {\r\n    if (!this.options.enabled || this.updateScheduled) return;\r\n\r\n    this.scheduleUpdate();\r\n  }\r\n\r\n  /**\r\n   * Handle window resize\r\n   */\r\n  handleResize() {\r\n    if (!this.options.enabled) return;\r\n\r\n    this.calculateViewport();\r\n    this.scheduleUpdate();\r\n  }\r\n\r\n  /**\r\n   * Schedule an update using requestAnimationFrame\r\n   */\r\n  scheduleUpdate() {\r\n    if (this.updateScheduled) return;\r\n\r\n    this.updateScheduled = true;\r\n    requestAnimationFrame(() => {\r\n      this.update();\r\n      this.updateScheduled = false;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Main update method - calculates viewport and renders visible rows\r\n   */\r\n  update() {\r\n    const startTime = performance.now();\r\n    \r\n    this.calculateViewport();\r\n    this.renderVisibleRows();\r\n    \r\n    const endTime = performance.now();\r\n    this.trackPerformance(endTime - startTime);\r\n    \r\n    this.performanceData.scrollUpdates++;\r\n  }\r\n\r\n  /**\r\n   * Render only the visible rows plus buffer\r\n   */\r\n  renderVisibleRows() {\r\n    if (!this.tableBody) return;\r\n\r\n    // Clear existing rows (except spacers)\r\n    const existingRows = this.tableBody.querySelectorAll('.tablix-row');\r\n    existingRows.forEach(row => row.remove());\r\n\r\n    // Render new rows\r\n    const fragment = document.createDocumentFragment();\r\n    \r\n    for (let i = this.renderedStart; i < this.renderedEnd; i++) {\r\n      if (i < this.data.length) {\r\n        const row = this.renderSingleRow(this.data[i], i);\r\n        fragment.appendChild(row);\r\n      }\r\n    }\r\n\r\n    // Insert rows between spacers\r\n    this.tableBody.insertBefore(fragment, this.bottomSpacer);\r\n\r\n    // Store currently rendered data slice for other managers\r\n    this.renderedData = this.data.slice(this.renderedStart, this.renderedEnd);\r\n    \r\n    // Handle image loading for the newly rendered rows\r\n    this.handleImageLoading();\r\n    \r\n    // Update selection states for the newly rendered rows\r\n    this.updateSelectionStates();\r\n  }\r\n\r\n  /**\r\n   * Update selection states for currently rendered rows\r\n   */\r\n  updateSelectionStates() {\r\n    if (!this.table.selectionManager || !this.tableBody) return;\r\n\r\n    const rows = this.tableBody.querySelectorAll('.tablix-row');\r\n    rows.forEach(row => {\r\n      const virtualIndex = parseInt(row.getAttribute('data-virtual-index'));\r\n      const rowData = this.data[virtualIndex];\r\n      \r\n      if (rowData && this.table.selectionManager.isRowSelectedByData(rowData)) {\r\n        row.classList.add('tablix-selected');\r\n      } else {\r\n        row.classList.remove('tablix-selected');\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Handle image loading optimization\r\n   */\r\n  handleImageLoading() {\r\n    if (!this.tableBody) return;\r\n\r\n    // Find all images in the rendered rows\r\n    const images = this.tableBody.querySelectorAll('.tablix-row img');\r\n    \r\n    images.forEach((img, index) => {\r\n      // Skip if image is already loaded or loading\r\n      if (img.complete || img.classList.contains('loading')) return;\r\n      \r\n      img.classList.add('loading');\r\n      \r\n      // Create a placeholder while loading\r\n      const placeholder = img.cloneNode();\r\n      placeholder.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSIjZjBmMGYwIi8+CjxwYXRoIGQ9Ik0xNiA4TDIwIDEySDEyTDE2IDhaIiBmaWxsPSIjY2NjY2NjIi8+CjxwYXRoIGQ9Ik04IDIwSDI0VjE2SDhWMjBaIiBmaWxsPSIjY2NjY2NjIi8+Cjwvc3ZnPgo=';\r\n      placeholder.classList.add('image-placeholder');\r\n      \r\n      // Handle successful load\r\n      const handleLoad = () => {\r\n        img.classList.remove('loading');\r\n        img.style.opacity = '1';\r\n        img.removeEventListener('load', handleLoad);\r\n        img.removeEventListener('error', handleError);\r\n      };\r\n      \r\n      // Handle load error\r\n      const handleError = () => {\r\n        img.classList.remove('loading');\r\n        img.src = placeholder.src; // Use placeholder as fallback\r\n        img.removeEventListener('load', handleLoad);\r\n        img.removeEventListener('error', handleError);\r\n      };\r\n      \r\n      img.addEventListener('load', handleLoad);\r\n      img.addEventListener('error', handleError);\r\n      \r\n      // Set initial opacity for fade-in effect\r\n      img.style.opacity = '0.5';\r\n      img.style.transition = 'opacity 0.2s ease';\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Render a single row element\r\n   */\r\n  renderSingleRow(rowData, originalIndex) {\r\n    const columns = this.table.columnManager ? \r\n      this.table.columnManager.getColumns() : \r\n      (this.table.options.columns || []);\r\n\r\n    const tr = document.createElement('tr');\r\n    tr.className = 'tablix-row';\r\n    tr.setAttribute('data-row-index', originalIndex); // Keep for compatibility\r\n    tr.setAttribute('data-virtual-index', originalIndex); // Virtual scroll index\r\n    \r\n    // Add a unique identifier for debugging\r\n    tr.setAttribute('data-row-id', this.table.selectionManager ? \r\n      this.table.selectionManager.getRowId(rowData) : originalIndex);\r\n\r\n    // Apply initial selection state\r\n    const isSelected = this.table.selectionManager && \r\n      this.table.selectionManager.isRowSelectedByData(rowData);\r\n    \r\n    if (isSelected) {\r\n      tr.classList.add('tablix-selected');\r\n      console.log('Row initially selected:', originalIndex, rowData.id);\r\n    }\r\n\r\n    // Render cells\r\n    columns.forEach(col => {\r\n      const td = document.createElement('td');\r\n      td.className = 'tablix-td';\r\n      \r\n      const cellValue = rowData[col.name];\r\n\r\n      // Use ColumnManager for formatting if available\r\n      if (this.table.columnManager) {\r\n        // Pass the column object instead of just the name to support multiple columns with same field\r\n        const result = this.table.columnManager.formatCellValue(col, cellValue, rowData);\r\n        if (result.isHtml) {\r\n          td.innerHTML = result.value;\r\n        } else {\r\n          td.textContent = result.value;\r\n        }\r\n      } else {\r\n        // Fallback to original renderer logic\r\n        if (col.renderer && typeof col.renderer === 'function') {\r\n          const rendered = col.renderer(cellValue, rowData);\r\n          if (typeof rendered === 'string' && rendered.includes('<')) {\r\n            td.innerHTML = rendered;\r\n          } else {\r\n            td.textContent = rendered;\r\n          }\r\n        } else {\r\n          td.textContent = cellValue != null ? String(cellValue) : '';\r\n        }\r\n      }\r\n\r\n      tr.appendChild(td);\r\n    });\r\n\r\n    return tr;\r\n  }\r\n\r\n  /**\r\n   * Update data and refresh virtual scrolling\r\n   */\r\n  updateData(newData) {\r\n    this.data = newData;\r\n    this.totalRows = newData.length;\r\n    \r\n    if (this.options.enabled) {\r\n      this.calculateViewport();\r\n      this.scheduleUpdate();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Scroll to a specific row index\r\n   */\r\n  scrollToRow(index) {\r\n    if (!this.scrollContainer || !this.options.enabled) return;\r\n\r\n    const targetScrollTop = index * this.rowHeight;\r\n    this.scrollContainer.scrollTop = targetScrollTop;\r\n    \r\n    // Force immediate update\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * Get the currently visible row indices\r\n   */\r\n  getVisibleRange() {\r\n    return {\r\n      start: this.visibleStart,\r\n      end: this.visibleEnd,\r\n      renderedStart: this.renderedStart,\r\n      renderedEnd: this.renderedEnd\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get the currently rendered data slice\r\n   */\r\n  getRenderedData() {\r\n    return this.renderedData;\r\n  }\r\n\r\n  /**\r\n   * Check if virtual scrolling is active\r\n   */\r\n  isEnabled() {\r\n    return this.options.enabled;\r\n  }\r\n\r\n  /**\r\n   * Enable/disable virtual scrolling\r\n   */\r\n  setEnabled(enabled) {\r\n    this.options.enabled = enabled;\r\n    \r\n    if (enabled && this.data.length > 0) {\r\n      this.init(this.data);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Track performance metrics\r\n   */\r\n  trackPerformance(renderTime) {\r\n    this.performanceData.renderTimes.push(renderTime);\r\n    this.performanceData.lastMeasurement = renderTime;\r\n\r\n    // Keep only last 100 measurements\r\n    if (this.performanceData.renderTimes.length > 100) {\r\n      this.performanceData.renderTimes.shift();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get performance statistics\r\n   */\r\n  getPerformanceStats() {\r\n    const times = this.performanceData.renderTimes;\r\n    if (times.length === 0) return null;\r\n\r\n    const avg = times.reduce((a, b) => a + b, 0) / times.length;\r\n    const max = Math.max(...times);\r\n    const min = Math.min(...times);\r\n\r\n    return {\r\n      averageRenderTime: avg.toFixed(2),\r\n      maxRenderTime: max.toFixed(2),\r\n      minRenderTime: min.toFixed(2),\r\n      scrollUpdates: this.performanceData.scrollUpdates,\r\n      totalRows: this.totalRows,\r\n      visibleRows: this.visibleEnd - this.visibleStart,\r\n      renderedRows: this.renderedEnd - this.renderedStart\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Utility: Throttle function\r\n   */\r\n  throttle(func, limit) {\r\n    let inThrottle;\r\n    return function() {\r\n      const args = arguments;\r\n      const context = this;\r\n      if (!inThrottle) {\r\n        func.apply(context, args);\r\n        inThrottle = true;\r\n        setTimeout(() => inThrottle = false, limit);\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Utility: Logging for performance tracking\r\n   */\r\n  log(message, data = {}) {\r\n    if (this.table.options.debug) {\r\n      console.log(`[VirtualScroll] ${message}`, data);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clean up event listeners and resources\r\n   */\r\n  destroy() {\r\n    if (this.scrollContainer) {\r\n      this.scrollContainer.removeEventListener('scroll', this.throttledScrollHandler);\r\n      this.scrollContainer.removeEventListener('scroll', this.handleScrollImmediate);\r\n      this.scrollContainer.removeEventListener('mousedown', this.handleScrollStart);\r\n    }\r\n    document.removeEventListener('mouseup', this.handleScrollEnd);\r\n    window.removeEventListener('resize', this.handleResize);\r\n    \r\n    // Clean up scroll drag interval\r\n    if (this.scrollDragInterval) {\r\n      clearInterval(this.scrollDragInterval);\r\n      this.scrollDragInterval = null;\r\n    }\r\n    \r\n    this.scrollContainer = null;\r\n    this.tableBody = null;\r\n    this.topSpacer = null;\r\n    this.bottomSpacer = null;\r\n  }\r\n}\r\n","/**\r\n * TablixJS Localization Module\r\n * Provides internationalization support for the table library\r\n */\r\n\r\nexport default class Localization {\r\n  constructor() {\r\n    this.currentLanguage = 'en';\r\n    this.translations = new Map();\r\n    this.fallbackLanguage = 'en';\r\n    \r\n    // Initialize with English defaults\r\n    this.addTranslations('en', this.getDefaultEnglishTranslations());\r\n  }\r\n\r\n  /**\r\n   * Get default English translations (fallback language pack)\r\n   * @returns {Object} English translations object\r\n   */\r\n  getDefaultEnglishTranslations() {\r\n    return {\r\n      // General\r\n      'general.loading': 'Loading...',\r\n      'general.error': 'Error',\r\n      'general.noData': 'No data available',\r\n      'general.show': 'Show',\r\n      'general.entries': 'entries',\r\n      'general.of': 'of',\r\n      'general.to': 'to',\r\n      'general.records': 'records',\r\n      'general.perPage': 'per page',\r\n      'general.showing': 'Showing',\r\n      'general.total': 'Total',\r\n      'general.rows': 'rows',\r\n\r\n      // Search\r\n      'search.placeholder': 'Search...',\r\n      'search.clear': 'Clear search',\r\n      'search.noResults': 'No results found',\r\n      'search.resultsFound': 'results found',\r\n\r\n      // Pagination\r\n      'pagination.first': 'First',\r\n      'pagination.previous': 'Previous',\r\n      'pagination.next': 'Next',\r\n      'pagination.last': 'Last',\r\n      'pagination.page': 'Page',\r\n      'pagination.pageOf': 'Page {currentPage} of {totalPages}',\r\n      'pagination.showingRecords': 'Showing {startRow}-{endRow} of {totalRows} records',\r\n      'pagination.noRecords': 'No records found',\r\n      'pagination.pageSize': 'Records per page',\r\n\r\n      // Sorting\r\n      'sort.sortAscending': 'Sort ascending',\r\n      'sort.sortDescending': 'Sort descending',\r\n      'sort.sortedAscending': 'Sorted ascending',\r\n      'sort.sortedDescending': 'Sorted descending',\r\n      'sort.notSorted': 'Not sorted',\r\n      'sort.clearSort': 'Clear sorting',\r\n\r\n      // Selection\r\n      'selection.selectRow': 'Select row',\r\n      'selection.deselectRow': 'Deselect row',\r\n      'selection.selectAll': 'Select all',\r\n      'selection.deselectAll': 'Deselect all',\r\n      'selection.selectedCount': '{count} selected',\r\n      'selection.selectAllVisible': 'Select all visible rows',\r\n      'selection.clearSelection': 'Clear selection',\r\n\r\n      // Filtering\r\n      'filter.filter': 'Filter',\r\n      'filter.clearFilter': 'Clear filter',\r\n      'filter.clearAllFilters': 'Clear all filters',\r\n      'filter.applyFilter': 'Apply filter',\r\n      'filter.filterBy': 'Filter by',\r\n      'filter.filterColumn': 'Filter column',\r\n      'filter.filterByValue': 'Filter by Value',\r\n      'filter.filterByCondition': 'Filter by Condition',\r\n      'filter.searchValues': 'Search values...',\r\n      'filter.selectAll': 'Select All',\r\n      'filter.noValuesAvailable': 'No values available',\r\n      'filter.addCondition': 'Add Condition',\r\n      'filter.removeCondition': 'Remove condition',\r\n      'filter.value': 'Value',\r\n      'filter.apply': 'Apply',\r\n      'filter.clear': 'Clear',\r\n      'filter.cancel': 'Cancel',\r\n      'filter.contains': 'Contains',\r\n      'filter.startsWith': 'Starts with',\r\n      'filter.endsWith': 'Ends with',\r\n      'filter.equals': 'Equals',\r\n      'filter.notEquals': 'Not equals',\r\n      'filter.greaterThan': 'Greater than',\r\n      'filter.lessThan': 'Less than',\r\n      'filter.greaterThanOrEqual': 'Greater than or equal',\r\n      'filter.lessThanOrEqual': 'Less than or equal',\r\n      'filter.between': 'Between',\r\n      'filter.isEmpty': 'Is empty',\r\n      'filter.isNotEmpty': 'Is not empty',\r\n      'filter.selectValues': 'Select values',\r\n      'filter.noOptionsAvailable': 'No options available',\r\n      'filter.complexDataNotSupported': 'Value filtering is not available for columns with complex data. Use Condition filtering instead.',\r\n\r\n      // Controls\r\n      'controls.refresh': 'Refresh data',\r\n      'controls.export': 'Export data',\r\n      'controls.settings': 'Settings',\r\n      'controls.columns': 'Columns',\r\n      'controls.showColumns': 'Show/Hide columns',\r\n\r\n      // Virtual Scrolling\r\n      'virtualScroll.loadingMoreRows': 'Loading more rows...',\r\n      'virtualScroll.scrollToTop': 'Scroll to top',\r\n      'virtualScroll.scrollToBottom': 'Scroll to bottom',\r\n\r\n      // Error Messages\r\n      'error.loadingData': 'Failed to load data',\r\n      'error.networkError': 'Network error occurred',\r\n      'error.invalidData': 'Invalid data format',\r\n      'error.serverError': 'Server error occurred',\r\n      'error.timeout': 'Request timed out',\r\n      'error.unknown': 'An unknown error occurred',\r\n      'error.retry': 'Retry',\r\n\r\n      // Data Types\r\n      'dataType.string': 'Text',\r\n      'dataType.number': 'Number',\r\n      'dataType.date': 'Date',\r\n      'dataType.boolean': 'Boolean',\r\n      'dataType.currency': 'Currency',\r\n      'dataType.percentage': 'Percentage',\r\n\r\n      // Accessibility\r\n      'accessibility.table': 'Data table',\r\n      'accessibility.sortableColumn': 'Sortable column',\r\n      'accessibility.selectableRow': 'Selectable row',\r\n      'accessibility.rowSelected': 'Row selected',\r\n      'accessibility.rowNotSelected': 'Row not selected',\r\n      'accessibility.pageNavigation': 'Page navigation',\r\n      'accessibility.searchInput': 'Search table data',\r\n      'accessibility.filterColumn': 'Filter column',\r\n\r\n      // Actions\r\n      'action.apply': 'Apply',\r\n      'action.cancel': 'Cancel',\r\n      'action.close': 'Close',\r\n      'action.save': 'Save',\r\n      'action.reset': 'Reset',\r\n      'action.ok': 'OK',\r\n      'action.yes': 'Yes',\r\n      'action.no': 'No',\r\n\r\n      // Time and Date\r\n      'date.today': 'Today',\r\n      'date.yesterday': 'Yesterday',\r\n      'date.thisWeek': 'This week',\r\n      'date.lastWeek': 'Last week',\r\n      'date.thisMonth': 'This month',\r\n      'date.lastMonth': 'Last month',\r\n\r\n      // Numbers and Formatting\r\n      'format.currency.symbol': '$',\r\n      'format.decimal.separator': '.',\r\n      'format.thousand.separator': ',',\r\n      'format.percentage.symbol': '%'\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Set the current language\r\n   * @param {string} language - Language code (e.g., 'en', 'fr', 'es')\r\n   */\r\n  setLanguage(language) {\r\n    if (typeof language !== 'string' || language.trim() === '') {\r\n      console.warn('TablixJS Localization: Invalid language code provided. Using fallback.');\r\n      return;\r\n    }\r\n\r\n    this.currentLanguage = language.toLowerCase().trim();\r\n  }\r\n\r\n  /**\r\n   * Add translations for a specific language\r\n   * @param {string} language - Language code\r\n   * @param {Object} translations - Translations object\r\n   */\r\n  addTranslations(language, translations) {\r\n    if (typeof language !== 'string' || !translations || typeof translations !== 'object') {\r\n      console.warn('TablixJS Localization: Invalid parameters for addTranslations.');\r\n      return;\r\n    }\r\n\r\n    const languageCode = language.toLowerCase().trim();\r\n    \r\n    if (!this.translations.has(languageCode)) {\r\n      this.translations.set(languageCode, {});\r\n    }\r\n\r\n    // Merge with existing translations for this language\r\n    const existing = this.translations.get(languageCode);\r\n    this.translations.set(languageCode, { ...existing, ...translations });\r\n  }\r\n\r\n  /**\r\n   * Get localized string by key\r\n   * @param {string} key - Translation key (e.g., 'pagination.next')\r\n   * @param {Object} params - Parameters to substitute in the translation\r\n   * @returns {string} Localized string or fallback\r\n   */\r\n  t(key, params = {}) {\r\n    if (typeof key !== 'string') {\r\n      console.warn('TablixJS Localization: Translation key must be a string.');\r\n      return key;\r\n    }\r\n\r\n    // Try current language first\r\n    let translation = this.getTranslationFromLanguage(this.currentLanguage, key);\r\n    \r\n    // Fallback to English if not found\r\n    if (translation === null && this.currentLanguage !== this.fallbackLanguage) {\r\n      translation = this.getTranslationFromLanguage(this.fallbackLanguage, key);\r\n    }\r\n\r\n    // Final fallback: return the key itself\r\n    if (translation === null) {\r\n      console.warn(`TablixJS Localization: Translation not found for key: ${key}`);\r\n      return key;\r\n    }\r\n\r\n    // Substitute parameters in the translation\r\n    return this.substituteParameters(translation, params);\r\n  }\r\n\r\n  /**\r\n   * Get translation from a specific language\r\n   * @private\r\n   * @param {string} language - Language code\r\n   * @param {string} key - Translation key\r\n   * @returns {string|null} Translation or null if not found\r\n   */\r\n  getTranslationFromLanguage(language, key) {\r\n    const languageTranslations = this.translations.get(language);\r\n    \r\n    if (!languageTranslations) {\r\n      return null;\r\n    }\r\n\r\n    // First try direct key lookup (for flat structure like 'pagination.first')\r\n    if (key in languageTranslations && typeof languageTranslations[key] === 'string') {\r\n      return languageTranslations[key];\r\n    }\r\n\r\n    // Fallback to nested key lookup (for nested structure)\r\n    const keys = key.split('.');\r\n    let current = languageTranslations;\r\n\r\n    for (const k of keys) {\r\n      if (current && typeof current === 'object' && k in current) {\r\n        current = current[k];\r\n      } else {\r\n        return null;\r\n      }\r\n    }\r\n\r\n    return typeof current === 'string' ? current : null;\r\n  }\r\n\r\n  /**\r\n   * Substitute parameters in translation string\r\n   * @private\r\n   * @param {string} translation - Translation string with placeholders\r\n   * @param {Object} params - Parameters to substitute\r\n   * @returns {string} Translation with substituted parameters\r\n   */\r\n  substituteParameters(translation, params) {\r\n    if (!params || typeof params !== 'object') {\r\n      return translation;\r\n    }\r\n\r\n    let result = translation;\r\n    \r\n    // Replace {paramName} with actual values\r\n    Object.keys(params).forEach(key => {\r\n      const regex = new RegExp(`\\\\{${key}\\\\}`, 'g');\r\n      result = result.replace(regex, params[key]);\r\n    });\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Get current language code\r\n   * @returns {string} Current language code\r\n   */\r\n  getCurrentLanguage() {\r\n    return this.currentLanguage;\r\n  }\r\n\r\n  /**\r\n   * Get available languages\r\n   * @returns {Array<string>} Array of available language codes\r\n   */\r\n  getAvailableLanguages() {\r\n    return Array.from(this.translations.keys());\r\n  }\r\n\r\n  /**\r\n   * Check if a language is available\r\n   * @param {string} language - Language code to check\r\n   * @returns {boolean} True if language is available\r\n   */\r\n  hasLanguage(language) {\r\n    return this.translations.has(language.toLowerCase().trim());\r\n  }\r\n\r\n  /**\r\n   * Get all translations for current language\r\n   * @returns {Object} All translations for current language\r\n   */\r\n  getAllTranslations() {\r\n    return this.translations.get(this.currentLanguage) || {};\r\n  }\r\n\r\n  /**\r\n   * Remove translations for a specific language\r\n   * @param {string} language - Language code to remove\r\n   */\r\n  removeLanguage(language) {\r\n    const languageCode = language.toLowerCase().trim();\r\n    if (languageCode === this.fallbackLanguage) {\r\n      console.warn('TablixJS Localization: Cannot remove fallback language.');\r\n      return;\r\n    }\r\n    \r\n    this.translations.delete(languageCode);\r\n    \r\n    // If we removed the current language, switch to fallback\r\n    if (this.currentLanguage === languageCode) {\r\n      this.currentLanguage = this.fallbackLanguage;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear all translations except fallback\r\n   */\r\n  clearTranslations() {\r\n    const fallbackTranslations = this.translations.get(this.fallbackLanguage);\r\n    this.translations.clear();\r\n    this.translations.set(this.fallbackLanguage, fallbackTranslations);\r\n    this.currentLanguage = this.fallbackLanguage;\r\n  }\r\n\r\n  /**\r\n   * Format number based on current locale\r\n   * @param {number} number - Number to format\r\n   * @param {Object} options - Formatting options\r\n   * @returns {string} Formatted number\r\n   */\r\n  formatNumber(number, options = {}) {\r\n    const {\r\n      style = 'decimal',\r\n      currency = 'USD',\r\n      minimumFractionDigits,\r\n      maximumFractionDigits\r\n    } = options;\r\n\r\n    try {\r\n      const formatter = new Intl.NumberFormat(this.getLocaleCode(), {\r\n        style,\r\n        currency: style === 'currency' ? currency : undefined,\r\n        minimumFractionDigits,\r\n        maximumFractionDigits\r\n      });\r\n      \r\n      return formatter.format(number);\r\n    } catch (error) {\r\n      // Fallback formatting if Intl is not available\r\n      return this.fallbackNumberFormat(number, options);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Format date based on current locale\r\n   * @param {Date|string|number} date - Date to format\r\n   * @param {Object} options - Formatting options\r\n   * @returns {string} Formatted date\r\n   */\r\n  formatDate(date, options = {}) {\r\n    const dateObj = date instanceof Date ? date : new Date(date);\r\n    \r\n    if (isNaN(dateObj.getTime())) {\r\n      return date.toString();\r\n    }\r\n\r\n    try {\r\n      const formatter = new Intl.DateTimeFormat(this.getLocaleCode(), options);\r\n      return formatter.format(dateObj);\r\n    } catch (error) {\r\n      // Fallback to simple date formatting\r\n      return dateObj.toLocaleDateString();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get locale code for Intl formatting\r\n   * @private\r\n   * @returns {string} Locale code\r\n   */\r\n  getLocaleCode() {\r\n    // Map language codes to locale codes\r\n    const languageToLocaleMap = {\r\n      'en': 'en-US',\r\n      'fr': 'fr-FR',\r\n      'es': 'es-ES',\r\n      'de': 'de-DE',\r\n      'it': 'it-IT',\r\n      'pt': 'pt-BR',\r\n      'ru': 'ru-RU',\r\n      'ja': 'ja-JP',\r\n      'ko': 'ko-KR',\r\n      'zh': 'zh-CN'\r\n    };\r\n\r\n    return languageToLocaleMap[this.currentLanguage] || this.currentLanguage || 'en-US';\r\n  }\r\n\r\n  /**\r\n   * Fallback number formatting when Intl is not available\r\n   * @private\r\n   * @param {number} number - Number to format\r\n   * @param {Object} options - Formatting options\r\n   * @returns {string} Formatted number\r\n   */\r\n  fallbackNumberFormat(number, options = {}) {\r\n    const { style } = options;\r\n    \r\n    if (style === 'currency') {\r\n      const symbol = this.t('format.currency.symbol');\r\n      return `${symbol}${number.toFixed(2)}`;\r\n    } else if (style === 'percent') {\r\n      const symbol = this.t('format.percentage.symbol');\r\n      return `${(number * 100).toFixed(1)}${symbol}`;\r\n    }\r\n    \r\n    return number.toString();\r\n  }\r\n\r\n  /**\r\n   * Pluralization helper\r\n   * @param {number} count - Count for pluralization\r\n   * @param {string} singularKey - Key for singular form\r\n   * @param {string} pluralKey - Key for plural form\r\n   * @param {Object} params - Additional parameters\r\n   * @returns {string} Pluralized string\r\n   */\r\n  pluralize(count, singularKey, pluralKey, params = {}) {\r\n    const key = count === 1 ? singularKey : pluralKey;\r\n    return this.t(key, { count, ...params });\r\n  }\r\n}\r\n","/**\r\n * StateManager - Centralized state management for server-side operations\r\n * \r\n * This class manages the persistent state for pagination, sorting, filtering, and search\r\n * to ensure consistency across all server requests and prevent state loss during operations.\r\n */\r\nexport default class StateManager {\r\n  constructor(table) {\r\n    this.table = table;\r\n    \r\n    // Centralized state\r\n    this.state = {\r\n      // Pagination state\r\n      page: 1,\r\n      pageSize: 10,\r\n      totalRows: 0,\r\n      \r\n      // Sorting state\r\n      sort: null, // { column: 'name', direction: 'asc' } or null\r\n      \r\n      // Filtering state\r\n      filters: {}, // { columnName: { type: 'value', values: [...] } }\r\n      \r\n      // Search state\r\n      search: '', // Global search term\r\n      \r\n      // Loading state\r\n      isLoading: false\r\n    };\r\n    \r\n    // Track if initial load has completed\r\n    this.isInitialized = false;\r\n  }\r\n\r\n  /**\r\n   * Get current state snapshot\r\n   * @returns {Object} Current state\r\n   */\r\n  getState() {\r\n    return { ...this.state };\r\n  }\r\n\r\n  /**\r\n   * Update pagination state\r\n   * @param {Object} pageState - Pagination state\r\n   */\r\n  updatePagination(pageState) {\r\n    if (pageState.page !== undefined) {\r\n      this.state.page = pageState.page;\r\n    }\r\n    if (pageState.pageSize !== undefined) {\r\n      this.state.pageSize = pageState.pageSize;\r\n    }\r\n    if (pageState.totalRows !== undefined) {\r\n      this.state.totalRows = pageState.totalRows;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update sorting state\r\n   * @param {Object|null} sortState - Sort state { column, direction } or null\r\n   */\r\n  updateSort(sortState) {\r\n    this.state.sort = sortState;\r\n  }\r\n\r\n  /**\r\n   * Update filtering state\r\n   * @param {Object} filters - Filter configurations by column\r\n   */\r\n  updateFilters(filters) {\r\n    this.state.filters = { ...filters };\r\n  }\r\n\r\n  /**\r\n   * Update search state\r\n   * @param {string} searchTerm - Search term\r\n   */\r\n  updateSearch(searchTerm) {\r\n    this.state.search = searchTerm || '';\r\n  }\r\n\r\n  /**\r\n   * Update loading state\r\n   * @param {boolean} isLoading - Loading state\r\n   */\r\n  updateLoading(isLoading) {\r\n    this.state.isLoading = isLoading;\r\n  }\r\n\r\n  /**\r\n   * Reset pagination to first page\r\n   */\r\n  resetPage() {\r\n    this.state.page = 1;\r\n  }\r\n\r\n  /**\r\n   * Get parameters for server requests\r\n   * Normalizes state into consistent format for server loaders\r\n   * @returns {Object} Server request parameters\r\n   */\r\n  getServerParams() {\r\n    return {\r\n      page: this.state.page,\r\n      pageSize: this.state.pageSize,\r\n      sort: this.state.sort || {}, // Always send object, never null/undefined\r\n      filters: this.state.filters || {},\r\n      search: this.state.search || ''\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Mark initial load as completed\r\n   */\r\n  markInitialized() {\r\n    this.isInitialized = true;\r\n  }\r\n\r\n  /**\r\n   * Check if initial load has completed\r\n   * @returns {boolean}\r\n   */\r\n  isReady() {\r\n    return this.isInitialized;\r\n  }\r\n\r\n  /**\r\n   * Reset all state to defaults\r\n   */\r\n  reset() {\r\n    this.state = {\r\n      page: 1,\r\n      pageSize: this.state.pageSize, // Preserve page size\r\n      totalRows: 0,\r\n      sort: null,\r\n      filters: {},\r\n      search: '',\r\n      isLoading: false\r\n    };\r\n    this.isInitialized = false;\r\n  }\r\n}\r\n","/**\r\n * French (fr) translations for TablixJS\r\n */\r\nexport const frenchTranslations = {\r\n  // General\r\n  'general.loading': 'Chargement...',\r\n  'general.error': 'Erreur',\r\n  'general.noData': 'Aucune donnée disponible',\r\n  'general.show': 'Afficher',\r\n  'general.entries': 'entrées',\r\n  'general.of': 'de',\r\n  'general.to': 'à',\r\n  'general.records': 'enregistrements',\r\n  'general.perPage': 'par page',\r\n  'general.showing': 'Affichage',\r\n  'general.total': 'Total',\r\n  'general.rows': 'lignes',\r\n\r\n  // Search\r\n  'search.placeholder': 'Rechercher...',\r\n  'search.clear': 'Effacer la recherche',\r\n  'search.noResults': 'Aucun résultat trouvé',\r\n  'search.resultsFound': 'résultats trouvés',\r\n\r\n  // Pagination\r\n  'pagination.first': 'Premier',\r\n  'pagination.previous': 'Précédent',\r\n  'pagination.next': 'Suivant',\r\n  'pagination.last': 'Dernier',\r\n  'pagination.page': 'Page',\r\n  'pagination.pageOf': 'Page {currentPage} sur {totalPages}',\r\n  'pagination.showingRecords': 'Affichage de {startRow} à {endRow} sur {totalRows} enregistrements',\r\n  'pagination.noRecords': 'Aucun enregistrement trouvé',\r\n  'pagination.pageSize': 'Enregistrements par page',\r\n\r\n  // Sorting\r\n  'sort.sortAscending': 'Trier croissant',\r\n  'sort.sortDescending': 'Trier décroissant',\r\n  'sort.sortedAscending': 'Trié croissant',\r\n  'sort.sortedDescending': 'Trié décroissant',\r\n  'sort.notSorted': 'Non trié',\r\n  'sort.clearSort': 'Effacer le tri',\r\n\r\n  // Selection\r\n  'selection.selectRow': 'Sélectionner la ligne',\r\n  'selection.deselectRow': 'Désélectionner la ligne',\r\n  'selection.selectAll': 'Tout sélectionner',\r\n  'selection.deselectAll': 'Tout désélectionner',\r\n  'selection.selectedCount': '{count} sélectionné(s)',\r\n  'selection.selectAllVisible': 'Sélectionner toutes les lignes visibles',\r\n  'selection.clearSelection': 'Effacer la sélection',\r\n\r\n  // Filtering\r\n  'filter.filter': 'Filtrer',\r\n  'filter.clearFilter': 'Effacer le filtre',\r\n  'filter.clearAllFilters': 'Effacer tous les filtres',\r\n  'filter.applyFilter': 'Appliquer le filtre',\r\n  'filter.filterBy': 'Filtrer par',\r\n  'filter.filterColumn': 'Filtrer la colonne',\r\n  'filter.filterByValue': 'Filtrer par valeur',\r\n  'filter.filterByCondition': 'Filtrer par condition',\r\n  'filter.searchValues': 'Rechercher des valeurs...',\r\n  'filter.selectAll': 'Tout sélectionner',\r\n  'filter.noValuesAvailable': 'Aucune valeur disponible',\r\n  'filter.addCondition': 'Ajouter une condition',\r\n  'filter.removeCondition': 'Supprimer la condition',\r\n  'filter.value': 'Valeur',\r\n  'filter.apply': 'Appliquer',\r\n  'filter.clear': 'Effacer',\r\n  'filter.cancel': 'Annuler',\r\n  'filter.contains': 'Contient',\r\n  'filter.startsWith': 'Commence par',\r\n  'filter.endsWith': 'Se termine par',\r\n  'filter.equals': 'Égal à',\r\n  'filter.notEquals': 'Différent de',\r\n  'filter.greaterThan': 'Supérieur à',\r\n  'filter.lessThan': 'Inférieur à',\r\n  'filter.greaterThanOrEqual': 'Supérieur ou égal à',\r\n  'filter.lessThanOrEqual': 'Inférieur ou égal à',\r\n  'filter.between': 'Entre',\r\n  'filter.isEmpty': 'Est vide',\r\n  'filter.isNotEmpty': 'N\\'est pas vide',\r\n  'filter.selectValues': 'Sélectionner les valeurs',\r\n  'filter.noOptionsAvailable': 'Aucune option disponible',\r\n  'filter.complexDataNotSupported': 'Le filtrage par valeur n\\'est pas disponible pour les colonnes avec des données complexes. Utilisez le filtrage par condition à la place.',\r\n\r\n  // Controls\r\n  'controls.refresh': 'Actualiser les données',\r\n  'controls.export': 'Exporter les données',\r\n  'controls.settings': 'Paramètres',\r\n  'controls.columns': 'Colonnes',\r\n  'controls.showColumns': 'Afficher/Masquer les colonnes',\r\n\r\n  // Virtual Scrolling\r\n  'virtualScroll.loadingMoreRows': 'Chargement de plus de lignes...',\r\n  'virtualScroll.scrollToTop': 'Faire défiler vers le haut',\r\n  'virtualScroll.scrollToBottom': 'Faire défiler vers le bas',\r\n\r\n  // Error Messages\r\n  'error.loadingData': 'Échec du chargement des données',\r\n  'error.networkError': 'Erreur réseau',\r\n  'error.invalidData': 'Format de données invalide',\r\n  'error.serverError': 'Erreur serveur',\r\n  'error.timeout': 'Délai d\\'attente dépassé',\r\n  'error.unknown': 'Une erreur inconnue s\\'est produite',\r\n  'error.retry': 'Réessayer',\r\n\r\n  // Data Types\r\n  'dataType.string': 'Texte',\r\n  'dataType.number': 'Nombre',\r\n  'dataType.date': 'Date',\r\n  'dataType.boolean': 'Booléen',\r\n  'dataType.currency': 'Devise',\r\n  'dataType.percentage': 'Pourcentage',\r\n\r\n  // Accessibility\r\n  'accessibility.table': 'Tableau de données',\r\n  'accessibility.sortableColumn': 'Colonne triable',\r\n  'accessibility.selectableRow': 'Ligne sélectionnable',\r\n  'accessibility.rowSelected': 'Ligne sélectionnée',\r\n  'accessibility.rowNotSelected': 'Ligne non sélectionnée',\r\n  'accessibility.pageNavigation': 'Navigation des pages',\r\n  'accessibility.searchInput': 'Rechercher dans les données du tableau',\r\n  'accessibility.filterColumn': 'Filtrer la colonne',\r\n\r\n  // Actions\r\n  'action.apply': 'Appliquer',\r\n  'action.cancel': 'Annuler',\r\n  'action.close': 'Fermer',\r\n  'action.save': 'Enregistrer',\r\n  'action.reset': 'Réinitialiser',\r\n  'action.ok': 'OK',\r\n  'action.yes': 'Oui',\r\n  'action.no': 'Non',\r\n\r\n  // Time and Date\r\n  'date.today': 'Aujourd\\'hui',\r\n  'date.yesterday': 'Hier',\r\n  'date.thisWeek': 'Cette semaine',\r\n  'date.lastWeek': 'La semaine dernière',\r\n  'date.thisMonth': 'Ce mois-ci',\r\n  'date.lastMonth': 'Le mois dernier',\r\n\r\n  // Numbers and Formatting\r\n  'format.currency.symbol': '€',\r\n  'format.decimal.separator': ',',\r\n  'format.thousand.separator': ' ',\r\n  'format.percentage.symbol': '%'\r\n};\r\n\r\nexport default frenchTranslations;\r\n","/**\r\n * Spanish (es) translations for TablixJS\r\n */\r\nexport const spanishTranslations = {\r\n  // General\r\n  'general.loading': 'Cargando...',\r\n  'general.error': 'Error',\r\n  'general.noData': 'No hay datos disponibles',\r\n  'general.show': 'Mostrar',\r\n  'general.entries': 'entradas',\r\n  'general.of': 'de',\r\n  'general.to': 'a',\r\n  'general.records': 'registros',\r\n  'general.perPage': 'por página',\r\n  'general.showing': 'Mostrando',\r\n  'general.total': 'Total',\r\n  'general.rows': 'filas',\r\n\r\n  // Search\r\n  'search.placeholder': 'Buscar...',\r\n  'search.clear': 'Limpiar búsqueda',\r\n  'search.noResults': 'No se encontraron resultados',\r\n  'search.resultsFound': 'resultados encontrados',\r\n\r\n  // Pagination\r\n  'pagination.first': 'Primero',\r\n  'pagination.previous': 'Anterior',\r\n  'pagination.next': 'Siguiente',\r\n  'pagination.last': 'Último',\r\n  'pagination.page': 'Página',\r\n  'pagination.pageOf': 'Página {currentPage} de {totalPages}',\r\n  'pagination.showingRecords': 'Mostrando {startRow} a {endRow} de {totalRows} registros',\r\n  'pagination.noRecords': 'No se encontraron registros',\r\n  'pagination.pageSize': 'Registros por página',\r\n\r\n  // Sorting\r\n  'sort.sortAscending': 'Ordenar ascendente',\r\n  'sort.sortDescending': 'Ordenar descendente',\r\n  'sort.sortedAscending': 'Ordenado ascendente',\r\n  'sort.sortedDescending': 'Ordenado descendente',\r\n  'sort.notSorted': 'Sin ordenar',\r\n  'sort.clearSort': 'Limpiar ordenación',\r\n\r\n  // Selection\r\n  'selection.selectRow': 'Seleccionar fila',\r\n  'selection.deselectRow': 'Deseleccionar fila',\r\n  'selection.selectAll': 'Seleccionar todo',\r\n  'selection.deselectAll': 'Deseleccionar todo',\r\n  'selection.selectedCount': '{count} seleccionado(s)',\r\n  'selection.selectAllVisible': 'Seleccionar todas las filas visibles',\r\n  'selection.clearSelection': 'Limpiar selección',\r\n\r\n  // Filtering\r\n  'filter.filter': 'Filtrar',\r\n  'filter.clearFilter': 'Limpiar filtro',\r\n  'filter.clearAllFilters': 'Limpiar todos los filtros',\r\n  'filter.applyFilter': 'Aplicar filtro',\r\n  'filter.filterBy': 'Filtrar por',\r\n  'filter.filterColumn': 'Filtrar columna',\r\n  'filter.filterByValue': 'Filtrar por valor',\r\n  'filter.filterByCondition': 'Filtrar por condición',\r\n  'filter.searchValues': 'Buscar valores...',\r\n  'filter.selectAll': 'Seleccionar todo',\r\n  'filter.noValuesAvailable': 'No hay valores disponibles',\r\n  'filter.addCondition': 'Agregar condición',\r\n  'filter.removeCondition': 'Eliminar condición',\r\n  'filter.value': 'Valor',\r\n  'filter.apply': 'Aplicar',\r\n  'filter.clear': 'Limpiar',\r\n  'filter.cancel': 'Cancelar',\r\n  'filter.contains': 'Contiene',\r\n  'filter.startsWith': 'Comienza con',\r\n  'filter.endsWith': 'Termina con',\r\n  'filter.equals': 'Igual a',\r\n  'filter.notEquals': 'No igual a',\r\n  'filter.greaterThan': 'Mayor que',\r\n  'filter.lessThan': 'Menor que',\r\n  'filter.greaterThanOrEqual': 'Mayor o igual a',\r\n  'filter.lessThanOrEqual': 'Menor o igual a',\r\n  'filter.between': 'Entre',\r\n  'filter.isEmpty': 'Está vacío',\r\n  'filter.isNotEmpty': 'No está vacío',\r\n  'filter.selectValues': 'Seleccionar valores',\r\n  'filter.noOptionsAvailable': 'No hay opciones disponibles',\r\n  'filter.complexDataNotSupported': 'El filtrado por valor no está disponible para columnas con datos complejos. Utilice el filtrado por condición en su lugar.',\r\n\r\n  // Controls\r\n  'controls.refresh': 'Actualizar datos',\r\n  'controls.export': 'Exportar datos',\r\n  'controls.settings': 'Configuración',\r\n  'controls.columns': 'Columnas',\r\n  'controls.showColumns': 'Mostrar/Ocultar columnas',\r\n\r\n  // Virtual Scrolling\r\n  'virtualScroll.loadingMoreRows': 'Cargando más filas...',\r\n  'virtualScroll.scrollToTop': 'Desplazar hacia arriba',\r\n  'virtualScroll.scrollToBottom': 'Desplazar hacia abajo',\r\n\r\n  // Error Messages\r\n  'error.loadingData': 'Error al cargar los datos',\r\n  'error.networkError': 'Error de red',\r\n  'error.invalidData': 'Formato de datos inválido',\r\n  'error.serverError': 'Error del servidor',\r\n  'error.timeout': 'Tiempo de espera agotado',\r\n  'error.unknown': 'Ocurrió un error desconocido',\r\n  'error.retry': 'Reintentar',\r\n\r\n  // Data Types\r\n  'dataType.string': 'Texto',\r\n  'dataType.number': 'Número',\r\n  'dataType.date': 'Fecha',\r\n  'dataType.boolean': 'Booleano',\r\n  'dataType.currency': 'Moneda',\r\n  'dataType.percentage': 'Porcentaje',\r\n\r\n  // Accessibility\r\n  'accessibility.table': 'Tabla de datos',\r\n  'accessibility.sortableColumn': 'Columna ordenable',\r\n  'accessibility.selectableRow': 'Fila seleccionable',\r\n  'accessibility.rowSelected': 'Fila seleccionada',\r\n  'accessibility.rowNotSelected': 'Fila no seleccionada',\r\n  'accessibility.pageNavigation': 'Navegación de páginas',\r\n  'accessibility.searchInput': 'Buscar en los datos de la tabla',\r\n  'accessibility.filterColumn': 'Filtrar columna',\r\n\r\n  // Actions\r\n  'action.apply': 'Aplicar',\r\n  'action.cancel': 'Cancelar',\r\n  'action.close': 'Cerrar',\r\n  'action.save': 'Guardar',\r\n  'action.reset': 'Restablecer',\r\n  'action.ok': 'OK',\r\n  'action.yes': 'Sí',\r\n  'action.no': 'No',\r\n\r\n  // Time and Date\r\n  'date.today': 'Hoy',\r\n  'date.yesterday': 'Ayer',\r\n  'date.thisWeek': 'Esta semana',\r\n  'date.lastWeek': 'La semana pasada',\r\n  'date.thisMonth': 'Este mes',\r\n  'date.lastMonth': 'El mes pasado',\r\n\r\n  // Numbers and Formatting\r\n  'format.currency.symbol': '€',\r\n  'format.decimal.separator': ',',\r\n  'format.thousand.separator': '.',\r\n  'format.percentage.symbol': '%'\r\n};\r\n\r\nexport default spanishTranslations;\r\n","/**\r\n * Serbian (sr) translations for TablixJS\r\n */\r\nexport const serbianTranslations = {\r\n  // General\r\n  'general.loading': 'Učitavanje...',\r\n  'general.error': 'Greška',\r\n  'general.noData': 'Nema dostupnih podataka',\r\n  'general.show': 'Prikaži',\r\n  'general.entries': 'unosa',\r\n  'general.of': 'od',\r\n  'general.to': 'do',\r\n  'general.records': 'zapisa',\r\n  'general.perPage': 'po stranici',\r\n  'general.showing': 'Prikazano',\r\n  'general.total': 'Ukupno',\r\n  'general.rows': 'redova',\r\n\r\n  // Search\r\n  'search.placeholder': 'Pretraga...',\r\n  'search.clear': 'Obriši pretragu',\r\n  'search.noResults': 'Nema rezultata',\r\n  'search.resultsFound': 'rezultata pronađeno',\r\n\r\n  // Pagination\r\n  'pagination.first': 'Prva',\r\n  'pagination.previous': 'Prethodna',\r\n  'pagination.next': 'Sledeća',\r\n  'pagination.last': 'Poslednja',\r\n  'pagination.page': 'Stranica',\r\n  'pagination.pageOf': 'Stranica {currentPage} od {totalPages}',\r\n  'pagination.showingRecords': 'Prikazano {startRow}-{endRow} od {totalRows} zapisa',\r\n  'pagination.noRecords': 'Nema zapisa',\r\n  'pagination.pageSize': 'Zapisa po stranici',\r\n\r\n  // Sorting\r\n  'sort.sortAscending': 'Sortiraj rastuće',\r\n  'sort.sortDescending': 'Sortiraj opadajuće',\r\n  'sort.sortedAscending': 'Sortirano rastuće',\r\n  'sort.sortedDescending': 'Sortirano opadajuće',\r\n  'sort.notSorted': 'Nije sortirano',\r\n  'sort.clearSort': 'Obriši sortiranje',\r\n\r\n  // Selection\r\n  'selection.selectRow': 'Izaberi red',\r\n  'selection.deselectRow': 'Poništi izbor reda',\r\n  'selection.selectAll': 'Izaberi sve',\r\n  'selection.deselectAll': 'Poništi sve',\r\n  'selection.selectedCount': '{count} izabrano',\r\n  'selection.selectAllVisible': 'Izaberi sve vidljive redove',\r\n  'selection.clearSelection': 'Obriši izbor',\r\n\r\n  // Filtering\r\n  'filter.filter': 'Filter',\r\n  'filter.clearFilter': 'Obriši filter',\r\n  'filter.clearAllFilters': 'Obriši sve filtere',\r\n  'filter.applyFilter': 'Primeni filter',\r\n  'filter.filterBy': 'Filtriraj po',\r\n  'filter.filterColumn': 'Filtriraj kolonu',\r\n  'filter.filterByValue': 'Filtriraj po vrednosti',\r\n  'filter.filterByCondition': 'Filtriraj po uslovu',\r\n  'filter.searchValues': 'Pretraži vrednosti...',\r\n  'filter.selectAll': 'Izaberi sve',\r\n  'filter.noValuesAvailable': 'Nema dostupnih vrednosti',\r\n  'filter.addCondition': 'Dodaj uslov',\r\n  'filter.removeCondition': 'Ukloni uslov',\r\n  'filter.value': 'Vrednost',\r\n  'filter.apply': 'Primeni',\r\n  'filter.clear': 'Obriši',\r\n  'filter.cancel': 'Otkaži',\r\n  'filter.contains': 'Sadrži',\r\n  'filter.startsWith': 'Počinje sa',\r\n  'filter.endsWith': 'Završava se sa',\r\n  'filter.equals': 'Jednako',\r\n  'filter.notEquals': 'Nije jednako',\r\n  'filter.greaterThan': 'Veće od',\r\n  'filter.lessThan': 'Manje od',\r\n  'filter.greaterThanOrEqual': 'Veće ili jednako',\r\n  'filter.lessThanOrEqual': 'Manje ili jednako',\r\n  'filter.between': 'Između',\r\n  'filter.isEmpty': 'Prazno',\r\n  'filter.isNotEmpty': 'Nije prazno',\r\n  'filter.selectValues': 'Izaberi vrednosti',\r\n  'filter.noOptionsAvailable': 'Nema dostupnih opcija',\r\n  'filter.complexDataNotSupported': 'Filtriranje po vrednosti nije dostupno za kolone sa složenim podacima. Koristite filtriranje po uslovu umesto toga.',\r\n\r\n  // Controls\r\n  'controls.refresh': 'Osveži podatke',\r\n  'controls.export': 'Izvezi podatke',\r\n  'controls.settings': 'Podešavanja',\r\n  'controls.columns': 'Kolone',\r\n  'controls.showColumns': 'Prikaži/Sakrij kolone',\r\n\r\n  // Virtual Scrolling\r\n  'virtualScroll.loadingMoreRows': 'Učitavanje dodatnih redova...',\r\n  'virtualScroll.scrollToTop': 'Idi na vrh',\r\n  'virtualScroll.scrollToBottom': 'Idi na dno',\r\n\r\n  // Error Messages\r\n  'error.loadingData': 'Neuspešno učitavanje podataka',\r\n  'error.networkError': 'Došlo je do mrežne greške',\r\n  'error.invalidData': 'Neispravan format podataka',\r\n  'error.serverError': 'Došlo je do greške na serveru',\r\n  'error.timeout': 'Isteklo vreme zahteva',\r\n  'error.unknown': 'Došlo je do nepoznate greške',\r\n  'error.retry': 'Pokušaj ponovo',\r\n\r\n  // Data Types\r\n  'dataType.string': 'Tekst',\r\n  'dataType.number': 'Broj',\r\n  'dataType.date': 'Datum',\r\n  'dataType.boolean': 'Logička vrednost',\r\n  'dataType.currency': 'Valuta',\r\n  'dataType.percentage': 'Procenat',\r\n\r\n  // Accessibility\r\n  'accessibility.table': 'Tabela podataka',\r\n  'accessibility.sortableColumn': 'Kolona za sortiranje',\r\n  'accessibility.selectableRow': 'Red za izbor',\r\n  'accessibility.rowSelected': 'Red izabran',\r\n  'accessibility.rowNotSelected': 'Red nije izabran',\r\n  'accessibility.pageNavigation': 'Navigacija stranica',\r\n  'accessibility.searchInput': 'Pretraga podataka tabele',\r\n  'accessibility.filterColumn': 'Filtriraj kolonu',\r\n\r\n  // Actions\r\n  'action.apply': 'Primeni',\r\n  'action.cancel': 'Otkaži',\r\n  'action.close': 'Zatvori',\r\n  'action.save': 'Sačuvaj',\r\n  'action.reset': 'Resetuj',\r\n  'action.ok': 'U redu',\r\n  'action.yes': 'Da',\r\n  'action.no': 'Ne',\r\n\r\n  // Time and Date\r\n  'date.today': 'Danas',\r\n  'date.yesterday': 'Juče',\r\n  'date.thisWeek': 'Ove nedelje',\r\n  'date.lastWeek': 'Prošle nedelje',\r\n  'date.thisMonth': 'Ovog meseca',\r\n  'date.lastMonth': 'Prošlog meseca',\r\n\r\n  // Numbers and Formatting\r\n  'format.currency.symbol': 'RSD',\r\n  'format.decimal.separator': ',',\r\n  'format.thousand.separator': '.',\r\n  'format.percentage.symbol': '%'\r\n};\r\n\r\nexport default serbianTranslations;\r\n","import DataManager from './DataManager.js';\r\nimport Renderer from './Renderer.js';\r\nimport EventManager from './EventManager.js';\r\nimport PaginationManager from './PaginationManager.js';\r\nimport SortingManager from './SortingManager.js';\r\nimport ColumnManager from './ColumnManager.js';\r\nimport FilterManager from './FilterManager.js';\r\nimport FilterUI from './FilterUI.js';\r\nimport SearchManager from './SearchManager.js';\r\nimport SelectionManager from './SelectionManager.js';\r\nimport VirtualScrollManager from './VirtualScroll.js';\r\nimport Localization from './Localization.js';\r\nimport StateManager from './StateManager.js';\r\nimport { frenchTranslations } from '../locales/fr.js';\r\nimport { spanishTranslations } from '../locales/es.js';\r\nimport { serbianTranslations } from '../locales/sr.js';\r\n\r\nexport default class Table {\r\n  constructor(container, options = {}) {\r\n    this.container = typeof container === 'string' ? document.querySelector(container) : container;\r\n    this.options = {\r\n      // Default options\r\n      pagination: {\r\n        enabled: true,\r\n        pageSize: 10,\r\n        mode: 'client', // 'client' or 'server'\r\n        showPageNumbers: true,\r\n        maxPageNumbers: 5,\r\n        showFirstLast: true,\r\n        showPrevNext: true,\r\n        showPageSizes: false,\r\n        pageSizeOptions: [10, 25, 50, 100],\r\n        serverDataLoader: null\r\n      },\r\n      // Sorting options\r\n      sorting: {\r\n        enabled: true,\r\n        mode: 'client', // 'client' or 'server'\r\n        serverSortLoader: null,\r\n        defaultSortType: 'auto',\r\n        caseSensitive: false,\r\n        nullsFirst: false\r\n      },\r\n      // Filtering options\r\n      filtering: {\r\n        enabled: true,\r\n        mode: 'client', // 'client' or 'server'\r\n        serverFilterLoader: null,\r\n        debounceDelay: 300,\r\n        showBadges: true,\r\n        showTooltips: true\r\n      },\r\n      // Control panels\r\n      controls: {\r\n        enabled: true,  // Enable by default to show search\r\n        search: true,\r\n        pagination: true,\r\n        pageSize: true,\r\n        refresh: true,\r\n        export: false,\r\n        position: 'top' // 'top', 'bottom', 'both'\r\n      },\r\n      search: {\r\n        enabled: true,\r\n        placeholder: null, // Will use localized string if not provided\r\n        searchDelay: 300, // Debounce delay in milliseconds\r\n        minLength: 1, // Minimum characters before search starts\r\n        caseSensitive: false\r\n      },\r\n      // Selection options\r\n      selection: {\r\n        enabled: false,  // Default: selection is disabled\r\n        mode: 'single',  // 'single' or 'multi'\r\n        dataIdKey: 'id'  // Key to use as stable row identifier\r\n      },\r\n      // Virtual scrolling options\r\n      virtualScroll: {\r\n        enabled: false,\r\n        buffer: 10, // Number of rows to render above/below viewport\r\n        rowHeight: null, // Auto-detected if null\r\n        containerHeight: 400 // Default container height in pixels\r\n      },\r\n      // Localization options\r\n      language: 'en',\r\n      translations: {},\r\n      ...options\r\n    };\r\n\r\n    // Initialize localization first (before other managers that might use it)\r\n    this.localization = new Localization();\r\n    \r\n    // Auto-load common language packs for developer convenience\r\n    this.localization.addTranslations('fr', frenchTranslations);\r\n    this.localization.addTranslations('es', spanishTranslations);\r\n    this.localization.addTranslations('sr', serbianTranslations);\r\n    \r\n    // Set language and translations if provided\r\n    if (this.options.language) {\r\n      this.localization.setLanguage(this.options.language);\r\n    }\r\n    \r\n    // Add custom translations if provided (these will override auto-loaded ones)\r\n    if (this.options.translations) {\r\n      Object.keys(this.options.translations).forEach(lang => {\r\n        this.localization.addTranslations(lang, this.options.translations[lang]);\r\n      });\r\n    }\r\n\r\n    // Initialize managers\r\n    this.eventManager = new EventManager();\r\n    this.columnManager = new ColumnManager(this);\r\n    this.dataManager = new DataManager(this, options.data || []);\r\n    this.renderer = new Renderer(this);\r\n    \r\n    // Initialize state manager for server-side operations\r\n    this.stateManager = new StateManager(this);\r\n    \r\n    // Initialize columns if provided\r\n    if (options.columns) {\r\n      this.columnManager.initializeColumns(options.columns);\r\n    }\r\n    \r\n    // Initialize pagination if enabled\r\n    if (this.options.pagination && this.options.pagination.enabled !== false) {\r\n      this.paginationManager = new PaginationManager(this, this.options.pagination);\r\n      // Sync initial page size with state manager\r\n      this.stateManager.updatePagination({ \r\n        pageSize: this.options.pagination.pageSize || 10 \r\n      });\r\n    }\r\n\r\n    // Initialize sorting if enabled\r\n    if (this.options.sorting && this.options.sorting.enabled !== false) {\r\n      this.sortingManager = new SortingManager(this, this.options.sorting);\r\n    }\r\n\r\n    // Initialize filtering if enabled\r\n    if (this.options.filtering && this.options.filtering.enabled !== false) {\r\n      this.filterManager = new FilterManager(this, this.options.filtering);\r\n      this.filterUI = new FilterUI(this.filterManager);\r\n    }\r\n\r\n    // Initialize search if enabled\r\n    if (this.options.search && this.options.search.enabled !== false) {\r\n      this.searchManager = new SearchManager(this, this.options.search);\r\n    }\r\n\r\n    // Initialize selection if enabled\r\n    if (this.options.selection) {\r\n      this.selectionManager = new SelectionManager(this, this.options.selection);\r\n    }\r\n\r\n    // Initialize virtual scrolling\r\n    if (this.options.virtualScroll) {\r\n      this.virtualScrollManager = new VirtualScrollManager(this, this.options.virtualScroll);\r\n    }\r\n\r\n    this.init();\r\n  }\r\n\r\n  async init() {\r\n    try {\r\n      // Initialize search manager\r\n      if (this.searchManager) {\r\n        this.searchManager.init();\r\n      }\r\n\r\n      // Determine if we're using server-side operations\r\n      const isServerMode = this._isServerMode();\r\n      \r\n      // Trigger beforeLoad hook for initial data\r\n      this.eventManager.trigger('beforeLoad', { source: 'initialization' });\r\n      \r\n      if (isServerMode) {\r\n        // For server mode, load initial data through unified request\r\n        await this._loadServerData();\r\n      } else {\r\n        // For client mode, just refresh with local data\r\n        await this.refreshTable();\r\n      }\r\n      \r\n      // Mark state as initialized\r\n      this.stateManager.markInitialized();\r\n      \r\n      // Trigger afterLoad hook with consistent payload format\r\n      const loadedData = this.dataManager.getData();\r\n      this.eventManager.trigger('afterLoad', { data: loadedData, source: 'initialization' });\r\n      \r\n      // Explicitly trigger afterRender to ensure selection works on first load\r\n      this.eventManager.trigger('afterRender');\r\n    } catch (error) {\r\n      console.error('Failed to initialize table:', error);\r\n      this.eventManager.trigger('loadError', { error, source: 'initialization' });\r\n      if (this.renderer && this.renderer.renderError) {\r\n        this.renderer.renderError(error);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if any feature is using server mode\r\n   * @private\r\n   */\r\n  _isServerMode() {\r\n    return (this.options.pagination && this.options.pagination.mode === 'server') ||\r\n           (this.options.sorting && this.options.sorting.mode === 'server') ||\r\n           (this.options.filtering && this.options.filtering.mode === 'server');\r\n  }\r\n\r\n  /**\r\n   * Unified server data loading\r\n   * Ensures only one request is made with all current state (pagination, sort, filter, search)\r\n   * @private\r\n   */\r\n  async _loadServerData() {\r\n    // Update state manager with current search term\r\n    if (this.searchManager) {\r\n      this.stateManager.updateSearch(this.searchManager.currentSearchTerm);\r\n    }\r\n\r\n    // Get unified parameters from state manager\r\n    const params = this.stateManager.getServerParams();\r\n    \r\n    this.stateManager.updateLoading(true);\r\n    this.eventManager.trigger('beforeServerLoad', params);\r\n\r\n    try {\r\n      let result;\r\n      \r\n      // Determine which loader to use based on the operation\r\n      // Priority: serverFilterLoader > serverSortLoader > serverDataLoader\r\n      if (this.options.filtering && \r\n          this.options.filtering.mode === 'server' && \r\n          this.options.filtering.serverFilterLoader &&\r\n          Object.keys(params.filters).length > 0) {\r\n        // Use filter loader if filters are active\r\n        result = await this.options.filtering.serverFilterLoader(params);\r\n      } else if (this.options.sorting && \r\n                 this.options.sorting.mode === 'server' && \r\n                 this.options.sorting.serverSortLoader &&\r\n                 params.sort && params.sort.column) {\r\n        // Use sort loader if sort is active and no filters\r\n        result = await this.options.sorting.serverSortLoader(params);\r\n      } else if (this.options.pagination && \r\n                 this.options.pagination.serverDataLoader) {\r\n        // Fall back to pagination loader\r\n        result = await this.options.pagination.serverDataLoader(params);\r\n      } else {\r\n        throw new Error('No server data loader configured for server-side operations');\r\n      }\r\n\r\n      // Update data manager with server response\r\n      this.dataManager.setServerData(result.data, result.totalRows);\r\n      \r\n      // Update state manager with total rows\r\n      this.stateManager.updatePagination({ totalRows: result.totalRows });\r\n      \r\n      // Update pagination manager info\r\n      if (this.paginationManager) {\r\n        this.paginationManager.updatePaginationInfo(result.totalRows);\r\n      }\r\n\r\n      // Render the table with the loaded data\r\n      this.renderer.renderTable(result.data);\r\n\r\n      this.stateManager.updateLoading(false);\r\n      this.eventManager.trigger('afterServerLoad', { params, result });\r\n      \r\n      return result.data;\r\n    } catch (error) {\r\n      this.stateManager.updateLoading(false);\r\n      this.eventManager.trigger('serverLoadError', { params, error });\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Refresh the table with current data and pagination\r\n   */\r\n  async refreshTable() {\r\n    let dataToRender;\r\n    \r\n    // Check if we're in server mode\r\n    const isServerMode = this._isServerMode();\r\n    \r\n    if (isServerMode && this.stateManager.isReady()) {\r\n      // For server mode after initialization, always use unified server loading\r\n      dataToRender = await this._loadServerData();\r\n      return; // _loadServerData already renders the table\r\n    }\r\n    \r\n    if (this.virtualScrollManager && this.virtualScrollManager.isEnabled()) {\r\n      // Virtual scrolling mode - get all data for virtual scrolling manager\r\n      dataToRender = this.dataManager.getData();\r\n      \r\n      // Initialize or update virtual scrolling with full dataset\r\n      this.virtualScrollManager.updateData(dataToRender);\r\n      \r\n      // Render the table structure first (without data rows)\r\n      this.renderer.renderTable([], true); // Pass empty array and virtualMode flag\r\n      \r\n      // Initialize virtual scrolling after table structure is ready\r\n      this.virtualScrollManager.init(dataToRender);\r\n    } else if (this.paginationManager) {\r\n      // Traditional pagination mode (client-side)\r\n      dataToRender = await this.paginationManager.getPageData();\r\n      this.renderer.renderTable(dataToRender);\r\n    } else {\r\n      // No pagination, show all data (traditional mode)\r\n      dataToRender = this.dataManager.getData();\r\n      this.renderer.renderTable(dataToRender);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Load new data into the table\r\n   * Supports multiple data sources:\r\n   * - Array: loadData([{id: 1, name: 'John'}])\r\n   * - URL string: loadData('/api/data')\r\n   * - Async function: loadData(() => fetch('/api/data').then(r => r.json()))\r\n   * @param {Array|string|Function} source - Data source\r\n   */\r\n  async loadData(source) {\r\n    try {\r\n      // Trigger beforeLoad hook\r\n      this.eventManager.trigger('beforeLoad', { source });\r\n\r\n      let data;\r\n\r\n      // Handle different data source types\r\n      if (Array.isArray(source)) {\r\n        // Direct array data\r\n        data = source;\r\n      } else if (typeof source === 'string') {\r\n        // URL string - fetch data\r\n        data = await this._fetchFromUrl(source);\r\n      } else if (typeof source === 'function') {\r\n        // Custom async function\r\n        data = await source();\r\n      } else {\r\n        throw new Error('Invalid data source. Expected array, URL string, or function.');\r\n      }\r\n\r\n      // Validate data\r\n      if (!Array.isArray(data)) {\r\n        throw new Error('Data source must resolve to an array.');\r\n      }\r\n\r\n      // Update data and refresh table\r\n      this.dataManager.setData(data);\r\n      await this.refreshTable();\r\n      \r\n      // Trigger afterLoad hook\r\n      this.eventManager.trigger('afterLoad', { data, source });\r\n\r\n    } catch (error) {\r\n      // Handle loading errors\r\n      console.error('Error loading data:', error);\r\n      this.eventManager.trigger('loadError', { error, source });\r\n      \r\n      // Render error state\r\n      if (this.renderer && this.renderer.renderError) {\r\n        this.renderer.renderError(error);\r\n      }\r\n      \r\n      // Re-throw for caller handling\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Internal method to fetch data from URL\r\n   * @private\r\n   */\r\n  async _fetchFromUrl(url) {\r\n    if (typeof fetch === 'undefined') {\r\n      throw new Error('fetch is not available. Please use a modern browser or provide a polyfill.');\r\n    }\r\n\r\n    const response = await fetch(url);\r\n    \r\n    if (!response.ok) {\r\n      throw new Error(`HTTP error! status: ${response.status} - ${response.statusText}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    return data;\r\n  }\r\n\r\n  /**\r\n   * Filter data by criteria\r\n   */\r\n  async filter(criteria) {\r\n    this.dataManager.applyFilter(criteria);\r\n    await this.refreshTable();\r\n    this.eventManager.trigger('afterFilter', criteria);\r\n  }\r\n\r\n  /**\r\n   * Sort data by column\r\n   * @param {string} columnName - Column to sort by\r\n   * @param {string|null} direction - 'asc', 'desc', or null (unsorted)\r\n   */\r\n  async sort(columnName, direction = 'asc') {\r\n    if (this.sortingManager) {\r\n      await this.sortingManager.sort(columnName, direction);\r\n    } else {\r\n      // Fallback to legacy sorting\r\n      this.dataManager.applySorting([{ column: columnName, direction }]);\r\n      await this.refreshTable();\r\n      this.eventManager.trigger('afterSort', [{ column: columnName, direction }]);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Toggle sort for a column (handles click cycling)\r\n   */\r\n  async toggleSort(columnName) {\r\n    if (this.sortingManager) {\r\n      await this.sortingManager.toggleSort(columnName);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear all sorting\r\n   */\r\n  async clearSorting() {\r\n    if (this.sortingManager) {\r\n      await this.sortingManager.clearSorting();\r\n    } else {\r\n      // Fallback to legacy sorting\r\n      this.dataManager.clearSorting();\r\n      await this.refreshTable();\r\n      this.eventManager.trigger('afterSort', []);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current sort state\r\n   */\r\n  getSortState() {\r\n    if (this.sortingManager) {\r\n      return this.sortingManager.getSortState();\r\n    }\r\n    return { sort: null, mode: 'client' };\r\n  }\r\n\r\n  /**\r\n   * Clear all filters\r\n   */\r\n  async clearFilters() {\r\n    this.dataManager.clearFilters();\r\n    await this.refreshTable();\r\n    this.eventManager.trigger('afterFilter', {});\r\n  }\r\n\r\n  /**\r\n   * Clear all sorting\r\n   */\r\n  async clearSorting() {\r\n    if (this.sortingManager) {\r\n      await this.sortingManager.clearSorting();\r\n    } else {\r\n      // Fallback to legacy sorting\r\n      this.dataManager.clearSorting();\r\n      await this.refreshTable();\r\n      this.eventManager.trigger('afterSort', []);\r\n    }\r\n  }\r\n\r\n  // ===== FILTERING API =====\r\n\r\n  /**\r\n   * Apply filter to a specific column\r\n   * @param {string} columnName - Column to filter\r\n   * @param {Object} filterConfig - Filter configuration\r\n   * @example\r\n   * table.applyFilter('status', { type: 'value', values: ['Active', 'Pending'] });\r\n   * table.applyFilter('name', { type: 'condition', conditions: [{ operator: 'beginsWith', value: 'A' }] });\r\n   */\r\n  async applyFilter(columnName, filterConfig) {\r\n    if (this.filterManager) {\r\n      await this.filterManager.applyFilter(columnName, filterConfig);\r\n    } else {\r\n      console.warn('TablixJS: Filtering is not enabled. Set filtering.enabled to true in options.');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear filter for a specific column\r\n   * @param {string} columnName - Column to clear filter for\r\n   */\r\n  async clearFilter(columnName) {\r\n    if (this.filterManager) {\r\n      await this.filterManager.clearFilter(columnName);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear all filters\r\n   */\r\n  async clearAllFilters() {\r\n    if (this.filterManager) {\r\n      await this.filterManager.clearAllFilters();\r\n    } else {\r\n      // Fallback to legacy method\r\n      this.dataManager.clearFilters();\r\n      await this.refreshTable();\r\n      this.eventManager.trigger('afterFilter', {});\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get active filters\r\n   * @returns {Object} Active filters by column\r\n   */\r\n  getActiveFilters() {\r\n    return this.filterManager ? this.filterManager.getActiveFilters() : {};\r\n  }\r\n\r\n  /**\r\n   * Get filter state for a column\r\n   * @param {string} columnName - Column name\r\n   * @returns {Object|null} Filter state\r\n   */\r\n  getColumnFilter(columnName) {\r\n    return this.filterManager ? this.filterManager.getColumnFilter(columnName) : null;\r\n  }\r\n\r\n  // ===== SEARCH API =====\r\n\r\n  /**\r\n   * Set search term programmatically\r\n   * @param {string} searchTerm - Search term\r\n   */\r\n  async setSearchTerm(searchTerm) {\r\n    if (this.searchManager) {\r\n      await this.searchManager.setSearchTerm(searchTerm);\r\n    } else {\r\n      console.warn('TablixJS: Search is not enabled. Set search.enabled to true in options.');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current search term\r\n   * @returns {string} Current search term\r\n   */\r\n  getSearchTerm() {\r\n    return this.searchManager ? this.searchManager.getSearchTerm() : '';\r\n  }\r\n\r\n  /**\r\n   * Clear search\r\n   */\r\n  async clearSearch() {\r\n    if (this.searchManager) {\r\n      await this.searchManager.clearSearch();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get search information\r\n   * @returns {Object} Search results information\r\n   */\r\n  getSearchInfo() {\r\n    return this.searchManager ? this.searchManager.getSearchInfo() : null;\r\n  }\r\n\r\n  // ===== PAGINATION API =====\r\n\r\n  /**\r\n   * Go to next page\r\n   */\r\n  async nextPage() {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.nextPage();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to previous page\r\n   */\r\n  async prevPage() {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.prevPage();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to first page\r\n   */\r\n  async firstPage() {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.firstPage();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to last page\r\n   */\r\n  async lastPage() {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.lastPage();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Go to specific page\r\n   */\r\n  async goToPage(pageNumber) {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.goToPage(pageNumber);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Change page size\r\n   */\r\n  async changePageSize(pageSize) {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.changePageSize(pageSize);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get pagination information\r\n   */\r\n  getPaginationInfo() {\r\n    return this.paginationManager ? this.paginationManager.getInfo() : null;\r\n  }\r\n\r\n  /**\r\n   * Enable/disable pagination\r\n   */\r\n  async setPaginationEnabled(enabled) {\r\n    if (this.paginationManager) {\r\n      this.paginationManager.setEnabled(enabled);\r\n      await this.refreshTable();\r\n    } else if (enabled) {\r\n      // Create pagination manager if it doesn't exist\r\n      this.paginationManager = new PaginationManager(this, this.options.pagination);\r\n      await this.refreshTable();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Switch between client-side and server-side pagination\r\n   */\r\n  async setPaginationMode(mode, serverDataLoader = null) {\r\n    if (this.paginationManager) {\r\n      await this.paginationManager.setMode(mode, serverDataLoader);\r\n    }\r\n  }\r\n\r\n  // ===== EVENT MANAGEMENT =====\r\n\r\n  /**\r\n   * Register event callback\r\n   */\r\n  on(event, callback) {\r\n    this.eventManager.on(event, callback);\r\n  }\r\n\r\n  /**\r\n   * Remove event callback\r\n   */\r\n  off(event, callback) {\r\n    this.eventManager.off(event, callback);\r\n  }\r\n\r\n  /**\r\n   * Clear event listeners\r\n   */\r\n  clearEvents(event) {\r\n    this.eventManager.clear(event);\r\n  }\r\n\r\n  /**\r\n   * Trigger event\r\n   */\r\n  trigger(event, data) {\r\n    this.eventManager.trigger(event, data);\r\n  }\r\n\r\n  // ===== UTILITY METHODS =====\r\n\r\n  /**\r\n   * Get current filtered data\r\n   */\r\n  getData() {\r\n    return this.dataManager.getData();\r\n  }\r\n\r\n  /**\r\n   * Get original unfiltered data\r\n   */\r\n  getOriginalData() {\r\n    return this.dataManager.originalData;\r\n  }\r\n\r\n  /**\r\n   * Get table options\r\n   */\r\n  getOptions() {\r\n    return this.options;\r\n  }\r\n\r\n  /**\r\n   * Update table options\r\n   */\r\n  async setOptions(newOptions) {\r\n    this.options = { ...this.options, ...newOptions };\r\n    \r\n    // Update pagination options if provided\r\n    if (newOptions.pagination && this.paginationManager) {\r\n      this.paginationManager.options = { ...this.paginationManager.options, ...newOptions.pagination };\r\n    }\r\n    \r\n    // Update selection options if provided\r\n    if (newOptions.selection && this.selectionManager) {\r\n      this.selectionManager.options = { ...this.selectionManager.options, ...newOptions.selection };\r\n      \r\n      // Re-initialize if enabled state changed\r\n      if (newOptions.selection.enabled !== undefined) {\r\n        if (newOptions.selection.enabled) {\r\n          this.selectionManager.enable();\r\n        } else {\r\n          this.selectionManager.disable();\r\n        }\r\n      }\r\n      \r\n      // Update mode if provided\r\n      if (newOptions.selection.mode) {\r\n        this.selectionManager.setMode(newOptions.selection.mode);\r\n      }\r\n    }\r\n    \r\n    await this.refreshTable();\r\n  }\r\n\r\n  // ===== SELECTION API =====\r\n\r\n  /**\r\n   * Get selected row data\r\n   * @returns {Array} Array of selected row data objects\r\n   */\r\n  getSelectedData() {\r\n    return this.selectionManager ? this.selectionManager.getSelectedData() : [];\r\n  }\r\n\r\n  /**\r\n   * Get selected row IDs\r\n   * @returns {Array} Array of selected row IDs\r\n   */\r\n  getSelectedIds() {\r\n    return this.selectionManager ? this.selectionManager.getSelectedIds() : [];\r\n  }\r\n\r\n  /**\r\n   * Programmatically select rows by ID\r\n   * @param {String|Array} rowIds - Single row ID or array of row IDs\r\n   */\r\n  selectRows(rowIds) {\r\n    if (this.selectionManager) {\r\n      this.selectionManager.selectRows(rowIds);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Programmatically deselect rows by ID\r\n   * @param {String|Array} rowIds - Single row ID or array of row IDs\r\n   */\r\n  deselectRows(rowIds) {\r\n    if (this.selectionManager) {\r\n      this.selectionManager.deselectRows(rowIds);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear all selections\r\n   */\r\n  clearSelection() {\r\n    if (this.selectionManager) {\r\n      this.selectionManager.clearSelection();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if a row is selected\r\n   * @param {String} rowId - Row ID to check\r\n   * @returns {Boolean} True if row is selected\r\n   */\r\n  isRowSelected(rowId) {\r\n    return this.selectionManager ? this.selectionManager.isRowSelected(rowId) : false;\r\n  }\r\n\r\n  /**\r\n   * Get selection count\r\n   * @returns {Number} Number of selected rows\r\n   */\r\n  getSelectionCount() {\r\n    return this.selectionManager ? this.selectionManager.getSelectionCount() : 0;\r\n  }\r\n\r\n  /**\r\n   * Enable selection\r\n   */\r\n  enableSelection() {\r\n    if (this.selectionManager) {\r\n      this.selectionManager.enable();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Disable selection\r\n   */\r\n  disableSelection() {\r\n    if (this.selectionManager) {\r\n      this.selectionManager.disable();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set selection mode\r\n   * @param {String} mode - 'single' or 'multi'\r\n   */\r\n  setSelectionMode(mode) {\r\n    if (this.selectionManager) {\r\n      this.selectionManager.setMode(mode);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Select all rows (currently visible/filtered rows)\r\n   * This will select all rows that are currently visible based on applied filters and search\r\n   * @returns {Number} Number of rows selected\r\n   */\r\n  selectAllRows() {\r\n    if (!this.selectionManager) {\r\n      console.warn('TablixJS: Selection is not enabled. Set selection.enabled to true in options.');\r\n      return 0;\r\n    }\r\n\r\n    // Get currently visible/filtered data\r\n    const allData = this.getData();\r\n    \r\n    if (allData.length === 0) {\r\n      console.warn('TablixJS: No rows available to select.');\r\n      return 0;\r\n    }\r\n\r\n    // Extract all IDs from current data\r\n    const dataIdKey = this.options.selection.dataIdKey || 'id';\r\n    const allIds = allData.map(row => String(row[dataIdKey]));\r\n\r\n    // Select all rows\r\n    this.selectionManager.selectRows(allIds);\r\n\r\n    // Trigger custom event for select all action\r\n    this.eventManager.trigger('selectAll', { \r\n      selectedIds: allIds, \r\n      selectedData: allData,\r\n      count: allData.length \r\n    });\r\n\r\n    return allData.length;\r\n  }\r\n\r\n  // ===== LOCALIZATION API =====\r\n\r\n  /**\r\n   * Get localized string by key\r\n   * @param {string} key - Translation key (e.g., 'pagination.next')\r\n   * @param {Object} params - Parameters to substitute in the translation\r\n   * @returns {string} Localized string\r\n   */\r\n  t(key, params = {}) {\r\n    return this.localization.t(key, params);\r\n  }\r\n\r\n  /**\r\n   * Set the current language\r\n   * @param {string} language - Language code (e.g., 'en', 'fr', 'es')\r\n   */\r\n  setLanguage(language) {\r\n    // Close any open filter dropdowns before changing language\r\n    if (this.filterUI && this.filterUI.activeDropdown) {\r\n      this.filterUI.closeAllDropdowns();\r\n    }\r\n    \r\n    this.localization.setLanguage(language);\r\n    this.options.language = language;\r\n    \r\n    // Ensure language translations are available\r\n    this.ensureLanguageTranslations(language);\r\n    \r\n    // Re-render table to apply new translations\r\n    this.refreshTable();\r\n  }\r\n\r\n  /**\r\n   * Ensure language translations are loaded\r\n   * @private\r\n   * @param {string} language - Language code\r\n   */\r\n  ensureLanguageTranslations(language) {\r\n    // If translations are already available, no need to reload\r\n    if (this.localization.hasLanguage(language)) {\r\n      return;\r\n    }\r\n    \r\n    // Auto-load translations for common languages\r\n    const languageLoaders = {\r\n      'fr': () => frenchTranslations,\r\n      'es': () => spanishTranslations,\r\n      'sr': () => serbianTranslations\r\n    };\r\n    \r\n    if (languageLoaders[language]) {\r\n      try {\r\n        const translations = languageLoaders[language]();\r\n        this.localization.addTranslations(language, translations);\r\n        console.log(`TablixJS: Auto-loaded ${language} translations`);\r\n      } catch (error) {\r\n        console.warn(`TablixJS: Failed to auto-load ${language} translations:`, error);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add translations for a specific language\r\n   * @param {string} language - Language code\r\n   * @param {Object} translations - Translations object\r\n   */\r\n  addTranslations(language, translations) {\r\n    this.localization.addTranslations(language, translations);\r\n    // If we just added translations for the current language, re-render\r\n    if (language === this.localization.getCurrentLanguage()) {\r\n      this.refreshTable();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add a complete language pack (convenience method for developers)\r\n   * This method helps developers add a new language with all required translations\r\n   * @param {string} language - Language code (e.g., 'de', 'it', 'pt')\r\n   * @param {Object} translations - Complete translations object\r\n   * @param {boolean} setAsCurrent - Whether to immediately set this as the current language\r\n   */\r\n  addLanguagePack(language, translations, setAsCurrent = false) {\r\n    // Add the translations\r\n    this.addTranslations(language, translations);\r\n    \r\n    // Optionally set as current language\r\n    if (setAsCurrent) {\r\n      this.setLanguage(language);\r\n    }\r\n    \r\n    console.log(`TablixJS: Language pack '${language}' added successfully`);\r\n  }\r\n\r\n  /**\r\n   * Get current language\r\n   * @returns {string} Current language code\r\n   */\r\n  getCurrentLanguage() {\r\n    return this.localization.getCurrentLanguage();\r\n  }\r\n\r\n  /**\r\n   * Get available languages\r\n   * @returns {Array<string>} Array of available language codes\r\n   */\r\n  getAvailableLanguages() {\r\n    return this.localization.getAvailableLanguages();\r\n  }\r\n\r\n  /**\r\n   * Check if a language is available\r\n   * @param {string} language - Language code to check\r\n   * @returns {boolean} True if language is available\r\n   */\r\n  hasLanguage(language) {\r\n    return this.localization.hasLanguage(language);\r\n  }\r\n\r\n  /**\r\n   * Format number using current locale\r\n   * @param {number} number - Number to format\r\n   * @param {Object} options - Formatting options\r\n   * @returns {string} Formatted number\r\n   */\r\n  formatNumber(number, options = {}) {\r\n    return this.localization.formatNumber(number, options);\r\n  }\r\n\r\n  /**\r\n   * Format date using current locale\r\n   * @param {Date|string|number} date - Date to format\r\n   * @param {Object} options - Formatting options\r\n   * @returns {string} Formatted date\r\n   */\r\n  formatDate(date, options = {}) {\r\n    return this.localization.formatDate(date, options);\r\n  }\r\n\r\n  /**\r\n   * Destroy the table and clean up all resources\r\n   */\r\n  destroy() {\r\n    // Clean up virtual scrolling\r\n    if (this.virtualScrollManager) {\r\n      this.virtualScrollManager.destroy();\r\n    }\r\n\r\n    // Clean up other managers\r\n    if (this.selectionManager) {\r\n      this.selectionManager.destroy && this.selectionManager.destroy();\r\n    }\r\n\r\n    if (this.searchManager) {\r\n      this.searchManager.destroy && this.searchManager.destroy();\r\n    }\r\n\r\n    if (this.filterManager) {\r\n      this.filterManager.destroy && this.filterManager.destroy();\r\n    }\r\n\r\n    if (this.sortingManager) {\r\n      this.sortingManager.destroy && this.sortingManager.destroy();\r\n    }\r\n\r\n    if (this.paginationManager) {\r\n      this.paginationManager.destroy && this.paginationManager.destroy();\r\n    }\r\n\r\n    // Clear container\r\n    if (this.container) {\r\n      this.container.innerHTML = '';\r\n    }\r\n\r\n    // Clear references\r\n    this.virtualScrollManager = null;\r\n    this.selectionManager = null;\r\n    this.searchManager = null;\r\n    this.filterManager = null;\r\n    this.sortingManager = null;\r\n    this.paginationManager = null;\r\n    this.dataManager = null;\r\n    this.renderer = null;\r\n    this.eventManager = null;\r\n  }\r\n\r\n  /**\r\n   * Destroy table and clean up event listeners\r\n   */\r\n  destroy() {\r\n    // Clean up any event listeners\r\n    const paginationContainer = this.container.querySelector('.tablix-pagination');\r\n    if (paginationContainer) {\r\n      paginationContainer.removeEventListener('click', this._paginationClickHandler);\r\n    }\r\n\r\n    // Destroy managers\r\n    if (this.selectionManager) {\r\n      this.selectionManager.destroy();\r\n    }\r\n\r\n    // Clear container\r\n    this.container.innerHTML = '';\r\n    \r\n    // Clear references\r\n    this.dataManager = null;\r\n    this.renderer = null;\r\n    this.eventManager = null;\r\n    this.paginationManager = null;\r\n    this.sortingManager = null;\r\n    this.selectionManager = null;\r\n  }\r\n}","/**\r\n * TablixJS jQuery Wrapper Bundle\r\n * This file bundles TablixJS core with the jQuery wrapper for standalone use\r\n */\r\n\r\n// Import TablixJS core (default export is the Table class)\r\nimport Table from '../index.js';\r\n\r\n// Import the jQuery wrapper initializer\r\nimport { initializeJQueryWrapper } from './tablixjs-jquery-bundled.js';\r\n\r\n// Create TablixJS object with both the Table class and named export\r\nconst TablixJS = Table;\r\nTablixJS.Table = Table;\r\n\r\n// Expose TablixJS globally FIRST (before importing jQuery wrapper)\r\nif (typeof window !== 'undefined') {\r\n  window.TablixJS = TablixJS;\r\n} else if (typeof global !== 'undefined') {\r\n  global.TablixJS = TablixJS;\r\n}\r\n\r\n// Initialize the jQuery wrapper (this ensures the function is called and not tree-shaken)\r\nconst jQueryWrapperInitialized = initializeJQueryWrapper();\r\nconsole.log('TablixJS jQuery bundle initialized:', jQueryWrapperInitialized);\r\n\r\n// Export TablixJS as default (no named exports to avoid the warning)\r\nexport default TablixJS;\r\n","/**\r\n * TablixJS jQuery Wrapper for Bundled Version\r\n * This version directly imports the Table class instead of looking for globals\r\n */\r\n\r\n// Import the Table class directly\r\nimport Table from '../core/Table.js';\r\n\r\n/**\r\n * Initialize jQuery wrapper with direct Table class reference\r\n * This function is called by the bundle to set up the jQuery plugin\r\n */\r\nexport function initializeJQueryWrapper() {\r\n  // Get jQuery from various sources\r\n  const $ = (typeof window !== 'undefined' && (window.jQuery || window.$)) || \r\n            (typeof global !== 'undefined' && (global.jQuery || global.$)) ||\r\n            (typeof require === 'function' ? (() => {\r\n              try { return require('jquery'); } catch(e) { return null; }\r\n            })() : null);\r\n\r\n  if (!$) {\r\n    // jQuery not available - this is OK, just don't register the plugin\r\n    console.warn('TablixJS jQuery wrapper: jQuery is not available. The wrapper will not be registered.');\r\n    return false;\r\n  }\r\n\r\n  // Plugin name\r\n  const PLUGIN_NAME = 'tablixJS';\r\n  \r\n  // Data key for storing TablixJS instances\r\n  const DATA_KEY = 'tablixjs-instance';\r\n  \r\n  /**\r\n   * TablixJS jQuery Plugin\r\n   * @param {Object|String} options - Configuration options or method name\r\n   * @param {...*} args - Additional arguments for method calls\r\n   * @returns {jQuery|*} - jQuery chainable object or method result\r\n   */\r\n  $.fn[PLUGIN_NAME] = function(options, ...args) {\r\n    // Handle method calls on existing instances\r\n    if (typeof options === 'string') {\r\n      const method = options;\r\n      const $element = $(this.first()); // Use first element for method calls\r\n      const instance = $element.data(DATA_KEY);\r\n\r\n      if (!instance) {\r\n        console.error(`TablixJS: Cannot call method '${method}' - table not initialized`);\r\n        return this;\r\n      }\r\n\r\n      // Methods that return data (not chainable)\r\n      const dataReturningMethods = ['getData', 'getSelectedData', 'getSelectedIds', 'getPaginationInfo', 'getSearchTerm', 'getSearchInfo', 'getActiveFilters', 'getColumnFilter', 'getSortState', 'getSelectionCount', 'isRowSelected'];\r\n      \r\n      if (dataReturningMethods.includes(method)) {\r\n        switch (method) {\r\n          case 'getData':\r\n            return instance.getData();\r\n          case 'getSelectedData':\r\n            return instance.getSelectedData();\r\n          case 'getSelectedIds':\r\n            return instance.getSelectedIds();\r\n          case 'getPaginationInfo':\r\n            return instance.getPaginationInfo();\r\n          case 'getSearchTerm':\r\n            return instance.getSearchTerm();\r\n          case 'getSearchInfo':\r\n            return instance.getSearchInfo();\r\n          case 'getActiveFilters':\r\n            return instance.getActiveFilters();\r\n          case 'getColumnFilter':\r\n            return instance.getColumnFilter(args[0]);\r\n          case 'getSortState':\r\n            return instance.getSortState();\r\n          case 'getSelectionCount':\r\n            return instance.getSelectionCount();\r\n          case 'isRowSelected':\r\n            return instance.isRowSelected(args[0]);\r\n          default:\r\n            return undefined;\r\n        }\r\n      }\r\n\r\n      // Methods that don't return data (chainable)\r\n      switch (method) {\r\n        case 'destroy':\r\n          instance.destroy();\r\n          $element.removeData(DATA_KEY);\r\n          break;\r\n        case 'reload':\r\n        case 'loadData':\r\n          const newData = args[0];\r\n          if (newData) {\r\n            instance.loadData(newData);\r\n          }\r\n          break;\r\n        case 'clearSelection':\r\n          instance.clearSelection();\r\n          break;\r\n        case 'refresh':\r\n          instance.refreshTable();\r\n          break;\r\n        case 'selectRows':\r\n          instance.selectRows(args[0]);\r\n          break;\r\n        case 'deselectRows':\r\n          instance.deselectRows(args[0]);\r\n          break;\r\n        case 'selectAllRows':\r\n          instance.selectAllRows();\r\n          break;\r\n        case 'clearSearch':\r\n          instance.clearSearch();\r\n          break;\r\n        case 'setSearchTerm':\r\n          instance.setSearchTerm(args[0]);\r\n          break;\r\n        case 'applyFilter':\r\n          instance.applyFilter(args[0], args[1]);\r\n          break;\r\n        case 'clearFilter':\r\n          instance.clearFilter(args[0]);\r\n          break;\r\n        case 'clearAllFilters':\r\n          instance.clearAllFilters();\r\n          break;\r\n        case 'sort':\r\n          instance.sort(args[0], args[1]);\r\n          break;\r\n        case 'toggleSort':\r\n          instance.toggleSort(args[0]);\r\n          break;\r\n        case 'clearSorting':\r\n          instance.clearSorting();\r\n          break;\r\n        case 'nextPage':\r\n          instance.nextPage();\r\n          break;\r\n        case 'prevPage':\r\n          instance.prevPage();\r\n          break;\r\n        case 'firstPage':\r\n          instance.firstPage();\r\n          break;\r\n        case 'lastPage':\r\n          instance.lastPage();\r\n          break;\r\n        case 'goToPage':\r\n          instance.goToPage(args[0]);\r\n          break;\r\n        case 'changePageSize':\r\n          instance.changePageSize(args[0]);\r\n          break;\r\n        default:\r\n          console.warn(`TablixJS: Unknown method '${method}'`);\r\n      }\r\n      \r\n      // Return jQuery object for chaining for non-data methods\r\n      return this;\r\n    }\r\n\r\n    // Initialize new instances (chainable)\r\n    return this.each(function() {\r\n      const $element = $(this);\r\n      initializeTable($element, options);\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Initialize table instance\r\n   * @private\r\n   */\r\n  function initializeTable($element, options = {}) {\r\n    // Get existing instance\r\n    const existingInstance = $element.data(DATA_KEY);\r\n    \r\n    // If instance already exists, destroy it first\r\n    if (existingInstance) {\r\n      console.warn('TablixJS: Reinitializing existing table instance.');\r\n      existingInstance.destroy();\r\n    }\r\n    \r\n    // Normalize options structure\r\n    const normalizedOptions = normalizeOptions(options);\r\n    \r\n    try {\r\n      // Create new TablixJS instance using direct Table class reference\r\n      const instance = new Table($element[0], normalizedOptions);\r\n      \r\n      // Store instance reference\r\n      $element.data(DATA_KEY, instance);\r\n      \r\n      // Set up jQuery-specific event forwarding\r\n      setupJQueryEventForwarding($element, instance);\r\n      \r\n    } catch (error) {\r\n      console.error('TablixJS: Failed to initialize table:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Normalize options to handle jQuery-specific patterns\r\n   * @private\r\n   */\r\n  function normalizeOptions(options) {\r\n    // Handle jQuery-style option patterns\r\n    const normalized = { ...options };\r\n\r\n    // Convert jQuery elements to DOM elements\r\n    if (options.container && options.container.jquery) {\r\n      normalized.container = options.container[0];\r\n    }\r\n\r\n    return normalized;\r\n  }\r\n\r\n  /**\r\n   * Set up jQuery event forwarding\r\n   * @private\r\n   */\r\n  function setupJQueryEventForwarding($element, instance) {\r\n    // Forward TablixJS events as jQuery events\r\n    const eventsToForward = [\r\n      'beforeLoad', 'afterLoad', 'loadError',\r\n      'beforeSort', 'afterSort', \r\n      'beforeFilter', 'afterFilter',\r\n      'beforePageChange', 'afterPageChange',\r\n      'selectionChanged', 'selectAll'\r\n    ];\r\n\r\n    eventsToForward.forEach(eventName => {\r\n      instance.on(eventName, (data) => {\r\n        $element.trigger(`tablixjs:${eventName}`, data);\r\n      });\r\n    });\r\n  }\r\n\r\n  // jQuery plugin static methods\r\n  \r\n  /**\r\n   * Get TablixJS instance from element\r\n   * @param {jQuery|String} element - jQuery element or selector\r\n   * @returns {Object|null} - TablixJS instance or null\r\n   */\r\n  $.fn[PLUGIN_NAME].getInstance = function(element) {\r\n    const $el = $(element);\r\n    return $el.length > 0 ? $el.data(DATA_KEY) : null;\r\n  };\r\n\r\n  /**\r\n   * Check if element has TablixJS initialized\r\n   * @param {jQuery|String} element - jQuery element or selector\r\n   * @returns {Boolean} - True if initialized\r\n   */\r\n  $.fn[PLUGIN_NAME].isInitialized = function(element) {\r\n    const $el = $(element);\r\n    return $el.length > 0 && !!$el.data(DATA_KEY);\r\n  };\r\n\r\n  /**\r\n   * Destroy all TablixJS instances on the page\r\n   */\r\n  $.fn[PLUGIN_NAME].destroyAll = function() {\r\n    $(`[data-${DATA_KEY}]`).each(function() {\r\n      const $el = $(this);\r\n      const instance = $el.data(DATA_KEY);\r\n      if (instance) {\r\n        instance.destroy();\r\n        $el.removeData(DATA_KEY);\r\n      }\r\n    });\r\n  };\r\n\r\n  console.log('TablixJS jQuery plugin initialized successfully (bundled version)');\r\n  return true;\r\n}\r\n"],"names":["DataManager","constructor","table","data","this","originalData","filteredData","currentFilters","currentSorts","serverTotalRows","getData","setData","paginationManager","updatePaginationInfo","setServerData","totalRows","getTotalRows","length","applyFilter","criteria","Object","keys","filter","item","entries","every","key","value","toLowerCase","includes","resetToFirstPage","setFilteredData","applySorting","sorts","sortingManager","_applySorting","sort","a","b","column","direction","aVal","bVal","comparison","clearFilters","clearSorting","getPageData","page","pageSize","start","slice","Renderer","renderTable","virtualMode","columns","columnManager","getColumns","options","controlsOptions","controls","isVirtualScrollEnabled","virtualScrollManager","isEnabled","preservedSearchValue","searchInputHadFocus","cursorPosition","existingSearchInput","container","querySelector","document","activeElement","selectionStart","html","selectionManager","enabled","mode","position","renderControls","virtualScroll","containerHeight","forEach","col","isSortable","_isColumnSortable","sortDirection","_getSortDirection","name","title","t","row","index","globalIndex","currentPage","cell","renderedCell","result","formatCellValue","isHtml","escapeHtml","renderer","innerHTML","newSearchInput","renderPagination","bindControlEvents","searchManager","bindEvents","bindSortEvents","bindRowClickEvents","filterUI","renderFilterIcons","requestAnimationFrame","focus","setSelectionRange","eventManager","trigger","paginationContainer","info","getInfo","undefined","totalPages","showPageSizes","startRow","endRow","pageSizeOptions","size","showFirstLast","showPrevNext","hasPrevPage","showPageNumbers","getPageNumbers","hasNextPage","isLoading","bindPaginationEvents","addEventListener","async","e","target","classList","contains","disabled","preventDefault","parseInt","dataset","isNaN","goToPage","error","console","pageSizeSelect","newPageSize","changePageSize","text","div","createElement","textContent","renderLoading","renderError","message","searchOptions","search","placeholder","pagination","currentPageSize","refresh","placeholderText","wrapper","action","firstPage","prevPage","nextPage","lastPage","handleRefresh","handleExport","onRefresh","newData","loadData","refreshTable","csv","map","join","values","Date","replace","JSON","stringify","blob","Blob","type","url","URL","createObjectURL","href","download","body","appendChild","click","removeChild","revokeObjectURL","format","headerRow","th","closest","columnName","toggleSort","tbody","globalRowIndex","rowIndex","localRowIndex","currentData","getCurrentPageData","rowData","originalEvent","dataManager","updateSortIndicators","currentSort","querySelectorAll","isSorted","remove","indicator","arrow","add","setAttribute","removeAttribute","isColumnSortable","getSortDirection","EventManager","events","on","event","callback","push","off","indexOf","splice","clear","payload","cb","PaginationManager","maxPageNumbers","serverDataLoader","init","Math","ceil","getClientPageData","getServerPageData","pageNumber","targetPage","max","min","oldPage","stateManager","updatePagination","newPage","oldPageSize","floor","maxPages","pages","end","i","unshift","setEnabled","setMode","isComplexValue","resolveColumnValue","purpose","rawValue","accessorKey","pathKey","err","warn","obj","path","segments","split","current","segment","getByPath","isFeatureEnabled","sampleData","flag","edit","limit","SortingManager","serverSortLoader","defaultSortType","caseSensitive","nullsFirst","sortOrder","sortTypes","auto","_autoSort","bind","string","_stringSort","number","_numberSort","date","_dateSort","boolean","_booleanSort","updateSort","resetPage","currentIndex","nextDirection","_sortClient","_sortServer","find","valA","valB","_compareValues","sortFunction","sortType","numA","parseFloat","numB","dateA","dateB","isDateLike","str","test","String","strA","trim","strB","localeCompare","sensitivity","boolA","filters","getSortState","setOptions","newOptions","ColumnManager","formatters","Map","supportedFormats","initializeColumns","prepareColumn","compileFormatters","prepared","Error","formatter","createFormatter","set","locale","formatOptions","formatText","formatDate","formatCurrency","currency","formatNumber","formatPercent","columnObj","getColumn","get","formattedValue","getTime","Intl","DateTimeFormat","numericValue","Number","style","NumberFormat","registerFormat","formatType","formatterFactory","log","getSupportedFormats","FilterManager","serverFilterLoader","debounceDelay","showBadges","showTooltips","columnFilters","operators","none","label","apply","isEmpty","isNotEmpty","equals","filterValue","notEquals","beginsWith","startsWith","endsWith","notContains","debounceTimer","openDropdowns","Set","filterConfig","validateFilterConfig","beforeFilterData","getActiveFilters","config","isActive","isFilterActive","updateFilters","_filterClient","updateFilterIndicators","activeFilters","clearFilter","has","delete","clearAllFilters","filterState","isColumnFilterable","_getColumnDef","getColumnUniqueValues","resolved","Array","from","getColumnFilter","hasColumnFilter","isArray","conditions","cond","operator","some","_testRowAgainstFilter","_filterServer","cellValue","cellValueStr","_valueToString","condition","header","hasFilter","filterIndicator","_updateFilterBadge","badge","badgeText","activeConditions","className","registerOperator","getOperators","c","FilterUI","filterManager","activeDropdown","handleDocumentClick","handleFilterIconClick","_isColumnFilterable","destroy","removeEventListener","closeAllDropdowns","thContent","filterIcon","stopPropagation","sortIndicator","insertBefore","nextSibling","dropdown","createFilterDropdown","showDropdown","renderDropdownContent","bindDropdownEvents","currentFilter","renderValueFilterPanel","renderConditionFilterPanel","uniqueValues","selectedValues","isChecked","renderConditionRow","needsValue","op","tab","switchTab","bindValueFilterEvents","bindConditionFilterEvents","valuePanel","searchInput","searchTimeout","clearTimeout","setTimeout","filterValueList","selectAllCheckbox","toggleSelectAll","checked","checkbox","updateSelectAllState","conditionPanel","addButton","addCondition","bindConditionRowEvents","select","valueInput","parentElement","button","conditionRow","operatorSelect","tabType","toggle","panel","searchTerm","items","term","matches","display","checkboxes","visibleCheckboxes","checkedCount","indeterminate","conditionsContainer","conditionHtml","children","insertAdjacentHTML","newCondition","lastElementChild","collectValueFilter","collectConditionFilter","conditionRows","top","left","visibility","triggerRect","getBoundingClientRect","dropdownRect","window","scrollX","bottom","scrollY","width","innerWidth","height","innerHeight","SearchManager","searchDelay","searchColumns","minLength","currentSearchTerm","handleSearchInput","handleSearchClear","source","performSearch","searchClear","clearSearch","updateClearButtonVisibility","previousTerm","hadFocus","willSearch","updateSearch","_isServerMode","filterData","afterSearchData","resultsCount","totalCount","isSearchActive","searchPerformed","getSearchableColumns","updateInputValue","setSearchTerm","getSearchTerm","getSearchInfo","configure","oldOptions","getConfiguration","SelectionManager","selectedRows","lastSelectedRow","rowIdMap","dataIdKey","dragSelection","startRowIndex","currentRowIndex","startRowId","originalSelection","isDragging","dragThreshold","eventListeners","eventListenersSetup","setupEventListeners","handleRowClick","setupDragSelection","clearSelection","updateSelectionAfterDataChange","updateUI","rowId","getRowId","hasOriginalEvent","ctrlKey","shiftKey","metaKey","timestamp","now","beforeSelectEvent","currentSelection","isCtrlClick","isShiftClick","isDragSelection","handleSingleSelection","handleMultiSelection","afterSelectEvent","selectedData","getSelectedData","selectionSize","handleRangeSelection","endRowId","fullData","getFullData","startIndex","findIndex","endIndex","minIndex","maxIndex","tableElement","startX","startY","clientX","clientY","abs","startDragSelection","updateDragSelection","completeDragSelection","cancelDragSelection","tableWrapper","dragStart","applyDragSelection","dragComplete","resetDragSelection","createRowHash","hash","charCodeAt","allRows","hasAttribute","virtualIndex","getAttribute","allDataRowIds","newSelection","getSelectedIds","selectRows","rowIds","ids","id","deselectRows","hadSelection","isRowSelected","isRowSelectedByData","getSelectionCount","enable","disable","oldMode","lastSelected","VirtualScrollManager","buffer","rowHeight","throttleDelay","scrollContainer","tableBody","topSpacer","bottomSpacer","visibleStart","visibleEnd","renderedStart","renderedEnd","performanceData","renderTimes","scrollUpdates","lastMeasurement","throttledScrollHandler","throttle","handleScroll","immediateScrollHandler","updateScheduled","pendingUpdate","lastScrollTime","scrollVelocity","renderedData","setupScrollContainer","detectRowHeight","calculateViewport","scheduleUpdate","handleScrollImmediate","passive","handleScrollStart","handleScrollEnd","handleResize","setupEventDelegation","setupSelectionListeners","rowClickHandler","justFinishedDrag","eventType","element","updateSelectionStates","setupVirtualDragSelection","rowHoverHandler","createSpacers","existingTop","existingBottom","cssText","firstChild","sampleRow","renderSingleRow","rect","scrollTop","visibleRowCount","updateSpacers","bottomHeight","performance","lastScrollTop","timeDelta","isScrollbarDragging","scrollDragInterval","setInterval","clearInterval","isDragSelecting","dragStartIndex","dragStartX","dragStartY","applyVirtualDragSelection","handleMouseUp","update","startTime","renderVisibleRows","endTime","trackPerformance","fragment","createDocumentFragment","handleImageLoading","img","complete","cloneNode","src","handleLoad","opacity","handleError","transition","originalIndex","tr","td","rendered","updateData","scrollToRow","getVisibleRange","getRenderedData","renderTime","shift","getPerformanceStats","times","avg","reduce","averageRenderTime","toFixed","maxRenderTime","minRenderTime","visibleRows","renderedRows","func","inThrottle","arguments","debug","Localization","currentLanguage","translations","fallbackLanguage","addTranslations","getDefaultEnglishTranslations","setLanguage","language","languageCode","existing","params","translation","getTranslationFromLanguage","substituteParameters","languageTranslations","k","regex","RegExp","getCurrentLanguage","getAvailableLanguages","hasLanguage","getAllTranslations","removeLanguage","clearTranslations","fallbackTranslations","minimumFractionDigits","maximumFractionDigits","getLocaleCode","fallbackNumberFormat","dateObj","toLocaleDateString","en","fr","es","de","it","pt","ru","ja","ko","zh","symbol","pluralize","count","singularKey","pluralKey","StateManager","state","isInitialized","getState","pageState","sortState","updateLoading","getServerParams","markInitialized","isReady","reset","frenchTranslations","spanishTranslations","serbianTranslations","Table","sorting","filtering","export","selection","localization","lang","isServerMode","_loadServerData","loadedData","dataToRender","_fetchFromUrl","fetch","response","ok","status","statusText","json","getPaginationInfo","setPaginationEnabled","setPaginationMode","clearEvents","getOriginalData","getOptions","enableSelection","disableSelection","setSelectionMode","selectAllRows","allData","allIds","selectedIds","ensureLanguageTranslations","languageLoaders","sr","addLanguagePack","setAsCurrent","_paginationClickHandler","TablixJS","global","jQueryWrapperInitialized","$","jQuery","require","PLUGIN_NAME","DATA_KEY","fn","args","method","$element","first","instance","removeData","each","existingInstance","normalizedOptions","normalized","jquery","normalizeOptions","eventName","setupJQueryEventForwarding","initializeTable","getInstance","$el","destroyAll","initializeJQueryWrapper"],"mappings":"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"}